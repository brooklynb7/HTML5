/*!
 * @copyright@
 */
sap.ui.controller("sap.collaboration.components.fiori.feed.splitApp.SplitApp",{onInit:function(){this.oSplitApp=this.getView().oSplitApp;this.sAppType=this.getView().getViewData().appType;this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.oEventBus=sap.ui.getCore().getEventBus();this.oEventBus.subscribe("nav","to",this.navToHandler,this);this.oEventBus.subscribe("nav","back",this.navBackHandler,this)},onBeforeRendering:function(){this.createMasterDetail()},createMasterDetail:function(){var o=new sap.collaboration.components.utils.OdataUtil();var j=o.getJamUrl(this.oOdataModel);this.sJamToken=o.getJamToken(this.oOdataModel);var m=sap.ui.view({id:this.sPrefixId+"masterView",viewData:{controlId:this.sPrefixId,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.feed.splitApp.FeedTypeMaster"});var d=sap.ui.view({id:this.sPrefixId+"detailView",viewData:{controlId:this.sPrefixId,appType:this.sAppType,jamURL:j,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.collaboration.components.fiori.feed.commons.Detail"});this.oSplitApp.addDetailPage(d);this.oSplitApp.addMasterPage(m);this.oSplitApp.setInitialDetail(d);this.oSplitApp.setInitialMaster(m)},navToHandler:function(c,e,d){if(d&&d.viewId===this.sPrefixId+"groupMasterView"){if(!sap.ui.getCore().byId(d.viewId)){var v=sap.ui.view({id:d.viewId,viewData:{controlId:this.sPrefixId,odataModel:this.oOdataModel,object:this.oBusinessObject,feedType:d.data.feedType,pageTitle:d.data.groupMasterPageTitle,jamToken:this.sJamToken,langBundle:this.oLangBundle},type:sap.ui.core.mvc.ViewType.JS,viewName:d.viewName});this.oSplitApp.addMasterPage(v)}else{sap.ui.getCore().byId(d.viewId).getController().sFeedType=d.data.feedType;sap.ui.getCore().byId(d.viewId).getController().sPageTitle=d.data.groupMasterPageTitle;sap.ui.getCore().byId(d.viewId).rerender()}this.oSplitApp.to(d.viewId)}else{jQuery.sap.log.error("nav-to event cannot be processed. Invalid data: "+d)}},navBackHandler:function(){this.oSplitApp.backMaster()}});
