 VBI.GeoLocation=
function(){var g={};g.vbiclass="GeoLocation";g.m_coords={};g.m_bValid=false;g.m_coords.latiude=0;g.m_coords.longitude=0;g.m_coords.altitude=0;g.m_coords.accuracy=0;g.m_coords.altiudeAccuracy=0;g.m_coords.heading=0;g.m_coords.speed=0;g.m_timestamp=0;g.m_watch=null;g.OnError=function(m){VBI.m_bTrace&&VBI.Trace("GeoLocation.OnError: "+(typeof m=='string'?m:"unknown"))};g.OnPosition=function(p){g.m_coords.latiude=p.coords.latitude*Math.PI/180;g.m_coords.longitude=p.coords.longitude*Math.PI/180;g.m_coords.altitude=p.coords.altitude;g.m_coords.accuracy=p.coords.accuracy;g.m_coords.altiudeAccuracy=p.coords.altiudeAccuracy;g.m_coords.heading=p.coords.heading;g.m_coords.speed=p.coords.speed;g.m_timestamp=p.timestamp;g.m_bValid=true;g.OnPositionChanged(g)};g.StartWatch=function(){if(g.watch)return;if(!navigator)return;g.m_watch=navigator.geolocation.watchPosition(g.OnPosition,g.OnError);return};g.StopWatch=function(){if(g.watch)navigator.geolocation.clearWatch(g.watch);g.watch=null};g.GetWifiScan=function(l,a){var w=VBI.Utilities.CreateWifiObject();if(w)return w.ScanWifi("Scan "+a+","+l,0);return null};g.OnPositionChanged=null;return g}
;
