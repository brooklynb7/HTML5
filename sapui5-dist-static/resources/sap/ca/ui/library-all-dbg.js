// This file has been generated by the SAPUI5 'AllInOne' Builder
/*
 * jQuery File Upload Plugin 5.32.2
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

/*jslint nomen: true, unparam: true, regexp: true */
/*global define, window, document, location, File, Blob, FormData */

try{
(function (factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // Register as an anonymous AMD module:
        define([
            'jquery',
            'jquery.ui.widget'
        ], factory);
    } else {
        // Browser globals:
        factory(window.jQuery);
    }
}(function ($) {
    'use strict';

    // Detect file input support, based on
    // http://viljamis.com/blog/2012/file-upload-support-on-mobile/
    $.support.fileInput = !(new RegExp(
        // Handle devices which give false positives for the feature detection:
        '(Android (1\\.[0156]|2\\.[01]))' +
            '|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)' +
            '|(w(eb)?OSBrowser)|(webOS)' +
            '|(Kindle/(1\\.0|2\\.[05]|3\\.0))'
    ).test(window.navigator.userAgent) ||
        // Feature detection for all other devices:
        $('<input type="file">').prop('disabled'));

    // The FileReader API is not actually used, but works as feature detection,
    // as e.g. Safari supports XHR file uploads via the FormData API,
    // but not non-multipart XHR file uploads:
    $.support.xhrFileUpload = !!(window.XMLHttpRequestUpload && window.FileReader);
    $.support.xhrFormDataFileUpload = !!window.FormData;

    // Detect support for Blob slicing (required for chunked uploads):
    $.support.blobSlice = window.Blob && (Blob.prototype.slice ||
        Blob.prototype.webkitSlice || Blob.prototype.mozSlice);

    // The fileupload widget listens for change events on file input fields defined
    // via fileInput setting and paste or drop events of the given dropZone.
    // In addition to the default jQuery Widget methods, the fileupload widget
    // exposes the "add" and "send" methods, to add or directly send files using
    // the fileupload API.
    // By default, files added via file input selection, paste, drag & drop or
    // "add" method are uploaded immediately, but it is possible to override
    // the "add" callback option to queue file uploads.
    $.widget('blueimp.fileupload', {

        options: {
            // The drop target element(s), by the default the complete document.
            // Set to null to disable drag & drop support:
            dropZone: $(document),
            // The paste target element(s), by the default the complete document.
            // Set to null to disable paste support:
            pasteZone: $(document),
            // The file input field(s), that are listened to for change events.
            // If undefined, it is set to the file input fields inside
            // of the widget element on plugin initialization.
            // Set to null to disable the change listener.
            fileInput: undefined,
            // By default, the file input field is replaced with a clone after
            // each input field change event. This is required for iframe transport
            // queues and allows change events to be fired for the same file
            // selection, but can be disabled by setting the following option to false:
            replaceFileInput: true,
            // The parameter name for the file form data (the request argument name).
            // If undefined or empty, the name property of the file input field is
            // used, or "files[]" if the file input name property is also empty,
            // can be a string or an array of strings:
            paramName: undefined,
            // By default, each file of a selection is uploaded using an individual
            // request for XHR type uploads. Set to false to upload file
            // selections in one request each:
            singleFileUploads: true,
            // To limit the number of files uploaded with one XHR request,
            // set the following option to an integer greater than 0:
            limitMultiFileUploads: undefined,
            // Set the following option to true to issue all file upload requests
            // in a sequential order:
            sequentialUploads: false,
            // To limit the number of concurrent uploads,
            // set the following option to an integer greater than 0:
            limitConcurrentUploads: undefined,
            // Set the following option to true to force iframe transport uploads:
            forceIframeTransport: false,
            // Set the following option to the location of a redirect url on the
            // origin server, for cross-domain iframe transport uploads:
            redirect: undefined,
            // The parameter name for the redirect url, sent as part of the form
            // data and set to 'redirect' if this option is empty:
            redirectParamName: undefined,
            // Set the following option to the location of a postMessage window,
            // to enable postMessage transport uploads:
            postMessage: undefined,
            // By default, XHR file uploads are sent as multipart/form-data.
            // The iframe transport is always using multipart/form-data.
            // Set to false to enable non-multipart XHR uploads:
            multipart: true,
            // To upload large files in smaller chunks, set the following option
            // to a preferred maximum chunk size. If set to 0, null or undefined,
            // or the browser does not support the required Blob API, files will
            // be uploaded as a whole.
            maxChunkSize: undefined,
            // When a non-multipart upload or a chunked multipart upload has been
            // aborted, this option can be used to resume the upload by setting
            // it to the size of the already uploaded bytes. This option is most
            // useful when modifying the options object inside of the "add" or
            // "send" callbacks, as the options are cloned for each file upload.
            uploadedBytes: undefined,
            // By default, failed (abort or error) file uploads are removed from the
            // global progress calculation. Set the following option to false to
            // prevent recalculating the global progress data:
            recalculateProgress: true,
            // Interval in milliseconds to calculate and trigger progress events:
            progressInterval: 100,
            // Interval in milliseconds to calculate progress bitrate:
            bitrateInterval: 500,
            // By default, uploads are started automatically when adding files:
            autoUpload: true,

            // Error and info messages:
            messages: {
                uploadedBytes: 'Uploaded bytes exceed file size'
            },

            // Translation function, gets the message key to be translated
            // and an object with context specific data as arguments:
            i18n: function (message, context) {
                message = this.messages[message] || message.toString();
                if (context) {
                    $.each(context, function (key, value) {
                        message = message.replace('{' + key + '}', value);
                    });
                }
                return message;
            },

            // Additional form data to be sent along with the file uploads can be set
            // using this option, which accepts an array of objects with name and
            // value properties, a function returning such an array, a FormData
            // object (for XHR file uploads), or a simple object.
            // The form of the first fileInput is given as parameter to the function:
            formData: function (form) {
                return form.serializeArray();
            },

            // The add callback is invoked as soon as files are added to the fileupload
            // widget (via file input selection, drag & drop, paste or add API call).
            // If the singleFileUploads option is enabled, this callback will be
            // called once for each file in the selection for XHR file uploads, else
            // once for each file selection.
            //
            // The upload starts when the submit method is invoked on the data parameter.
            // The data object contains a files property holding the added files
            // and allows you to override plugin options as well as define ajax settings.
            //
            // Listeners for this callback can also be bound the following way:
            // .bind('fileuploadadd', func);
            //
            // data.submit() returns a Promise object and allows to attach additional
            // handlers using jQuery's Deferred callbacks:
            // data.submit().done(func).fail(func).always(func);
            add: function (e, data) {
                if (data.autoUpload || (data.autoUpload !== false &&
                        $(this).fileupload('option', 'autoUpload'))) {
                    data.process().done(function () {
                        data.submit();
                    });
                }
            },

            // Other callbacks:

            // Callback for the submit event of each file upload:
            // submit: function (e, data) {}, // .bind('fileuploadsubmit', func);

            // Callback for the start of each file upload request:
            // send: function (e, data) {}, // .bind('fileuploadsend', func);

            // Callback for successful uploads:
            // done: function (e, data) {}, // .bind('fileuploaddone', func);

            // Callback for failed (abort or error) uploads:
            // fail: function (e, data) {}, // .bind('fileuploadfail', func);

            // Callback for completed (success, abort or error) requests:
            // always: function (e, data) {}, // .bind('fileuploadalways', func);

            // Callback for upload progress events:
            // progress: function (e, data) {}, // .bind('fileuploadprogress', func);

            // Callback for global upload progress events:
            // progressall: function (e, data) {}, // .bind('fileuploadprogressall', func);

            // Callback for uploads start, equivalent to the global ajaxStart event:
            // start: function (e) {}, // .bind('fileuploadstart', func);

            // Callback for uploads stop, equivalent to the global ajaxStop event:
            // stop: function (e) {}, // .bind('fileuploadstop', func);

            // Callback for change events of the fileInput(s):
            // change: function (e, data) {}, // .bind('fileuploadchange', func);

            // Callback for paste events to the pasteZone(s):
            // paste: function (e, data) {}, // .bind('fileuploadpaste', func);

            // Callback for drop events of the dropZone(s):
            // drop: function (e, data) {}, // .bind('fileuploaddrop', func);

            // Callback for dragover events of the dropZone(s):
            // dragover: function (e) {}, // .bind('fileuploaddragover', func);

            // Callback for the start of each chunk upload request:
            // chunksend: function (e, data) {}, // .bind('fileuploadchunksend', func);

            // Callback for successful chunk uploads:
            // chunkdone: function (e, data) {}, // .bind('fileuploadchunkdone', func);

            // Callback for failed (abort or error) chunk uploads:
            // chunkfail: function (e, data) {}, // .bind('fileuploadchunkfail', func);

            // Callback for completed (success, abort or error) chunk upload requests:
            // chunkalways: function (e, data) {}, // .bind('fileuploadchunkalways', func);

            // The plugin options are used as settings object for the ajax calls.
            // The following are jQuery ajax settings required for the file uploads:
            processData: false,
            contentType: false,
            cache: false
        },

        // A list of options that require reinitializing event listeners and/or
        // special initialization code:
        _specialOptions: [
            'fileInput',
            'dropZone',
            'pasteZone',
            'multipart',
            'forceIframeTransport'
        ],

        _blobSlice: $.support.blobSlice && function () {
            var slice = this.slice || this.webkitSlice || this.mozSlice;
            return slice.apply(this, arguments);
        },

        _BitrateTimer: function () {
            this.timestamp = ((Date.now) ? Date.now() : (new Date()).getTime());
            this.loaded = 0;
            this.bitrate = 0;
            this.getBitrate = function (now, loaded, interval) {
                var timeDiff = now - this.timestamp;
                if (!this.bitrate || !interval || timeDiff > interval) {
                    this.bitrate = (loaded - this.loaded) * (1000 / timeDiff) * 8;
                    this.loaded = loaded;
                    this.timestamp = now;
                }
                return this.bitrate;
            };
        },

        _isXHRUpload: function (options) {
            return !options.forceIframeTransport &&
                ((!options.multipart && $.support.xhrFileUpload) ||
                $.support.xhrFormDataFileUpload);
        },

        _getFormData: function (options) {
            var formData;
            if (typeof options.formData === 'function') {
                return options.formData(options.form);
            }
            if ($.isArray(options.formData)) {
                return options.formData;
            }
            if ($.type(options.formData) === 'object') {
                formData = [];
                $.each(options.formData, function (name, value) {
                    formData.push({name: name, value: value});
                });
                return formData;
            }
            return [];
        },

        _getTotal: function (files) {
            var total = 0;
            $.each(files, function (index, file) {
                total += file.size || 1;
            });
            return total;
        },

        _initProgressObject: function (obj) {
            var progress = {
                loaded: 0,
                total: 0,
                bitrate: 0
            };
            if (obj._progress) {
                $.extend(obj._progress, progress);
            } else {
                obj._progress = progress;
            }
        },

        _initResponseObject: function (obj) {
            var prop;
            if (obj._response) {
                for (prop in obj._response) {
                    if (obj._response.hasOwnProperty(prop)) {
                        delete obj._response[prop];
                    }
                }
            } else {
                obj._response = {};
            }
        },

        _onProgress: function (e, data) {
            if (e.lengthComputable) {
                var now = ((Date.now) ? Date.now() : (new Date()).getTime()),
                    loaded;
                if (data._time && data.progressInterval &&
                        (now - data._time < data.progressInterval) &&
                        e.loaded !== e.total) {
                    return;
                }
                data._time = now;
                loaded = Math.floor(
                    e.loaded / e.total * (data.chunkSize || data._progress.total)
                ) + (data.uploadedBytes || 0);
                // Add the difference from the previously loaded state
                // to the global loaded counter:
                this._progress.loaded += (loaded - data._progress.loaded);
                this._progress.bitrate = this._bitrateTimer.getBitrate(
                    now,
                    this._progress.loaded,
                    data.bitrateInterval
                );
                data._progress.loaded = data.loaded = loaded;
                data._progress.bitrate = data.bitrate = data._bitrateTimer.getBitrate(
                    now,
                    loaded,
                    data.bitrateInterval
                );
                // Trigger a custom progress event with a total data property set
                // to the file size(s) of the current upload and a loaded data
                // property calculated accordingly:
                this._trigger('progress', e, data);
                // Trigger a global progress event for all current file uploads,
                // including ajax calls queued for sequential file uploads:
                this._trigger('progressall', e, this._progress);
            }
        },

        _initProgressListener: function (options) {
            var that = this,
                xhr = options.xhr ? options.xhr() : $.ajaxSettings.xhr();
            // Accesss to the native XHR object is required to add event listeners
            // for the upload progress event:
            if (xhr.upload) {
                $(xhr.upload).bind('progress', function (e) {
                    var oe = e.originalEvent;
                    // Make sure the progress event properties get copied over:
                    e.lengthComputable = oe.lengthComputable;
                    e.loaded = oe.loaded;
                    e.total = oe.total;
                    that._onProgress(e, options);
                });
                options.xhr = function () {
                    return xhr;
                };
            }
        },

        _isInstanceOf: function (type, obj) {
            // Cross-frame instanceof check
            return Object.prototype.toString.call(obj) === '[object ' + type + ']';
        },

        _initXHRData: function (options) {
            var that = this,
                formData,
                file = options.files[0],
                // Ignore non-multipart setting if not supported:
                multipart = options.multipart || !$.support.xhrFileUpload,
                paramName = options.paramName[0];
            options.headers = options.headers || {};
            if (options.contentRange) {
                options.headers['Content-Range'] = options.contentRange;
            }
            if (!multipart || options.blob || !this._isInstanceOf('File', file)) {
                options.headers['Content-Disposition'] = 'attachment; filename="' +
                    encodeURI(file.name) + '"';
            }
            if (!multipart) {
                options.contentType = file.type;
                options.data = options.blob || file;
            } else if ($.support.xhrFormDataFileUpload) {
                if (options.postMessage) {
                    // window.postMessage does not allow sending FormData
                    // objects, so we just add the File/Blob objects to
                    // the formData array and let the postMessage window
                    // create the FormData object out of this array:
                    formData = this._getFormData(options);
                    if (options.blob) {
                        formData.push({
                            name: paramName,
                            value: options.blob
                        });
                    } else {
                        $.each(options.files, function (index, file) {
                            formData.push({
                                name: options.paramName[index] || paramName,
                                value: file
                            });
                        });
                    }
                } else {
                    if (that._isInstanceOf('FormData', options.formData)) {
                        formData = options.formData;
                    } else {
                        formData = new FormData();
                        $.each(this._getFormData(options), function (index, field) {
                            formData.append(field.name, field.value);
                        });
                    }
                    if (options.blob) {
                        formData.append(paramName, options.blob, file.name);
                    } else {
                        $.each(options.files, function (index, file) {
                            // This check allows the tests to run with
                            // dummy objects:
                            if (that._isInstanceOf('File', file) ||
                                    that._isInstanceOf('Blob', file)) {
                                formData.append(
                                    options.paramName[index] || paramName,
                                    file,
                                    file.name
                                );
                            }
                        });
                    }
                }
                options.data = formData;
            }
            // Blob reference is not needed anymore, free memory:
            options.blob = null;
        },

        _initIframeSettings: function (options) {
            var targetHost = $('<a></a>').prop('href', options.url).prop('host');
            // Setting the dataType to iframe enables the iframe transport:
            options.dataType = 'iframe ' + (options.dataType || '');
            // The iframe transport accepts a serialized array as form data:
            options.formData = this._getFormData(options);
            // Add redirect url to form data on cross-domain uploads:
            if (options.redirect && targetHost && targetHost !== location.host) {
                options.formData.push({
                    name: options.redirectParamName || 'redirect',
                    value: options.redirect
                });
            }
        },

        _initDataSettings: function (options) {
            if (this._isXHRUpload(options)) {
                if (!this._chunkedUpload(options, true)) {
                    if (!options.data) {
                        this._initXHRData(options);
                    }
                    this._initProgressListener(options);
                }
                if (options.postMessage) {
                    // Setting the dataType to postmessage enables the
                    // postMessage transport:
                    options.dataType = 'postmessage ' + (options.dataType || '');
                }
            } else {
                this._initIframeSettings(options);
            }
        },

        _getParamName: function (options) {
            var fileInput = $(options.fileInput),
                paramName = options.paramName;
            if (!paramName) {
                paramName = [];
                fileInput.each(function () {
                    var input = $(this),
                        name = input.prop('name') || 'files[]',
                        i = (input.prop('files') || [1]).length;
                    while (i) {
                        paramName.push(name);
                        i -= 1;
                    }
                });
                if (!paramName.length) {
                    paramName = [fileInput.prop('name') || 'files[]'];
                }
            } else if (!$.isArray(paramName)) {
                paramName = [paramName];
            }
            return paramName;
        },

        _initFormSettings: function (options) {
            // Retrieve missing options from the input field and the
            // associated form, if available:
            if (!options.form || !options.form.length) {
                options.form = $(options.fileInput.prop('form'));
                // If the given file input doesn't have an associated form,
                // use the default widget file input's form:
                if (!options.form.length) {
                    options.form = $(this.options.fileInput.prop('form'));
                }
            }
            options.paramName = this._getParamName(options);
            if (!options.url) {
                options.url = options.form.prop('action') || location.href;
            }
            // The HTTP request method must be "POST" or "PUT":
            options.type = (options.type || options.form.prop('method') || '')
                .toUpperCase();
            if (options.type !== 'POST' && options.type !== 'PUT' &&
                    options.type !== 'PATCH') {
                options.type = 'POST';
            }
            if (!options.formAcceptCharset) {
                options.formAcceptCharset = options.form.attr('accept-charset');
            }
        },

        _getAJAXSettings: function (data) {
            var options = $.extend({}, this.options, data);
            this._initFormSettings(options);
            this._initDataSettings(options);
            return options;
        },

        // jQuery 1.6 doesn't provide .state(),
        // while jQuery 1.8+ removed .isRejected() and .isResolved():
        _getDeferredState: function (deferred) {
            if (deferred.state) {
                return deferred.state();
            }
            if (deferred.isResolved()) {
                return 'resolved';
            }
            if (deferred.isRejected()) {
                return 'rejected';
            }
            return 'pending';
        },

        // Maps jqXHR callbacks to the equivalent
        // methods of the given Promise object:
        _enhancePromise: function (promise) {
            promise.success = promise.done;
            promise.error = promise.fail;
            promise.complete = promise.always;
            return promise;
        },

        // Creates and returns a Promise object enhanced with
        // the jqXHR methods abort, success, error and complete:
        _getXHRPromise: function (resolveOrReject, context, args) {
            var dfd = $.Deferred(),
                promise = dfd.promise();
            context = context || this.options.context || promise;
            if (resolveOrReject === true) {
                dfd.resolveWith(context, args);
            } else if (resolveOrReject === false) {
                dfd.rejectWith(context, args);
            }
            promise.abort = dfd.promise;
            return this._enhancePromise(promise);
        },

        // Adds convenience methods to the data callback argument:
        _addConvenienceMethods: function (e, data) {
            var that = this,
                getPromise = function (data) {
                    return $.Deferred().resolveWith(that, [data]).promise();
                };
            data.process = function (resolveFunc, rejectFunc) {
                if (resolveFunc || rejectFunc) {
                    data._processQueue = this._processQueue =
                        (this._processQueue || getPromise(this))
                            .pipe(resolveFunc, rejectFunc);
                }
                return this._processQueue || getPromise(this);
            };
            data.submit = function () {
                if (this.state() !== 'pending') {
                    data.jqXHR = this.jqXHR =
                        (that._trigger('submit', e, this) !== false) &&
                        that._onSend(e, this);
                }
                return this.jqXHR || that._getXHRPromise();
            };
            data.abort = function () {
                if (this.jqXHR) {
                    return this.jqXHR.abort();
                }
                return that._getXHRPromise();
            };
            data.state = function () {
                if (this.jqXHR) {
                    return that._getDeferredState(this.jqXHR);
                }
                if (this._processQueue) {
                    return that._getDeferredState(this._processQueue);
                }
            };
            data.progress = function () {
                return this._progress;
            };
            data.response = function () {
                return this._response;
            };
        },

        // Parses the Range header from the server response
        // and returns the uploaded bytes:
        _getUploadedBytes: function (jqXHR) {
            var range = jqXHR.getResponseHeader('Range'),
                parts = range && range.split('-'),
                upperBytesPos = parts && parts.length > 1 &&
                    parseInt(parts[1], 10);
            return upperBytesPos && upperBytesPos + 1;
        },

        // Uploads a file in multiple, sequential requests
        // by splitting the file up in multiple blob chunks.
        // If the second parameter is true, only tests if the file
        // should be uploaded in chunks, but does not invoke any
        // upload requests:
        _chunkedUpload: function (options, testOnly) {
            options.uploadedBytes = options.uploadedBytes || 0;
            var that = this,
                file = options.files[0],
                fs = file.size,
                ub = options.uploadedBytes,
                mcs = options.maxChunkSize || fs,
                slice = this._blobSlice,
                dfd = $.Deferred(),
                promise = dfd.promise(),
                jqXHR,
                upload;
            if (!(this._isXHRUpload(options) && slice && (ub || mcs < fs)) ||
                    options.data) {
                return false;
            }
            if (testOnly) {
                return true;
            }
            if (ub >= fs) {
                file.error = options.i18n('uploadedBytes');
                return this._getXHRPromise(
                    false,
                    options.context,
                    [null, 'error', file.error]
                );
            }
            // The chunk upload method:
            upload = function () {
                // Clone the options object for each chunk upload:
                var o = $.extend({}, options),
                    currentLoaded = o._progress.loaded;
                o.blob = slice.call(
                    file,
                    ub,
                    ub + mcs,
                    file.type
                );
                // Store the current chunk size, as the blob itself
                // will be dereferenced after data processing:
                o.chunkSize = o.blob.size;
                // Expose the chunk bytes position range:
                o.contentRange = 'bytes ' + ub + '-' +
                    (ub + o.chunkSize - 1) + '/' + fs;
                // Process the upload data (the blob and potential form data):
                that._initXHRData(o);
                // Add progress listeners for this chunk upload:
                that._initProgressListener(o);
                jqXHR = ((that._trigger('chunksend', null, o) !== false && $.ajax(o)) ||
                        that._getXHRPromise(false, o.context))
                    .done(function (result, textStatus, jqXHR) {
                        ub = that._getUploadedBytes(jqXHR) ||
                            (ub + o.chunkSize);
                        // Create a progress event if no final progress event
                        // with loaded equaling total has been triggered
                        // for this chunk:
                        if (currentLoaded + o.chunkSize - o._progress.loaded) {
                            that._onProgress($.Event('progress', {
                                lengthComputable: true,
                                loaded: ub - o.uploadedBytes,
                                total: ub - o.uploadedBytes
                            }), o);
                        }
                        options.uploadedBytes = o.uploadedBytes = ub;
                        o.result = result;
                        o.textStatus = textStatus;
                        o.jqXHR = jqXHR;
                        that._trigger('chunkdone', null, o);
                        that._trigger('chunkalways', null, o);
                        if (ub < fs) {
                            // File upload not yet complete,
                            // continue with the next chunk:
                            upload();
                        } else {
                            dfd.resolveWith(
                                o.context,
                                [result, textStatus, jqXHR]
                            );
                        }
                    })
                    .fail(function (jqXHR, textStatus, errorThrown) {
                        o.jqXHR = jqXHR;
                        o.textStatus = textStatus;
                        o.errorThrown = errorThrown;
                        that._trigger('chunkfail', null, o);
                        that._trigger('chunkalways', null, o);
                        dfd.rejectWith(
                            o.context,
                            [jqXHR, textStatus, errorThrown]
                        );
                    });
            };
            this._enhancePromise(promise);
            promise.abort = function () {
                return jqXHR.abort();
            };
            upload();
            return promise;
        },

        _beforeSend: function (e, data) {
            if (this._active === 0) {
                // the start callback is triggered when an upload starts
                // and no other uploads are currently running,
                // equivalent to the global ajaxStart event:
                this._trigger('start');
                // Set timer for global bitrate progress calculation:
                this._bitrateTimer = new this._BitrateTimer();
                // Reset the global progress values:
                this._progress.loaded = this._progress.total = 0;
                this._progress.bitrate = 0;
            }
            // Make sure the container objects for the .response() and
            // .progress() methods on the data object are available
            // and reset to their initial state:
            this._initResponseObject(data);
            this._initProgressObject(data);
            data._progress.loaded = data.loaded = data.uploadedBytes || 0;
            data._progress.total = data.total = this._getTotal(data.files) || 1;
            data._progress.bitrate = data.bitrate = 0;
            this._active += 1;
            // Initialize the global progress values:
            this._progress.loaded += data.loaded;
            this._progress.total += data.total;
        },

        _onDone: function (result, textStatus, jqXHR, options) {
            var total = options._progress.total,
                response = options._response;
            if (options._progress.loaded < total) {
                // Create a progress event if no final progress event
                // with loaded equaling total has been triggered:
                this._onProgress($.Event('progress', {
                    lengthComputable: true,
                    loaded: total,
                    total: total
                }), options);
            }
            response.result = options.result = result;
            response.textStatus = options.textStatus = textStatus;
            response.jqXHR = options.jqXHR = jqXHR;
            this._trigger('done', null, options);
        },

        _onFail: function (jqXHR, textStatus, errorThrown, options) {
            var response = options._response;
            if (options.recalculateProgress) {
                // Remove the failed (error or abort) file upload from
                // the global progress calculation:
                this._progress.loaded -= options._progress.loaded;
                this._progress.total -= options._progress.total;
            }
            response.jqXHR = options.jqXHR = jqXHR;
            response.textStatus = options.textStatus = textStatus;
            response.errorThrown = options.errorThrown = errorThrown;
            this._trigger('fail', null, options);
        },

        _onAlways: function (jqXHRorResult, textStatus, jqXHRorError, options) {
            // jqXHRorResult, textStatus and jqXHRorError are added to the
            // options object via done and fail callbacks
            this._trigger('always', null, options);
        },

        _onSend: function (e, data) {
            if (!data.submit) {
                this._addConvenienceMethods(e, data);
            }
            var that = this,
                jqXHR,
                aborted,
                slot,
                pipe,
                options = that._getAJAXSettings(data),
                send = function () {
                    that._sending += 1;
                    // Set timer for bitrate progress calculation:
                    options._bitrateTimer = new that._BitrateTimer();
                    jqXHR = jqXHR || (
                        ((aborted || that._trigger('send', e, options) === false) &&
                        that._getXHRPromise(false, options.context, aborted)) ||
                        that._chunkedUpload(options) || $.ajax(options)
                    ).done(function (result, textStatus, jqXHR) {
                        that._onDone(result, textStatus, jqXHR, options);
                    }).fail(function (jqXHR, textStatus, errorThrown) {
                        that._onFail(jqXHR, textStatus, errorThrown, options);
                    }).always(function (jqXHRorResult, textStatus, jqXHRorError) {
                        that._onAlways(
                            jqXHRorResult,
                            textStatus,
                            jqXHRorError,
                            options
                        );
                        that._sending -= 1;
                        that._active -= 1;
                        if (options.limitConcurrentUploads &&
                                options.limitConcurrentUploads > that._sending) {
                            // Start the next queued upload,
                            // that has not been aborted:
                            var nextSlot = that._slots.shift();
                            while (nextSlot) {
                                if (that._getDeferredState(nextSlot) === 'pending') {
                                    nextSlot.resolve();
                                    break;
                                }
                                nextSlot = that._slots.shift();
                            }
                        }
                        if (that._active === 0) {
                            // The stop callback is triggered when all uploads have
                            // been completed, equivalent to the global ajaxStop event:
                            that._trigger('stop');
                        }
                    });
                    return jqXHR;
                };
            this._beforeSend(e, options);
            if (this.options.sequentialUploads ||
                    (this.options.limitConcurrentUploads &&
                    this.options.limitConcurrentUploads <= this._sending)) {
                if (this.options.limitConcurrentUploads > 1) {
                    slot = $.Deferred();
                    this._slots.push(slot);
                    pipe = slot.pipe(send);
                } else {
                    this._sequence = this._sequence.pipe(send, send);
                    pipe = this._sequence;
                }
                // Return the piped Promise object, enhanced with an abort method,
                // which is delegated to the jqXHR object of the current upload,
                // and jqXHR callbacks mapped to the equivalent Promise methods:
                pipe.abort = function () {
                    aborted = [undefined, 'abort', 'abort'];
                    if (!jqXHR) {
                        if (slot) {
                            slot.rejectWith(options.context, aborted);
                        }
                        return send();
                    }
                    return jqXHR.abort();
                };
                return this._enhancePromise(pipe);
            }
            return send();
        },

        _onAdd: function (e, data) {
            var that = this,
                result = true,
                options = $.extend({}, this.options, data),
                limit = options.limitMultiFileUploads,
                paramName = this._getParamName(options),
                paramNameSet,
                paramNameSlice,
                fileSet,
                i;
            if (!(options.singleFileUploads || limit) ||
                    !this._isXHRUpload(options)) {
                fileSet = [data.files];
                paramNameSet = [paramName];
            } else if (!options.singleFileUploads && limit) {
                fileSet = [];
                paramNameSet = [];
                for (i = 0; i < data.files.length; i += limit) {
                    fileSet.push(data.files.slice(i, i + limit));
                    paramNameSlice = paramName.slice(i, i + limit);
                    if (!paramNameSlice.length) {
                        paramNameSlice = paramName;
                    }
                    paramNameSet.push(paramNameSlice);
                }
            } else {
                paramNameSet = paramName;
            }
            data.originalFiles = data.files;
            $.each(fileSet || data.files, function (index, element) {
                var newData = $.extend({}, data);
                newData.files = fileSet ? element : [element];
                newData.paramName = paramNameSet[index];
                that._initResponseObject(newData);
                that._initProgressObject(newData);
                that._addConvenienceMethods(e, newData);
                result = that._trigger('add', e, newData);
                return result;
            });
            return result;
        },

        _replaceFileInput: function (input) {
            var inputClone = input.clone(true);
            $('<form></form>').append(inputClone)[0].reset();
            // Detaching allows to insert the fileInput on another form
            // without loosing the file input value:
            input.after(inputClone).detach();
            // Avoid memory leaks with the detached file input:
            $.cleanData(input.unbind('remove'));
            // Replace the original file input element in the fileInput
            // elements set with the clone, which has been copied including
            // event handlers:
            this.options.fileInput = this.options.fileInput.map(function (i, el) {
                if (el === input[0]) {
                    return inputClone[0];
                }
                return el;
            });
            // If the widget has been initialized on the file input itself,
            // override this.element with the file input clone:
            if (input[0] === this.element[0]) {
                this.element = inputClone;
            }
        },

        _handleFileTreeEntry: function (entry, path) {
            var that = this,
                dfd = $.Deferred(),
                errorHandler = function (e) {
                    if (e && !e.entry) {
                        e.entry = entry;
                    }
                    // Since $.when returns immediately if one
                    // Deferred is rejected, we use resolve instead.
                    // This allows valid files and invalid items
                    // to be returned together in one set:
                    dfd.resolve([e]);
                },
                dirReader;
            path = path || '';
            if (entry.isFile) {
                if (entry._file) {
                    // Workaround for Chrome bug #149735
                    entry._file.relativePath = path;
                    dfd.resolve(entry._file);
                } else {
                    entry.file(function (file) {
                        file.relativePath = path;
                        dfd.resolve(file);
                    }, errorHandler);
                }
            } else if (entry.isDirectory) {
                dirReader = entry.createReader();
                dirReader.readEntries(function (entries) {
                    that._handleFileTreeEntries(
                        entries,
                        path + entry.name + '/'
                    ).done(function (files) {
                        dfd.resolve(files);
                    }).fail(errorHandler);
                }, errorHandler);
            } else {
                // Return an empy list for file system items
                // other than files or directories:
                dfd.resolve([]);
            }
            return dfd.promise();
        },

        _handleFileTreeEntries: function (entries, path) {
            var that = this;
            return $.when.apply(
                $,
                $.map(entries, function (entry) {
                    return that._handleFileTreeEntry(entry, path);
                })
            ).pipe(function () {
                return Array.prototype.concat.apply(
                    [],
                    arguments
                );
            });
        },

        _getDroppedFiles: function (dataTransfer) {
            dataTransfer = dataTransfer || {};
            var items = dataTransfer.items;
            if (items && items.length && (items[0].webkitGetAsEntry ||
                    items[0].getAsEntry)) {
                return this._handleFileTreeEntries(
                    $.map(items, function (item) {
                        var entry;
                        if (item.webkitGetAsEntry) {
                            entry = item.webkitGetAsEntry();
                            if (entry) {
                                // Workaround for Chrome bug #149735:
                                entry._file = item.getAsFile();
                            }
                            return entry;
                        }
                        return item.getAsEntry();
                    })
                );
            }
            return $.Deferred().resolve(
                $.makeArray(dataTransfer.files)
            ).promise();
        },

        _getSingleFileInputFiles: function (fileInput) {
            fileInput = $(fileInput);
            var entries = fileInput.prop('webkitEntries') ||
                    fileInput.prop('entries'),
                files,
                value;
            if (entries && entries.length) {
                return this._handleFileTreeEntries(entries);
            }
            files = $.makeArray(fileInput.prop('files'));
            if (!files.length) {
                value = fileInput.prop('value');
                if (!value) {
                    return $.Deferred().resolve([]).promise();
                }
                // If the files property is not available, the browser does not
                // support the File API and we add a pseudo File object with
                // the input value as name with path information removed:
                files = [{name: value.replace(/^.*\\/, '')}];
            } else if (files[0].name === undefined && files[0].fileName) {
                // File normalization for Safari 4 and Firefox 3:
                $.each(files, function (index, file) {
                    file.name = file.fileName;
                    file.size = file.fileSize;
                });
            }
            return $.Deferred().resolve(files).promise();
        },

        _getFileInputFiles: function (fileInput) {
            if (!(fileInput instanceof $) || fileInput.length === 1) {
                return this._getSingleFileInputFiles(fileInput);
            }
            return $.when.apply(
                $,
                $.map(fileInput, this._getSingleFileInputFiles)
            ).pipe(function () {
                return Array.prototype.concat.apply(
                    [],
                    arguments
                );
            });
        },

        _onChange: function (e) {
            var that = this,
                data = {
                    fileInput: $(e.target),
                    form: $(e.target.form)
                };
            this._getFileInputFiles(data.fileInput).always(function (files) {
                data.files = files;
                if (that.options.replaceFileInput) {
                    that._replaceFileInput(data.fileInput);
                }
                if (that._trigger('change', e, data) !== false) {
                    that._onAdd(e, data);
                }
            });
        },

        _onPaste: function (e) {
            var items = e.originalEvent && e.originalEvent.clipboardData &&
                    e.originalEvent.clipboardData.items,
                data = {files: []};
            if (items && items.length) {
                $.each(items, function (index, item) {
                    var file = item.getAsFile && item.getAsFile();
                    if (file) {
                        data.files.push(file);
                    }
                });
                if (this._trigger('paste', e, data) === false ||
                        this._onAdd(e, data) === false) {
                    return false;
                }
            }
        },

        _onDrop: function (e) {
            e.dataTransfer = e.originalEvent && e.originalEvent.dataTransfer;
            var that = this,
                dataTransfer = e.dataTransfer,
                data = {};
            if (dataTransfer && dataTransfer.files && dataTransfer.files.length) {
                e.preventDefault();
                this._getDroppedFiles(dataTransfer).always(function (files) {
                    data.files = files;
                    if (that._trigger('drop', e, data) !== false) {
                        that._onAdd(e, data);
                    }
                });
            }
        },

        _onDragOver: function (e) {
            e.dataTransfer = e.originalEvent && e.originalEvent.dataTransfer;
            var dataTransfer = e.dataTransfer;
            if (dataTransfer) {
                if (this._trigger('dragover', e) === false) {
                    return false;
                }
                if ($.inArray('Files', dataTransfer.types) !== -1) {
                    dataTransfer.dropEffect = 'copy';
                    e.preventDefault();
                }
            }
        },

        _initEventHandlers: function () {
            if (this._isXHRUpload(this.options)) {
                this._on(this.options.dropZone, {
                    dragover: this._onDragOver,
                    drop: this._onDrop
                });
                this._on(this.options.pasteZone, {
                    paste: this._onPaste
                });
            }
            if ($.support.fileInput) {
                this._on(this.options.fileInput, {
                    change: this._onChange
                });
            }
        },

        _destroyEventHandlers: function () {
            this._off(this.options.dropZone, 'dragover drop');
            this._off(this.options.pasteZone, 'paste');
            this._off(this.options.fileInput, 'change');
        },

        _setOption: function (key, value) {
            var reinit = $.inArray(key, this._specialOptions) !== -1;
            if (reinit) {
                this._destroyEventHandlers();
            }
            this._super(key, value);
            if (reinit) {
                this._initSpecialOptions();
                this._initEventHandlers();
            }
        },

        _initSpecialOptions: function () {
            var options = this.options;
            if (options.fileInput === undefined) {
                options.fileInput = this.element.is('input[type="file"]') ?
                        this.element : this.element.find('input[type="file"]');
            } else if (!(options.fileInput instanceof $)) {
                options.fileInput = $(options.fileInput);
            }
            if (!(options.dropZone instanceof $)) {
                options.dropZone = $(options.dropZone);
            }
            if (!(options.pasteZone instanceof $)) {
                options.pasteZone = $(options.pasteZone);
            }
        },

        _getRegExp: function (str) {
            var parts = str.split('/'),
                modifiers = parts.pop();
            parts.shift();
            return new RegExp(parts.join('/'), modifiers);
        },

        _isRegExpOption: function (key, value) {
            return key !== 'url' && $.type(value) === 'string' &&
                /^\/.*\/[igm]{0,3}$/.test(value);
        },

        _initDataAttributes: function () {
            var that = this,
                options = this.options;
            // Initialize options set via HTML5 data-attributes:
            $.each(
                $(this.element[0].cloneNode(false)).data(),
                function (key, value) {
                    if (that._isRegExpOption(key, value)) {
                        value = that._getRegExp(value);
                    }
                    options[key] = value;
                }
            );
        },

        _create: function () {
            this._initDataAttributes();
            this._initSpecialOptions();
            this._slots = [];
            this._sequence = this._getXHRPromise(true);
            this._sending = this._active = 0;
            this._initProgressObject(this);
            this._initEventHandlers();
        },

        // This method is exposed to the widget API and allows to query
        // the number of active uploads:
        active: function () {
            return this._active;
        },

        // This method is exposed to the widget API and allows to query
        // the widget upload progress.
        // It returns an object with loaded, total and bitrate properties
        // for the running uploads:
        progress: function () {
            return this._progress;
        },

        // This method is exposed to the widget API and allows adding files
        // using the fileupload API. The data parameter accepts an object which
        // must have a files property and can contain additional options:
        // .fileupload('add', {files: filesList});
        add: function (data) {
            var that = this;
            if (!data || this.options.disabled) {
                return;
            }
            if (data.fileInput && !data.files) {
                this._getFileInputFiles(data.fileInput).always(function (files) {
                    data.files = files;
                    that._onAdd(null, data);
                });
            } else {
                data.files = $.makeArray(data.files);
                this._onAdd(null, data);
            }
        },

        // This method is exposed to the widget API and allows sending files
        // using the fileupload API. The data parameter accepts an object which
        // must have a files or fileInput property and can contain additional options:
        // .fileupload('send', {files: filesList});
        // The method returns a Promise object for the file upload call.
        send: function (data) {
            if (data && !this.options.disabled) {
                if (data.fileInput && !data.files) {
                    var that = this,
                        dfd = $.Deferred(),
                        promise = dfd.promise(),
                        jqXHR,
                        aborted;
                    promise.abort = function () {
                        aborted = true;
                        if (jqXHR) {
                            return jqXHR.abort();
                        }
                        dfd.reject(null, 'abort', 'abort');
                        return promise;
                    };
                    this._getFileInputFiles(data.fileInput).always(
                        function (files) {
                            if (aborted) {
                                return;
                            }
                            if (!files.length) {
                                dfd.reject();
                                return;
                            }
                            data.files = files;
                            jqXHR = that._onSend(null, data).then(
                                function (result, textStatus, jqXHR) {
                                    dfd.resolve(result, textStatus, jqXHR);
                                },
                                function (jqXHR, textStatus, errorThrown) {
                                    dfd.reject(jqXHR, textStatus, errorThrown);
                                }
                            );
                        }
                    );
                    return this._enhancePromise(promise);
                }
                data.files = $.makeArray(data.files);
                if (data.files.length) {
                    return this._onSend(null, data);
                }
            }
            return this._getXHRPromise(false, data && data.context);
        }

    });

}));
} catch (e) {
	console.log(e);
}


/*
 * jQuery Iframe Transport Plugin 1.7
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */

/*jslint unparam: true, nomen: true */
/*global define, window, document */

try{
(function (factory) {
    'use strict';
    if (typeof define === 'function' && define.amd) {
        // Register as an anonymous AMD module:
        define(['jquery'], factory);
    } else {
        // Browser globals:
        factory(window.jQuery);
    }
}(function ($) {
    'use strict';

    // Helper variable to create unique names for the transport iframes:
    var counter = 0;

    // The iframe transport accepts three additional options:
    // options.fileInput: a jQuery collection of file input fields
    // options.paramName: the parameter name for the file form data,
    //  overrides the name property of the file input field(s),
    //  can be a string or an array of strings.
    // options.formData: an array of objects with name and value properties,
    //  equivalent to the return data of .serializeArray(), e.g.:
    //  [{name: 'a', value: 1}, {name: 'b', value: 2}]
    $.ajaxTransport('iframe', function (options) {
        if (options.async) {
            var form,
                iframe,
                addParamChar;
            return {
                send: function (_, completeCallback) {
                    form = $('<form style="display:none;"></form>');
                    form.attr('accept-charset', options.formAcceptCharset);
                    addParamChar = /\?/.test(options.url) ? '&' : '?';
                    // XDomainRequest only supports GET and POST:
                    if (options.type === 'DELETE') {
                        options.url = options.url + addParamChar + '_method=DELETE';
                        options.type = 'POST';
                    } else if (options.type === 'PUT') {
                        options.url = options.url + addParamChar + '_method=PUT';
                        options.type = 'POST';
                    } else if (options.type === 'PATCH') {
                        options.url = options.url + addParamChar + '_method=PATCH';
                        options.type = 'POST';
                    }
                    // javascript:false as initial iframe src
                    // prevents warning popups on HTTPS in IE6.
                    // IE versions below IE8 cannot set the name property of
                    // elements that have already been added to the DOM,
                    // so we set the name along with the iframe HTML markup:
                    counter += 1;
                    iframe = $(
                        '<iframe src="javascript:false;" name="iframe-transport-' +
                            counter + '"></iframe>'
                    ).bind('load', function () {
                        var fileInputClones,
                            paramNames = $.isArray(options.paramName) ?
                                    options.paramName : [options.paramName];
                        iframe
                            .unbind('load')
                            .bind('load', function () {
                                var response;
                                // Wrap in a try/catch block to catch exceptions thrown
                                // when trying to access cross-domain iframe contents:
                                try {
                                    response = iframe.contents();
                                    // Google Chrome and Firefox do not throw an
                                    // exception when calling iframe.contents() on
                                    // cross-domain requests, so we unify the response:
                                    if (!response.length || !response[0].firstChild) {
                                        throw new Error();
                                    }
                                } catch (e) {
                                    response = undefined;
                                }
                                // The complete callback returns the
                                // iframe content document as response object:
                                completeCallback(
                                    200,
                                    'success',
                                    {'iframe': response}
                                );
                                // Fix for IE endless progress bar activity bug
                                // (happens on form submits to iframe targets):
                                $('<iframe src="javascript:false;"></iframe>')
                                    .appendTo(form);
                                window.setTimeout(function () {
                                    // Removing the form in a setTimeout call
                                    // allows Chrome's developer tools to display
                                    // the response result
                                    form.remove();
                                }, 0);
                            });
                        form
                            .prop('target', iframe.prop('name'))
                            .prop('action', options.url)
                            .prop('method', options.type);
                        if (options.formData) {
                            $.each(options.formData, function (index, field) {
                                $('<input type="hidden"/>')
                                    .prop('name', field.name)
                                    .val(field.value)
                                    .appendTo(form);
                            });
                        }
                        if (options.fileInput && options.fileInput.length &&
                                options.type === 'POST') {
                            fileInputClones = options.fileInput.clone();
                            // Insert a clone for each file input field:
                            options.fileInput.after(function (index) {
                                return fileInputClones[index];
                            });
                            if (options.paramName) {
                                options.fileInput.each(function (index) {
                                    $(this).prop(
                                        'name',
                                        paramNames[index] || options.paramName
                                    );
                                });
                            }
                            // Appending the file input fields to the hidden form
                            // removes them from their original location:
                            form
                                .append(options.fileInput)
                                .prop('enctype', 'multipart/form-data')
                                // enctype must be set as encoding for IE:
                                .prop('encoding', 'multipart/form-data');
                        }
                        form.submit();
                        // Insert the file input fields at their original location
                        // by replacing the clones with the originals:
                        if (fileInputClones && fileInputClones.length) {
                            options.fileInput.each(function (index, input) {
                                var clone = $(fileInputClones[index]);
                                $(input).prop('name', clone.prop('name'));
                                clone.replaceWith(input);
                            });
                        }
                    });
                    form.append(iframe).appendTo(document.body);
                },
                abort: function () {
                    if (iframe) {
                        // javascript:false as iframe src aborts the request
                        // and prevents warning popups on HTTPS in IE6.
                        // concat is used to avoid the "Script URL" JSLint error:
                        iframe
                            .unbind('load')
                            .prop('src', 'javascript'.concat(':false;'));
                    }
                    if (form) {
                        form.remove();
                    }
                }
            };
        }
    });

    // The iframe transport returns the iframe content document as response.
    // The following adds converters from iframe to text, json, html, xml
    // and script.
    // Please note that the Content-Type for JSON responses has to be text/plain
    // or text/html, if the browser doesn't include application/json in the
    // Accept header, else IE will show a download dialog.
    // The Content-Type for XML responses on the other hand has to be always
    // application/xml or text/xml, so IE properly parses the XML response.
    // See also
    // https://github.com/blueimp/jQuery-File-Upload/wiki/Setup#content-type-negotiation
    $.ajaxSetup({
        converters: {
            'iframe text': function (iframe) {
                return iframe && $(iframe[0].body).text();
            },
            'iframe json': function (iframe) {
                return iframe && $.parseJSON($(iframe[0].body).text());
            },
            'iframe html': function (iframe) {
                return iframe && $(iframe[0].body).html();
            },
            'iframe xml': function (iframe) {
                var xmlDoc = iframe && iframe[0];
                return xmlDoc && $.isXMLDoc(xmlDoc) ? xmlDoc :
                        $.parseXML((xmlDoc.XMLDocument && xmlDoc.XMLDocument.xml) ||
                            $(xmlDoc.body).html());
            },
            'iframe script': function (iframe) {
                return iframe && $.globalEval($(iframe[0].body).text());
            }
        }
    });

}));
} catch (e) {
	console.log(e);
}


/*
 * jQuery UI Widget 1.10.3+amd
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */

try {
(function (factory) {
    if (typeof define === "function" && define.amd) {
        // Register as an anonymous AMD module:
        define(["jquery"], factory);
    } else {
        // Browser globals:
        factory(jQuery);
    }
}(function( $, undefined ) {

var uuid = 0,
	slice = Array.prototype.slice,
	_cleanData = $.cleanData;
$.cleanData = function( elems ) {
	for ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {
		try {
			$( elem ).triggerHandler( "remove" );
		// http://bugs.jquery.com/ticket/8235
		} catch( e ) {}
	}
	_cleanData( elems );
};

$.widget = function( name, base, prototype ) {
	var fullName, existingConstructor, constructor, basePrototype,
		// proxiedPrototype allows the provided prototype to remain unmodified
		// so that it can be used as a mixin for multiple widgets (#8876)
		proxiedPrototype = {},
		namespace = name.split( "." )[ 0 ];

	name = name.split( "." )[ 1 ];
	fullName = namespace + "-" + name;

	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}

	// create selector for plugin
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};

	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {
		// allow instantiation without "new" keyword
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}

		// allow instantiation without initializing for simple inheritance
		// must use "new" keyword (the code above always passes args)
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};
	// extend with the existing constructor to carry over any static properties
	$.extend( constructor, existingConstructor, {
		version: prototype.version,
		// copy the object used to create the prototype in case we need to
		// redefine the widget later
		_proto: $.extend( {}, prototype ),
		// track widgets that inherit from this widget in case this widget is
		// redefined after a widget inherits from it
		_childConstructors: []
	});

	basePrototype = new base();
	// we need to make the options hash a property directly on the new instance
	// otherwise we'll modify the options hash on the prototype that we're
	// inheriting from
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( !$.isFunction( value ) ) {
			proxiedPrototype[ prop ] = value;
			return;
		}
		proxiedPrototype[ prop ] = (function() {
			var _super = function() {
					return base.prototype[ prop ].apply( this, arguments );
				},
				_superApply = function( args ) {
					return base.prototype[ prop ].apply( this, args );
				};
			return function() {
				var __super = this._super,
					__superApply = this._superApply,
					returnValue;

				this._super = _super;
				this._superApply = _superApply;

				returnValue = value.apply( this, arguments );

				this._super = __super;
				this._superApply = __superApply;

				return returnValue;
			};
		})();
	});
	constructor.prototype = $.widget.extend( basePrototype, {
		// TODO: remove support for widgetEventPrefix
		// always use the name + a colon as the prefix, e.g., draggable:start
		// don't prefix for widgets that aren't DOM-based
		widgetEventPrefix: existingConstructor ? basePrototype.widgetEventPrefix : name
	}, proxiedPrototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetFullName: fullName
	});

	// If this widget is being redefined then we need to find all widgets that
	// are inheriting from it and redefine all of them so that they inherit from
	// the new version of this widget. We're essentially trying to replace one
	// level in the prototype chain.
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;

			// redefine the child widget using the same prototype that was
			// originally used, but inherit from the new version of the base
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto );
		});
		// remove the list of existing child constructors from the old constructor
		// so the old child constructors can be garbage collected
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}

	$.widget.bridge( name, constructor );
};

$.widget.extend = function( target ) {
	var input = slice.call( arguments, 1 ),
		inputIndex = 0,
		inputLength = input.length,
		key,
		value;
	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {
				// Clone objects
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :
						// Don't extend strings, arrays, etc. with objects
						$.widget.extend( {}, value );
				// Copy everything else by reference
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};

$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string",
			args = slice.call( arguments, 1 ),
			returnValue = this;

		// allow multiple hashes to be passed on init
		options = !isMethodCall && args.length ?
			$.widget.extend.apply( null, [ options ].concat(args) ) :
			options;

		if ( isMethodCall ) {
			this.each(function() {
				var methodValue,
					instance = $.data( this, fullName );
				if ( !instance ) {
					return $.error( "cannot call methods on " + name + " prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}
				if ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name + " widget instance" );
				}
				methodValue = instance[ options ].apply( instance, args );
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			});
		} else {
			this.each(function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} )._init();
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			});
		}

		return returnValue;
	};
};

$.Widget = function( /* options, element */ ) {};
$.Widget._childConstructors = [];

$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",
	options: {
		disabled: false,

		// callbacks
		create: null
	},
	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = uuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;
		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );

		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();

		if ( element !== this ) {
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			});
			this.document = $( element.style ?
				// element within the document
				element.ownerDocument :
				// element is window or document
				element.document || element );
			this.window = $( this.document[0].defaultView || this.document[0].parentWindow );
		}

		this._create();
		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,

	destroy: function() {
		this._destroy();
		// we can probably remove the unbind calls in 2.0
		// all event bindings should go through this._on()
		this.element
			.unbind( this.eventNamespace )
			// 1.9 BC for #7810
			// TODO remove dual storage
			.removeData( this.widgetName )
			.removeData( this.widgetFullName )
			// support: jquery <1.6.3
			// http://bugs.jquery.com/ticket/9413
			.removeData( $.camelCase( this.widgetFullName ) );
		this.widget()
			.unbind( this.eventNamespace )
			.removeAttr( "aria-disabled" )
			.removeClass(
				this.widgetFullName + "-disabled " +
				"ui-state-disabled" );

		// clean up events and states
		this.bindings.unbind( this.eventNamespace );
		this.hoverable.removeClass( "ui-state-hover" );
		this.focusable.removeClass( "ui-state-focus" );
	},
	_destroy: $.noop,

	widget: function() {
		return this.element;
	},

	option: function( key, value ) {
		var options = key,
			parts,
			curOption,
			i;

		if ( arguments.length === 0 ) {
			// don't return a reference to the internal hash
			return $.widget.extend( {}, this.options );
		}

		if ( typeof key === "string" ) {
			// handle nested keys, e.g., "foo.bar" => { foo: { bar: ___ } }
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( value === undefined ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( value === undefined ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}

		this._setOptions( options );

		return this;
	},
	_setOptions: function( options ) {
		var key;

		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}

		return this;
	},
	_setOption: function( key, value ) {
		this.options[ key ] = value;

		if ( key === "disabled" ) {
			this.widget()
				.toggleClass( this.widgetFullName + "-disabled ui-state-disabled", !!value )
				.attr( "aria-disabled", value );
			this.hoverable.removeClass( "ui-state-hover" );
			this.focusable.removeClass( "ui-state-focus" );
		}

		return this;
	},

	enable: function() {
		return this._setOption( "disabled", false );
	},
	disable: function() {
		return this._setOption( "disabled", true );
	},

	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement,
			instance = this;

		// no suppressDisabledCheck flag, shuffle arguments
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}

		// no element argument, shuffle and use this.element
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			// accept selectors, DOM elements
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}

		$.each( handlers, function( event, handler ) {
			function handlerProxy() {
				// allow widgets to customize the disabled handling
				// - disabled as an array instead of boolean
				// - disabled class as method for disabling individual parts
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
							$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}

			// copy the guid so direct unbinding works
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}

			var match = event.match( /^(\w+)\s*(.*)$/ ),
				eventName = match[1] + instance.eventNamespace,
				selector = match[2];
			if ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} else {
				element.bind( eventName, handlerProxy );
			}
		});
	},

	_off: function( element, eventName ) {
		eventName = (eventName || "").split( " " ).join( this.eventNamespace + " " ) + this.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );
	},

	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},

	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-hover" );
			},
			mouseleave: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-hover" );
			}
		});
	},

	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-focus" );
			},
			focusout: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-focus" );
			}
		});
	},

	_trigger: function( type, event, data ) {
		var prop, orig,
			callback = this.options[ type ];

		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();
		// the original event may come from any element
		// so we need to reset the target on the new event
		event.target = this.element[ 0 ];

		// copy original event properties over to the new event
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}

		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[0], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};

$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}
		var hasOptions,
			effectName = !options ?
				method :
				options === true || typeof options === "number" ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		if ( options.delay ) {
			element.delay( options.delay );
		}
		if ( hasOptions && $.effects && $.effects.effect[ effectName ] ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue(function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			});
		}
	};
});

}));
} catch (e) {
	console.log(e);
}

sap.ui.controller("sap.ca.ui.message.MessageBox", {
	_MSGBOX_ID : "DLG_MSGBOX",
	_MSGBOX_DETAILS_ID : "TXA_DETAILS",
/**
* Called when a controller is instantiated and its View controls (if available) are already created.
* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.
* @memberOf sap.ca.common.uilib.dialog.MessageBox
*/
//	onInit: function() {
//
//	},

	onCloseDialog: function() {
		sap.ca.ui.dialog.factory.closeDialog(this._MSGBOX_ID);
	},
	
	onShowDetails: function(oEvent) {
		var oLink = oEvent.getSource();
		if (oLink) {
			oLink.setVisible(false);
		}
		
		var oDetails = this.getView().byId(this._MSGBOX_DETAILS_ID);
		if (oDetails) {
			oDetails.setVisible(true);
		}
		
		this.getView().byId(this._MSGBOX_ID).rerender();
	}
/**
* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered
* (NOT before the first rendering! onInit() is used for that one!).
* @memberOf sap.ca.common.uilib.dialog.MessageBox
*/
//	onBeforeRendering: function() {
//
//	},

/**
* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.
* This hook is the same one that SAPUI5 controls get after being rendered.
* @memberOf sap.ca.common.uilib.dialog.MessageBox
*/
//	onAfterRendering: function() {
//
//	},

/**
* Called when the Controller is destroyed. Use this one to free resources and finalize activities.
* @memberOf sap.ca.common.uilib.dialog.MessageBox
*/
//	onExit: function() {
//
//	}

});
sap.ui.controller("sap.ca.ui.quickoverview.Company", {
	
	onTapSMS: function(oEvent) {
		sap.m.URLHelper.triggerSms(this.byId("qvMainContactMobile").getText());
	},

	onTapPhone: function(oEvent) {
		sap.m.URLHelper.triggerTel(oEvent.getSource().getText());
		//this.QuickViewHandler.navigateTo();
		
	},

	onTapEmail: function(oEvent) {
		//
		var sSubject = "";
		var oModel = this.getView().getModel();
		if (oModel && oModel.getData()) { 
			sSubject = (oModel.getData().maincontactemailsubj) ? oModel.getData().maincontactemailsubj : "";
		}
		sap.m.URLHelper.triggerEmail(oEvent.getSource().getText(), sSubject);
	}, 
	
	
	onBeforeRendering : function () {
		
		var oContactSMS = this.byId("qvMainContactSMS");
		if (oContactSMS)
			{
				oContactSMS.setVisible(this.byId("qvMainContactMobile").getText() !== "");
			}

	}	

});
try
{
	jQuery.sap.require("sap.ushell.services.CrossApplicationNavigation");
}
catch(e)
{
//currently unclear if the "require" - above - is necessary here
//..possibly this is provided by scfld ??	
}

sap.ui
		.controller(
				"sap.ca.ui.quickoverview.Quickview",
				{

					onInit : function() {
						//see API docu for sap.ushell.services.CrossApplicationNavigation
						var fgetService =  sap.ushell && sap.ushell.Container && sap.ushell.Container.getService; 
						if (fgetService) {
							this.oCrossAppNavigator = fgetService && fgetService("CrossApplicationNavigation");
						}
					},

					
					onExtNav : function(oEvt, oData) {
						//callback to the application - application has to set application parameters
						var sCallback = oData.callback; //this.viewConfig.beforeExtNav;
						if ( typeof(sCallback) == "function"){
							var oConfig = sCallback( this.getView() );
							if (oConfig.target.semanticObject && oConfig.target.action)
							 {
								//this.oCrossAppNavigator.toExternal(oConfig); ... not recommended ?
								var href = ( this.oCrossAppNavigator && this.oCrossAppNavigator.hrefForExternal(
										{ target : { semanticObject : oConfig.target.semanticObject,
													 action : oConfig.target.action }, 
													 params : oConfig.params 
										}
										)
										); 
								
								sap.m.URLHelper.redirect(href);

							 }
						}	
					},					
					
					onBeforeRendering : function() {

					},
					
					configureView: function ()	{

						//...for debugging...
						var oAnalyze = {};
						oAnalyze.bHeader = true;
						oAnalyze.bSubview = true;
						
						if (oAnalyze.bHeader)
						 {
							// set predefined ViewAttributes							
							this.configHeader();
						 }
						
						var sSubViewName = this.viewConfig.subViewName;
						var oVBox = this.byId("QVVBox");
						if (sSubViewName && oAnalyze.bSubview) {
							var oAppView = sap.ui.getCore().byId(sSubViewName);
							if (!oAppView) {
								oAppView = new sap.ui.core.mvc.XMLView(
										sSubViewName, {
											viewName : sSubViewName
										});
								oAppView.getController().QuickViewHandler = this.viewConfig.quickOverview;
								oAppView.getController().HostingView = this
										.getView();
							}

							var oModel = this.getView().getModel();

							oVBox.removeAllItems();
							oVBox.addItem(oAppView);

							// on the save side: in case the plugged in view is
							// controlled by a
							// sap.ca.scfld.md.controller.BaseMasterController.extend
							// the model has to be set explicitly!
							oAppView.setModel(oModel);
						} else {
							oVBox.removeAllItems();
						}
						
						var oQvViewSetup = {};
						oQvViewSetup.oQvView = this.getView();
						oQvViewSetup.oSubView = oAppView;						
						return oQvViewSetup; 

					},

					configHeader : function() {
	
						var sImage = this.viewConfig.headerImgURL;
							
						if (!sImage)
							{
							  sImage = "sap-icon://picture"
							}
						
						var oHeaderBox = this.byId("HeaderBox");
						oHeaderBox.destroyItems();
						oHeaderBox.removeAllItems();
						


						//create a new header - remove the old one!
						var oSubTitle = new sap.m.ObjectAttribute({
			            	text : this.viewConfig.headerSubTitle
			            })
						//navigation from subtitle - enable if callback for Parameters is provided
						var sCallbackSubHdr = this.viewConfig.beforeExtNavSubHdr;
						if ( typeof(sCallbackSubHdr) == "function"){
							var oData = {};
							oSubTitle.setActive(true);
							oData.callback = sCallbackSubHdr;
							oSubTitle.attachPress(oData, this.onExtNav, this);
						}
						
						
						var oHead = new sap.m.ObjectHeader( {
							title : this.viewConfig.headerTitle,
							attributes : [ oSubTitle ]
						});
						
						//navigation from header - enable if callback for Parameters is provided
						var sCallback = this.viewConfig.beforeExtNav;
						if ( typeof(sCallback) == "function"){
							var oDataHdr = {};
							oHead.setTitleActive(true);
							oDataHdr.callback = sCallback;							
							oHead.attachTitlePress(oDataHdr, this.onExtNav, this);
						}
						
						//header icon
						if ( !this.viewConfig.headerNoIcon)
							{
								oHead.setIcon(sImage);
								//color of header image:
								oHead.addStyleClass("sapCaUiQuickOverviewHdrImgColor");								
							}

						//add header
						oHeaderBox.addItem(oHead);

					},

				});
jQuery.sap.declare('sap.ca.ui.library-all');
jQuery.sap.declare('sap.ca.ui.JS.jquery-fileupload'); // raw module, declared by SAPUI5 'AllInOne' Builder
jQuery.sap.declare('sap.ca.ui.JS.jquery-iframe-transport'); // raw module, declared by SAPUI5 'AllInOne' Builder
jQuery.sap.declare('sap.ca.ui.JS.jquery-ui-widget'); // raw module, declared by SAPUI5 'AllInOne' Builder
jQuery.sap.declare('sap.ca.ui.message.MessageBox.controller'); // raw module, declared by SAPUI5 'AllInOne' Builder
jQuery.sap.declare('sap.ca.ui.quickoverview.Company.controller'); // raw module, declared by SAPUI5 'AllInOne' Builder
jQuery.sap.declare('sap.ca.ui.quickoverview.Quickview.controller'); // raw module, declared by SAPUI5 'AllInOne' Builder
if ( !jQuery.sap.isDeclared('sap.ca.ui.AppConfig') ) {

jQuery.sap.declare("sap.ca.ui.AppConfig");

sap.ca.ui.AppConfig = function(oConfig){
	this.config = oConfig;
	this._fnValidate();
};

sap.ca.ui.AppConfig.prototype.getStringValue = function(sPropName,args){
	var val = this.config[sPropName];
	
	if (jQuery.isFunction(val)){
		val = val.apply(null,args);
	}
	
	if(typeof val == 'string' || val instanceof String){
		return  val;		
	} else {
		jQuery.sap.log.error("The app config is not correct, the function " + sPropName + " has to return a string");
	}
};
sap.ca.ui.AppConfig.prototype.getBoolValue = function(sPropName,args){
	var val = this.config[sPropName];
	
	if (jQuery.isFunction(val)){
		val = val.apply(null,args);
	}
	return !!val;
};


sap.ca.ui.AppConfig.prototype._fnValidate = function(){
	this._isStringOfFunction("defaultPageId");
	this._isStringOfFunction("isMaster");
	this._isStringOfFunction("viewName");
	this._isStringOfFunction("viewType");
	this._isStringOfFunction("transition");
};


sap.ca.ui.AppConfig.prototype._isStringOfFunction = function(sName){
	var val = this.config[sName];
	
	if(!(typeof val == 'string' || val instanceof String || jQuery.isFunction(val))){
		jQuery.sap.log.error("The app config is not correct, this property " + sName + "has to be a string or a function");
	}
};
}; // end of sap/ca/ui/AppConfig.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.DatePickerRenderer') ) {
jQuery.sap.declare("sap.ca.ui.DatePickerRenderer");
jQuery.sap.require('sap.m.InputBaseRenderer'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained


/**
 * @class DatePicker renderer. 
 * @static
 */
sap.ca.ui.DatePickerRenderer = sap.ui.core.Renderer.extend(sap.m.InputBaseRenderer);



/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */

sap.ca.ui.DatePickerRenderer.writeInnerContent = function(r, c) {

        r.write('<div class="sapMInputValHelp">');
        r.renderControl(c._getCalendarIcon());
        r.write('</div>');
    
};

sap.ca.ui.DatePickerRenderer.addInnerClasses = function(oRm, oControl) {
        oRm.addClass("sapMInputInnerVH");
};

}; // end of sap/ca/ui/DatePickerRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.ExpansibleFeedListItemRenderer') ) {
jQuery.sap.declare("sap.ca.ui.ExpansibleFeedListItemRenderer");

jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained

jQuery.sap.require('sap.m.FeedListItemRenderer'); // unlisted dependency retained


/**
 * @class ExpansibleFeedListItem renderer. 
 * @static
 */
sap.ca.ui.ExpansibleFeedListItemRenderer = sap.ui.core.Renderer.extend(sap.m.FeedListItemRenderer);


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */

sap.m.FeedListItemRenderer.renderLIContent = function (rm, oFeedListItem) {
    //TODO: This code should be somehow integrated in the original FeedListItem and not added in this ugly way here...
    // convenience variable
    var sMyId = oFeedListItem.getId(),
        bIsPhone = jQuery.device.is.phone;

    rm.write('<article');
    rm.writeControlData(oFeedListItem);
    rm.addClass('sapMFeedListItem');
    rm.addClass('sapCaUiExpansibleFeedListItem');

    rm.writeClasses();
    rm.write('>');

    // icon
    if (!!oFeedListItem.getShowIcon()) {
        rm.write('<figure id="' + sMyId + '-figure" class ="sapMFeedListItemFigure');
        if (!!oFeedListItem.getIcon()) {
            rm.write('">');
        } else {
            rm.write(' sapMFeedListItemIsDefaultIcon">');
        }
        if (!!oFeedListItem.getIconActive()) {
            
            rm.write('<a id="' + sMyId + '-iconRef" ');
            rm.writeAttribute('href', 'javascript:void(0);');
            rm.write('>');
        } 
        rm.renderControl(oFeedListItem._getImageControl()); 
        if (!!oFeedListItem.getIconActive()) {
            rm.write('</a>');
        }
        rm.write('</figure>');
    }

    // text (starting with sender)
    

    
    if (bIsPhone) {
        rm.write('<div class= "sapMFeedListItemHeader ');
        if (!!oFeedListItem.getShowIcon()) {
            rm.write('sapMFeedListItemHasFigure ');
        }
        if (!!oFeedListItem.getSender() && !!oFeedListItem.getTimestamp()) {
            rm.write('sapMFeedListItemFullHeight');
        }
        rm.write('" >');
            if (!!oFeedListItem.getSender()) {
                rm.write('<p id="' + sMyId + '-name" class="sapMFeedListItemTextName">');
                rm.renderControl(oFeedListItem._getLinkControl());
                rm.write('</p>');
            }
            if (!!oFeedListItem.getTimestamp()) {
                //write date
                rm.write('<p class="sapMFeedListItemTimestamp">');
                rm.writeEscaped(oFeedListItem.getTimestamp());
                rm.write('</p>');
            }
        
        rm.write('</div>');
        rm.write('<p id="' + sMyId + '-text" class="sapMFeedListItemText">');
        rm.writeEscaped(oFeedListItem.getText(), true);
        rm.write('</p>');

        if (oFeedListItem.getMaxLines() > 0) {
            sap.ca.ui.ExpansibleFeedListItemRenderer.renderSeeMoreContent(rm, oFeedListItem);
        }

        if (!!oFeedListItem.getInfo()) {
            // info
            rm.write('<p class="sapMFeedListItemFooter">');
            if (!!oFeedListItem.getInfo()) {
                rm.write('<span class="sapMFeedListItemInfo">');
                rm.writeEscaped(oFeedListItem.getInfo());
                rm.write('</span>');
            }
        }
    } else {
        rm.write('<div class= "sapMFeedListItemText ');
        if (!!oFeedListItem.getShowIcon()) {
            rm.write('sapMFeedListItemHasFigure ');
        }
        rm.write('" >');
        rm.write('<p id="' + sMyId + '-text" class="sapMFeedListItemTextText">');
        if (!!oFeedListItem.getSender()) {
            rm.write('<span id="' + sMyId + '-name" class="sapMFeedListItemTextName">');
            rm.renderControl(oFeedListItem._getLinkControl());
            rm.write(': ');
            rm.write('</span>');
        }
        rm.writeEscaped(oFeedListItem.getText(), true);
        if (oFeedListItem.getMaxLines() > 0) {
            sap.ca.ui.ExpansibleFeedListItemRenderer.renderSeeMoreContent(rm, oFeedListItem);
        }
        if (!!oFeedListItem.getInfo() || !!oFeedListItem.getTimestamp()) {
            // info and date
            rm.write('<p class="sapMFeedListItemFooter">');
            if (!!oFeedListItem.getInfo()) {
                rm.writeEscaped(oFeedListItem.getInfo());
                //Write Interpunct separator if necessary (with spaces before and after)
                if (!!oFeedListItem.getTimestamp()) {
                    rm.write("&#160&#160&#x00B7&#160&#160");
                }
            }
            if (!!oFeedListItem.getTimestamp()) {
                rm.writeEscaped(oFeedListItem.getTimestamp());
            }
        }
        rm.write('</p>');
        rm.write('</div>');
    }
    rm.write('</article>');
};

sap.ca.ui.ExpansibleFeedListItemRenderer.renderSeeMoreContent = function (rm, oFeedListItem) {
    rm.write('<div');
    rm.addClass('sapCaUiExpansibleFeedListItemSeeMoreLink');
    rm.writeClasses();
    rm.write('>');
    rm.write("<p");
    rm.addClass('sapCaUiExpansibleFeedListItemSeeMoreLinkDots');
    rm.writeClasses();
    rm.write(">...</p>");
    rm.renderControl(oFeedListItem._getSeeMoreLink());
    rm.write('</div>');
};
}; // end of sap/ca/ui/ExpansibleFeedListItemRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.GrowingTileContainerRenderer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */
jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained

jQuery.sap.require('sap.m.ScrollContainerRenderer'); // unlisted dependency retained

jQuery.sap.require('sap.ui.layout.GridRenderer'); // unlisted dependency retained

jQuery.sap.declare("sap.ca.ui.GrowingTileContainerRenderer");

/**
 * @class GrowingTileContainer renderer. 
 * @static
 */
sap.ca.ui.GrowingTileContainerRenderer = sap.ui.core.Renderer.extend(sap.m.ScrollContainerRenderer);


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.GrowingTileContainerRenderer.render = function(oRm, oControl){ 
	var that = this;
	// call base renderer to do real rendering
	//sap.m.ScrollContainerRenderer.render.call(that, oRm, oControl);
	
	// return immediately if control is invisible
	if (!oControl.getVisible()) {
		return;
	}

	oRm.write("<div");
	oRm.writeControlData(oControl);

	var width = oControl.getWidth(),
	height = oControl.getHeight();
	if (width) {
		oRm.addStyle("width", width);
	}
	if (height) {
		oRm.addStyle("height", height);
	}
	oRm.writeStyles();
	oRm.addClass("sapCaUiGTCBScroll");

	if (oControl.getVertical()) {
		if (!oControl.getHorizontal()) {
			oRm.addClass("sapMScrollContV");
		} else {
			oRm.addClass("sapMScrollContVH");
		}
	} else if (oControl.getHorizontal()) {
		oRm.addClass("sapMScrollContH");
	}

	oRm.addClass("sapMScrollCont");
	oRm.writeClasses();
	
	var sTooltip = oControl.getTooltip_AsString();
	if (sTooltip) {
		oRm.writeAttributeEscaped("title", sTooltip);
	}
	
	oRm.write("><div id='" + oControl.getId() + "-scroll' class='sapMScrollContScroll'>");
	
	// render child controls
	var aContent = oControl.getContent(), 
	l = aContent.length;
	var oLayoutGrid = oControl._getGridLayout();
	for (var i = 0; i < l; i++) {
		oLayoutGrid.addContent(aContent[i]);
		//oRm.renderControl(aContent[i]);
	}
	
	//sap.ui.layout.GridRenderer.render.call(that, oRm, oLayoutGrid);
	oRm.renderControl(oLayoutGrid);

	oRm.write("</div></div>");
};

}; // end of sap/ca/ui/GrowingTileContainerRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchicalSelectDialogRenderer') ) {
jQuery.sap.declare("sap.ca.ui.HierarchicalSelectDialogRenderer");
jQuery.sap.require('sap.m.DialogRenderer'); // unlisted dependency retained


/**
 * @class HierarchicalSelectDialog renderer.
 * @static
 *
 * HierarchicalSelectDialogRenderer extends the DialogRenderer
 */
sap.ca.ui.HierarchicalSelectDialogRenderer = sap.ui.core.Renderer.extend(sap.m.DialogRenderer);
}; // end of sap/ca/ui/HierarchicalSelectDialogRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchyItemRenderer') ) {
jQuery.sap.declare("sap.ca.ui.HierarchyItemRenderer");
jQuery.sap.require('sap.ui.layout.HorizontalLayout'); // unlisted dependency retained

jQuery.sap.require('sap.m.Label'); // unlisted dependency retained

jQuery.sap.require('sap.m.Link'); // unlisted dependency retained


/**
 * @class HierarchyItem renderer.
 * @static
 */
sap.ca.ui.HierarchyItemRenderer = {
};


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.HierarchyItemRenderer.render = function (oRm, oControl) {
    var iconURI = oControl.getProperty("icon");
    var sLevelType = oControl.getProperty("levelType");
    var sIdentifier = oControl.getProperty("identifier");
    var sTitle = oControl.getProperty("title");
    var sLink = oControl.getProperty("link");
    var bEmphasized = oControl.getProperty("emphasized");
    var bIsIconURINotEmpty = this.isNotEmpty(iconURI);
    var bIsLevelTypeNotEmpty = this.isNotEmpty(sLevelType);
    var bIsIdentifierNotEmpty = this.isNotEmpty(sIdentifier);
    var bIsTitleNotEmpty = this.isNotEmpty(sTitle);
    var bIsLinkNoEmpty = this.isNotEmpty(sLink);
    // write the HTML into the render manager
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiHierarchyItem");
    if (bEmphasized) {
        oRm.addClass("sapCaUiHierarchyItemEmphasized");
    }
    oRm.writeClasses();
    oRm.write(">");
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiHierarchyItemBlockContainer");
    oRm.writeClasses();
    oRm.write(">");
    if (bIsIconURINotEmpty || bIsLevelTypeNotEmpty || bIsIdentifierNotEmpty) {
        oRm.write("<div");
        oRm.writeControlData(oControl);
        oRm.addClass("sapCaUiHierarchyItemBlock");
        oRm.writeClasses();
        oRm.write(">");
        if (bIsIconURINotEmpty) {
            oRm.renderControl(oControl._getIconControl());
        }
        if (bIsLevelTypeNotEmpty) {
            oRm.renderControl(oControl._getLevelTypeLabel());
        }
        if (bIsIdentifierNotEmpty) {
            oRm.renderControl(oControl._getIdentifierLabel());
        }
        oRm.write("</div>");
    }
    if (bIsTitleNotEmpty || bIsLinkNoEmpty) {
        oRm.write("<div");
        oRm.writeControlData(oControl);
        oRm.addClass("sapCaUiHierarchyItemBlock");
        oRm.writeClasses();
        oRm.write(">");
        if (bIsTitleNotEmpty) {
            oRm.renderControl(oControl._getTitleLabel());
        }
        if (bIsLinkNoEmpty) {
            oRm.renderControl(oControl._getLinkControl());
        }
        oRm.write("</div>");
    }
    oRm.write("</div>");
    oRm.write("</div>");
};


sap.ca.ui.HierarchyItemRenderer.isNotEmpty = function (value) {
    return (value != undefined && value != "");
}
}; // end of sap/ca/ui/HierarchyItemRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchyRenderer') ) {
jQuery.sap.declare("sap.ca.ui.HierarchyRenderer");

/**
 * @class Hierarchy renderer.
 * @static
 */
sap.ca.ui.HierarchyRenderer = {
};


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.HierarchyRenderer.render = function (oRm, oControl) {
    // write the HTML into the render manager
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiHierarchy");
    oRm.writeClasses();
    oRm.write(">");
    var sIconHtml = '<div class="sapCaUiHierarchyIcon"><div class="sapCaUiHierarchyIconVertRec"></div><div class="sapCaUiHierarchyIconHorizRec"></div><div class="sapCaUiHierarchyIconTriangle"></div></div>';
    var aItems = oControl.getItems();
    var iNbOfItems = aItems.length;
    var bNeedsExpand = oControl.getHideOptionalLevels();
    var oBtnParent;
    // Render the lines
    for (var i = 0; i < iNbOfItems; i++) {
        var oItem = aItems[i];
        oItem.removeStyleClass("sapCaUiHierarchyHidden");
        var bIsOptional = oItem.getOptional();
        oRm.write("<div");
        if (bIsOptional && bNeedsExpand && oBtnParent) {
            oRm.addClass("sapCaUiHierarchyHidden");
        }
        oRm.addClass("sapCaUiHierarchyItemLine");
        oRm.writeClasses();
        oRm.write(">");
        if (i > 0) {
            oRm.write("<div class='sapCaUiHierarchyIconContainer'>" + sIconHtml + "</div>");
        }
        if (bIsOptional && bNeedsExpand && !oBtnParent) {
            oBtnParent = oControl._getExpandButton().addStyleClass("sapCaUiHierarchyItemLineContent");
            oRm.renderControl(oBtnParent);
            oItem.addStyleClass("sapCaUiHierarchyHidden");
        } else if( (!bIsOptional) && bNeedsExpand && oBtnParent){
            oBtnParent = null;
        }
        oItem.addStyleClass("sapCaUiHierarchyItemLineContent");
        oRm.renderControl(oItem);
        oRm.write("</div>");
    }
    oRm.write("</div>");
};

}; // end of sap/ca/ui/HierarchyRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.InPlaceEditRenderer') ) {
jQuery.sap.declare("sap.ca.ui.InPlaceEditRenderer");

/**
 * @class InPlaceEdit renderer.
 * @static
 */
sap.ca.ui.InPlaceEditRenderer = {
};

/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} rm the RenderManager that can be used for writing to the Render-Output-Buffer
 * @param {sap.ui.core.Control} oInPlaceEdit an object representation of the control that should be rendered
 */
sap.ca.ui.InPlaceEditRenderer.render = function(rm, oInPlaceEdit){

    var oContent = oInPlaceEdit.getContent();
    var sWidth;

    if (oContent) {
        if (oContent.getWidth) {
            sWidth = oContent.getWidth();
        }
        if (oContent.getVisible && !oContent.getVisible()) {
            // invisible -> render nothing
            return;
        }
    }else{
        // no content -> render nothing
        return;
    }

    // write the HTML into the render manager
    rm.write("<div");
    rm.writeControlData(oInPlaceEdit);
    rm.addClass("sapCaUiIpe");

    if (!oInPlaceEdit.getEditable()) {
        rm.addClass("sapCaUiIpeRo");
    }else if (!oInPlaceEdit._bEditMode) {
        // display mode
        rm.writeAttribute("tabindex", "-1"); //to have focus event on clicking on this DIV (ComboBox expander in display mode)
        if (!oInPlaceEdit._sOldTextAvailable) {
            if (oContent instanceof sap.m.Select) {
                rm.addClass("sapCaUiIpeCombo");
            }
        }
        if (oContent instanceof sap.m.Link) {
            rm.addClass("sapCaUiIpeLink");
        }
    }else{
        // edit mode
        rm.addClass("sapCaUiIpeEdit");
    }

    if (sWidth) {
        rm.addStyle("width", sWidth);
    }

    if (oInPlaceEdit.getUndoEnabled() && oInPlaceEdit._sOldTextAvailable &&
            ( !oInPlaceEdit._bEditMode || ( oInPlaceEdit._bEditMode && oInPlaceEdit._oEditControl.getValue() != oInPlaceEdit._sOldText))) {
        // there is an old text available - visualize Undo
        rm.addClass("sapCaUiIpeUndo");
    }

    switch (oInPlaceEdit.getValueState()) {
        case sap.ui.core.ValueState.Error:
            rm.addClass('sapCaUiIpeErr');
            break;
        case sap.ui.core.ValueState.Success:
            rm.addClass('sapCaUiIpeSucc');
            break;
        case sap.ui.core.ValueState.Warning:
            rm.addClass('sapCaUiIpeWarn');
            break;
        default:
            break;
    }


    rm.writeClasses();
    rm.writeStyles();
    rm.write(">"); // DIV

    if (oInPlaceEdit._sOldTextAvailable || oContent instanceof sap.m.Link) {
        // there is an old text available - put content in a extra DIV to position
        // for Link do it always to have the edit button next to the link, but have the defined width for the outer DIV
        rm.write("<div");
        rm.addClass("sapCaUiIpeCont");
        rm.addClass("sapCaUiIpeCont");
        if (oContent instanceof sap.m.Select) {
            rm.addClass("sapCaUiIpeCombo");
        }
        rm.writeClasses();
        rm.write(">"); // DIV

    }

    if (oInPlaceEdit._bEditMode) {
        this.renderEditContent(rm, oInPlaceEdit);
    }
    else{
        this.renderDisplayContent(rm, oInPlaceEdit);
    }
    if (oInPlaceEdit._sOldTextAvailable || oContent instanceof sap.m.Link) {
        rm.write("</div>");
        if (oInPlaceEdit.getUndoEnabled() && oInPlaceEdit._sOldTextAvailable) {
            // there is an old text available and undo enabled - render undo button
            rm.renderControl(oInPlaceEdit._oUndoButton);
        }
    }


    rm.write("</div>");
};

sap.ca.ui.InPlaceEditRenderer.renderDisplayContent = function(rm, oInPlaceEdit){

    if (oInPlaceEdit._oDisplayControl) {
        rm.renderControl(oInPlaceEdit._oDisplayControl);
        if (oInPlaceEdit.getEditable() && oInPlaceEdit._oDisplayControl instanceof sap.m.Link) {
            rm.renderControl(oInPlaceEdit._oEditButton);
        }
    }

};

sap.ca.ui.InPlaceEditRenderer.renderEditContent = function(rm, oInPlaceEdit){

    if (oInPlaceEdit._oEditControl) {
        rm.renderControl(oInPlaceEdit._oEditControl);
    }

};
}; // end of sap/ca/ui/InPlaceEditRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.NavigationHandler') ) {

jQuery.sap.declare("sap.ca.ui.NavigationHandler");

jQuery.sap.require('jquery.sap.history'); // unlisted dependency retained

jQuery.sap.require('sap.m.InstanceManager'); // unlisted dependency retained


sap.ca.ui.NavigationHandler = function(oApp, oAppConfig) {
	//add config
	this._app = oApp;
	this.config = oAppConfig;
};

sap.ca.ui.NavigationHandler.prototype._getValue = function(sPropName) {
	var val = this[sPropName];
	if (typeof val == 'string' || val instanceof String){
		return val;
	}
	return val();
};

sap.ca.ui.NavigationHandler.prototype.subscribe = function () {

	// handler for initial history
	var historyDefaultHandler = function (navType) {
		var pageId = this.config.getStringValue("defaultPageId");
		if (navType === jQuery.sap.history.NavType.Back) {
			this._navBack(pageId);
		} else {
			this._navTo(pageId, null, false);
		}
	};
	
	// handler for changes in browser history
	var historyPageHandler = function (params, navType) {
		if (!params || !params.id) {
			jQuery.sap.log.error("invalid parameter: " + params);
		} else {
			if (navType === jQuery.sap.history.NavType.Back) {
				this._navBack(params.id);
			} else {
				this._navTo(params.id, params.data, false);
			}
		}
	};
	
	// initialize the history plugin
	jQuery.sap.history({
		routes: [{ 
			// This handler is executed when you navigate back to the history state on the path "page"
			path : "page",
			handler: jQuery.proxy(historyPageHandler, this)
		}],
		// The default handler is executed when you navigate back to the history state with an empty hash
		//defaultHandler: jQuery.proxy(historyDefaultHandler, this)
	});
	
	// subscribe to event bus
	var bus = sap.ui.getCore().getEventBus();
	bus.subscribe("nav", "to", this._navHandler, this);
	bus.subscribe("nav", "back", this._navHandler, this);
	bus.subscribe("nav", "backMaster", this._backMaster, this);
	bus.subscribe("nav", "virtual", this._navHandler, this);
};

sap.ca.ui.NavigationHandler.prototype._backMaster = function (channelId, eventId, data) {
	this._app.backMaster();
};

sap.ca.ui.NavigationHandler.prototype._navHandler = function (channelId, eventId, data) {
	
	if (eventId === "to") {
		this._navTo(data.id, data.data, true);
	} 
	else if (eventId === "back") {
		this._navBack(data.id);
		//provide a default value for navigation,  one step back in history
		/*if (!data.step) {
			data.step = 1;
		}
		if (data.home) {
			jQuery.sap.history.backToHash("");
		} 
		else if (data.step > 0) {
			jQuery.sap.history.back(data.step);
		} 
		else {
			jQuery.sap.log.error("'nav back' event cannot be processed. At least one from [data.step, data.home] must be given with valid value");
		}
		*/
	} 
	else if (eventId === "virtual") {
		jQuery.sap.history.addVirtualHistory();
	} 
	else {
		jQuery.sap.log.error("'nav' event cannot be processed. There's no handler registered for event with id: " + eventId);
	}
};

sap.ca.ui.NavigationHandler.prototype._navTo = function (id, data, writeHistory) {
		
	if (id === undefined) {
		
		// invalid id
		jQuery.sap.log.error("navTo failed due to missing id");
		
	} else {
		
		// close open popovers
		if(sap.m.InstanceManager.hasOpenPopover()){
			sap.m.InstanceManager.closeAllPopovers();
			jQuery.sap.log.info("navTo - closed popover(s)");
		}

        var transition = this.config.getStringValue("transition");
        var isMaster = this.config.getBoolValue("isMaster",[id]);
        var hasMaster = isMaster || this.config.getBoolValue("masterVisible",[id]);
        if (id instanceof sap.ui.core.Control) {

            if (this._app.getPage(id.getId()) === null) {
                this._app.addPage(id);
            }
        }
        else {
            // load view on demand
            var viewType = this.config.getStringValue("viewType");
            var viewName = this.config.getStringValue("viewName",[id]);
            if (this._app.getPage(id, isMaster) === null) {
                var page = sap.ui.view({
                    id : id,
                    viewName : viewName,
                    type : viewType
                });
                this._app.addPage(page, isMaster);
                jQuery.sap.log.info("app controller > loaded page: " + id);
            }
        }


        this._app.toggleStyleClass("sapMSplitAppFullscreen", !hasMaster);
		this._app.to((page !== undefined ? page.getId() : id), transition, data);
		
		// write browser history
		if ((writeHistory === undefined || writeHistory)) {
			//TODO why does this work in explored app but no here?
			//&& (jQuery.device.is.phone || master)) {
			var bookmarkable = false;
			var stateData = { id : id };
//			jQuery.sap.history.addHistory("page", stateData, bookmarkable);
		}
		
		// log
		jQuery.sap.log.info("navTo - to page: " + id);
	}
};

sap.ca.ui.NavigationHandler.prototype._navBack = function (id) {
	if (!id) {		
		// invalid parameter
		jQuery.sap.log.error("navBack - parameters id must be given");
		
	} else {
		
		// close open popovers
		if (sap.m.InstanceManager.hasOpenPopover()) {
			sap.m.InstanceManager.closeAllPopovers();
		}
		
		// close open dialogs
		if (sap.m.InstanceManager.hasOpenDialog()) {
			sap.m.InstanceManager.closeAllDialogs();
			jQuery.sap.log.info("navBack - closed dialog(s)");
		}
		
		// ... and navigate back
		var currentId = (this._app.getCurrentPage()) ? this._app.getCurrentPage().getId() : null;
		if (currentId !== id) {
			
			var isMaster = this.config.getBoolValue("isMaster",[id]);
	        var hasMaster = isMaster || this.config.getBoolValue("masterVisible",[id]);
			
	        this._app.toggleStyleClass("sapMSplitAppFullscreen", !hasMaster);
			this._app.backToPage(id);
		}
		jQuery.sap.log.info("navBack - back to page: " + id);
	}
};
}; // end of sap/ca/ui/NavigationHandler.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.NotesRenderer') ) {
jQuery.sap.declare("sap.ca.ui.NotesRenderer");
jQuery.sap.require('sap.m.ListRenderer'); // unlisted dependency retained


/**
 * @class Notes renderer.
 * @static
 */
sap.ca.ui.NotesRenderer = {
};

/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.NotesRenderer.render = function(oRm, oControl){
    if (!oControl.getVisible())
        return;
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiNotes");
    oRm.writeClasses();
    oRm.write(">");
    if (oControl.getShowNoteInput()){
       oRm.write("<div ");
       oRm.writeAttributeEscaped("id", oControl.getId() + "-noteInput");
       oRm.addClass("sapCaUiNoteInput");
       oRm.writeClasses();
       oRm.write(">");


        if (!jQuery.device.is.phone) {
            oRm.renderControl(oControl._oButton);
            oRm.renderControl(oControl._oTextArea);
        } else {
            oRm.renderControl(oControl._oTextArea);
            oRm.renderControl(oControl._oButton);
        }

       oRm.write("</div>");
    }
    sap.m.ListRenderer.render(oRm, oControl);
    oRm.write("</div>");
};

}; // end of sap/ca/ui/NotesRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.OverflowContainerRenderer') ) {
jQuery.sap.declare("sap.ca.ui.OverflowContainerRenderer");

/**
 * @class OverflowContainer renderer. 
 * @static
 */
sap.ca.ui.OverflowContainerRenderer = {
};


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.OverflowContainerRenderer.render = function(oRm, oControl){ 
	 // write the HTML into the render manager
    var aContents = oControl.getContent();

    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addStyle("height", oControl.getExpanded() ? "auto" : oControl.getOverflowHeight());
    oRm.writeStyles();

    oRm.addClass("sapCaUiOC");
    oRm.writeClasses();
    oRm.write(">"); // first level div

    oRm.write("<div id='"+ oControl.getId() + "-content'");
    oRm.writeClasses();

    oRm.write(">");
    jQuery.each(aContents, function(oItem) {
        oRm.renderControl(aContents[oItem]);
    });
    oRm.write("</div>");

    // write div for overlay + button
    oRm.write("<div");
    oRm.writeAttributeEscaped("id", oControl.getId() + "-overlay");
    oRm.addClass("sapCaUiOCOverlay");
    oRm.writeClasses();
    oRm.write(">");
    oRm.write("</div>");

    // Button
    oRm.renderControl(oControl._getButton());

	oRm.write("</div>");

};

}; // end of sap/ca/ui/OverflowContainerRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.Overlay') ) {
  jQuery.sap.declare('sap.ca.ui.Overlay');
jQuery.sap.require('sap.ui.core.Popup'); // unlisted dependency retained


sap.ui.base.EventProvider.extend("sap.ca.ui.Overlay",{

	constructor: function(){
		
		this._oPopup = new sap.ui.core.Popup();
		this._oPopup.setModal(true);
		this._oPopup.setShadow(false);
		this._oPopup.setAutoClose(false);
		
		this._oPopup._applyPosition = function(oPostion){
			
			var $Ref = this._$();
			$Ref.css({left :"0px", top :"0px", right :"0px", bottom :"0px"});
		};
		
	}

	

});

sap.ca.ui.Overlay.prototype.open = function(oContent) {
	
	this.$content = oContent.$();
	if (this.$content){
				
		var domContent = oContent.getDomRef();
		//this.$parentNode = this.$content.parent();
		this.$tempNode = jQuery("<div></div>"); // id='" + this.$content.attr("id")+"-overlay"+ "'
		this.$content.before(this.$tempNode);
		
		
		this._$overlay = jQuery("<div></div>");
		this._$overlay.addClass("sapCaUiOverlay");
		this._$overlay.append(this.$content);
		this._oPopup.setContent(this._$overlay);
	}
	else {
		jQuery.sap.log.warn("Overlay: content does not exist or contains more than one child");
	}
	
	this._oPopup.open(200);
	
};

sap.ca.ui.Overlay.prototype.close = function() {
		
	this.$tempNode.replaceWith(this.$content);	
	
	this._oPopup.close(200);
	this._$overlay.remove();
};
}; // end of sap/ca/ui/Overlay.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.OverviewTileRenderer') ) {
jQuery.sap.declare("sap.ca.ui.OverviewTileRenderer");
jQuery.sap.require('sap.m.TileRenderer'); // unlisted dependency retained


/**
 * @class OverviewTile renderer. 
 * @static
 */
sap.ca.ui.OverviewTileRenderer = sap.ui.core.Renderer.extend(sap.m.TileRenderer);


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */

sap.ca.ui.OverviewTileRenderer.render =function(oRm, oControl){ 
	if(!oControl.getVisible()){
		return;
	}
    oRm.write("<div");
	oRm.writeControlData(oControl);
	var width = oControl.getWidth();
	if (width) {
		oRm.addStyle("width", width);
	}
	oRm.writeStyles();
	oRm.addClass("sapCaUiOverviewTile");
    oRm.addClass("sapMPointer");
	oRm.writeClasses();
    oRm.write(">"); // first level div

    	// Header
    	oRm.write("<div");
	    oRm.writeAttributeEscaped("id", oControl.getId() + "-header");
		oRm.addClass("sapCaUiOverviewTileHeader");
	    oRm.writeClasses();
	    oRm.write(">");
	    
	    	// Image
	    	oRm.write("<div");
		    oRm.writeAttributeEscaped("id", oControl.getId() + "-image");
		    oRm.addClass("sapCaUiOTImageDiv");
		    oRm.writeClasses();
		    oRm.write(">");
		    	oRm.renderControl(oControl._getImageCtrl());
			oRm.write("</div>");

	    	// TitleContent
	    	oRm.write("<div");
		    oRm.writeAttributeEscaped("id", oControl.getId() + "-titleContent");
		    oRm.addClass("sapCaUiOTTitleContentDiv");
		    oRm.writeClasses();
		    oRm.write(">");
	
		    	// Title
		    	oRm.write("<div");
			    oRm.writeAttributeEscaped("id", oControl.getId() + "-title");
			    //oRm.addClass("sapCaUiOverviewTileTitle");
			    oRm.writeClasses();
			    oRm.write(">");
			    	oRm.renderControl(oControl._getTitleCtrl());		
				oRm.write("</div>");

                // Address
                oRm.write("<div");
                oRm.writeAttributeEscaped("id", oControl.getId() + "-address");
                oRm.addClass("sapCaUiOTTitleAddressDiv");
                oRm.writeClasses();
                oRm.write(">");
                oRm.renderControl(oControl._getAddressCtrl());
                oRm.write("</div>");


                // Contact
		    	oRm.write("<div");
			    oRm.writeAttributeEscaped("id", oControl.getId() + "-contact");
			    oRm.addClass("sapCaUiOTTitleContactDiv");
			    oRm.writeClasses();
			    oRm.write(">");
			    	oRm.renderControl(oControl._getContactCtrl());		
				oRm.write("</div>");

			oRm.write("</div>");

		oRm.write("</div>");
	    
    	// Content
    	oRm.write("<div");
	    oRm.writeAttributeEscaped("id", oControl.getId() + "-content");
	    oRm.addClass("sapCaUiOverviewTileContent");
	    oRm.writeClasses();
	    oRm.write(">");

	    	// OppLine
	    	this.renderFormLine(oRm, oControl, "-oppLine",
	    			oControl._getOppLabelCtrl(), oControl._getOppCtrl());
	
	    	// RevenueLine
	    	this.renderFormLine(oRm, oControl, "-revenueLine",
	    			oControl._getRevenueLabelCtrl(), oControl._getRevenueCtrl());
	
	    	// RatingLine
	    	this.renderFormLine(oRm, oControl, "-ratingLine",
	    			oControl._getRatingLabelCtrl(), oControl._getRatingCtrl());
	
	    	// LastCtxLine
	    	this.renderFormLine(oRm, oControl, "-lastCtxLine",
	    			oControl._getLastCtxLabelCtrl(), oControl._getLastCtxCtrl());
	
	    	// NextCtxLine
	    	this.renderFormLine(oRm, oControl, "-nextCtxLine",
	    			oControl._getNextCtxLabelCtrl(), oControl._getNextCtxCtrl());
	
		oRm.write("</div>");
	    
	oRm.write("</div>");


};

sap.ca.ui.OverviewTileRenderer.renderFormLine = function(oRm, oControl, sIdSuffix, oLabel, oText){ 
	oRm.write("<div");
	oRm.writeAttributeEscaped("id", oControl.getId() + sIdSuffix);
	oRm.addClass("sapCaUiOTFormLine");
	oRm.writeClasses();
	oRm.write(">");

		// Need to invert the text and label because of the float
	    oRm.renderControl(oText);		
	    oRm.renderControl(oLabel);		
	
	oRm.write("</div>");
};


}; // end of sap/ca/ui/OverviewTileRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureItemRenderer') ) {
jQuery.sap.declare("sap.ca.ui.PictureItemRenderer");

/**
 * @class PictureItem renderer.
 * @static
 */
sap.ca.ui.PictureItemRenderer = {
};


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.PictureItemRenderer.render = function (oRm, oControl) {
    // write the HTML into the render manager
    
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiPictureItem");
    oRm.writeClasses();
    

    var _width = oControl._width || oControl.getWidth();
    var _height = oControl._height || oControl.getHeight();    
    oRm.addStyle("width", _width);
    oRm.addStyle("height", _height);    
    oRm.writeStyles();

    
    oRm.writeAttribute("tabindex", "0");
    oRm.write(">");

    oRm.renderControl(oControl._oImage);

    oRm.write("</div>");

};

}; // end of sap/ca/ui/PictureItemRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureTileRenderer') ) {
jQuery.sap.declare("sap.ca.ui.PictureTileRenderer");
jQuery.sap.require('sap.m.CustomTileRenderer'); // unlisted dependency retained


/**
 * @class PictureTile renderer. 
 * @static
 */

sap.ca.ui.PictureTileRenderer = sap.ui.core.Renderer.extend(sap.m.CustomTileRenderer);

/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */

 sap.ca.ui.PictureTileRenderer.render = function(oRm, oControl) {

	jQuery.sap.log.debug("PictureTileRenderer :: begin rendering");
	
	oRm.write("<div ");
	oRm.writeControlData(oControl);

	oRm.addClass("sapCaUiPictureTile");
	oRm.writeClasses();

	oRm.write(">");
	
	
	oRm.write("<div");
	oRm.addClass("sapCaUiPictureTileContent");
	oRm.writeClasses();
	oRm.write(">");

	oRm.write("<div id='"+oControl.getId()+"-wrapper'>");
	
	oRm.renderControl(oControl._oDeletePictureButton);
	
	this._renderContent(oRm, oControl);
	oRm.write("</div>");
	
	oRm.write("</div></div>");
};

sap.ca.ui.PictureTileRenderer._renderContent = function(rm, oTile) {
	rm.renderControl(oTile.getContent());
};

}; // end of sap/ca/ui/PictureTileRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureViewerRenderer') ) {
jQuery.sap.declare("sap.ca.ui.PictureViewerRenderer");

jQuery.sap.require('sap.m.TileContainerRenderer'); // unlisted dependency retained



/**
 * @class PictureViewer renderer.
 * @static
 */
sap.ca.ui.PictureViewerRenderer = {};

/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.PictureViewerRenderer.render = function(oRm, oControl) {
	// write the HTML into the render manager	
	jQuery.sap.log.debug("PictureViewerRenderer :: begin rendering");

	sap.m.TileContainerRenderer.render(oRm, oControl);

    jQuery.sap.log.debug("PictureViewerRenderer :: end rendering");
};

}; // end of sap/ca/ui/PictureViewerRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.TabContainerOverflowRenderer') ) {
jQuery.sap.declare("sap.ca.ui.TabContainerOverflowRenderer");
jQuery.sap.require('sap.ui.core.EnabledPropagator'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.IconPool'); // unlisted dependency retained

sap.ui.core.EnabledPropagator.apply(sap.ca.ui.TabContainerOverflow.prototype, [true]);


sap.ca.ui.TabContainerOverflowRenderer = {
};

/**
 * Array of all available icon color CSS classes
 * 
 * @private
 */
sap.ca.ui.TabContainerOverflowRenderer._aAllIconColors = ['sapMITFilterCritical', 'sapMITFilterPositive', 'sapMITFilterNegative', 'sapMITFilterDefault'];


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.TabContainerOverflowRenderer.render = function(oRM, oControl){
	
	// return immediately if control is not visible
	if (!oControl.getVisible()) {
		return;
	}
	
	var aItems = oControl.getItems();
	var bTextOnly = oControl._checkTextOnly(aItems);
	var bNoText = oControl._checkNoText(aItems);
	
	
	
	oRM.write("<div ");
	oRM.addClass("sapTCOB");
	oRM.writeControlData(oControl);
	oRM.writeClasses();
	oRM.write(">");
	oRM.write("<div");
	oRM.addClass("sapMITBHead");
	if (bTextOnly) {
		oRM.addClass("sapMITTextOnly");
	}
	if (bNoText) {
		oRM.addClass("sapMITNoText");
	}
	oRM.writeClasses();
	oRM.write(">");
	jQuery.each(aItems, function(iIndex, oItem) {
		oRM.write("<div ");
		oRM.writeElementData(oItem);
		oRM.addClass("sapTCO");
		if (oItem instanceof sap.m.IconTabFilter) {
			if (oItem.getShowAll()) {
				oRM.addClass("sapMITAll");
			} else {
				oRM.addClass("sapMITFilter");
				oRM.addClass("sapMITFilter" + oItem.getIconColor());
			}
			if (!oItem.getEnabled()) {
				oRM.addClass("sapMITDisabled");
			}
 			oRM.writeClasses();
			oRM.write(">");
			oRM.write("<div class='sapMITTab'>");
			if (!oItem.getShowAll() || !oItem.getIcon()) {
				oRM.renderControl(oItem._getImageControl(['sapMITFilterIcon', 'sapMITFilter' + oItem.getIconColor()], oControl, sap.ca.ui.TabContainerOverflowRenderer._aAllIconColors));	
			}
			if (!oItem.getShowAll() && !oItem.getIcon() && !bTextOnly)  {
				oRM.write("<span class='sapMITFilterNoIcon'> </span>");
			}
		//	oRM.write("<span class=\"sapMITDesc\">");
			oRM.write("<span class=\"sapMITCount\">");
			oRM.writeEscaped(oItem.getCount());
			oRM.write("</span>");
			oRM.write("</div>");
			if (oItem.getText().length) {
				oRM.write("<div class=\"sapMITText\">");
				oRM.writeEscaped(oItem.getText());
				oRM.write("</div>");
			}
			
		//	oRM.write("</span>");
		} 
		else if (oItem instanceof sap.m.IconTabSeparator) {
			oRM.addClass("sapMITSep");
			if (!oItem.getIcon()) {
				oRM.addClass("sapMITSepLine");
			}
			oRM.writeClasses();
			oRM.write(">");
			
			if (oItem.getIcon()) {
				oRM.renderControl(oItem._getImageControl(['sapMITSepIcon'], oControl));	
			}
		}
		oRM.write("</div>");
	});
	oRM.write("</div>");
	var oContent = oControl.getContent();

	oRM.write("<div");
	oRM.writeAttributeEscaped("id", oControl.getId()+"-containerContent");
	oRM.write( "class='sapTCOBContainerContent'>");
	oRM.write("<div");
	oRM.writeAttributeEscaped("id", oControl.getId()+"-arrow");
	oRM.write( " class=\"sapTCOBArrow\"></div>");
	oRM.write("<div");
	oRM.writeAttributeEscaped("id", oControl.getId()+"-content");
	oRM.write("class=\"sapTCOBContent\">");
		
	if (oControl.oSelectedItem) {
		if (oControl.oSelectedItem.getContent()) {
			var oContentSelectedTab = oControl.oSelectedItem.getContent();
			if (oContentSelectedTab.length > 0) {
				oContent = oContentSelectedTab;
			}
		}
	}
	if (oContent.length > 0) {
		for (var i = 0; i < oContent.length; i++) {
			oRM.renderControl(oContent[i]);
		}
	}

	oRM.write("</div>");
	oRM.write("<div");
	oRM.writeAttributeEscaped("id", oControl.getId()+"-overlay");
	oRM.write("class=\"sapTCOBOverlay\">");
	oRM.write("</div>");
	oRM.renderControl(oControl.moreLessButton);

	oRM.write("</div>");
	oRM.write("</div>");
};



}; // end of sap/ca/ui/TabContainerOverflowRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.ZoomableScrollContainerRenderer') ) {
jQuery.sap.declare("sap.ca.ui.ZoomableScrollContainerRenderer");
jQuery.sap.require('sap.m.ScrollContainerRenderer'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained



/**
 * @class ZoomableScrollContainer renderer. 
 * @static
 */
sap.ca.ui.ZoomableScrollContainerRenderer = sap.ui.core.Renderer.extend(sap.m.ScrollContainerRenderer);

}; // end of sap/ca/ui/ZoomableScrollContainerRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.BarListItemRenderer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

jQuery.sap.declare("sap.ca.ui.charts.BarListItemRenderer");

jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained

jQuery.sap.require('sap.m.ListItemBaseRenderer'); // unlisted dependency retained


/**
 * @class DisplayListItem renderer.
 * @static
 */
sap.ca.ui.charts.BarListItemRenderer = sap.ui.core.Renderer.extend(sap.m.ListItemBaseRenderer);

/**
 * Renders the HTML for the given control, using the provided
 * {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager}
 *          oRenderManager the RenderManager that can be used for writing to the
 *          Render-Output-Buffer
 * @param {sap.ui.core.Control}
 *          oControl an object representation of the control that should be
 *          rendered
 */
sap.ca.ui.charts.BarListItemRenderer.renderLIAttributes = function(rm, oLI) {
	rm.addClass("sapMBLI");
};

sap.ca.ui.charts.BarListItemRenderer.renderLIContent = function(rm, oLI) {

   var isAxis = oLI.getAxis();

   // List item axis
   if (isAxis) {
      rm.write("<p for='" + oLI.getId() + "-axis' class='sapMBLIAxis'>");
      rm.writeEscaped(oLI.getAxis());
      rm.write("</p>");
   }
   
	var isGroup = oLI.getGroup();

	// List item group
	if (isGroup) {
		rm.write("<label for='" + oLI.getId() + "-value' class='sapMBLIGroup'>");
		rm.writeEscaped(oLI.getGroup());
		rm.write("</label>");
	}
	
	var isValue = oLI.getValue();
	
	// List item value
	if (isValue) {
		rm.write("<div id='" + oLI.getId() + "-value' class='sapMBLIValue'>");
		rm.writeEscaped(oLI.getValue());
		rm.write("</div>");
	}
};

}; // end of sap/ca/ui/charts/BarListItemRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.ChartRenderer");

/**
 * @class Chart renderer.
 * @static
 */
sap.ca.ui.charts.ChartRenderer = {

    /**
     * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
     *
     * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
     * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
     */
    render: function (oRm, oControl) {
        if (!oControl.getDataset()) {
            return;
        }
        oRm.write("<div");
        oRm.writeControlData(oControl);
        oRm.addClass('sapCaUiChart');
        if (!oControl.getShowHoverBackground()) {
            oRm.addClass('sapCaUiChartNoHover');
        }
        oRm.addStyle("width", oControl.getWidth());
        oRm.addStyle("height", oControl.getHeight());
        oRm.writeClasses();
        oRm.writeStyles();
        oRm.write('>');

        oRm.renderControl(oControl.getAggregation('internalContent'));

//        oRm.write('<div');
//        oRm.addClass('sapCaUiChartRightShadow');
//        oRm.writeClasses();
//        oRm.write('</div>');

        oRm.write('</div>');
    }
};

}; // end of sap/ca/ui/charts/ChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartToolBarRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.ChartToolBarRenderer");

/**
 * @class ChartToolBar renderer.
 * @static
 */
sap.ca.ui.charts.ChartToolBarRenderer = {
};


/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.charts.ChartToolBarRenderer.render = function(oRm, oControl){

    var selectedId = oControl.getSelectedChart();
    var oChart = oControl._findChartById(selectedId);

    // write the HTML into the render manager
    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiChartToolBar");
    oRm.writeClasses();
    oRm.write(">");

        // wrapper
        oRm.write("<div");
        oRm.writeAttributeEscaped("id", oControl.getId() + "-wrapper");
        oRm.addClass("sapCaUiChartToolBarWrapper");

        oRm.writeClasses();
        oRm.write(">");

            //toolbar
            oRm.renderControl(oControl._oToolBar);

            // chart part
            oRm.write("<div");
            oRm.addClass("sapCaUiChartToolBarChartArea");
            oRm.writeClasses();
            oRm.write(">");

                oRm.renderControl(oChart);

            oRm.write("</div>");// end chartArea
        oRm.write("</div>");    // end wrapper

    oRm.write("</div>");
};

}; // end of sap/ca/ui/charts/ChartToolBarRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ClusterListItemRenderer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

jQuery.sap.declare("sap.ca.ui.charts.ClusterListItemRenderer");

jQuery.sap.require('sap.ui.core.Renderer'); // unlisted dependency retained

jQuery.sap.require('sap.m.ListItemBaseRenderer'); // unlisted dependency retained


/**
 * @class ClusterListItem renderer.
 * @static
 */
sap.ca.ui.charts.ClusterListItemRenderer = sap.ui.core.Renderer.extend(sap.m.ListItemBaseRenderer);

/**
 * Renders the HTML for the given control, using the provided
 * {@link sap.ui.core.RenderManager}.
 * 
 * @param {sap.ui.core.RenderManager}
 *          oRenderManager the RenderManager that can be used for writing to the
 *          Render-Output-Buffer
 * @param {sap.ui.core.Control}
 *          oControl an object representation of the control that should be
 *          rendered
 */
sap.ca.ui.charts.ClusterListItemRenderer.renderLIAttributes = function(rm, oLI) {
   rm.addClass("sapMCLI");
};

sap.ca.ui.charts.ClusterListItemRenderer.renderLIContent = function(rm, oLI) {
   var sTitle = oLI.getTitle();

   if (sTitle) {
      rm.write("<div");
      rm.writeAttributeEscaped("for", oLI.getId() + "-title");
      rm.writeAttributeEscaped("class", "sapMCLITitle");
      rm.write(">");
      rm.writeEscaped(sTitle);
      rm.write("</div>");
   }
   
   this.renderLIItems(rm, oLI, oLI.getItems());
};

sap.ca.ui.charts.ClusterListItemRenderer.renderLIItems = function(rm, oLI, oItems) {
   if ( typeof oItems === "undefined" ) {
      return;
   }
   
   for (var nIndex in oItems) {
      var oItem      = oItems[nIndex];
      var oSubItems  = oItem["items"];
      var bLeaf      = typeof oSubItems === "undefined";
      
      if ( bLeaf ) {
         var sLabel     = oItem["label"];
         var sValue     = oItem["value"];
         var vColor     = oItem["color"];
         
         rm.write("<div");
         rm.writeAttributeEscaped("id", oLI.getId() + "-item");
         rm.writeAttributeEscaped("class", "sapMCLIItem");
         rm.write(">");
         
         rm.write("<div");
         rm.writeAttributeEscaped("id", oLI.getId() + "-icon");
         rm.writeAttributeEscaped("class", "sapMCLIIcon");
         rm.write(">");
         
         rm.write("<div");
         rm.writeAttributeEscaped("id", oLI.getId() + "-colorBox");
         rm.writeAttributeEscaped("class", "sapMCLIColorBox");            
         rm.writeAttributeEscaped("style", "background: " + sap.ca.ui.charts.ClusterListItemRenderer.formatColor(vColor));
         rm.write(">");
         rm.write("</div>");
         
         rm.write("</div>");
         
         if (sLabel) {
            rm.write("<label");
            rm.writeAttributeEscaped("for", oLI.getId() + "-label");
            rm.writeAttributeEscaped("class", "sapMCLIGroup");
            rm.write(">");
            rm.writeEscaped(sLabel);
            rm.write("</label>");
         }
         
         if (sValue) {
            rm.write("<div");
            rm.writeAttributeEscaped("for", oLI.getId() + "-value");
            rm.writeAttributeEscaped("class", "sapMCLIValue");
            rm.write(">");
            rm.writeEscaped(sValue);
            rm.write("</div>");
         }
         
         rm.write("</div>");
         
      } else {
         var sTitle  = oItem["title"];

         if (sTitle) {
            rm.write("<div");
            rm.writeAttributeEscaped("for", oLI.getId() + "-title");
            rm.writeAttributeEscaped("class", "sapMCLITitle");
            rm.write(">");
            rm.writeEscaped(sTitle);
            rm.write("</div>");
         }
         
         this.renderLIItems(rm, oLI, oSubItems);
      }
   }
};

sap.ca.ui.charts.ClusterListItemRenderer.formatColor = function(vColor) {
   if ( typeof vColor === "string" ) {
      return vColor;
   }
   if ( typeof vColor !== "number" ) {
      return "#ffffff";
   }
   var sColor = vColor.toString(16);
   while ( sColor.length < 6 ) {
      sColor = "0" + sColor;
   }
   return "#" + sColor;
};
}; // end of sap/ca/ui/charts/ClusterListItemRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.CombinedChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.CombinedChartRenderer");


/**
 * @class CombinedChart renderer.
 * @static
 */
sap.ca.ui.charts.CombinedChartRenderer = sap.ca.ui.charts.ChartRenderer;


}; // end of sap/ca/ui/charts/CombinedChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.HorizontalBarChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.HorizontalBarChartRenderer");


/**
 * @class HorizontalBarChart renderer.
 * @static
 */
sap.ca.ui.charts.HorizontalBarChartRenderer = sap.ca.ui.charts.ChartRenderer;
}; // end of sap/ca/ui/charts/HorizontalBarChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.LineChartRenderer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

jQuery.sap.declare("sap.ca.ui.charts.LineChartRenderer");

/**
 * @class LineChart renderer.
 * @static
 */
sap.ca.ui.charts.LineChartRenderer = sap.ui.core.Renderer.extend(sap.ca.ui.charts.ChartRenderer);
}; // end of sap/ca/ui/charts/LineChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.StackedHorizontalBarChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.StackedHorizontalBarChartRenderer");


/**
 * @class StackedHorizontalBarChartRenderer renderer.
 * @static
 */
sap.ca.ui.charts.StackedHorizontalBarChartRenderer = sap.ca.ui.charts.ChartRenderer;
}; // end of sap/ca/ui/charts/StackedHorizontalBarChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.StackedVerticalColumnChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.StackedVerticalColumnChartRenderer");


/**
 * @class StackedVerticalColumnChartRenderer renderer.
 * @static
 */
sap.ca.ui.charts.StackedVerticalColumnChartRenderer = sap.ca.ui.charts.ChartRenderer;
}; // end of sap/ca/ui/charts/StackedVerticalColumnChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.VerticalBarChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.VerticalBarChartRenderer");


/**
 * @class VerticalBarChart renderer.
 * @static
 */
sap.ca.ui.charts.VerticalBarChartRenderer = sap.ca.ui.charts.ChartRenderer;
}; // end of sap/ca/ui/charts/VerticalBarChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.dialog.Dialog') ) {
jQuery.sap.declare("sap.ca.ui.dialog.Dialog");

sap.ca.ui.dialog.Dialog = function(sId, oSettings){
	this.setId(sId);
	if (oSettings) {
		this.setXMLView(oSettings.xmlViewId, 
						oSettings.xmlViewName, 
						oSettings.bStretchOnlyOnPhone, 
						oSettings.bWithPadding);
	}
};

sap.ca.ui.dialog.Dialog.prototype.initAndOpen = function(oSettings, fnClose) {
	//merge oSettings and fnClose function
	var oViewSettings = jQuery.extend({}, oSettings, {
		fnClose : (jQuery.isFunction(fnClose))? fnClose : null
	});
	
	//set model to view
	var oModel = new sap.ui.model.json.JSONModel(oViewSettings);
	this.getDialog().setModel(oModel);
	
	//open the dialog
	this.getDialog().open();
};

sap.ca.ui.dialog.Dialog.prototype.setId = function(sId) {
	this._sId = "";
	if (jQuery.type(sId) === "string") {
		this._sId = sId;
	}
};

sap.ca.ui.dialog.Dialog.prototype.getId = function() {
	return this._sId;
};

sap.ca.ui.dialog.Dialog.prototype.setXMLView = function(sXMLViewId, sXMLViewName, bStretchOnlyOnPhone, bWithPadding) {
	this._sXMLView = null;
	this._oDlg = null;
	if (jQuery.type(sXMLViewId) === "string" && jQuery.type(sXMLViewName) === "string") {
		this._sXMLView = new sap.ui.view({
			id : sXMLViewId, 
			viewName : sXMLViewName, 
			type : sap.ui.core.mvc.ViewType.XML
		});
		if (this._sXMLView) {
			this._oDlg = this._sXMLView.byId(this.getId());
			if (bStretchOnlyOnPhone && jQuery.device.is.phone) {
				this._oDlg.setStretch(true);
			}
			if (bWithPadding) {
				this._oDlg.addStyleClass("sapUiPopupWithPadding");
			}
		}
	}
};

sap.ca.ui.dialog.Dialog.prototype.setDataProperty = function(sPath, oValue) {
	if (this._oDlg) {
		this._oDlg.getModel().setProperty(sPath, oValue);
		this._oDlg.rerender();
	}
};

sap.ca.ui.dialog.Dialog.prototype.getXMLView = function() {
	return this._sXMLView;
};

sap.ca.ui.dialog.Dialog.prototype.getDialog = function() {
	return this._oDlg;
};

sap.ca.ui.dialog.Dialog.prototype.close = function(oResult) {
	if (this._oDlg) {
		if (this._oDlg.isOpen()) {
			this._oDlg.close();
		}
		//get callback function from Model
		var oModel = this._oDlg.getModel();
		if (oModel && oModel.getData()) { 
			if (oModel.getData().fnClose && typeof oModel.getData().fnClose === "function") {
				oModel.getData().fnClose(oResult);
			}
		}
	}
};
}; // end of sap/ca/ui/dialog/Dialog.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.dialog.factory') ) {
jQuery.sap.declare("sap.ca.ui.dialog.factory");


sap.ca.ui.dialog.factory = (function() {
	var _oDlgCollection = {};
	
	var _openDialog = function(oDlgInfo, oSettings, fnClose) {
		var oDlg = _oDlgCollection[oDlgInfo.dlgId];
		
		if (jQuery.isEmptyObject(oDlg)){
			oDlg = new sap.ca.ui.dialog.Dialog(oDlgInfo.dlgId, oDlgInfo);
			var oTempCol = {};
			oTempCol[oDlgInfo.dlgId] = oDlg;
			jQuery.extend(_oDlgCollection, oTempCol);
		}
		oDlg.initAndOpen(oSettings, fnClose);
	};
	
	return {
		showAbout : function(oSettings, fnClose) {
//implementation is removed to Unified Shell
//			_openDialog({
//				dlgId: "DLG_ABOUT",
//				xmlViewId: "CA_VIEW_ABOUT",
//				xmlViewName: "sap.ca.ui.dialog.About",
//				bStretchOnlyOnPhone: true
//			}, jQuery.extend(oSettings, {useragent: navigator.userAgent}), fnClose);
		},
		
		confirm : function(oSettings, fnClose) {
			_openDialog({
				dlgId: "DLG_CONFIRM",
				xmlViewId: "CA_VIEW_CONFIRM",
				xmlViewName: "sap.ca.ui.dialog.Confirm",
				bWithPadding: true
			}, oSettings, fnClose);
		},
		
		forward : function(fnStartSearch, fnClose) {
			_openDialog({
				dlgId: "DLG_FORWARD",
				xmlViewId: "CA_VIEW_FORWARD",
				xmlViewName: "sap.ca.ui.dialog.Forward",
				bStretchOnlyOnPhone: true
			}, {startExternalSearch: fnStartSearch}, fnClose);
		},
		
		selectItem : function(oSettings, fnClose) {
			_openDialog({
				dlgId: "DLG_SLTITEM",
				xmlViewId: "CA_VIEW_SLTITEM",
				xmlViewName: "sap.ca.ui.dialog.SelectItem",
				bStretchOnlyOnPhone: true
			}, oSettings, fnClose);
		},
		
		showLoginDetails : function(oSettings, fnClose) {
//implementation is removed to Unified Shell
//			_openDialog({
//				dlgId: "DLG_LOGIN",
//				xmlViewId: "CA_VIEW_LOGIN",
//				xmlViewName: "sap.ca.ui.dialog.LoginDetails",
//				bStretchOnlyOnPhone: true
//			}, oSettings, fnClose);
		},
		
		showMessageBox : function(oSettings, fnClose) {
			_openDialog({
				dlgId: "DLG_MSGBOX",
				xmlViewId: "CA_VIEW_MSG",
				xmlViewName: "sap.ca.ui.message.MessageBox",
				bWithPadding: true
			}, oSettings, fnClose);
		},
		
		setDataProperty : function(sDlgId, sPath, oValue) {
			var oDlg = _oDlgCollection[sDlgId];
			if (oDlg) oDlg.setDataProperty(sPath, oValue);
		},
		
		closeDialog : function(sDlgId, oResult) {
			var oDlg = _oDlgCollection[sDlgId];
			if (oDlg) oDlg.close(oResult);
		}
	};
}());

sap.ca.ui.dialog.loginDetails = (function() {
	return {
		open : function(oSettings, fnClose) {
			sap.ca.ui.dialog.factory.showLoginDetails(oSettings, fnClose);
		}
	};
}());

sap.ca.ui.dialog.about = (function() {
	return {
		open : function(oSettings, fnClose) {
			sap.ca.ui.dialog.factory.showAbout(oSettings, fnClose);
		}
	};
}());

sap.ca.ui.dialog.confirmation = (function() {
	return {
		open : function(oSettings, fnClose) {
			sap.ca.ui.dialog.factory.confirm(oSettings, fnClose);
		}
	};
}());

sap.ca.ui.dialog.forwarding = (function() {
	return {
		start : function(fnStartSearch, fnClose) {
			sap.ca.ui.dialog.factory.forward(fnStartSearch, fnClose);
		},
		
		setFoundAgents : function(arrAgents) {
			sap.ca.ui.dialog.factory.setDataProperty("DLG_FORWARD", "/agents", arrAgents);
		}
	};
}());

sap.ca.ui.dialog.selectItem = (function() {
	return {
		open : function(oSettings, fnClose) {
			sap.ca.ui.dialog.factory.selectItem(oSettings, fnClose);
		}
	};
}());
}; // end of sap/ca/ui/dialog/factory.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.images.images') ) {
jQuery.sap.declare("sap.ca.ui.images.images");

sap.ca.ui.images.images = (function(){
		
	var sPrefix = jQuery.sap.getModulePath("sap.ca.ui")+ "/images/";
	
	return {
		Flower : sPrefix + "Flower.png",
		placeholder : sPrefix + "placeholder.png",
		person_placeholder : sPrefix + "person_placeholder.png"
	};	
}());
}; // end of sap/ca/ui/images/images.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.library') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* -----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying
 * source files only (*.type, *.js) or they will be lost after the next generation.
 * ----------------------------------------------------------------------------------- */

/**
 * Initialization Code and shared classes of library sap.ca.ui (1.16.4)
 */
jQuery.sap.declare("sap.ca.ui.library");
jQuery.sap.require('sap.ui.core.Core'); // unlisted dependency retained

/**
 * SAP UI library: Fiori Commons
 *
 * @namespace
 * @name sap.ca.ui
 * @public
 */


// library dependencies
jQuery.sap.require('sap.ui.core.library'); // unlisted dependency retained

jQuery.sap.require('sap.viz.library'); // unlisted dependency retained

jQuery.sap.require('sap.m.library'); // unlisted dependency retained


// delegate further initialization of this library to the Core
sap.ui.getCore().initLibrary({
  name : "sap.ca.ui",
  dependencies : ["sap.ui.core","sap.viz","sap.m"],
  types: [
    "sap.ca.ui.charts.ChartColor",
    "sap.ca.ui.charts.ChartSelectionMode",
    "sap.ca.ui.charts.ChartSemanticColor"
  ],
  interfaces: [],
  controls: [
    "sap.ca.ui.AddPicture",
    "sap.ca.ui.CustomerContext",
    "sap.ca.ui.DatePicker",
    "sap.ca.ui.ExpansibleFeedListItem",
    "sap.ca.ui.FileUpload",
    "sap.ca.ui.GrowingTileContainer",
    "sap.ca.ui.HierarchicalSelectDialog",
    "sap.ca.ui.Hierarchy",
    "sap.ca.ui.HierarchyItem",
    "sap.ca.ui.InPlaceEdit",
    "sap.ca.ui.Notes",
    "sap.ca.ui.OverflowContainer",
    "sap.ca.ui.OverviewTile",
    "sap.ca.ui.PictureItem",
    "sap.ca.ui.PictureTile",
    "sap.ca.ui.PictureTileContainer",
    "sap.ca.ui.PictureViewer",
    "sap.ca.ui.PictureViewerItem",
    "sap.ca.ui.TabContainerOverflow",
    "sap.ca.ui.ZoomableScrollContainer",
    "sap.ca.ui.charts.BarListItem",
    "sap.ca.ui.charts.BubbleChart",
    "sap.ca.ui.charts.Chart",
    "sap.ca.ui.charts.ChartToolBar",
    "sap.ca.ui.charts.ClusterListItem",
    "sap.ca.ui.charts.CombinedChart",
    "sap.ca.ui.charts.HorizontalBarChart",
    "sap.ca.ui.charts.LineChart",
    "sap.ca.ui.charts.StackedHorizontalBarChart",
    "sap.ca.ui.charts.StackedVerticalColumnChart",
    "sap.ca.ui.charts.VerticalBarChart"
  ],
  elements: [
    "sap.ca.ui.HierarchicalSelectDialogItem"
  ],
  version: "1.16.4"});

/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.type, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides enumeration sap.ca.ui.charts.ChartColor.
jQuery.sap.declare("sap.ca.ui.charts.ChartColor");


/**
 * @class Enumeration of available color to be used in sap.ca.ui charts.
 *
 * @version 1.16.4
 * @static
 * @public
 */
sap.ca.ui.charts.ChartColor = {
  
    /**
     * Sap Ui Chart 1 
     * @public
     */
    sapUiChart1 : "sapUiChart1",

    /**
     * Sap Ui Chart 2 
     * @public
     */
    sapUiChart2 : "sapUiChart2",

    /**
     * Sap Ui Chart 3 
     * @public
     */
    sapUiChart3 : "sapUiChart3",

    /**
     * Sap Ui Chart 4 
     * @public
     */
    sapUiChart4 : "sapUiChart4",

    /**
     * Sap Ui Chart 5 
     * @public
     */
    sapUiChart5 : "sapUiChart5",

    /**
     * Sap Ui Chart 6 
     * @public
     */
    sapUiChart6 : "sapUiChart6",

    /**
     * Sap Ui Chart 7 
     * @public
     */
    sapUiChart7 : "sapUiChart7",

    /**
     * Sap Ui Chart 8 
     * @public
     */
    sapUiChart8 : "sapUiChart8",

    /**
     * Sap Ui Chart 9 
     * @public
     */
    sapUiChart9 : "sapUiChart9",

    /**
     * Sap Ui Chart 10 
     * @public
     */
    sapUiChart10 : "sapUiChart10",

    /**
     * Sap Ui Chart 11 
     * @public
     */
    sapUiChart11 : "sapUiChart11",

    /**
     * Sap Ui Chart Bad 
     * @public
     */
    sapUiChartBad : "sapUiChartBad",

    /**
     * Sap Ui Chart Critical 
     * @public
     */
    sapUiChartCritical : "sapUiChartCritical",

    /**
     * Sap Ui Chart Good 
     * @public
     */
    sapUiChartGood : "sapUiChartGood",

    /**
     * Sap Ui Chart Neutral 
     * @public
     */
    sapUiChartNeutral : "sapUiChartNeutral"

  };
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.type, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides enumeration sap.ca.ui.charts.ChartSelectionMode.
jQuery.sap.declare("sap.ca.ui.charts.ChartSelectionMode");


/**
 * @class Determines the selection mode of a Chart.
 *
 * @version 1.16.4
 * @static
 * @public
 */
sap.ca.ui.charts.ChartSelectionMode = {
  
    /**
     * The chart will not allow any selection 
     * @public
     */
    None : "None",

    /**
     * The chart will only allow single selection 
     * @public
     */
    Single : "Single",

    /**
     * The chart will allow multi selection. 
     * @public
     */
    Multiple : "Multiple"

  };
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.type, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides enumeration sap.ca.ui.charts.ChartSemanticColor.
jQuery.sap.declare("sap.ca.ui.charts.ChartSemanticColor");


/**
 * @class Enumeration of available semantic color to be used in sap.Ca.ui
 *
 * @version 1.16.4
 * @static
 * @public
 */
sap.ca.ui.charts.ChartSemanticColor = {
  
    /**
     * Darker Neutral color 
     * @public
     */
    NeutralDark : "NeutralDark",

    /**
     * Neutral colro 
     * @public
     */
    Neutral : "Neutral",

    /**
     * Lighter Neutral color 
     * @public
     */
    NeutralLight : "NeutralLight",

    /**
     * Darker Good color 
     * @public
     */
    GoodDark : "GoodDark",

    /**
     * Good colro 
     * @public
     */
    Good : "Good",

    /**
     * Lighter Good color 
     * @public
     */
    GoodLight : "GoodLight",

    /**
     * Darker Critical color 
     * @public
     */
    CriticalDark : "CriticalDark",

    /**
     * Critical colro 
     * @public
     */
    Critical : "Critical",

    /**
     * Lighter Critical color 
     * @public
     */
    CriticalLight : "CriticalLight",

    /**
     * Darker Bad color 
     * @public
     */
    BadDark : "BadDark",

    /**
     * Bad colro 
     * @public
     */
    Bad : "Bad",

    /**
     * Lighter Bad color 
     * @public
     */
    BadLight : "BadLight"

  };

}; // end of sap/ca/ui/library.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.FormatHelper') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.FormatHelper
jQuery.sap.declare("sap.ca.ui.model.format.FormatHelper");

jQuery.sap.require('sap.ui.core.format.NumberFormat'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.LocaleData'); // unlisted dependency retained



sap.ui.base.Object.extend("sap.ca.ui.model.format.FormatHelper", {});


sap.ca.ui.model.format.FormatHelper.stringToNumeric = function(str) {
    // Regexp for detecting hexadecimal prefix => requires parseInt instead of parseFloat
    var hexaDetect = /^\s*[\+-]?0[xX]/;
    if (hexaDetect.test(str)) {
        return parseInt(str, 16);
    }
    else {
        return parseFloat(str);
    }
}

sap.ca.ui.model.format.FormatHelper.toNumeric = function(obj) {
    if ((obj === null) || (obj === undefined)) {
        return NaN;
    }
    var t = typeof obj;
    var result;
    switch (t) {
        case "number":
            result = obj;
            break;
        case "string":
            result = sap.ca.ui.model.format.FormatHelper.stringToNumeric(obj);
            break;
        case "object":
            var v = obj.valueOf();
            if (typeof v === "number") {
                // Value object (e.g. Number)
                result = v;
            }
            else if (Array.isArray(obj)) {
                result = NaN
            }
            else {
                result = sap.ca.ui.model.format.FormatHelper.stringToNumeric(obj.toString());
            }
            break;
        default:
            result = NaN;
            break;
    }
    return result;
};

sap.ca.ui.model.format.FormatHelper.isNumeric = function(obj) {
    return isFinite(sap.ca.ui.model.format.FormatHelper.toNumeric(obj));
};

sap.ca.ui.model.format.FormatHelper.getFormatOptions = function(options, locale) {
    var formatOptions = {};
    formatOptions.locale = locale;
    var t = typeof options;
    switch (t) {
        case "number":
            formatOptions.decimals = options;
            break;
        case "object":
            if (typeof options.locale === "string") {
                formatOptions.locale = new sap.ui.core.Locale(options.locale);
            }
            else if (options.locale) {
                formatOptions.locale = options.locale;
            }
            formatOptions.decimals = options.decimals;
            formatOptions.rounding = options.rounding;
            formatOptions.formatStyle = options.formatStyle;
            formatOptions.shortDecimals = options.shortDecimals;
            formatOptions.shortRounding = options.shortRounding;
            break;
    }
    if (!formatOptions.locale) {
        if (sap.ui.getCore().getConfiguration().getLanguage() == "ZH") {
            formatOptions.locale = new sap.ui.core.Locale("zh_CN");
        }
        else {
            formatOptions.locale = sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();
        }
    }
    return formatOptions;
};

sap.ca.ui.model.format.FormatHelper.hasRounding = function (options) {
    var rounding;
    if (options !== undefined) {
        if (typeof options === "number") {
            rounding = true;
        }
        else {
            if (options.formatStyle === "short") {
                rounding = (options.shortDecimals !== undefined) || (options.shortRounding !== undefined);
            }
            else {
                rounding = (options.decimals !== undefined) || (options.rounding !== undefined);
            }
        }
    }
    else {
        rounding = false;
    }
    return rounding;
};

sap.ca.ui.model.format.FormatHelper.roundNumber = function(number, options) {
    options = options || {};
    var roundedNumber;
    var fRounding, oDecimals;
    if (options.formatStyle === "short") {
        fRounding = options.shortRounding;
        oDecimals = options.shortDecimals;
    }
    else {
        fRounding = options.rounding;
        oDecimals = options.decimals;
    }
    if (fRounding) {
        roundedNumber = fRounding(number);
    }
    // WARNING: oDecimals can be 0 => we cannot simply test (oDecimals)
    else if (oDecimals !== undefined) {
        var decimals;
        if (typeof oDecimals === "function") {
            decimals = oDecimals(number);
        }
        else {
            decimals = oDecimals;
        }
        roundedNumber = number.toFixed(decimals);
    }
    else {
        roundedNumber = number;
    }
    return roundedNumber;
};


// TODO: handle NaN and Infinity through "symbols-latn-infinity" and "symbols-latn-nan" properties
sap.ca.ui.model.format.FormatHelper.formatNumber = function(number, options) {
    var numValue  = sap.ca.ui.model.format.FormatHelper.toNumeric(number);
    if (!isFinite(numValue)) {
        return "";
    }

    var formatOptions = sap.ca.ui.model.format.FormatHelper.getFormatOptions(options);
    var numberFormatter = sap.ui.core.format.NumberFormat.getFloatInstance({}, formatOptions.locale);

    if (sap.ca.ui.model.format.FormatHelper.hasRounding(options)) {
        numValue = sap.ca.ui.model.format.FormatHelper.roundNumber(numValue, formatOptions);
        return numberFormatter.format(numValue);
    }
    else {
        // If no rounding is specified, pass the initial parameter to UI5 as it could be pre-formatted
        return numberFormatter.format(number);
    }
};


sap.ca.ui.model.format.FormatHelper.getMagnitude = function(number) {
    // Currently, only supported multiples are { k, M, G, T }
    var _magnitudes = [
        { value: 1e3, suffix: "Kilo" }
        , { value: 1e6, suffix: "Mega" }
        , { value: 1e9, suffix: "Giga" }
        , { value: 1e12, suffix: "Tera" }
        , { value: 1e15, suffix: "Peta" }
        , { value: 1e18, suffix: "Exa" }
        , { value: 1e21, suffix: "Zetta" }
        , { value: 1e24, suffix: "Yotta" }
    ];
    var num = (number >= 0 ? number : -number);
    for (var idx = _magnitudes.length - 1; idx >= 0; --idx) {
        var mag = _magnitudes[idx];
        if (num >= mag.value) {
            return mag;
        }
    }
    return { value: 1, suffix: "" };
};
}; // end of sap/ca/ui/model/format/FormatHelper.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.BinaryUtil') ) {
jQuery.sap.declare("sap.ca.ui.utils.BinaryUtil");

sap.ui.base.Object.extend("sap.ca.ui.utils.BinaryUtil", {
	
	constructor: function(strData, iDataOffset, iDataLength) {
		
		var data = strData;
		var dataOffset = iDataOffset || 0;
		var dataLength = 0;

		this.getRawData = function() {
			return data;
		}

		if (typeof strData == "string") {
			dataLength = iDataLength || data.length;

			this.getByteAt = function(iOffset) {
				return data.charCodeAt(iOffset + dataOffset) & 0xFF;
			}
			
			this.getBytesAt = function(iOffset, iLength) {
				var aBytes = [];
				
				for (var i = 0; i < iLength; i++) {
					aBytes[i] = data.charCodeAt((iOffset + i) + dataOffset) & 0xFF
				};
				
				return aBytes;
			}
		} 		

		this.getLength = function() {
			return dataLength;
		}

		this.getSByteAt = function(iOffset) {
			var iByte = this.getByteAt(iOffset);
			if (iByte > 127)
				return iByte - 256;
			else
				return iByte;
		}

		this.getShortAt = function(iOffset, bBigEndian) {
			var iShort = bBigEndian ? 
				(this.getByteAt(iOffset) << 8) + this.getByteAt(iOffset + 1)
				: (this.getByteAt(iOffset + 1) << 8) + this.getByteAt(iOffset)
			if (iShort < 0) iShort += 65536;
			return iShort;
		}
		this.getSShortAt = function(iOffset, bBigEndian) {
			var iUShort = this.getShortAt(iOffset, bBigEndian);
			if (iUShort > 32767)
				return iUShort - 65536;
			else
				return iUShort;
		}
		this.getLongAt = function(iOffset, bBigEndian) {
			var iByte1 = this.getByteAt(iOffset),
				iByte2 = this.getByteAt(iOffset + 1),
				iByte3 = this.getByteAt(iOffset + 2),
				iByte4 = this.getByteAt(iOffset + 3);

			var iLong = bBigEndian 
							? (((((iByte1 << 8) + iByte2) << 8) + iByte3) << 8) + iByte4
							: (((((iByte4 << 8) + iByte3) << 8) + iByte2) << 8) + iByte1;
			if (iLong < 0) 
				iLong += 4294967296;
			return iLong;
		}
		
		this.getSLongAt = function(iOffset, bBigEndian) {
			var iULong = this.getLongAt(iOffset, bBigEndian);
			if (iULong > 2147483647)
				return iULong - 4294967296;
			else
				return iULong;
		}

		this.getStringAt = function(iOffset, iLength) {
			var aStr = [];
			
			var aBytes = this.getBytesAt(iOffset, iLength);
			for (var j=0; j < iLength; j++) {
				aStr[j] = String.fromCharCode(aBytes[j]);
			}
			return aStr.join("");
		}
		
		this.getCharAt = function(iOffset) {
			return String.fromCharCode(this.getByteAt(iOffset));
		}
		
		this.toBase64 = function() {
			return window.btoa(data);
		}
		
		this.fromBase64 = function(strBase64) {
			data = window.atob(strBase64);
		}
	}
});

}; // end of sap/ca/ui/utils/BinaryUtil.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.Lessifier') ) {
jQuery.sap.declare("sap.ca.ui.utils.Lessifier");

sap.ca.ui.utils.Lessifier = {};
/**
 * Load a CSS File containing colors that have been coded with less variable and replace them dynamically
 * This is an experimental solution; a hack if you will that will be replaced by something much nicer in wave 3.
 *
 * @experimental
 * @param sModuleName {string} the module in which to load this file
 * @param sCssPath {string} the path to the CSS file
 */
sap.ca.ui.utils.Lessifier.lessifyCSS = function(sModuleName, sCssPath) {
    // Incorrect number of parameters...
    if(sModuleName == null || sModuleName.length == 0 || sCssPath == null || sCssPath.length == 0) {
        jQuery.sap.log.error("When trying to lessify a css make sure both the module name and the css file path are specified.");
        return;
    }
    // Unknown module, which means something is wrong
    var sModulePath = jQuery.sap.getModulePath(sModuleName);
    if(sModulePath == null) {
        jQuery.sap.log.error("The module "+sModuleName+" has never been registered for a specific path.");
        return;
    }
    // CSS already in DOM no need for duplicate effort
    if(jQuery("#"+sModuleName+"-less-css").length != 0) {
        jQuery.sap.log.warning("The css for module "+sModuleName+" has already been processed.");
        return;
    }
    var sCssUrl = sModulePath + sCssPath;
    if(!jQuery.sap.startsWith(sCssPath, "/") && !jQuery.sap.endsWith(sModulePath, "/")) {
        sCssUrl = sModulePath + "/" + sCssPath;
    }
    var stylesheetText = jQuery.ajax({
            url:  sCssUrl,
            async: false}
    ).responseText;

    if(stylesheetText != null && stylesheetText.length != 0) {
        var lessStylesheet = stylesheetText.replace(/@([\w]+)/g, function (match, compare) {
            return sap.ui.core.theming.Parameters.get(compare);
        });
        jQuery("head").append("<style id='"+sModuleName+"-less-css'>" + lessStylesheet + "</style>");
        jQuery.sap.log.info("The css for module "+sModuleName+" has been processed correctly.");
    }
};

}; // end of sap/ca/ui/utils/Lessifier.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.TablePersonalizer') ) {
jQuery.sap.declare("sap.ca.ui.utils.TablePersonalizer");

jQuery.sap.require('sap.ushell.services.Personalization'); // unlisted dependency retained

jQuery.sap.require('sap.m.TablePersoController'); // unlisted dependency retained



sap.ca.ui.utils.TablePersonalizer = function(oMobileTable, oStartPersButton, oPersId){


    try {
        var oPersonalizer = sap.ushell.Container.getService("Personalization").getPersonalizer(oPersId);

        var oTablePersoController = new sap.m.TablePersoController({
            table : oMobileTable,
            persoService : oPersonalizer
        });
        oTablePersoController.activate();


        oStartPersButton.attachPress(function() {
            oTablePersoController.openDialog();
        });

    }
    catch(oError){
        jQuery.sap.log.error("TablePersonalizer : cannot load personalization service from ushell " + oError.message);
    }



};

}; // end of sap/ca/ui/utils/TablePersonalizer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.busydialog') ) {
jQuery.sap.declare("sap.ca.ui.utils.busydialog");



sap.ca.ui.utils.BUSYDIALOG_TIMEOUT = 1500;

sap.ca.ui.utils.busydialog = (function() {
	var BUSIDIALOG_ID = "CA_BusyDialog";
	var _oBusyDialog = null;
	var _bIsOpen = false;
	var _iRequiredCount = 0;
	var _sTimerId = null;

	var _fnOpenBusyDialog = function(oSettings){
		if (!_oBusyDialog) {
			_oBusyDialog = new sap.m.BusyDialog(BUSIDIALOG_ID, { customIcon : sap.ca.ui.images.images.Flower });
		}
		if (oSettings && oSettings.text && typeof oSettings.text === "string") {
			_oBusyDialog.setText(oSettings.text);
		}
		if (!_bIsOpen){
			_oBusyDialog.open();
			_bIsOpen = true;
		}
	};

	var _removePreviousdCall = function(){
		if(_sTimerId){
			jQuery.sap.clearDelayedCall(_sTimerId)
			_sTimerId = null;
		}
	};

	var _fnUpdateDisplay = function(oSettings){
		if(_iRequiredCount > 0){
			_removePreviousdCall();
			_sTimerId = jQuery.sap.delayedCall(sap.ca.ui.utils.BUSYDIALOG_TIMEOUT, undefined, _fnOpenBusyDialog, [oSettings]);
		} else {
			_removePreviousdCall();
			if (_oBusyDialog) {
				_oBusyDialog.close();
				_bIsOpen = false;
				_oBusyDialog.setText("");
			}
		}
	}

	return {
		requireBusyDialog : function(oSettings){
			_iRequiredCount++;
			_fnUpdateDisplay(oSettings);
		},

		releaseBusyDialog : function(){
			_iRequiredCount--;
			if (_iRequiredCount < 0){
				jQuery.sap.log.error("busy dialog released more often than required");
				_iRequiredCount = 0;
			}
			_fnUpdateDisplay();
		},

		destroyBusyDialog : function(){
			if (_oBusyDialog) {
				_oBusyDialog.destroy();
				_oBusyDialog = null;
			}
		}
	}

}());

}; // end of sap/ca/ui/utils/busydialog.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.exif') ) {
jQuery.sap.declare("sap.ca.ui.utils.exif");

sap.ui.base.Object.extend("sap.ca.ui.utils.exif", {});

(function() {

	
	var bDebug = false;
	
	sap.ca.ui.utils.exif.TiffTags = {
		0x0100 : "ImageWidth",
		0x0101 : "ImageHeight",
		0x8769 : "ExifIFDPointer",
		0x8825 : "GPSInfoIFDPointer",
		0xA005 : "InteroperabilityIFDPointer",
		0x0102 : "BitsPerSample",
		0x0103 : "Compression",
		0x0106 : "PhotometricInterpretation",
		0x0112 : "Orientation",
		0x0115 : "SamplesPerPixel",
		0x011C : "PlanarConfiguration",
		0x0212 : "YCbCrSubSampling",
		0x0213 : "YCbCrPositioning",
		0x011A : "XResolution",
		0x011B : "YResolution",
		0x0128 : "ResolutionUnit",
		0x0111 : "StripOffsets",
		0x0116 : "RowsPerStrip",
		0x0117 : "StripByteCounts",
		0x0201 : "JPEGInterchangeFormat",
		0x0202 : "JPEGInterchangeFormatLength",
		0x012D : "TransferFunction",
		0x013E : "WhitePoint",
		0x013F : "PrimaryChromaticities",
		0x0211 : "YCbCrCoefficients",
		0x0214 : "ReferenceBlackWhite",
		0x0132 : "DateTime",
		0x010E : "ImageDescription",
		0x010F : "Make",
		0x0110 : "Model",
		0x0131 : "Software",
		0x013B : "Artist",
		0x8298 : "Copyright"
	};
	
	
	
	function findEXIFinJPEG(oFile) {
		var aMarkers = [];
	
		if (oFile.getByteAt(0) != 0xFF || oFile.getByteAt(1) != 0xD8) {
			return false; // not a valid jpeg
		}
	
		var iOffset = 2;
		var iLength = oFile.getLength();
		while (iOffset < iLength) {
			if (oFile.getByteAt(iOffset) != 0xFF) {
				if (bDebug) 
					jQuery.sap.log.error("Not a valid marker at offset " + iOffset + ", found: " + oFile.getByteAt(iOffset));
				return false; // not a valid marker, something is wrong
			}
	
			var iMarker = oFile.getByteAt(iOffset+1);
	
			// we could implement handling for other markers here, 
			// but we're only looking for 0xFFE1 for EXIF data
	
			if (iMarker == 22400) {
				if (bDebug) 
					jQuery.sap.log.error("Found 0xFFE1 marker");
				return readEXIFData(oFile, iOffset + 4, oFile.getShortAt(iOffset+2, true)-2);
				
			} 
			else if (iMarker == 225) {
				// 0xE1 = Application-specific 1 (for EXIF)
				if (bDebug) 
					jQuery.sap.log.error("Found 0xFFE1 marker");
				return readEXIFData(oFile, iOffset + 4, oFile.getShortAt(iOffset+2, true)-2);
	
			} else {
				iOffset += 2 + oFile.getShortAt(iOffset+2, true);
			}
	
		}
	
	}
	
	
	function readTags(oFile, iTIFFStart, iDirStart, oStrings, bBigEnd) 
	{
		var iEntries = oFile.getShortAt(iDirStart, bBigEnd);
		var oTags = {};
		for (var i=0;i<iEntries;i++) {
			var iEntryOffset = iDirStart + i*12 + 2;
			var strTag = oStrings[oFile.getShortAt(iEntryOffset, bBigEnd)];
			if (!strTag && bDebug) 
				jQuery.sap.log.error("Unknown tag: " + oFile.getShortAt(iEntryOffset, bBigEnd));
			oTags[strTag] = readTagValue(oFile, iEntryOffset, iTIFFStart, iDirStart, bBigEnd);
		}
		return oTags;
	}
	
	
	function readTagValue(oFile, iEntryOffset, iTIFFStart, iDirStart, bBigEnd)
	{
		var iType = oFile.getShortAt(iEntryOffset+2, bBigEnd);
		var iNumValues = oFile.getLongAt(iEntryOffset+4, bBigEnd);
		var iValueOffset = oFile.getLongAt(iEntryOffset+8, bBigEnd) + iTIFFStart;
	
		switch (iType) {
			case 1: // byte, 8-bit unsigned int
			case 7: // undefined, 8-bit byte, value depending on field
				if (iNumValues == 1) {
					return oFile.getByteAt(iEntryOffset + 8, bBigEnd);
				} else {
					var iValOffset = iNumValues > 4 ? iValueOffset : (iEntryOffset + 8);
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getByteAt(iValOffset + n);
					}
					return aVals;
				}
				break;
	
			case 2: // ascii, 8-bit byte
				var iStringOffset = iNumValues > 4 ? iValueOffset : (iEntryOffset + 8);
				return oFile.getStringAt(iStringOffset, iNumValues-1);
				break;
	
			case 3: // short, 16 bit int
				if (iNumValues == 1) {
					return oFile.getShortAt(iEntryOffset + 8, bBigEnd);
				} else {
					var iValOffset = iNumValues > 2 ? iValueOffset : (iEntryOffset + 8);
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getShortAt(iValOffset + 2*n, bBigEnd);
					}
					return aVals;
				}
				break;
	
			case 4: // long, 32 bit int
				if (iNumValues == 1) {
					return oFile.getLongAt(iEntryOffset + 8, bBigEnd);
				} else {
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getLongAt(iValueOffset + 4*n, bBigEnd);
					}
					return aVals;
				}
				break;
			case 5:	// rational = two long values, first is numerator, second is denominator
				if (iNumValues == 1) {
					return oFile.getLongAt(iValueOffset, bBigEnd) / oFile.getLongAt(iValueOffset+4, bBigEnd);
				} else {
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getLongAt(iValueOffset + 8*n, bBigEnd) / oFile.getLongAt(iValueOffset+4 + 8*n, bBigEnd);
					}
					return aVals;
				}
				break;
			case 9: // slong, 32 bit signed int
				if (iNumValues == 1) {
					return oFile.getSLongAt(iEntryOffset + 8, bBigEnd);
				} else {
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getSLongAt(iValueOffset + 4*n, bBigEnd);
					}
					return aVals;
				}
				break;
			case 10: // signed rational, two slongs, first is numerator, second is denominator
				if (iNumValues == 1) {
					return oFile.getSLongAt(iValueOffset, bBigEnd) / oFile.getSLongAt(iValueOffset+4, bBigEnd);
				} else {
					var aVals = [];
					for (var n=0;n<iNumValues;n++) {
						aVals[n] = oFile.getSLongAt(iValueOffset + 8*n, bBigEnd) / oFile.getSLongAt(iValueOffset+4 + 8*n, bBigEnd);
					}
					return aVals;
				}
				break;
		}
	}
	
	/**
	 * Reads file and returns EXIF metadata
	 */
	function readEXIFData(oFile, iStart, iLength) 
	{
		if (oFile.getStringAt(iStart, 4) != "Exif") {
			if (bDebug) 
				jQuery.sap.log.error("Not valid EXIF data! " + oFile.getStringAt(iStart, 4));
			return false;
		}
	
		var bBigEnd;
	
		var iTIFFOffset = iStart + 6;
	
		// test for TIFF validity and endianness
		if (oFile.getShortAt(iTIFFOffset) == 0x4949) {
			bBigEnd = false;
		} 
		else if (oFile.getShortAt(iTIFFOffset) == 0x4D4D) {
			bBigEnd = true;
		} 
		else {
			if (bDebug) 
				jQuery.sap.log.error("Not valid TIFF data! (no 0x4949 or 0x4D4D)");
			return false;
		}
	
		if (oFile.getShortAt(iTIFFOffset+2, bBigEnd) != 0x002A) {
			if (bDebug) 
				jQuery.sap.log.error("Not valid TIFF data! (no 0x002A)");
			return false;
		}
	
		if (oFile.getLongAt(iTIFFOffset+4, bBigEnd) != 0x00000008) {
			if (bDebug) 
				jQuery.sap.log.error("Not valid TIFF data! (First offset not 8)", oFile.getShortAt(iTIFFOffset+4, bBigEnd));
			return false;
		}
	
		var oTags = readTags(oFile, iTIFFOffset, iTIFFOffset+8, sap.ca.ui.utils.exif.TiffTags, bBigEnd);
		
		return oTags;
	}
	
	
	/**
	 * Takes a binary file and retrieve EXIF metadata from it
	 */
	sap.ca.ui.utils.exif.readFromBinary = function(oFile) {
		return findEXIFinJPEG(oFile);
	}



})();


}; // end of sap/ca/ui/utils/exif.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.resourcebundle') ) {
jQuery.sap.declare("sap.ca.ui.utils.resourcebundle");
jQuery.sap.require('sap.ui.model.resource.ResourceModel'); // unlisted dependency retained


//dialog interface for the applications
sap.ca.ui.utils.resourcebundle = (function() {
 
	var oI18nModel = new sap.ui.model.resource.ResourceModel({
		bundleUrl: jQuery.sap.getModulePath("sap.ca.ui.i18n.i18n", ".properties"),
	});

	sap.ui.getCore().setModel(oI18nModel, "sap.ca.ui.i18n");

	return oI18nModel.getResourceBundle();
}());
}; // end of sap/ca/ui/utils/resourcebundle.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.AddPictureRenderer') ) {
jQuery.sap.declare("sap.ca.ui.AddPictureRenderer");

//temporary workaround needed for the jQuery plugins to work
//proper fix to be implemented
define = undefined;




/**
 * @class AddPicture renderer.
 * @static
 */
sap.ca.ui.AddPictureRenderer = {
};

/**
 * Renders the HTML for the given control, using the provided {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager} oRm the RenderManager that can be used for writing to the render output buffer
 * @param {sap.ui.core.Control} oControl an object representation of the control that should be rendered
 */
sap.ca.ui.AddPictureRenderer.render = function(oRm, oControl){
	 // write the HTML into the render manager

    // check the rendering mode option
    var bEditable = oControl.getEditable();
    var oButtonPageType = oControl.getButtonPageType();
    var aPictures = oControl.getPictures();
    var iPicturesLength = aPictures.length;
    var maxNumber = oControl.getMaxPictureNumber();

	oRm.write("<div");
	oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiAddPicture");
    oRm.addClass("sapUiHLayout");
    oRm.addClass("sapUiHLayoutNoWrap");
    oRm.writeClasses();

    var width = oControl.getWidth();
    var alignment = oControl.getPictureAlign();
    var itemStyle = (alignment==sap.ui.core.TextAlign.Right) ? "sapCaUiPictureItemAlignRight" : "sapCaUiPictureItemAlignLeft";

    if (width) {
        oRm.addStyle("width", width);
        oRm.addStyle("text-align", alignment);
    }
    oRm.writeStyles();

	oRm.write(">");

    if (bEditable){
        oRm.write("<div");
        oRm.addClass("sapCaAPAddButton");
        oRm.writeClasses();
        oRm.write(">");
        oRm.renderControl(oControl._getButton());

        if (iPicturesLength < maxNumber) {
            oRm.write("<input type='file' accept='image/*' class='sapCaAPInputFile' ");
            if (jQuery.device.is.desktop){
            	oRm.writeAttribute("tabindex", "-1");
            }
            oRm.writeAttributeEscaped("id", oControl.getId() + "-capture");
            oRm.write(" />");
        }

        if (iPicturesLength >0 && oButtonPageType == sap.ca.ui.AddPicture.BUTTON_PAGE_TYPE.TAB){
            oRm.write("<hr");
            oRm.addClass("sapCaUiHorizontalRuler");
            oRm.writeClasses();
            oRm.write("></hr>");
        }
        oRm.write("</div>")
    }

    oRm.write("<div ");
    oRm.writeAttributeEscaped("id", oControl.getId() + "-imageContainer");
    oRm.addClass("sapCaUiAddPictureHLayout");
    oRm.writeClasses();
    oRm.write(">");

    if (aPictures){
        for (var i=0;i<iPicturesLength;i++) {
            aPictures[i]._addPictureId = oControl.getId();
            aPictures[i].addStyleClass(itemStyle);
            if(!oControl.hasListeners("show")){
                aPictures[i].addStyleClass("sapCaUiPictureItemNoPress");
            }
            var size = isNaN(parseInt(oControl.getItemSize())) ? 60 : parseInt(oControl.getItemSize());
            aPictures[i]._width = size +"px";
            aPictures[i]._height = size + "px";
            oRm.renderControl(aPictures[i]);

            
        }
    }
    oRm.write("</div>");

    oRm.write("</div>");
};

}; // end of sap/ca/ui/AddPictureRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.CustomerContext') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.CustomerContext.
jQuery.sap.declare("sap.ca.ui.CustomerContext");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new CustomerContext.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getPersonalizationPageName personalizationPageName} : string (default: 'AppCustomerContext')</li>
 * <li>{@link #getShowSalesArea showSalesArea} : boolean (default: false)</li>
 * <li>{@link #getPath path} : string (default: '/Customers')</li>
 * <li>{@link #getCustomerIDProperty customerIDProperty} : string (default: 'CustomerID')</li>
 * <li>{@link #getCustomerNameProperty customerNameProperty} : string (default: 'CustomerName')</li>
 * <li>{@link #getSalesOrganizationNameProperty salesOrganizationNameProperty} : string (default: 'SalesOrganizationName')</li>
 * <li>{@link #getDistributionChannelNameProperty distributionChannelNameProperty} : string (default: 'DistributionChannelName')</li>
 * <li>{@link #getDivisionNameProperty divisionNameProperty} : string (default: 'DivisionName')</li>
 * <li>{@link #getDialogTitle dialogTitle} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.CustomerContext#event:customerSelected customerSelected} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * This control allows you to open a dialog containing a list of customers for users to pick.
 * The chosen selected customer is persisted using sap.ushell services that shall be fully configured outside of this control.
 * 
 * The dialog can be open following two modes:
 * "select" : exiting without choosing a customer is firing the customerSelected event with a null customer before closing the dialog
 * "change" : exiting without choosing a customer is simply closing the dialog
 * 
 * When opening the dialog in "select" mode, if a customer has been persisted in a previous session, it will be retrieved and the dialog won't open at all.
 * 
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.CustomerContext
 */
sap.ui.core.Control.extend("sap.ca.ui.CustomerContext", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"setModel", "select", "change", "reset"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"personalizationPageName" : {type : "string", group : "Misc", defaultValue : 'AppCustomerContext'},
		"showSalesArea" : {type : "boolean", group : "Misc", defaultValue : false},
		"path" : {type : "string", group : "Misc", defaultValue : '/Customers'},
		"customerIDProperty" : {type : "string", group : "Misc", defaultValue : 'CustomerID'},
		"customerNameProperty" : {type : "string", group : "Misc", defaultValue : 'CustomerName'},
		"salesOrganizationNameProperty" : {type : "string", group : "Misc", defaultValue : 'SalesOrganizationName'},
		"distributionChannelNameProperty" : {type : "string", group : "Misc", defaultValue : 'DistributionChannelName'},
		"divisionNameProperty" : {type : "string", group : "Misc", defaultValue : 'DivisionName'},
		"dialogTitle" : {type : "string", group : "Misc", defaultValue : null}
	},
	events : {
		"customerSelected" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.CustomerContext with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.CustomerContext.extend
 * @function
 */

sap.ca.ui.CustomerContext.M_EVENTS = {'customerSelected':'customerSelected'};


/**
 * Getter for property <code>personalizationPageName</code>.
 * Name of your app that shall be unique.
 *
 * Default value is <code>AppCustomerContext</code>
 *
 * @return {string} the value of property <code>personalizationPageName</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getPersonalizationPageName
 * @function
 */

/**
 * Setter for property <code>personalizationPageName</code>.
 *
 * Default value is <code>AppCustomerContext</code> 
 *
 * @param {string} sPersonalizationPageName  new value for property <code>personalizationPageName</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setPersonalizationPageName
 * @function
 */


/**
 * Getter for property <code>showSalesArea</code>.
 * Display or not the customers sales area as well as its name and id.
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showSalesArea</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getShowSalesArea
 * @function
 */

/**
 * Setter for property <code>showSalesArea</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowSalesArea  new value for property <code>showSalesArea</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setShowSalesArea
 * @function
 */


/**
 * Getter for property <code>path</code>.
 * Model path to the customer collection to be displayed
 *
 * Default value is <code>/Customers</code>
 *
 * @return {string} the value of property <code>path</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getPath
 * @function
 */

/**
 * Setter for property <code>path</code>.
 *
 * Default value is <code>/Customers</code> 
 *
 * @param {string} sPath  new value for property <code>path</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setPath
 * @function
 */


/**
 * Getter for property <code>customerIDProperty</code>.
 * Property name of the customer ID
 *
 * Default value is <code>CustomerID</code>
 *
 * @return {string} the value of property <code>customerIDProperty</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getCustomerIDProperty
 * @function
 */

/**
 * Setter for property <code>customerIDProperty</code>.
 *
 * Default value is <code>CustomerID</code> 
 *
 * @param {string} sCustomerIDProperty  new value for property <code>customerIDProperty</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setCustomerIDProperty
 * @function
 */


/**
 * Getter for property <code>customerNameProperty</code>.
 * Property name of the customer name
 *
 * Default value is <code>CustomerName</code>
 *
 * @return {string} the value of property <code>customerNameProperty</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getCustomerNameProperty
 * @function
 */

/**
 * Setter for property <code>customerNameProperty</code>.
 *
 * Default value is <code>CustomerName</code> 
 *
 * @param {string} sCustomerNameProperty  new value for property <code>customerNameProperty</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setCustomerNameProperty
 * @function
 */


/**
 * Getter for property <code>salesOrganizationNameProperty</code>.
 * Property name of the sales organization name
 *
 * Default value is <code>SalesOrganizationName</code>
 *
 * @return {string} the value of property <code>salesOrganizationNameProperty</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getSalesOrganizationNameProperty
 * @function
 */

/**
 * Setter for property <code>salesOrganizationNameProperty</code>.
 *
 * Default value is <code>SalesOrganizationName</code> 
 *
 * @param {string} sSalesOrganizationNameProperty  new value for property <code>salesOrganizationNameProperty</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setSalesOrganizationNameProperty
 * @function
 */


/**
 * Getter for property <code>distributionChannelNameProperty</code>.
 * Property name of the distribution channel name
 *
 * Default value is <code>DistributionChannelName</code>
 *
 * @return {string} the value of property <code>distributionChannelNameProperty</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getDistributionChannelNameProperty
 * @function
 */

/**
 * Setter for property <code>distributionChannelNameProperty</code>.
 *
 * Default value is <code>DistributionChannelName</code> 
 *
 * @param {string} sDistributionChannelNameProperty  new value for property <code>distributionChannelNameProperty</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setDistributionChannelNameProperty
 * @function
 */


/**
 * Getter for property <code>divisionNameProperty</code>.
 * Property name of the division name
 *
 * Default value is <code>DivisionName</code>
 *
 * @return {string} the value of property <code>divisionNameProperty</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getDivisionNameProperty
 * @function
 */

/**
 * Setter for property <code>divisionNameProperty</code>.
 *
 * Default value is <code>DivisionName</code> 
 *
 * @param {string} sDivisionNameProperty  new value for property <code>divisionNameProperty</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setDivisionNameProperty
 * @function
 */


/**
 * Getter for property <code>dialogTitle</code>.
 * Overrides the default Dialog title
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>dialogTitle</code>
 * @public
 * @name sap.ca.ui.CustomerContext#getDialogTitle
 * @function
 */

/**
 * Setter for property <code>dialogTitle</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sDialogTitle  new value for property <code>dialogTitle</code>
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#setDialogTitle
 * @function
 */


/**
 * Fired when a customer is selected in the list. The fired customer can be empty in case the user press the cancel button while the Customer Context has been open using select() 
 *
 * @name sap.ca.ui.CustomerContext#customerSelected
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'customerSelected' event of this <code>sap.ca.ui.CustomerContext</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.CustomerContext</code>.<br/> itself. 
 *  
 * Fired when a customer is selected in the list. The fired customer can be empty in case the user press the cancel button while the Customer Context has been open using select() 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.CustomerContext</code>.<br/> itself.
 *
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#attachCustomerSelected
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'customerSelected' event of this <code>sap.ca.ui.CustomerContext</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.CustomerContext#detachCustomerSelected
 * @function
 */

/**
 * Fire event customerSelected to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.CustomerContext} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.CustomerContext#fireCustomerSelected
 * @function
 */


/**
 * Setter for the control model
 *
 * @name sap.ca.ui.CustomerContext.prototype.setModel
 * @function

 * @type void
 * @public
 */


/**
 * Open the Customer Context dialog and fires a null customerSelected if the cancel button is clicked
 *
 * @name sap.ca.ui.CustomerContext.prototype.select
 * @function

 * @type void
 * @public
 */


/**
 * Open the Customer Context dialog
 *
 * @name sap.ca.ui.CustomerContext.prototype.change
 * @function

 * @type void
 * @public
 */


/**
 * Delete the user selected customer
 *
 * @name sap.ca.ui.CustomerContext.prototype.reset
 * @function

 * @type void
 * @public
 */


// Start of sap\ca\ui\CustomerContext.js
jQuery.sap.declare("sap.ca.ui.CustomerContext");
jQuery.sap.require('sap.m.Dialog'); // unlisted dependency retained

jQuery.sap.require('sap.m.List'); // unlisted dependency retained

jQuery.sap.require('sap.m.ColumnListItem'); // unlisted dependency retained

jQuery.sap.require('sap.m.ObjectIdentifier'); // unlisted dependency retained



sap.ca.ui.CustomerContext.MODE = {Select:'Select', Change:'Change'};     //opening modes

//called right after Control instantiation
sap.ca.ui.CustomerContext.prototype.init = function () {

    //-------------- persistence relying on ushell personalisation services ----------------//
    this._oldValue = "";
    this._oPersService = null;
    this._bDialogTitleOverriden = false; //allows overriding of the dialog title

    this._oDialog = new sap.m.Dialog(this.getId()+"-ccDialog", {
        type:sap.m.DialogType.Standard,
        contentWidth:"25%",
        contentHeight:"350em"
    }).addStyleClass("sapCaUiCCD");

    if (jQuery.device.is.phone) {
        this._oDialog.setStretchOnPhone(true);
    }

    //------------ set accept & reject buttons -----------------
    this._oButtonOk = new sap.m.Button({
        text:sap.ca.ui.utils.resourcebundle.getText("CustomerContext.Ok"),
        press:jQuery.proxy(function () {
            if (this._oList.getSelectedItem()) {

                var oSelectedCustomer = this._oList.getSelectedItem().getBindingContext().getProperty();

                //save the customer into the personalization service
                if (this._oPersService) {
                    try {
                        var oSavePromise = this._oPersService.setPersData(JSON.stringify(oSelectedCustomer));

                        oSavePromise.done(function() {
                            jQuery.sap.log.info("CustomerContext: Customer '"+JSON.stringify(oSelectedCustomer)+"' successfully saved");
                        });
                        oSavePromise.fail(function(oError) {
                            jQuery.sap.log.error("CustomerContext: Error while saving customer info : " + oError.message);
                        });
                    }
                    catch (oError) {
                        jQuery.sap.log.error("CustomerContext: wasn't able to saved SelectedCustomer on personalization service "+ oError.message);
                    }
                }
                else {
                    jQuery.sap.log.error("CustomerContext: there is no service defined for saving the SelectedCustomer, did you set the personalizationPageName property? ");
                }

                this.fireCustomerSelected(oSelectedCustomer);
            }
            this._oDialog.close();
        }, this)
    });

    this._oDialog.setLeftButton(this._oButtonOk);

    this._oButtonCancel =  new sap.m.Button({
        text:sap.ca.ui.utils.resourcebundle.getText("CustomerContext.Cancel"),
        press:jQuery.proxy(this._onCancel, this)
    });

    this._oDialog.setRightButton(this._oButtonCancel);


    //------------- subheader (search field) --------------------
    var searchField = new sap.m.SearchField({
        placeholder:sap.ca.ui.utils.resourcebundle.getText("CustomerContext.Search"),
        width:"100%",
        layoutData:new sap.m.FlexItemData({growFactor:1}),
        liveChange:jQuery.proxy(this._onLiveSearch, this)
    });

    var oSubHeader = new sap.m.Bar(this._oDialog.getId()+"-searchField",{
        contentMiddle:[
            searchField
        ]
    });
    this._oDialog.setSubHeader(oSubHeader);


    //------------- build dialog content (list) ------------------------------
    this._oList = new sap.m.Table();

    //------------ column for sales area -------------------------------------
    this._oSalesAreaColumn = new sap.m.Column({
        hAlign:"Left",
        minScreenWidth:"5000px",
        demandPopin:true,
        header:new sap.m.Label({
            text:sap.ca.ui.utils.resourcebundle.getText("CustomerContext.SalesArea")
        }),
        visible:false
    });
    this._oList.applySettings({
        mode:sap.m.ListMode.SingleSelectMaster,
        columns:[
            new sap.m.Column({
                hAlign:"Left"
            }),
            this._oSalesAreaColumn
        ],
        items:{
            path:this.getPath(),
            factory: jQuery.proxy(this._getItemList,this)
        },
        noDataText: sap.ca.ui.utils.resourcebundle.getText("CustomerContext.NoData")
    });

    //------------- binds the list and the dialog together ------------------------------
    this._oDialog.addContent(this._oList);
    this._oDialog.attachAfterOpen(jQuery.proxy(function () {

        //if nothing is selected, select the first item
        if (!this._oList.getSelectedItem() && this._oList.getItems().length > 0) {
            this._oList.setSelectedItem(this._oList.getItems()[0], true);
        }

    }, this));
};


sap.ca.ui.CustomerContext.prototype.setDialogTitle = function (sValue, bInvalidate) {
    this._bDialogTitleOverriden = true;
    this.setProperty("dialogTitle", sValue, bInvalidate);
};

sap.ca.ui.CustomerContext.prototype.setPersonalizationPageName = function (sValue) {
    try {
        var personalizationService = sap.ushell.Container.getService("Personalization");
        this._oPersService = personalizationService.getPersonalizer({
            container : sValue,
            item : "SelectedCustomerContext"
        });
    }
    catch (oError) {
        jQuery.sap.log.error("CustomerContext: error while loading personalization service: "+ oError.message);
    }

    this.setProperty("personalizationPageName", sValue, false);
};

//setter for property ShowSalesArea: display or not the sales area from the customer
sap.ca.ui.CustomerContext.prototype.setShowSalesArea = function (bValue) {

    var _oldValue = this.getShowSalesArea();
    if (_oldValue !== !!bValue){
        this._oSalesAreaColumn.setVisible(!!bValue);

        this.setProperty("showSalesArea", bValue, false);
    }
};

//setter for property ShowSalesArea: display or not the sales area from the customer
sap.ca.ui.CustomerContext.prototype.setPath = function (sValue) {
    this._oList.bindItems(sValue, jQuery.proxy(this._getItemList,this));
    this.setProperty("path", sValue);
};

//set the customer list model
sap.ca.ui.CustomerContext.prototype.setModel = function (oModel) {

    /* static list + live search only : tranforms the model into a local JSON model */
    if (oModel instanceof sap.ui.model.odata.ODataModel) {
        oModel = this._prepareODataForLiveSearch(oModel);
    }
    else if (oModel instanceof sap.ui.model.json.JSONModel) {
        oModel = this._prepareJSONForLiveSearch(oModel);
    }

    this._oList.setModel(oModel);
};

//open the customer list for selecting a new value
sap.ca.ui.CustomerContext.prototype.select = function () {

    if (!this._oDialog.isOpen()) {

        //check if there is a customer persisted for that app
        if (this._oPersService) {
            try {

                var oReadPromise = this._oPersService.getPersData();

                oReadPromise.done(jQuery.proxy(function (sCustomer) { // Success callback

                   if (sCustomer && sCustomer !== "") {
                       var oCustomer = JSON.parse(sCustomer);

                        // set the right item into the list
                        var oList = this._oList;
                        var customerPropId = this.getCustomerIDProperty();
                        if (this._oList && this._oList.getItems() && this._oList.getItems().length > 0){
                            jQuery.each(this._oList.getItems(), function(index, o){
                                var c = o.getBindingContext();
                                if (c.getModel().getProperty(c.getPath())[customerPropId] == oCustomer[customerPropId]) {
                                    oList.setSelectedItem(o, true);
                                }
                            });
                        }

                        this.fireCustomerSelected(oCustomer);
                    }
                    else {
                        //if only 1 customer, we select it automatically without opening the dialog
                        //simulate a press on the button so the customer is selected and saved using personalization
                        if (this._oList.getItems().length == 1) {
                            this._oList.setSelectedItem(this._oList.getItems()[0], true);
                            this._oButtonOk.firePress();
                        }
                        else {
                            this._mode = sap.ca.ui.CustomerContext.MODE.Select;
                            if (this._bDialogTitleOverriden) {
                                this._oDialog.setTitle(this.getDialogTitle());
                            }
                            else {
                            this._oDialog.setTitle(sap.ca.ui.utils.resourcebundle.getText("CustomerContext.TitleSelect"));
                            }

                            this._oDialog.open();
                        }
                    }

                }, this));

                oReadPromise.fail(jQuery.proxy(function (oError) {
                    jQuery.sap.log.error("CustomerContext: error while using personalization service: "+ oError.message);
                    this.fireCustomerSelected(null);
                }, this));
            }
            catch (oError) {
                jQuery.sap.log.error("CustomerContext: error while loading personalization service: "+ oError.message);
                this.fireCustomerSelected(null);
            }
        }
    }
};

//open the customer list for changing a previously selected value
sap.ca.ui.CustomerContext.prototype.change = function () {

    if (!this._oDialog.isOpen()) {
        this._mode = sap.ca.ui.CustomerContext.MODE.Change;
        if (this._bDialogTitleOverriden) {
            this._oDialog.setTitle(this.getDialogTitle());
        }
        else {
        this._oDialog.setTitle(sap.ca.ui.utils.resourcebundle.getText("CustomerContext.TitleChange"));
        }

        this._oDialog.open();
    }
};

//reset (= save with empty) the customer into the personalization service
sap.ca.ui.CustomerContext.prototype.reset = function() {

    if (this._oPersService) {
        try {
            var oSavePromise = this._oPersService.setPersData("");

            oSavePromise.done(function() {
                jQuery.sap.log.info("CustomerContext: Customer successfully reset");
            });
            oSavePromise.fail(function(oError) {
                jQuery.sap.log.error("CustomerContext: Error while resetting customer context: " + oError.message);
            });
        }
        catch (oError) {
            jQuery.sap.log.error("CustomerContext: wasn't able to reset SelectedCustomer on personalization service "+ oError.message);
        }
    }
    else {
        jQuery.sap.log.error("CustomerContext: there is no service defined for resetting the SelectedCustomer, did you set the personalizationPageName property? ");
    }
};


/* ----------------------------------- private methods --------------------------------------------- */
// Factory function for list items
sap.ca.ui.CustomerContext.prototype._getItemList = function(){
    var aCells = [
        new sap.m.ObjectIdentifier({
            title:{
                parts:[
                    {path:this.getCustomerNameProperty()},
                    {path:this.getCustomerIDProperty()}
                ],
                formatter:function (sName, sId) {      //if 00000, don't display the id
                    var sFullName = sName;
                    if (parseInt(sId) !== 0) {
                        sFullName += " (" + sId + ")";
                    }
                    return sFullName;
                }
            }
        })
    ];
    if( this.getShowSalesArea()){
        aCells.push(new sap.m.Text({
            text:"{" + this.getSalesOrganizationNameProperty()+"}, {"+ this.getDistributionChannelNameProperty() +"}, {" + this.getDivisionNameProperty() + "}"
        }));
    }
    return new sap.m.ColumnListItem({
        cells: aCells
    });
};

//push the cancel button: behavior is different if you open the customer list in select or change mode
sap.ca.ui.CustomerContext.prototype._onCancel = function () {
    if (this._mode == sap.ca.ui.CustomerContext.MODE.Select) {
        this.fireCustomerSelected(null);
    }
    this._oDialog.close();
};


//enhance an odata model for the live search (creates a local json model in order to avoid backend calls onLiveSearch)
sap.ca.ui.CustomerContext.prototype._prepareJSONForLiveSearch = function (oModel) {

    var customerPath = this.getPath();
    if (customerPath.length > 1 && customerPath[0] == '/') {
        customerPath = customerPath.substring(1);
    }

    var oCustomers = oModel.getData()[customerPath];

    for (var i = 0; i < oCustomers.length; i++) {
        //enrich the model for the live search
        this._enrichModel(oCustomers[i]);
    }

    var oJsonData = {};
    oJsonData[customerPath] = oCustomers;
    oModel.setData(oJsonData);

    return oModel;
};

//create a unique field containing all others for live searching on all displayed information at once
sap.ca.ui.CustomerContext.prototype._enrichModel = function (oCustomer) {
    oCustomer["_searchString"] = "";
    if (oCustomer[this.getCustomerNameProperty()]) {
        oCustomer["_searchString"] += oCustomer[this.getCustomerNameProperty()];
    }
    if (oCustomer[this.getCustomerIDProperty()]) {
        oCustomer["_searchString"] += oCustomer[this.getCustomerIDProperty()];
    }
    if (this.getShowSalesArea()) {
        if (oCustomer[this.getSalesOrganizationNameProperty()]) {
            oCustomer["_searchString"] += oCustomer[this.getSalesOrganizationNameProperty()];
        }
        if (oCustomer[this.getDistributionChannelNameProperty()]) {
            oCustomer["_searchString"] += oCustomer[this.getDistributionChannelNameProperty()];
        }
        if (oCustomer[this.getDivisionNameProperty()]) {
            oCustomer["_searchString"] += oCustomer[this.getDivisionNameProperty()];
        }
    }

    return oCustomer;
};

//enhance an odata model for the live search (creates a local json model in order to avoid backend calls onLiveSearch)
sap.ca.ui.CustomerContext.prototype._prepareODataForLiveSearch = function (oModel) {

    var jsonModel = new sap.ui.model.json.JSONModel();
    var jsonResults = [];
    var oJsonData = {};

    var customerPath = this.getPath();
    if (customerPath.length > 1 && customerPath[0] == '/') {
        customerPath = customerPath.substring(1);
    }

    oModel.read(this.getPath(), null, [], false, jQuery.proxy(function (oData) {

        for (var key in oData.results) {
            //fill source ODataModel for the calling view
            oModel.oData[customerPath+"('" + oData.results[key][this.getCustomerIDProperty()] + "')"] = oData.results[key];

            //enrich the model for the live search
            jsonResults.push(this._enrichModel(oData.results[key]));
        }

        oJsonData[customerPath] = jsonResults;
        jsonModel.setData(oJsonData);

    }, this), function () {
    });

    return jsonModel;
};

//perform the filtering on the list
sap.ca.ui.CustomerContext.prototype._onLiveSearch = function (oEvent) {
    var searchValue = oEvent.getParameter("newValue");
    var aFilters = [];

    if (searchValue != "") {
        aFilters.push(new sap.ui.model.Filter("_searchString", sap.ui.model.FilterOperator.Contains, searchValue));
        this._oList.getBinding("items").filter(aFilters);

    }
    else {
        if (this._oldValue != ""){
            this._oList.getBinding("items").filter([]);
        }
    }

    this._oldValue = searchValue;
};

sap.ca.ui.CustomerContext.prototype.exit = function () {
    if (this._oButtonOk) {
        this._oButtonOk.destroy();
        this._oButtonOk = null;
    }

    if (this._oButtonCancel) {
        this._oButtonCancel.destroy();
        this._oButtonCancel = null;
    }

    if (this._oDialog) {
        this._oDialog.destroy();
        this._oDialog = null;
    }

};
}; // end of sap/ca/ui/CustomerContext.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.ExpansibleFeedListItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.ExpansibleFeedListItem.
jQuery.sap.declare("sap.ca.ui.ExpansibleFeedListItem");

jQuery.sap.require('sap.m.FeedListItem'); // unlisted dependency retained



/**
 * Constructor for a new ExpansibleFeedListItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getMaxLines maxLines} : int (default: 5)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.FeedListItem#constructor sap.m.FeedListItem}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Extends the FeedListItem to hide text when it is longer than maxLines. When text is hidden a See more link is displayed, clicking on the link displays the entire text.
 * @extends sap.m.FeedListItem
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.ExpansibleFeedListItem
 */
sap.m.FeedListItem.extend("sap.ca.ui.ExpansibleFeedListItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"maxLines" : {type : "int", group : "Misc", defaultValue : 5}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.ExpansibleFeedListItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.ExpansibleFeedListItem.extend
 * @function
 */


/**
 * Getter for property <code>maxLines</code>.
 * The maximum number of lines to display before adding the "See more" link.
 *
 * Default value is <code>5</code>
 *
 * @return {int} the value of property <code>maxLines</code>
 * @public
 * @name sap.ca.ui.ExpansibleFeedListItem#getMaxLines
 * @function
 */

/**
 * Setter for property <code>maxLines</code>.
 *
 * Default value is <code>5</code> 
 *
 * @param {int} iMaxLines  new value for property <code>maxLines</code>
 * @return {sap.ca.ui.ExpansibleFeedListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.ExpansibleFeedListItem#setMaxLines
 * @function
 */


// Start of sap\ca\ui\ExpansibleFeedListItem.js
///**
// * This file defines behavior for the control,
// */


sap.ca.ui.ExpansibleFeedListItem.prototype._getSeeMoreLink = function() {
    if(!this._oSeeMoreLink) {
        jQuery.sap.require("sap.m.Link");
        this._oSeeMoreLink =  new sap.m.Link({
                text: sap.ca.ui.utils.resourcebundle.getText("extensiblefeedlistitem.seeMore"),
                press : jQuery.proxy(function() {
                    if (this.$().hasClass("sapCaUiExpansibleFeedListItemSeeLess")) {
                        this._collapseText();
                        this._oSeeMoreLink.setText(sap.ca.ui.utils.resourcebundle.getText("extensiblefeedlistitem.seeMore"));
                    } else {
                        var $text = jQuery.sap.byId(this.getId() + "-text");
                        $text.height("auto");
                        this._oSeeMoreLink.setText(sap.ca.ui.utils.resourcebundle.getText("extensiblefeedlistitem.seeLess"));
                    }
                    this.$().toggleClass("sapCaUiExpansibleFeedListItemSeeLess");
                }, this)
            });
        //Necessary so this gets garbage collected
        this._oSeeMoreLink.setParent(this, null, true);
    }
        
    return this._oSeeMoreLink;
};

sap.ca.ui.ExpansibleFeedListItem.prototype._collapseText = function() {
    var iMaxLines = this.getMaxLines();
    var $text = jQuery.sap.byId(this.getId() + "-text");
    var sLineHeight = $text.css("lineHeight");
    var fLineHeight;
    if (sLineHeight.indexOf("px") != -1)
        fLineHeight = parseFloat(sLineHeight);
    else { //if this is just a number or expressed in em
        var fRelativeLineHeight = this._convertRelativeCSSSizeToFloat(sLineHeight) || 1.2; //if the line-height equals to "normal" lineheight is 1.2ish in most browsers according to: https://developer.mozilla.org/en-US/docs/Web/CSS/line-height
        var sFontSize = $text.css("font-size");
        var iFontSize;
        if (sFontSize.indexOf("px") != -1)
            iFontSize = parseInt(sFontSize);
        else { //let's have some fun to compute the font-size depending on the parent's font-size
            var fRelativeFontSize = this._convertRelativeCSSSizeToFloat(sFontSize) || 1; //if the font-size is expressed as small/large etc. we'd need a map to convert "word" values to relative values
            var $parent = $text.parent();
            var sParentsFontSize = "19px"; //if we could not find a valid value at the end of the parent's chain, we use 19 as a defualt value...
            while ($parent != null) {
                sParentsFontSize = $parent.css("font-size");
                if (sParentsFontSize.indexOf("px") != -1)
                    break;
                $parent = $parent.parent();
            }
            iFontSize = parseInt(sParentsFontSize)*fRelativeFontSize; //this is not completely correct, as we should consider intermediate font-sizes expressed in %/em etc
        }
        fLineHeight = iFontSize * fRelativeLineHeight;
    }

    var iLineCount = $text.height()/fLineHeight;
    var iMaxHeight = fLineHeight*iMaxLines;

    if (iLineCount > iMaxLines) {
        this.addStyleClass("sapCaUiExpansibleFeedListItemSeeMore");
        $text.height(iMaxHeight);
    } else { //we should not need to remove this class, but something seems to have changed in the rendering/cloning of elements in a list. For security reasons I'm clearing this class now.
        this.removeStyleClass("sapCaUiExpansibleFeedListItemSeeMore");
    }
};

sap.ca.ui.ExpansibleFeedListItem.prototype._convertRelativeCSSSizeToFloat = function(sSize) {
    var fRelativeFontSize = Number.NaN;
    if (jQuery.isNumeric(sSize) || sSize.indexOf("em") != -1)
        fRelativeFontSize = parseFloat(sSize);
    else if (sSize.indexOf("%") != -1)
        fRelativeFontSize = parseInt(sSize)/100;
    return fRelativeFontSize;
};

sap.ca.ui.ExpansibleFeedListItem.prototype.onAfterRendering = function() {
    if (sap.m.FeedListItem.prototype.onAfterRendering) {
        sap.m.FeedListItem.prototype.onAfterRendering.apply(this);
    }

    this._collapseText();
};
}; // end of sap/ca/ui/ExpansibleFeedListItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.FileUploadRenderer') ) {
jQuery.sap.declare("sap.ca.ui.FileUploadRenderer");
jQuery.sap.require('sap.m.ListRenderer'); // unlisted dependency retained

//temporary workaround needed for the jQuery plugins to work
//proper fix to be implemented
define = undefined;




/**
 * @class FileUpload renderer.
 * @static
 */
sap.ca.ui.FileUploadRenderer = {};

/**
 * Renders the HTML for the given control, using the provided
 * {@link sap.ui.core.RenderManager}.
 *
 * @param {sap.ui.core.RenderManager}
    *            oRm the RenderManager that can be used for writing to the render
 *            output buffer
 * @param {sap.ui.core.Control}
    *            oControl an object representation of the control that should be
 *            rendered
 */
sap.ca.ui.FileUploadRenderer.render = function(oRm, oControl) {
    // write the HTML into the render manager

    oRm.write("<div");
    oRm.writeControlData(oControl);
    oRm.addClass("sapCaUiFU");
    if (oControl.getEditMode()){
        oRm.addClass("sapCaUiFUEdit");
    }
    oRm.writeClasses();
    oRm.write(">");
    oRm.renderControl(oControl.getAggregation("attachmentNumberLabel"));

    oRm.write("<div ");
    oRm.addClass("sapCaUiFUHeader");
    oRm.writeClasses();
    oRm.write(">");

    oRm.renderControl(oControl.getAggregation("toolBar"));

    if(oControl.getUploadEnabled()) {
        oRm.write("<input type='file' name='files[]' tabindex='-1' ");
        oRm.writeAttributeEscaped("id", oControl.getId() + "-upload");

        //this is required for ios in order to allow camera capture
        //otherwise, it will only allow selecting from albums
        if(jQuery.device.is.ipad || jQuery.device.is.iphone) {
            oRm.write(" capture='camera' ");
        } else {
            oRm.write(" multiple ");
        }
        oRm.write("></input>");
    }

    oRm.write("<div ");
    oRm.addClass("sapCaUiFUProgressHeader");
    oRm.writeClasses();
    oRm.write(">");

    oRm.renderControl(oControl.getAggregation("uploadProgressLabel"));
    oRm.write("</div>");

    oRm.write("</div>");

    oRm.renderControl(oControl.getAggregation("fileList"));
    oRm.write("</div>");
};



}; // end of sap/ca/ui/FileUploadRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.GrowingTileContainer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.GrowingTileContainer.
jQuery.sap.declare("sap.ca.ui.GrowingTileContainer");

jQuery.sap.require('sap.m.ScrollContainer'); // unlisted dependency retained



/**
 * Constructor for a new GrowingTileContainer.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getGrowing growing} : boolean (default: false)</li>
 * <li>{@link #getGrowingThreshold growingThreshold} : int (default: 20)</li>
 * <li>{@link #getGrowingScrollToLoad growingScrollToLoad} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.ScrollContainer#constructor sap.m.ScrollContainer}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * A Tile container for the Overview tile with growing capapilities
 * @extends sap.m.ScrollContainer
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.GrowingTileContainer
 */
sap.m.ScrollContainer.extend("sap.ca.ui.GrowingTileContainer", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"growing" : {type : "boolean", group : "Misc", defaultValue : false},
		"growingThreshold" : {type : "int", group : "Misc", defaultValue : 20},
		"growingScrollToLoad" : {type : "boolean", group : "Misc", defaultValue : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.GrowingTileContainer with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.GrowingTileContainer.extend
 * @function
 */


/**
 * Getter for property <code>growing</code>.
 * growing enablement
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>growing</code>
 * @public
 * @name sap.ca.ui.GrowingTileContainer#getGrowing
 * @function
 */

/**
 * Setter for property <code>growing</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bGrowing  new value for property <code>growing</code>
 * @return {sap.ca.ui.GrowingTileContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.GrowingTileContainer#setGrowing
 * @function
 */


/**
 * Getter for property <code>growingThreshold</code>.
 * growing Threshold
 *
 * Default value is <code>20</code>
 *
 * @return {int} the value of property <code>growingThreshold</code>
 * @public
 * @name sap.ca.ui.GrowingTileContainer#getGrowingThreshold
 * @function
 */

/**
 * Setter for property <code>growingThreshold</code>.
 *
 * Default value is <code>20</code> 
 *
 * @param {int} iGrowingThreshold  new value for property <code>growingThreshold</code>
 * @return {sap.ca.ui.GrowingTileContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.GrowingTileContainer#setGrowingThreshold
 * @function
 */


/**
 * Getter for property <code>growingScrollToLoad</code>.
 * load when scrolling
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>growingScrollToLoad</code>
 * @public
 * @name sap.ca.ui.GrowingTileContainer#getGrowingScrollToLoad
 * @function
 */

/**
 * Setter for property <code>growingScrollToLoad</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bGrowingScrollToLoad  new value for property <code>growingScrollToLoad</code>
 * @return {sap.ca.ui.GrowingTileContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.GrowingTileContainer#setGrowingScrollToLoad
 * @function
 */


// Start of sap\ca\ui\GrowingTileContainer.js
///**
//* This file defines behavior for the control,
//*/
jQuery.sap.require('sap.ui.layout.Grid'); // unlisted dependency retained

sap.ca.ui.GrowingTileContainer.prototype.init = function() {
    sap.m.ScrollContainer.prototype.init.call(this);
    this._iItemCount = 0;
};

sap.ca.ui.GrowingTileContainer.prototype.destroy = function() {
    if (this._oBusyIndicator) {
	this._oBusyIndicator.destroy();
	delete this._oBusyIndicator;
    }
    if (this._oGridLayout) {
	this._oGridLayout.destroy();
	delete this._oGridLayout;
    }
    if (this._oScrollDelegate) {
	this._unbindGrowingDelegate();
	this._oScrollDelegate = null;
    }
    this._unbindDataEvents();
};

sap.ca.ui.GrowingTileContainer.prototype.onBeforRendering = function() {
    this._unbindDataEvents();
};

/**
 * Called after rendering phase of the given control
 */
sap.ca.ui.GrowingTileContainer.prototype.onAfterRendering = function() {
    this._bCountChecked = false;
    this._bindGrowingDelegate();
    this._bindDataEvents();
};

/**
 * add dataRequested and dataRecived listeners
 */
sap.ca.ui.GrowingTileContainer.prototype._bindDataEvents = function() {
    var oBinding = this.getBinding("content");
    if (oBinding) {
	oBinding.attachDataRequested(this._onDataRequested, this);
	oBinding.attachDataReceived(this._onDataReceived, this);
    }
};

/**
 * remove dataRequested and dataRecived listeners
 */
sap.ca.ui.GrowingTileContainer.prototype._unbindDataEvents = function() {
    var oBinding = this.getBinding("content");
    if (oBinding) {
	oBinding.detachDataRequested(this._onDataRequested, this);
	oBinding.detachDataReceived(this._onDataReceived, this);
    }
};
/**
 * on data requested
 */
sap.ca.ui.GrowingTileContainer.prototype._onDataRequested = function() {
    this._getBusyIndicator().setVisible(true);
};
/**
 * on data received
 */
sap.ca.ui.GrowingTileContainer.prototype._onDataReceived = function() {
    this._getBusyIndicator().setVisible(false);
};

sap.ca.ui.GrowingTileContainer.prototype._getBusyIndicator = function() {
    if (!this._oBusyIndicator) {
	this._oBusyIndicator = new sap.m.BusyIndicator({
	    size : "2.0rem"
	});

    }
    if (!this._oBusyIndicator.getDomRef()) {
	this._renderAndFlushLayoutItem(this._oBusyIndicator);
    }
    return this._oBusyIndicator;
};
/**
 * this method will be called by the model ... used to update the content
 * aggregation
 */
sap.ca.ui.GrowingTileContainer.prototype.updateContent = function(sChangeReason) {
    var oBindingInfo = this.getBindingInfo("content");
    if (this.getGrowing() && oBindingInfo) {
	if (this._iItemCount == 0 || sChangeReason == sap.ui.model.ChangeReason.Filter) {
	    this._iItemCount = this.getGrowingThreshold();
	}
	var fnFactory = oBindingInfo.factory, oBinding = oBindingInfo.binding, fnODataListBinding = sap.ui.model && sap.ui.model.odata && sap.ui.model.odata.ODataListBinding, bODataListBinding = fnODataListBinding
	&& oBinding instanceof fnODataListBinding, aContexts = oBinding ? oBinding.getContexts(0, this._iItemCount) : [];

	if (aContexts.length > 0) {
	    var sListId = this.getId() + "-scroll";
	    if (jQuery.sap.domById(sListId) != null) {
		// check if model diff-array exists and execute
		if (aContexts.diff) {
		    var aItems, oClone;
		    for ( var i = 0, l = aContexts.diff.length; i < l; i++) {
			aItems = this.getContent();
			if (aContexts.diff[i].type === "delete") {
			    this.deleteListItem(aItems[aContexts.diff[i].index]);
			}
			if (aContexts.diff[i].type === "insert") {
			    oClone = fnFactory("", aContexts[aContexts.diff[i].index]);
			    oClone.setBindingContext(aContexts[aContexts.diff[i].index], oBindingInfo.model);
			    this.insertListItem(oClone, aContexts.diff[i].index);
			}
		    }
		    // update context on all items after applying diff
		    aItems = this.getContent();
		    for ( var i = 0, l = aContexts.length; i < l; i++) {
			if (aItems[i]) {
			    aItems[i].setBindingContext(aContexts[i], oBindingInfo.model);
			}
		    }
		} else {
		    // most likely a new binding is set in this case - therefore
		    // remove all items and aggregations
		    this._iRenderedDataItems = 0;
		    this.destroyAggregation("content");
		    // renderer available - fill the aggregation and render list
		    // items
		    for ( var i = 0, l = aContexts.length; i < l; i++) {
			var oClone = fnFactory("", aContexts[i]);
			oClone.setBindingContext(aContexts[i], oBindingInfo.model);
			this.addListItem(oClone, false);
		    }
		}
	    } else {
		// no renderer - fill only the aggregation
		for ( var i = 0, l = aContexts.length; i < l; i++) {
		    var oClone = fnFactory("", aContexts[i]);
		    oClone.setBindingContext(aContexts[i], oBindingInfo.model);
		    this.addListItem(oClone, true);
		}
	    }
	} else {
	    this.destroyAggregation("content");
	    this._getGridLayout().destroyAggregation("content");
	    this._iRenderedDataItems = 0;
	}
    } else { // if no growing update aggregation
	this.updateAggregation("content");
	this._getGridLayout().updateAggregation("content");
    }

};

/**
 * Function is called to add single list item or row
 */
sap.ca.ui.GrowingTileContainer.prototype.addListItem = function(oItem, bSuppressInvalidate) {
    if (!this._bCountChecked) {
	this._bCountChecked = true;
	// TODO: handle no data add/remove text info
	// if (this._oControl.getShowNoData()) {
	// jQuery.sap.byId(this.getId() + "-NoData").remove();
	// }
    }

    this._iRenderedDataItems++;
    var oBinding = this.getBinding("content");
    this.addAggregation("content", oItem, bSuppressInvalidate);
    if (bSuppressInvalidate) {
	this._renderAndFlushLayoutItem(oItem);
    }
    return this;
};

/**
 * Function is called to insert single list item or row
 */
sap.ca.ui.GrowingTileContainer.prototype.insertListItem = function(oItem, iIndex) {
    if (!this._bCountChecked) {
	this._bCountChecked = true;
    }
    this.insertAggregation("content", oItem, iIndex, true);
    this._iRenderedDataItems++;
    this._renderAndFlushLayoutItem(oItem, iIndex)
    return this;
};

/**
 * function is called to remove single list item or row
 */
sap.ca.ui.GrowingTileContainer.prototype.deleteListItem = function(oItem) {

    if (oItem) {
	this._iRenderedDataItems--;
	this.removeAggregation("content", oItem, true);
	jQuery.sap.byId(this._getItemWrapperId(oItem)).remove();
	oItem.destroy();
	return this;
    }

},
/**
 * return the id of item wrapper element
 * 
 * @param oItem
 */
sap.ca.ui.GrowingTileContainer.prototype._getItemWrapperId = function(oItem) {
    if (oItem) {
	return oItem.getId() + "_wrapper";
    }
    return "";
},

sap.ca.ui.GrowingTileContainer.prototype._getDomIndex = function(iIndex) {

    return (typeof iIndex === "number") ? iIndex : true;
};

sap.ca.ui.GrowingTileContainer.prototype._getItemsContainer = function() {
    // return jQuery.sap.domById(this.getId() + "-scroll");
    if (!this._oGridLayout) {
	var gridLayout = this._getGridLayout();
	return gridLayout.getDomRef();
    }
    return this._oGridLayout.getDomRef();

};
sap.ca.ui.GrowingTileContainer.prototype._getGridLayout = function() {
    // return jQuery.sap.domById(this.getId() + "-scroll");
    if (!this._oGridLayout) {
	this._oGridLayout = new sap.ui.layout.Grid({
	    id : this.getId() + "-grid", // sap.ui.core.ID
	    width : 'auto',
	    inContainer : true,
	    vSpacing : 1, // int
	    hSpacing : 1, // int
	    position : sap.ui.layout.GridPosition.Center, // sap.ui.layout.GridPosition
	    defaultSpan : "L4 M6 S12", // sap.ui.layout.GridSpan
	    defaultIndent : "L0 M0 S0", // sap.ui.layout.GridIndent
	});

    }
    return this._oGridLayout;

};

sap.ca.ui.GrowingTileContainer.prototype.onLoadMorePressed = function() {
    // this._showIndicator();
    jQuery.sap.delayedCall(0, this, function() {
	this._iItemCount += this.getGrowingThreshold();
	this.updateContent();
    });
},

sap.ca.ui.GrowingTileContainer.prototype.setGrowing = function(bGrowing) {
    if (this.getGrowing() != bGrowing) {
	this.setProperty("growing", bGrowing);
	if (bGrowing) {
	    this._iItemCount += this.getGrowingThreshold();
	    // important parameter to make the model calcutalte the contexts
	    // diff
	    this.bUseExtendedChangeDetection = true;

	} else if (this._oGrowingDelegate) {
	    this._oGrowingDelegate.destroy();
	    this._oGrowingDelegate = null;
	}
    }
    return this;
};

/**
 * Returns the content items count. If aggregation content is bound the count
 * will be the length of the binding, otherwise the count of the list items
 * aggregation will be returned
 */
sap.ca.ui.GrowingTileContainer.prototype._getListItemCount = function() {
    var oBinding = this.getBinding("content");
    if (oBinding) {
	return oBinding.getLength() || 0;
    }
    return this.getContent().length;
},

/**
 * ScrollDelegate call this method to inform new page needs to load
 */
sap.ca.ui.GrowingTileContainer.prototype._triggerLoadingByScroll = function(oEvent) {
    if (this._iItemCount < this._getListItemCount()) {
	// handle correctly very fast scrolling case
	jQuery.sap.clearDelayedCall(this._delayCallId);
	this._delayCallId = jQuery.sap.delayedCall(1000, this, function() {
	    jQuery.sap.log.info("loading elements triggered on scroll");
	    this._iItemCount += this.getGrowingThreshold();
	    this.updateContent();
	});
    }
};

sap.ca.ui.GrowingTileContainer.prototype._unbindGrowingDelegate = function(){
    if (this._oScrollDelegate) {
	jQuery.sap.log.debug("unbinding scroll delegate");
	delete this._fnProxytriggerLoadingByScroll;
	this._oScrollDelegate.setGrowingList(null);
    } 
};

sap.ca.ui.GrowingTileContainer.prototype._bindGrowingDelegate = function(){
    var oScrollDelegate = sap.m.getScrollDelegate(this);
    if (oScrollDelegate) {
	jQuery.sap.log.debug("binding scroll delegate");
	this._oScrollDelegate = oScrollDelegate;
	this._fnProxytriggerLoadingByScroll = jQuery.proxy(this._triggerLoadingByScroll, this);

	oScrollDelegate.setGrowingList(this, this._fnProxytriggerLoadingByScroll);
    }
};

sap.ca.ui.GrowingTileContainer.prototype._renderAndFlushLayoutItem = function(oItem, iIndex) {
    var INDENTPATTERN = /^([L](?:[0-9]|1[0-1]))? ?([M](?:[0-9]|1[0-1]))? ?([S](?:[0-9]|1[0-1]))?$/i;
    var SPANPATTERN = /^([L](?:[1-9]|1[0-2]))? ?([M](?:[1-9]|1[0-2]))? ?([S](?:[1-9]|1[0-2]))?$/i;
    var oGridLayout = this._getGridLayout();
    var defaultSpan = oGridLayout.getDefaultSpan();
    var defaultIndent = oGridLayout.getDefaultIndent();
    var aDIndent = INDENTPATTERN.exec(defaultIndent);

    // Default Span if nothing is specified at all, not on Grid , not on the
    // cell.
    var aDefColSpan = [ "", "L3", "M6", "S12" ];

    // Default Span values defined on the whole Grid, that is used if there is
    // no individual span defined for the cell.
    var aDSpan = SPANPATTERN.exec(defaultSpan);

    var oDomRef = this._getItemsContainer();
    if (oDomRef) {
	var oRm = sap.ui.getCore().createRenderManager();

	oRm.write("<div id=" + this._getItemWrapperId(oItem));
	var oLay = oGridLayout._getLayoutDataForControl(oItem);

	if (oLay) {

	    // Line break
	    if (oLay.getLinebreak() === true) {
		oRm.addClass("sapUiRespGridBreak");
	    } else {
		if (oLay.getLinebreakL() === true) {
		    oRm.addClass("sapUiRespGridBreakL");
		}
		if (oLay.getLinebreakM() === true) {
		    oRm.addClass("sapUiRespGridBreakM");
		}
		if (oLay.getLinebreakS() === true) {
		    oRm.addClass("sapUiRespGridBreakS");
		}
	    }

	    // Span
	    var aSpan;
	    var sSpan = oLay.getSpan();
	    if (!sSpan || !sSpan.length == 0) {
		aSpan = aDSpan;
	    } else {
		aSpan = SPANPATTERN.exec(sSpan);
	    }

	    if (aSpan) {
		for ( var j = 1; j < aSpan.length; j++) {
		    var span = aSpan[j];
		    if (!span) {
			span = aDSpan[j];
			if (!span) {
			    span = aDefColSpan[j];
			}
		    }

		    // Catch the Individual Spans
		    var iSpanLarge = oLay.getSpanLarge();
		    var iSpanMedium = oLay.getSpanMedium();
		    var iSpanSmall = oLay.getSpanSmall();

		    span = span.toUpperCase();
		    if ((span.substr(0, 1) === "L") && (iSpanLarge > 0) && (iSpanLarge < 13)) {
			oRm.addClass("sapUiRespGridSpanL" + iSpanLarge);
		    } else if ((span.substr(0, 1) === "M") && (iSpanMedium > 0) && (iSpanMedium < 13)) {
			oRm.addClass("sapUiRespGridSpanM" + iSpanMedium);
		    } else if ((span.substr(0, 1) === "S") && (iSpanSmall > 0) && (iSpanSmall < 13)) {
			oRm.addClass("sapUiRespGridSpanS" + iSpanSmall);
		    } else {
			oRm.addClass("sapUiRespGridSpan" + span);
		    }
		}
	    }

	    // Indent
	    var aIndent;

	    var sIndent = oLay.getIndent();
	    if (!sIndent || sIndent.length == 0) {
		aIndent = aDIndent;
	    } else {
		aIndent = INDENTPATTERN.exec(sIndent);
	    }

	    if (!aIndent) {
		aIndent = aDIndent;
		if (!aIndent) {
		    aIndent = undefined; // no indent
		}
	    }

	    if (aIndent) {
		for ( var j = 1; j < aIndent.length; j++) {
		    var indent = aIndent[j];
		    if (!indent) {
			if (aDIndent && aDIndent[j]) {
			    indent = aDIndent[j];
			}
		    }
		    if (indent) {
			indent = indent.toUpperCase();
			if (!(/^(L0)? ?(M0)? ?(S0)?$/.exec(indent))) {

			    // Catch the Individual Indents
			    var iIndentLarge = oLay.getIndentLarge();
			    var iIndentMedium = oLay.getIndentMedium();
			    var iIndentSmall = oLay.getIndentSmall();

			    if ((indent.substr(0, 1) === "L") && (iIndentLarge > 0) && (iIndentLarge < 12)) {
				oRm.addClass("sapUiRespGridIndentL" + iIndentLarge);
			    } else if ((indent.substr(0, 1) === "M") && (iIndentMedium > 0) && (iIndentMedium < 12)) {
				oRm.addClass("sapUiRespGridIndentM" + iIndentMedium);
			    } else if ((indent.substr(0, 1) === "S") && (iIndentSmall > 0) && (iIndentSmall < 12)) {
				oRm.addClass("sapUiRespGridIndentS" + iIndentSmall);
			    } else {
				oRm.addClass("sapUiRespGridIndent" + indent);
			    }
			}
		    }
		}
	    }

	    // Visibility
	    var l = oLay.getVisibleOnLarge(), m = oLay.getVisibleOnMedium(), s = oLay.getVisibleOnSmall();

	    if (!l && m && s) {
		oRm.addClass("sapUiRespGridHiddenL");
	    } else if (!l && !m && s) {
		oRm.addClass("sapUiRespGridVisibleS");
	    } else if (l && !m && !s) {
		oRm.addClass("sapUiRespGridVisibleL");
	    } else if (!l && m && !s) {
		oRm.addClass("sapUiRespGridVisibleM");
	    } else if (l && !m && s) {
		oRm.addClass("sapUiRespGridHiddenM");
	    } else if (l && m && !s) {
		oRm.addClass("sapUiRespGridHiddenS");
	    }

	    // Move - moveBwd shifts a grid element to the left in LTR mode and
	    // opposite in RTL mode

	    var sMoveB = oLay.getMoveBackwards();

	    if (sMoveB && sMoveB.length > 0) {
		var aMoveB = INDENTPATTERN.exec(sMoveB);
		if (aMoveB) {
		    for ( var j = 1; j < aMoveB.length; j++) {
			var moveB = aMoveB[j];
			if (moveB) {
			    oRm.addClass("sapUiRespGridBwd" + moveB.toUpperCase());
			}
		    }
		}
	    }
	    // ... while moveFwd shifts it to the right in LTR mode and opposite
	    // in RTL
	    var sMoveF = oLay.getMoveForward();

	    if (sMoveF && sMoveF.length > 0) {
		var aMoveF = INDENTPATTERN.exec(sMoveF);
		if (aMoveF) {
		    for ( var j = 1; j < aMoveF.length; j++) {
			var moveF = aMoveF[j];
			if (moveF) {
			    oRm.addClass("sapUiRespGridFwd" + moveF.toUpperCase());
			}
		    }
		}
	    }

	    // Internal additional classes
	    if (oLay._sStylesInternal) {
		oRm.addClass(oLay._sStylesInternal);
	    }
	}

	// No layoutData - just apply defaults
	if (!oLay) {
	    var span = "";
	    if (aDSpan) {
		for ( var j = 1; j < aDSpan.length; j++) {
		    span = aDSpan[j];
		    if (!span) {
			span = aDefColSpan[j];
		    }
		    oRm.addClass("sapUiRespGridSpan" + span.toUpperCase());
		}
	    } else {
		for ( var j = 1; j < aDefColSpan.length; j++) {
		    span = aDefColSpan[j];
		    oRm.addClass("sapUiRespGridSpan" + span.toUpperCase());
		}
	    }
	}

	oRm.writeClasses();
	oRm.write(">");

	oRm.renderControl(oItem); // render the child control (could even
	// be a big control tree, but you don't
	// need to care)

	oRm.write("</div>"); // end of the box around the respective child
	oRm.flush(oDomRef, false, this._getDomIndex(iIndex));
	oRm.destroy();
    }
};

sap.ca.ui.GrowingTileContainer.prototype.getHorizontal = function() {
    return false;
}

}; // end of sap/ca/ui/GrowingTileContainer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchicalSelectDialog') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.HierarchicalSelectDialog.
jQuery.sap.declare("sap.ca.ui.HierarchicalSelectDialog");

jQuery.sap.require('sap.m.Dialog'); // unlisted dependency retained



/**
 * Constructor for a new HierarchicalSelectDialog.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getItems items} : sap.ca.ui.HierarchicalSelectDialogItem[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.HierarchicalSelectDialog#event:select select} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.HierarchicalSelectDialog#event:cancel cancel} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.Dialog#constructor sap.m.Dialog}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Select an item in a dialog from a hierarchical list
 * @extends sap.m.Dialog
 *
 * @author Bruno Vicente 
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog
 */
sap.m.Dialog.extend("sap.ca.ui.HierarchicalSelectDialog", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	defaultAggregation : "items",
	aggregations : {
    	"items" : {type : "sap.ca.ui.HierarchicalSelectDialogItem", multiple : true, singularName : "item"}
	},
	events : {
		"select" : {}, 
		"cancel" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.HierarchicalSelectDialog with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.HierarchicalSelectDialog.extend
 * @function
 */

sap.ca.ui.HierarchicalSelectDialog.M_EVENTS = {'select':'select','cancel':'cancel'};


/**
 * Getter for aggregation <code>items</code>.<br/>
 * Type checker, only HierarchicalSelectDialogItem are allowed. Please do NOT use the "content" aggregation of the dialog
 * 
 * @return {sap.ca.ui.HierarchicalSelectDialogItem[]}
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#getItems
 * @function
 */


/**
 * Inserts a item into the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.HierarchicalSelectDialogItem}
 *          oItem the item to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the item should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the item is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the item is inserted at 
 *             the last position        
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#insertItem
 * @function
 */

/**
 * Adds some item <code>oItem</code> 
 * to the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.HierarchicalSelectDialogItem}
 *            oItem the item to add; if empty, nothing is inserted
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#addItem
 * @function
 */

/**
 * Removes an item from the aggregation named <code>items</code>.
 *
 * @param {int | string | sap.ca.ui.HierarchicalSelectDialogItem} vItem the item to remove or its index or id
 * @return {sap.ca.ui.HierarchicalSelectDialogItem} the removed item or null
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#removeItem
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>items</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ca.ui.HierarchicalSelectDialogItem[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#removeAllItems
 * @function
 */

/**
 * Checks for the provided <code>sap.ca.ui.HierarchicalSelectDialogItem</code> in the aggregation named <code>items</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ca.ui.HierarchicalSelectDialogItem}
 *            oItem the item whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#indexOfItem
 * @function
 */
	

/**
 * Destroys all the items in the aggregation 
 * named <code>items</code>.
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#destroyItems
 * @function
 */


/**
 * Thrown when user selects an item 
 *
 * @name sap.ca.ui.HierarchicalSelectDialog#select
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'select' event of this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/> itself. 
 *  
 * Thrown when user selects an item 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/> itself.
 *
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#attachSelect
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'select' event of this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#detachSelect
 * @function
 */

/**
 * Fire event select to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.HierarchicalSelectDialog#fireSelect
 * @function
 */


/**
 * Thrown when user clicks cancel 
 *
 * @name sap.ca.ui.HierarchicalSelectDialog#cancel
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'cancel' event of this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/> itself. 
 *  
 * Thrown when user clicks cancel 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/> itself.
 *
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#attachCancel
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'cancel' event of this <code>sap.ca.ui.HierarchicalSelectDialog</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialog#detachCancel
 * @function
 */

/**
 * Fire event cancel to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.HierarchicalSelectDialog} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.HierarchicalSelectDialog#fireCancel
 * @function
 */


// Start of sap\ca\ui\HierarchicalSelectDialog.js

jQuery.sap.require('sap.m.NavContainer'); // unlisted dependency retained


sap.ca.ui.HierarchicalSelectDialog.prototype.init = function() {

	sap.m.Dialog.prototype.init.apply(this);
    this.addStyleClass("sapCaUiHSD");

	// internal Navigation Container
	this._oNavContainer = new sap.m.NavContainer(this.getId() + 'hsAppContainer', {
		pages : []
	});
	this._pageIdx = 0;

	sap.m.Dialog.prototype.addContent.apply(this, [this._oNavContainer]);

	// create Cancel button
	this.setEndButton(new sap.m.Button({
		text : sap.ca.ui.utils.resourcebundle.getText("hsd.cancelButton"),
		press : jQuery.proxy(function() {

			// close the ResponsivePopover
			this.close();

			// fire cancel event
			this.fireCancel();
		}, this) ,
        width: "100%"
	}));

	this.setShowHeader(false);
	this.setContentWidth('250px');
	this.setContentHeight('350px');

    // "beforeOpen", "afterClose" and "beforeClose" does *NOT* work
    // because the transition never ends and then the NavContainer is
    // in a instable state
    this.attachAfterOpen(function(){

        this._oNavContainer.backToTop();

        // iterate through every pages to clean the search
        var aPages = this._oNavContainer.getPages();
        for (var i = 0; i < aPages.length; ++i){
            var page = aPages[i];
            var oSearchField = sap.ui.getCore().byId(page.getId()+"-searchfield");
            if (oSearchField){
                oSearchField.clear();
            }
        }
    });
};


/**
 * "content" is an aggregation of the ResponsivePopover, we override it to add the content
 * the "items" aggregation but only if the instance is a @see sap.ca.ui.HierarchicalSelectDialogItem
 *
 * Otherwise nothing is done
 *
 * @override
 *
 * @param oContent
 */
sap.ca.ui.HierarchicalSelectDialog.prototype.addContent = function(oContent) {
	if (oContent instanceof sap.ca.ui.HierarchicalSelectDialogItem) {
		this.addItem(oContent);
	} else {
		jQuery.sap.log.error("Only sap.ca.ui.HierarchicalSelectDialogItem are authorized in HierarchicalSelectDialog, also please use the items aggregation")
	}
};
sap.ca.ui.HierarchicalSelectDialog.prototype.addItem = function(oItem) {
	this.insertItem(oItem, this.getItems().length)
}

/**
 * When adding a new item to the aggregation, a sap.m.Page is actually created
 * with its own ID and added to the internal NavContainer.
 *
 * This method calls @see _getPageContent() to build the page content
 *
 * Unless it is the first page, a back button is added
 *
 * @override
 *
 * @param oItem
 * @returns this
 */
sap.ca.ui.HierarchicalSelectDialog.prototype.insertItem = function(oItem, iIndex) {
	// Read the content to parse the HierarchicalSelectDialogItem
	// Generate the pages of the sap.m.App based on those item

	var pageId = "p" + this._pageIdx;
	var pageTitle = oItem.getTitle();
	var entityToBind = oItem.getEntityName();
	var itemTemplate = oItem.getListItemTemplate();
	var nextPageId = "p" + (this._pageIdx + 1);
	// Page Creation
	var list = this._getPageContent(pageId, nextPageId, entityToBind, itemTemplate);
	var page = new sap.m.Page(pageId, {
		title : pageTitle,
		content : list
	});

	var listData = new sap.ui.core.CustomData({
		key : 'list',
		value : list
	});

	var itemTemplateData = new sap.ui.core.CustomData({
		key : 'itemTemplate',
		value : itemTemplate
	});
	// create searchField
	page.setSubHeader(new sap.m.Bar({
		contentMiddle : [new sap.m.SearchField(page.getId() + "-searchfield", {
			placeholder : sap.ca.ui.utils.resourcebundle.getText("hsd.searchTextField"),
			width : "100%",
			liveChange : this._onSearchItem,
			customData : [listData, itemTemplateData]
		})]
	}));

	if (this._pageIdx != 0) {
		page.setShowNavButton(true);
		page.attachNavButtonPress(jQuery.proxy(this._onNavigateBack, this));
		page.onBeforeShow = function(oEvent) {
			jQuery.each(oEvent.data, function(modelName, context) {
				page.setBindingContext(context, modelName);
			})

		};
	}
    else{
        this._oNavContainer.setInitialPage(page);
    }
	if (this._pageIdx > 0) {
		var items = this.getItems();
		items[items.length - 1].getListItemTemplate().setType(sap.m.ListType.Navigation);
	}

	this._oNavContainer.addPage(page);
	this._pageIdx++;

    this.insertAggregation("items", oItem, iIndex);

	return this;
};

/**
 * Adds filter from the searchfield to the list. This is liveSearch (as you type)
 *
 * @param evt
 * @private
 */
sap.ca.ui.HierarchicalSelectDialog.prototype._onSearchItem = function(evt) {
	var searchValue = evt.getParameter("newValue");
	var itemTemplate = evt.getSource().data("itemTemplate");

    var aListItems = evt.getSource().data("list").getBinding("items");
	if (searchValue !== null && searchValue !== "") {
        var availableProperties = itemTemplate.getMetadata().getProperties();
        var aFilterList = [];
        jQuery.each(availableProperties, function(propName, propValue) {
            var bindingInfo = itemTemplate.getBindingInfo(propName);
            if(bindingInfo != null) {
                aFilterList.push(new sap.ui.model.Filter(bindingInfo.binding.getPath(), sap.ui.model.FilterOperator.Contains, searchValue));
             }
        })

		aListItems.filter(new sap.ui.model.Filter(aFilterList, false));
	}
    else {
        aListItems.filter(null);
    }
}

/**
 *
 * Takes the pageId and the nextPageId (for navigation purpose) and creates
 * a sap.m.List bound to the data defined by the user
 *
 * When clicking a item, the navigation is triggered
 *
 * @param pageId
 * @param nextPageId
 * @param entityToBind
 * @param itemTemplate
 * @returns {sap.m.List}
 * @private
 */
sap.ca.ui.HierarchicalSelectDialog.prototype._getPageContent = function(pageId, nextPageId, entityToBind, itemTemplate) {
	var list = new sap.m.List(pageId + "list");
	var data = new sap.ui.core.CustomData({
		key : 'pageId',
		value : nextPageId
	});

	itemTemplate.setType(sap.m.ListType.Active);

	itemTemplate.setIconInset(true);
	itemTemplate.attachPress(jQuery.proxy(this._onItemSelected, this));
	itemTemplate.addCustomData(data);
	list.bindItems(entityToBind, itemTemplate);

	return list;
};

/**
 * Navigates one page back
 *
 * @param channelId
 * @param eventId
 * @param data
 * @private
 */
sap.ca.ui.HierarchicalSelectDialog.prototype._onNavigateBack = function(channelId, eventId, data) {
	this._oNavContainer.back();
};

/**
 * Navigates to the next page
 *
 * @param evt
 * @private
 */
sap.ca.ui.HierarchicalSelectDialog.prototype._onItemSelected = function(evt) {
	var item = evt.getSource();
	var nextPageId = item.data("pageId");
	var nextPage = this._oNavContainer.getPage(nextPageId);
	if (nextPage) {
		//Show Selected Item Label in page header
		nextPage.setTitle(item.getTitle());
		//Navigate
		this._oNavContainer.to(nextPageId, "slide", item.oBindingContexts);
	}
    else {
		this.fireSelect({ selectedItem : item});
		this.close();
	}

};
}; // end of sap/ca/ui/HierarchicalSelectDialog.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchicalSelectDialogItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.HierarchicalSelectDialogItem.
jQuery.sap.declare("sap.ca.ui.HierarchicalSelectDialogItem");

jQuery.sap.require('sap.ui.core.Item'); // unlisted dependency retained



/**
 * Constructor for a new HierarchicalSelectDialogItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getTitle title} : string</li>
 * <li>{@link #getEntityName entityName} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getListItemTemplate listItemTemplate} : sap.m.ListItemBase</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ui.core.Item#constructor sap.ui.core.Item}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * 
 * Kind of item required by the sap.ca.ui.HierarchicalSelectDialog control.
 * An item is actually one page of the Dialog
 * 
 * @extends sap.ui.core.Item
 *
 * @author Bruno Vicente 
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem
 */
sap.ui.core.Item.extend("sap.ca.ui.HierarchicalSelectDialogItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"title" : {type : "string", group : "Appearance", defaultValue : null},
		"entityName" : {type : "string", group : "Data", defaultValue : null}
	},
	aggregations : {
    	"listItemTemplate" : {type : "sap.m.ListItemBase", multiple : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.HierarchicalSelectDialogItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.HierarchicalSelectDialogItem.extend
 * @function
 */


/**
 * Getter for property <code>title</code>.
 * Dialog title for this item
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>title</code>
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#getTitle
 * @function
 */

/**
 * Setter for property <code>title</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.HierarchicalSelectDialogItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#setTitle
 * @function
 */


/**
 * Getter for property <code>entityName</code>.
 * Property used for the binding
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>entityName</code>
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#getEntityName
 * @function
 */

/**
 * Setter for property <code>entityName</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sEntityName  new value for property <code>entityName</code>
 * @return {sap.ca.ui.HierarchicalSelectDialogItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#setEntityName
 * @function
 */


/**
 * Getter for aggregation <code>listItemTemplate</code>.<br/>
 * Used as a template for each list item of the page
 * 
 * @return {sap.m.ListItemBase}
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#getListItemTemplate
 * @function
 */


/**
 * Setter for the aggregated <code>listItemTemplate</code>.
 * @param oListItemTemplate {sap.m.ListItemBase}
 * @return {sap.ca.ui.HierarchicalSelectDialogItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#setListItemTemplate
 * @function
 */
	

/**
 * Destroys the listItemTemplate in the aggregation 
 * named <code>listItemTemplate</code>.
 * @return {sap.ca.ui.HierarchicalSelectDialogItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchicalSelectDialogItem#destroyListItemTemplate
 * @function
 */


// Start of sap\ca\ui\HierarchicalSelectDialogItem.js

}; // end of sap/ca/ui/HierarchicalSelectDialogItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.Hierarchy') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.Hierarchy.
jQuery.sap.declare("sap.ca.ui.Hierarchy");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new Hierarchy.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getHideOptionalLevels hideOptionalLevels} : boolean (default: true)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getItems items} : sap.ca.ui.HierarchyItem[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Display the Hierarchy of an item. Useful to indicates where an object stand in a chain of hierarchical data. The emphasized item shows the one item to display. Optional item can be hidden using the hideOptionalLevels property. Hidden items will stay accessible with an expand button.
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.Hierarchy
 */
sap.ui.core.Control.extend("sap.ca.ui.Hierarchy", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"hideOptionalLevels" : {type : "boolean", group : "Appearance", defaultValue : true}
	},
	aggregations : {
    	"items" : {type : "sap.ca.ui.HierarchyItem", multiple : true, singularName : "item", bindable : "bindable"}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.Hierarchy with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.Hierarchy.extend
 * @function
 */


/**
 * Getter for property <code>hideOptionalLevels</code>.
 * Hide the levels marked optional. An expand button will appear
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>hideOptionalLevels</code>
 * @public
 * @name sap.ca.ui.Hierarchy#getHideOptionalLevels
 * @function
 */

/**
 * Setter for property <code>hideOptionalLevels</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bHideOptionalLevels  new value for property <code>hideOptionalLevels</code>
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#setHideOptionalLevels
 * @function
 */


/**
 * Getter for aggregation <code>items</code>.<br/>
 * The array of HierarchyItem ordered and starting from the root hierarchy
 * 
 * @return {sap.ca.ui.HierarchyItem[]}
 * @public
 * @name sap.ca.ui.Hierarchy#getItems
 * @function
 */


/**
 * Inserts a item into the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.HierarchyItem}
 *          oItem the item to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the item should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the item is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the item is inserted at 
 *             the last position        
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#insertItem
 * @function
 */

/**
 * Adds some item <code>oItem</code> 
 * to the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.HierarchyItem}
 *            oItem the item to add; if empty, nothing is inserted
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#addItem
 * @function
 */

/**
 * Removes an item from the aggregation named <code>items</code>.
 *
 * @param {int | string | sap.ca.ui.HierarchyItem} vItem the item to remove or its index or id
 * @return {sap.ca.ui.HierarchyItem} the removed item or null
 * @public
 * @name sap.ca.ui.Hierarchy#removeItem
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>items</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ca.ui.HierarchyItem[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.Hierarchy#removeAllItems
 * @function
 */

/**
 * Checks for the provided <code>sap.ca.ui.HierarchyItem</code> in the aggregation named <code>items</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ca.ui.HierarchyItem}
 *            oItem the item whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.Hierarchy#indexOfItem
 * @function
 */
	

/**
 * Destroys all the items in the aggregation 
 * named <code>items</code>.
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#destroyItems
 * @function
 */


/**
 * Binder for aggregation <code>items</code>.
 *
 * @param {string} sPath path to a list in the model 
 * @param {sap.ui.core.Element} oTemplate the control template for this aggregation
 * @param {sap.ui.model.Sorter} oSorter the initial sort order (optional)
 * @param {array} aFilters the predefined filters for this aggregation (optional)
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#bindItems
 * @function
 */

/**
 * Unbinder for aggregation <code>items</code>.
 *
 * @return {sap.ca.ui.Hierarchy} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Hierarchy#unbindItems
 * @function
 */


// Start of sap\ca\ui\Hierarchy.js
///**
// * This file defines behavior for the control,
// */

sap.ca.ui.Hierarchy.prototype._getExpandButton = function () {
    return new sap.m.Link({text:"...", press:jQuery.proxy(this.expand,this)});
};

sap.ca.ui.Hierarchy.prototype.expand = function (e) {
    var oBtn = e.getSource();
    var $expandedLine = oBtn.$().parent();
    var $lineContent = $expandedLine.children(".sapCaUiHierarchyItem");
    oBtn.$().remove();
    jQuery($lineContent).removeClass("sapCaUiHierarchyHidden");
    var aLines = jQuery(".sapCaUiHierarchyItemLine");
    var bShow = false;
    jQuery.each(aLines, function (i, $line) {
        // We found the expanded line so we will start display the hidden lines
        if ($line == $expandedLine[0]) {
            bShow = true;
            return;
        }
        if (bShow) {
            if (jQuery($line).hasClass("sapCaUiHierarchyHidden")) {
                jQuery($line).removeClass("sapCaUiHierarchyHidden");
            } else {
                // No more hidden lines so we stop to not display other lines that are not directly related
                bShow = false;
                return;
            }
        }
    });
    this.indent();
};

sap.ca.ui.Hierarchy.prototype.onAfterRendering = function () {
    this.indent();
    jQuery(window).resize(jQuery.proxy(this.indent, this));
};

sap.ca.ui.Hierarchy.prototype.exit = function () {
    jQuery(window).unbind("resize", jQuery.proxy(this.indent, this));
};

// We handle the indentation here to handle the 50% limit of indentation
sap.ca.ui.Hierarchy.prototype.indent = function () {
    var step = 20;
    var minIndent = 8;
    var minWidth = step;
    var lines = jQuery(".sapCaUiHierarchyItemLine").not(".sapCaUiHierarchyHidden");
    var maxWidth = this.$().width() * 0.5;
    var maxIndent = (step * lines.length) + minIndent;
    if (maxIndent > maxWidth) {
        step = Math.floor(maxWidth / lines.length);
    }
    jQuery.each(lines, function (i, line) {
        // When it's the first line we don't have an icon so we don't bother doing the work
        if (i > 0) {
            var $iconDiv = jQuery(line).children(".sapCaUiHierarchyIconContainer");
            var w = i * step;
            if (w < minWidth) {
                w = minWidth;
            }
            jQuery($iconDiv).width(w + minIndent + "px").css("min-width", w + minIndent + "px");
        }
    });
};




}; // end of sap/ca/ui/Hierarchy.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.HierarchyItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.HierarchyItem.
jQuery.sap.declare("sap.ca.ui.HierarchyItem");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new HierarchyItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getIcon icon} : sap.ui.core.URI</li>
 * <li>{@link #getLevelType levelType} : string</li>
 * <li>{@link #getTitle title} : string</li>
 * <li>{@link #getIdentifier identifier} : string</li>
 * <li>{@link #getLink link} : string</li>
 * <li>{@link #getEmphasized emphasized} : boolean (default: false)</li>
 * <li>{@link #getOptional optional} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.HierarchyItem#event:linkPress linkPress} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Item that represent a line of the Hierarchy control. The emphasized property should apply to the item that we want to represent in his hierarchy. Optionals item will be hidden if the option is true on the Hierarchy control.
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.HierarchyItem
 */
sap.ui.core.Control.extend("sap.ca.ui.HierarchyItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"icon" : {type : "sap.ui.core.URI", group : "Appearance", defaultValue : null},
		"levelType" : {type : "string", group : "Data", defaultValue : null},
		"title" : {type : "string", group : "Data", defaultValue : null},
		"identifier" : {type : "string", group : "Data", defaultValue : null},
		"link" : {type : "string", group : "Data", defaultValue : null},
		"emphasized" : {type : "boolean", group : "Data", defaultValue : false},
		"optional" : {type : "boolean", group : "Data", defaultValue : false}
	},
	aggregations : {
    	"_iconControl" : {type : "sap.ui.core.Icon", multiple : false, visibility : "hidden"}, 
    	"_levelTypeLabel" : {type : "sap.m.Label", multiple : false, visibility : "hidden"}, 
    	"_identifierLabel" : {type : "sap.m.Label", multiple : false, visibility : "hidden"}, 
    	"_titleLabel" : {type : "sap.m.Label", multiple : false, visibility : "hidden"}, 
    	"_linkControl" : {type : "sap.m.Link", multiple : false, visibility : "hidden"}
	},
	events : {
		"linkPress" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.HierarchyItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.HierarchyItem.extend
 * @function
 */

sap.ca.ui.HierarchyItem.M_EVENTS = {'linkPress':'linkPress'};


/**
 * Getter for property <code>icon</code>.
 * Icon for the item
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.URI} the value of property <code>icon</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getIcon
 * @function
 */

/**
 * Setter for property <code>icon</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.URI} sIcon  new value for property <code>icon</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setIcon
 * @function
 */


/**
 * Getter for property <code>levelType</code>.
 * Level type
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>levelType</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getLevelType
 * @function
 */

/**
 * Setter for property <code>levelType</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sLevelType  new value for property <code>levelType</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setLevelType
 * @function
 */


/**
 * Getter for property <code>title</code>.
 * Title
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>title</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getTitle
 * @function
 */

/**
 * Setter for property <code>title</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setTitle
 * @function
 */


/**
 * Getter for property <code>identifier</code>.
 * Identifier text
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>identifier</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getIdentifier
 * @function
 */

/**
 * Setter for property <code>identifier</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sIdentifier  new value for property <code>identifier</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setIdentifier
 * @function
 */


/**
 * Getter for property <code>link</code>.
 * Text of the link
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>link</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getLink
 * @function
 */

/**
 * Setter for property <code>link</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sLink  new value for property <code>link</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setLink
 * @function
 */


/**
 * Getter for property <code>emphasized</code>.
 * Does the item looks emphasized
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>emphasized</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getEmphasized
 * @function
 */

/**
 * Setter for property <code>emphasized</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bEmphasized  new value for property <code>emphasized</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setEmphasized
 * @function
 */


/**
 * Getter for property <code>optional</code>.
 * Is the item optional, so we hide it if option is set on the Hierarchy control
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>optional</code>
 * @public
 * @name sap.ca.ui.HierarchyItem#getOptional
 * @function
 */

/**
 * Setter for property <code>optional</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bOptional  new value for property <code>optional</code>
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#setOptional
 * @function
 */


/**
 * Event when a link is pressed 
 *
 * @name sap.ca.ui.HierarchyItem#linkPress
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'linkPress' event of this <code>sap.ca.ui.HierarchyItem</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.HierarchyItem</code>.<br/> itself. 
 *  
 * Event when a link is pressed 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.HierarchyItem</code>.<br/> itself.
 *
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#attachLinkPress
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'linkPress' event of this <code>sap.ca.ui.HierarchyItem</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.HierarchyItem#detachLinkPress
 * @function
 */

/**
 * Fire event linkPress to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.HierarchyItem} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.HierarchyItem#fireLinkPress
 * @function
 */


// Start of sap\ca\ui\HierarchyItem.js
///**
// * This file defines behavior for the control,
// */

jQuery.sap.require('sap.ui.layout.VerticalLayout'); // unlisted dependency retained



sap.ca.ui.HierarchyItem.prototype.init = function () {
};

sap.ca.ui.HierarchyItem.prototype._getIconControl = function () {
    var oIcon = this.getAggregation("_iconControl");
    if (oIcon == undefined) {
        oIcon = new sap.ui.core.Icon({
            src:this.getProperty("icon"),
            color:sap.ui.core.theming.Parameters.get("sapUiLightText")
        }).addStyleClass("sapCaUiHierarchyItemIcon");
        this.setAggregation("_iconControl", oIcon);
    }
    return oIcon;
};
sap.ca.ui.HierarchyItem.prototype._getLevelTypeLabel = function () {
    var oLevelTypeLabel = this.getAggregation("_levelTypeLabel");
    if (oLevelTypeLabel == undefined) {
        oLevelTypeLabel = new sap.m.Label({
            text:this.getProperty("levelType")
        }).addStyleClass("sapCaUiHierarchyItemLevelTypeLbl");
        this.setAggregation("_levelTypeLabel", oLevelTypeLabel);
    }
    return oLevelTypeLabel;
};
sap.ca.ui.HierarchyItem.prototype._getIdentifierLabel = function () {
    var oIdentifierLabel = this.getAggregation("_identifierLabel");
    if (oIdentifierLabel == undefined) {
        oIdentifierLabel = new sap.m.Label({
            text:this.getProperty("identifier")
        }).addStyleClass("sapCaUiHierarchyItemIdentifierLbl");
        this.setAggregation("_identifierLabel", oIdentifierLabel);
    }
    return oIdentifierLabel;
};
sap.ca.ui.HierarchyItem.prototype._getTitleLabel = function () {
    var oTitleLabel = this.getAggregation("_titleLabel");
    if (oTitleLabel == undefined) {
        oTitleLabel = new sap.m.Label({
            text:this.getProperty("title")
        }).addStyleClass("sapCaUiHierarchyItemTitleLbl");
        this.setAggregation("_titleLabel", oTitleLabel);
    }
    return oTitleLabel;
};
sap.ca.ui.HierarchyItem.prototype._getLinkControl = function () {
    var oLinkControl = this.getAggregation("_linkControl");
    if (oLinkControl == undefined) {
        oLinkControl = new sap.m.Link({
            text:this.getProperty("link")
        }).addStyleClass("sapCaUiHierarchyItemLink");
        oLinkControl.attachPress(this.fireLinkPress, this);
        this.setAggregation("_linkControl", oLinkControl);
    }
    return oLinkControl;
};



}; // end of sap/ca/ui/HierarchyItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.InPlaceEdit') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.InPlaceEdit.
jQuery.sap.declare("sap.ca.ui.InPlaceEdit");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new InPlaceEdit.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getValueState valueState} : sap.ui.core.ValueState (default: sap.ui.core.ValueState.None)</li>
 * <li>{@link #getUndoEnabled undoEnabled} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.InPlaceEdit#event:change change} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * 
 * This control is used to switch between readonly and edit modes. A typical use case would be to change the value of a Label.
 * 
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.InPlaceEdit
 */
sap.ui.core.Control.extend("sap.ca.ui.InPlaceEdit", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"clearOldText"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"valueState" : {type : "sap.ui.core.ValueState", group : "Data", defaultValue : sap.ui.core.ValueState.None},
		"undoEnabled" : {type : "boolean", group : "Misc", defaultValue : false}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : false}
	},
	events : {
		"change" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.InPlaceEdit with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.InPlaceEdit.extend
 * @function
 */

sap.ca.ui.InPlaceEdit.M_EVENTS = {'change':'change'};


/**
 * Getter for property <code>valueState</code>.
 * Visualizes warnings or errors related to the InPlaceEdit. Possible values: Warning, Error, Success.
 * If the content control has a own valueState property this will be used.
 *
 * Default value is <code>None</code>
 *
 * @return {sap.ui.core.ValueState} the value of property <code>valueState</code>
 * @public
 * @name sap.ca.ui.InPlaceEdit#getValueState
 * @function
 */

/**
 * Setter for property <code>valueState</code>.
 *
 * Default value is <code>None</code> 
 *
 * @param {sap.ui.core.ValueState} oValueState  new value for property <code>valueState</code>
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#setValueState
 * @function
 */


/**
 * Getter for property <code>undoEnabled</code>.
 * If undo is enabled after changing the text an undo button appears.
 * 
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>undoEnabled</code>
 * @public
 * @name sap.ca.ui.InPlaceEdit#getUndoEnabled
 * @function
 */

/**
 * Setter for property <code>undoEnabled</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bUndoEnabled  new value for property <code>undoEnabled</code>
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#setUndoEnabled
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * Content control of the InPlaceEdit.
 * The following control is allowed: sap.m.Input, sap.m.Link
 * 
 * @return {sap.ui.core.Control}
 * @public
 * @name sap.ca.ui.InPlaceEdit#getContent
 * @function
 */


/**
 * Setter for the aggregated <code>content</code>.
 * @param oContent {sap.ui.core.Control}
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#setContent
 * @function
 */
	

/**
 * Destroys the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#destroyContent
 * @function
 */


/**
 * Event is fired when the text in the field has changed AND the focus leaves the InPlaceEdit or the Enter key is pressed. 
 *
 * @name sap.ca.ui.InPlaceEdit#change
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @param {string} oControlEvent.getParameters.newValue The new / changed value of the InPlaceEdit.
 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'change' event of this <code>sap.ca.ui.InPlaceEdit</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.InPlaceEdit</code>.<br/> itself. 
 *  
 * Event is fired when the text in the field has changed AND the focus leaves the InPlaceEdit or the Enter key is pressed. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.InPlaceEdit</code>.<br/> itself.
 *
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#attachChange
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'change' event of this <code>sap.ca.ui.InPlaceEdit</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.InPlaceEdit#detachChange
 * @function
 */

/**
 * Fire event change to attached listeners.
 * 
 * Expects following event parameters:
 * <ul>
 * <li>'newValue' of type <code>string</code> The new / changed value of the InPlaceEdit.</li>
 * </ul>
 *
 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.InPlaceEdit} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.InPlaceEdit#fireChange
 * @function
 */


/**
 * Clear the old text after a change to disable the undo functionality. If undoEnabled is false this has no effect.
 *
 * @name sap.ca.ui.InPlaceEdit.prototype.clearOldText
 * @function

 * @type void
 * @public
 */


// Start of sap\ca\ui\InPlaceEdit.js
jQuery.sap.require('sap.m.Input'); // unlisted dependency retained

jQuery.sap.require('sap.m.Select'); // unlisted dependency retained

jQuery.sap.require('sap.m.Link'); // unlisted dependency retained


/*
 * On focus the InplaceEdit automatically switches to edit mode. Only for Links it stays in display mode to allow link-clicking.
 * When the focus is set outside the control is switches back to display mode. So for styling it is clear that edit mode
 * is always focused. The focusout handling must be done with a delay because in ComboBoxes the click of the expand button fires a focusout event too.
 * So it must be checked if the focus is still inside the control.
 * As the content controls don't bubble their property changes the _change event is handled. Because the InPlaceEdit have to react on content-changes.
 * Changing the content needs a rerendering of the InPlaceEdit. Toggling edit mode also rerenders the control.
 * The focusDomRef is in display mode the display control, in edit mode the edit control.
 * So as the control often rerenders and changes the focusDomRef be careful if you put the control in an ItemNavigation. (Update the DomRefs!)
 */

sap.ca.ui.InPlaceEdit.prototype.init = function() {

	this._bEditMode = false;

};

sap.ca.ui.InPlaceEdit.prototype.exit = function() {

	this._bEditMode = undefined;
	this._oDisplayControl = undefined;
	this._oEditControl = undefined;
	this._sOldText = undefined;
	this._sOldTextAvailable = undefined;
	this._bUseEditButton = undefined;
	this._iHeight = undefined;

	if (this._oTextView) {
		this._oTextView.destroy();
		delete this._oTextView;
	}

	if (this._oTextField) {
		this._oTextField.destroy();
		delete this._oTextField;
	}

	if (this._oUndoButton) {
		this._oUndoButton.destroy();
		delete this._oUndoButton;
	}

	if (this._oEditButton) {
		this._oEditButton.destroy();
		delete this._oEditButton;
	}

	var oContent = this.getContent();
	if (oContent) {
		oContent.detachEvent("_change", this._handleContentInvalidate, this);
		if (oContent instanceof sap.m.Input) {
			oContent.detachEvent("change", this._handleContentChange, this);
			oContent.detachEvent("liveChange",this._handleContentLiveChange, this);
		}
	}
};

sap.ca.ui.InPlaceEdit.prototype.onBeforeRendering = function() {

	// detach events
	if (!jQuery.device.is.desktop) {
		//this.$().off("focusin focus", jQuery.proxy(this.onfocusin, this));
		this.$().off("focusout blur", jQuery.proxy(this.onfocusout, this));
	}


	this._updateControls();

	this._createUndoButton(); // create here, because if created onfocusin there are focus errors

};

sap.ca.ui.InPlaceEdit.prototype.onAfterRendering = function() {
	// attach events
	if (!jQuery.device.is.desktop) {
		//this.$().on("focusin focus", jQuery.proxy(this.onfocusin, this));
		this.$().on("focusout blur", jQuery.proxy(this.onfocusout, this));
	}

	//
	// Warning: This method is called several times, for example after the child controls
	//          are (re-)rendered.
	//

	// if TextView is rendered make it not focusable (only InPlaceEdit is focused)
	if (!this._bEditMode && this.getEditable() && this._oTextView && jQuery.sap.domById(this._oTextView.getId())) {
		jQuery.sap.byId(this._oTextView.getId()).attr("tabindex", "0");
	}

	var $Control = jQuery.sap.byId(this.getId());
	// In edit mode use 100% width for edit control, because width is set outside
	if (this._bEditMode) {
		jQuery.sap.byId(this._oEditControl.getId()).css("width", "100%");
		if (this._iHeight > 0) {
			// Control is in display mode higher than in edit mode
			// add margins to center edit control
			var iOuterHeight = $Control.height();
			var iDelta = this._iHeight - iOuterHeight;
			// check if already margins added and add them
			var iMargins = $Control.outerHeight(true) - $Control.outerHeight(false);
			iDelta = iDelta + iMargins;
			var iMarginTop = Math.floor(iDelta / 2);
			var iMarginBottom = iDelta - iMarginTop;
			$Control.css("margin-top", iMarginTop + "px").css("margin-bottom", iMarginBottom + "px");
		}
	} else if (this._oDisplayControl instanceof sap.m.Link) {
		// edit icon should be directly next to link
		jQuery.sap.byId(this._oDisplayControl.getId()).css("width", "auto").css("max-width", "100%");
	} else {
		var $DisplayControl = jQuery.sap.byId(this._oDisplayControl.getId());
		$DisplayControl.css("width", "100%");
		if (!this._iHeight && this._iHeight != 0) {
			// check if TextView is higher than inPlaceEdits standards height (Header design) ->
			// set to this new height even in edit mode to avoid flickering
			// special case: standard TextView has line height of textFields height in most themes
			// but font size fits. in this case the height should not be changed.
			var iInnerHeight = $DisplayControl.outerHeight(true);
			var iOuterHeight = $Control.innerHeight();
			if (iOuterHeight < iInnerHeight) {
				// because of box-sizing: border-box add borders to height
				var iOffset = $Control.outerHeight() - $Control.innerHeight();
				this._iHeight = iInnerHeight + iOffset;
			} else {
				this._iHeight = 0;
			}
		}
		if (this._iHeight > 0) {
			$Control.css("height", this._iHeight + "px");
		}
	}

	// if undo button is rendered remove it from tab-chain
	if (this._sOldTextAvailable && this._oUndoButton && jQuery.sap.domById(this._oUndoButton.getId())) {
		jQuery.sap.byId(this._oUndoButton.getId()).attr("tabindex", "-1");
	}
	if (this._oEditButton && jQuery.sap.domById(this._oEditButton.getId())) {
		jQuery.sap.byId(this._oEditButton.getId()).attr("tabindex", "-1");
	}

	if (this._delayedCallId) {
		jQuery.sap.clearDelayedCall(this._delayedCallId);
		this._delayedCallId = null;
	}

	if (this.getValueState() == sap.ui.core.ValueState.Success) {
		this._delayedCallId = jQuery.sap.delayedCall(3000, this, "removeValidVisualization");
	}

};

sap.ca.ui.InPlaceEdit.prototype.removeValidVisualization = function() {

	var oDomRef = jQuery.sap.byId(this.getId());
	if (oDomRef) {
		oDomRef.removeClass("sapCaUiIpeSucc");
	}

};

sap.ca.ui.InPlaceEdit.prototype.clearOldText = function() {

	if (!this.getUndoEnabled()) {
		return;
	}

	if (this._bEditMode) {
		this._sOldText = this._oEditControl.getValue();
		this._sOldTextAvailable = true; // because "" can be a valid text so check for sOldText will not work in this case
	} else {
		this._sOldText = undefined;
		this._sOldTextAvailable = false;
	}
	this.rerender();

};

/*
 * If a label is assigned to the InPlaceEdit it need to know if it's required
 * So check the content for required
 * @public
 */
sap.ca.ui.InPlaceEdit.prototype.getRequired = function() {

	if (this.getContent() && this.getContent().getRequired) {
		return this.getContent().getRequired();
	} else {
		return false;
	}

};

sap.ca.ui.InPlaceEdit.prototype.getEditable = function() {

	var oContent = this.getContent();

	if ((oContent.getEditable && !oContent.getEditable()) || (oContent.getEnabled && !oContent.getEnabled())) {
		// readOnly or disabled -> only display mode
		return false;
	} else {
		return true;
	}

};

sap.ca.ui.InPlaceEdit.prototype.onsapescape = function(oEvent) {

	if (this.getUndoEnabled()) {
		// Escape fires no keypress in webkit
		// In Firefox value can not be changed in keydown (onsapescape) event
		// So the escape event is stored in this._bEsc and the value in this._sValue
		if (!!!sap.ui.Device.browser.firefox) {
			this._undoTextChange();
		} else {
			this._bEsc = true;
		}
		if (jQuery.sap.byId(this.getId()).hasClass("sapCaUiIpeUndo")) {
			// undo is possible -> do not propagate escape (not close popup)
			oEvent.stopPropagation();
		}
		// delete TextFields escape information, because native ESC-logic not needed
		this._oEditControl._bEsc = undefined;
		this._oEditControl._sValue = undefined;
	}

};

sap.ca.ui.InPlaceEdit.prototype.onkeypress = function(oEvent) {

	// Firefox escape logic
	if (this._bEsc) {
		this._bEsc = undefined;
		this._undoTextChange();
	}

};

sap.ca.ui.InPlaceEdit.prototype.onkeydown = function(oEvent) {

	if (oEvent.keyCode == jQuery.sap.KeyCodes.F2 && !this._bEditMode) {
		this._switchToEditMode();
		jQuery.sap.byId(this.getId()).addClass("sapCaUiIpeFocus");
	}

};

sap.ca.ui.InPlaceEdit.prototype.ontap = function(oEvent) {
	if (!jQuery.device.is.desktop)
		this.onfocusin(oEvent);
};

sap.ca.ui.InPlaceEdit.prototype.onfocusin = function(oEvent) {

	// in display mode focus is on displayControl -> simulate focus on outer DIV
	if (!this._bEditMode) {
		if (!this._bUseEditButton && oEvent.target.id != this.getId() + "--X") {
			// if not a link and not clicked on undo button -> directly switch to edit mode
			this._switchToEditMode();
		}
		jQuery.sap.byId(this.getId()).addClass("sapCaUiIpeFocus");
	}

};

sap.ca.ui.InPlaceEdit.prototype.onfocusout = function(oEvent) {

	if (this._focusDelay) {
		jQuery.sap.clearDelayedCall(this._focusDelay);
		this._focusDelay = null;
	}
	this._focusDelay = jQuery.sap.delayedCall(200, this, "_handleFocusOut", arguments); // check delayed because click of ComboBox Expander (shorter than 200 sometimes don't work)

};

sap.ca.ui.InPlaceEdit.prototype._handleFocusOut = function(oEvent) {

	var oFocusedDom = document.activeElement;
	if (!jQuery.sap.containsOrEquals(this.getDomRef(), oFocusedDom)) {
		// focus is not inside of the InPlaceEdit
		// in display mode focus is on displayControl -> simulate focus on outer DIV
		if (!this._bEditMode) {
			jQuery.sap.byId(this.getId()).removeClass("sapCaUiIpeFocus");
		}
		this._switchToDisplayMode();
	}

};

sap.ca.ui.InPlaceEdit.prototype.setContent = function(oContent) {

	var oOldContent = this.getContent();
	if (oOldContent) {
		oOldContent.detachEvent("_change", this._handleContentInvalidate, this);
		if (oOldContent instanceof sap.m.Input) {
			oOldContent.detachEvent("change", this._handleContentChange, this);
			oOldContent.detachEvent("liveChange", this._handleContentLiveChange, this);
			oOldContent._propagateEsc = undefined;
		}
	}
	this._sOldText = undefined;
	this._sOldTextAvailable = false;
	this._oDisplayControl = undefined;
	this._oEditControl = undefined;

	this.setAggregation("content", oContent);

	if (oContent) {
		// As controls don't bubble their invalidate we have to use the _change event
		oContent.attachEvent("_change", this._handleContentInvalidate, this);
		if (oContent instanceof sap.m.Input) {
			oContent.attachEvent("change", this._handleContentChange, this);
			oContent.attachEvent("liveChange", this._handleContentLiveChange, this);
			oContent._propagateEsc = true;
		}
	}

	this._updateControls();

};

// since some Properties and the change event are not available on all controls (Link)
// have it as property on InPlaceEdit too. If Content-control has the property too just forward it to
// the content control
// ! what's about setting property before adding content? !
sap.ca.ui.InPlaceEdit.prototype.setValueState = function(oValueState) {

	var oContent = this.getContent();

	if (oContent && oContent.setValueState) {
		oContent.setValueState(oValueState);
	} else if (this._oEditControl && this._oEditControl.setValueState) {
		this._oEditControl.setValueState(oValueState);
		_handleContentInvalidate.call(this);
	} else {
		this.setProperty("valueState", oValueState);
	}

};

sap.ca.ui.InPlaceEdit.prototype.getValueState = function() {

	var oContent = this.getContent();

	if (oContent && oContent.getValueState) {
		return oContent.getValueState();
	} else if (this._oEditControl && this._oEditControl.getValueState) {
		return this._oEditControl.getValueState();
	} else {
		return this.getProperty("valueState");
	}

};

/**
 * Sets a new tooltip for this InPlaceEdit. The tooltip can either be a simple string
 * (which in most cases will be rendered as the <code>title</code> attribute of this
 * Element) or an instance of {@link sap.ui.core.TooltipBase}.
 *
 * If a new tooltip is set, any previously set tooltip is deactivated.
 *
 * If a content control is assigned to the InPlaceEdit the tooltip of this control
 * is used. A directly set tooltip to the InPlaceEdit is ignored in this case.
 *
 * @param {string|sap.ui.core.TooltipBase} oTooltip.
 * @public
 */
sap.ca.ui.InPlaceEdit.prototype.setTooltip = function(oTooltip) {

	var oContent = this.getContent();

	if (oContent) {
		oContent.setTooltip(oTooltip);
	} else {
		if (oTooltip instanceof sap.ui.core.TooltipBase) {
			oTooltip._currentControl = this;
			this.addDelegate(oTooltip);
		}
		this.setAggregation("tooltip", oTooltip);
	}

	return this;

};

/**
 * Returns the tooltip for this InPlaceEdit if any or an undefined value.
 * The tooltip can either be a simple string or a subclass of
 * {@link sap.ui.core.TooltipBase}.
 *
 * Callers that are only interested in tooltips of type string (e.g. to render
 * them as a <code>title</code> attribute), should call the convenience method
 * {@link #getTooltip_AsString} instead. If they want to get a tooltip text no
 * matter where it comes from (be it a string tooltip or the text from a TooltipBase
 * instance) then they could call {@link #getTooltip_Text} instead.
 *
 * If a content control is assigned to the InPlaceEdit the tooltip of this control
 * is used. A directly set tooltip to the InPlaceEdit is ignored in this case.
 *
 * @return {string|sap.ui.core.TooltipBase} The tooltip for this Element.
 * @public
 */
sap.ca.ui.InPlaceEdit.prototype.getTooltip = function() {

	var oContent = this.getContent();

	if (oContent) {
		return oContent.getTooltip();
	} else {
		return this.getAggregation("tooltip");
	}

};

sap.ca.ui.InPlaceEdit.prototype.clone = function() {

	// on clone don't clone event handler
	var oContent = this.getContent();
	if (oContent) {
		oContent.detachEvent("_change", this._handleContentInvalidate, this);
		if (oContent instanceof sap.m.Input) {
			oContent.detachEvent("change", this._handleContentChange, this);
			oContent.detachEvent("liveChange", this._handleContentLiveChange, this);
		}
	}

	var oClone = sap.ui.core.Control.prototype.clone.apply(this, arguments);

	if (oContent) {
		oContent.attachEvent("_change", this._handleContentInvalidate, this);
		if (oContent instanceof sap.m.Input) {
			oContent.attachEvent("change", this._handleContentChange, this);
			oContent.attachEvent("liveChange", this._handleContentLiveChange, this);
		}
	}

	return oClone;

};

sap.ca.ui.InPlaceEdit.prototype.getFocusDomRef = function() {

	if (!this.getDomRef()) {
		// not rendered
		return;
	}

	// focus is on inner control (display or edit)
	if (this._bEditMode) {
		return this._oEditControl.getFocusDomRef();
	} else {
		return this._oDisplayControl.getFocusDomRef();
	}

};

sap.ca.ui.InPlaceEdit.prototype.getIdForLabel = function() {

	// point the label to the edit control because on tabbing in its in edit mode
	// only link must get label on it self

	if (this._oDisplayControl) {
		return this._oDisplayControl.getId();
	} else if (this._oEditControl) {
		return this._oEditControl.getId();
	} else {
		return this.getId();
	}

};

// Private variables

/**
 * Delegate object for listening to the child elements' events.
 * WARNING: this is set to the InPlaceEdit-instance. This is done by setting it as the second
 *          parameter of the addDelegate call. (See updateControls())
 * @private
 */
sap.ca.ui.InPlaceEdit.prototype._contentDelegate = {
	onAfterRendering : function() {
		this.onAfterRendering(); // WARNING: this means the InPlaceEdit instance
	}
};

// Private functions

sap.ca.ui.InPlaceEdit.prototype._updateControls = function() {

    var oInPlaceEdit = this;
	var oContent = oInPlaceEdit.getContent();
	if (!oContent) {
		return;
	}

	// do not check with instanceof because then all classes must be loaded
	switch (oContent.getMetadata().getName()) {
		case "sap.m.Input" :
		case "sap.m.Select" :
			// use TextView for display
			if (!oInPlaceEdit._oTextView) {
				oInPlaceEdit._oTextView = new sap.m.Text(oInPlaceEdit.getId() + "--TV", {
					wrapping : false
				});
				oInPlaceEdit._oTextView.setParent(oInPlaceEdit);
				// Make sure the delegate is not there twice
				oInPlaceEdit._oTextView.removeDelegate(this._contentDelegate);
				oInPlaceEdit._oTextView.addDelegate(this._contentDelegate, oInPlaceEdit);
			}
			oInPlaceEdit._oTextView.setText(oContent.getValue());
			//oInPlaceEdit._oTextView.setEnabled(oContent.getEnabled());
			//oInPlaceEdit._oTextView.setTextDirection(oContent.getTextDirection());
			oInPlaceEdit._oTextView.setVisible(oContent.getVisible());
			oInPlaceEdit._oTextView.setWidth("100%"); // width is set on the outer DIV
			//oInPlaceEdit._oTextView.setTooltip(sap.ui.core.ValueStateSupport.enrichTooltip(oInPlaceEdit, oContent.getTooltip_AsString()));

			oInPlaceEdit._oDisplayControl = oInPlaceEdit._oTextView;

			// use oContent for edit
			oInPlaceEdit._oEditControl = oContent;
			oInPlaceEdit._bUseEditButton = false;
			break;

		case "sap.m.Link" :
			// use Link for display
			oInPlaceEdit._oDisplayControl = oContent;

			// Make sure the delegate is not there twice
			oInPlaceEdit._oDisplayControl.removeDelegate(this._contentDelegate);
			oInPlaceEdit._oDisplayControl.addDelegate(this._contentDelegate, oInPlaceEdit);

			// use TextField for edit
			if (oInPlaceEdit._oTextField) {
				oInPlaceEdit._oTextField.setValue(oContent.getText());
				oInPlaceEdit._oTextField.setWidth("100%");
				oInPlaceEdit._oTextField.setTooltip(oContent.getTooltip()); // value state text is added in TextField

				oInPlaceEdit._oEditControl = oInPlaceEdit._oTextField;
			}

			// for link an edit button is needed to allow the link click
			this._createEditButton();
			oInPlaceEdit._bUseEditButton = true;
			break;

		default :
			throw new Error("Control '" + oContent.getMetadata().getName() + "' not supported for InPlaceEdit");
			break;
	}

};

sap.ca.ui.InPlaceEdit.prototype._switchToEditMode = function() {
    var oInPlaceEdit = this;

	if (!oInPlaceEdit._bEditMode && oInPlaceEdit.getEditable()) {
		// switch to edit mode
		if (!oInPlaceEdit._oEditControl && oInPlaceEdit.getContent().getMetadata().getName() == "sap.m.Link") {
			// for Link - create TextField (Only on first edit mode to do not have it if not needed)
			var sValueState = oInPlaceEdit.getValueState(); // initially get ValueState from property, after this its stored on the TextField
			oInPlaceEdit._oTextField = new sap.m.Input(oInPlaceEdit.getId() + "--input", {
				valueState : sValueState
			});
			oInPlaceEdit._oTextField.attachEvent('change', this._handleTextFieldChange, oInPlaceEdit); // attach event this way to have the right this-reference in handler
			oInPlaceEdit._oTextField.attachEvent('liveChange', this._handleContentLiveChange, oInPlaceEdit); // attach event this way to have the right this-reference in handler
			oInPlaceEdit._oTextField._propagateEsc = true;
		}

		if (!oInPlaceEdit._sOldTextAvailable && oInPlaceEdit.getUndoEnabled()) {
			// only remember original text, not by toggling between edit and display
			oInPlaceEdit._sOldText = this._getContentText();
			oInPlaceEdit._sOldTextAvailable = true;
		}
		oInPlaceEdit._bEditMode = true;
		oInPlaceEdit.rerender();
		oInPlaceEdit._oEditControl.focus();
	}

};

sap.ca.ui.InPlaceEdit.prototype._switchToDisplayMode = function() {
    var oInPlaceEdit = this;

	if (oInPlaceEdit._bEditMode && oInPlaceEdit.getEditable()) {
		// switch to edit mode
		oInPlaceEdit._bEditMode = false;
		if (oInPlaceEdit._sOldText == this._getContentText()) {
			// nothing changed
			oInPlaceEdit._sOldText = undefined;
			oInPlaceEdit._sOldTextAvailable = false;
		}
		oInPlaceEdit.rerender();
	}

};

sap.ca.ui.InPlaceEdit.prototype._getContentText = function() {
    var oInPlaceEdit = this;

	var oContent = oInPlaceEdit.getContent();
	if (!oContent) {
		return;
	}

	if (oContent.getValue) {
		return oContent.getValue();
	} else if (oContent.getText) {
		return oContent.getText();
	}

};

sap.ca.ui.InPlaceEdit.prototype._createUndoButton = function() {
    var oInPlaceEdit = this;

	if (!oInPlaceEdit._oUndoButton && oInPlaceEdit.getUndoEnabled()) {
		oInPlaceEdit._oUndoButton = new sap.m.Button(oInPlaceEdit.getId() + "--X", {
            icon: "sap-icon://undo",
            type: sap.m.ButtonType.Transparent
        }).setParent(oInPlaceEdit);
		oInPlaceEdit._oUndoButton.attachEvent('press', this._handleUndoButtonPress, this); // attach event this way to have the right this-reference in handler
	}

};

sap.ca.ui.InPlaceEdit.prototype._handleUndoButtonPress = function(oEvent) {

	this._undoTextChange();

	if (this._bEditMode) {
		this._oEditControl.focus();
		jQuery.sap.byId(this.getId()).removeClass("sapCaUiIpeUndo");
	}

};

sap.ca.ui.InPlaceEdit.prototype._undoTextChange = function() {
    var oInPlaceEdit = this;

	// change text back to old value (only if value changed -> undo button visible)
	if (oInPlaceEdit.getUndoEnabled() && oInPlaceEdit._sOldTextAvailable) {
		var oContent = oInPlaceEdit.getContent();
		if (!oContent) {
			return;
		}

		if (oContent.setValue) {
			oContent.setValue(oInPlaceEdit._sOldText);
		} else if (oContent.setText) {
			oContent.setText(oInPlaceEdit._sOldText);
		}
		if (oInPlaceEdit._bEditMode) {
			// to be sure that text is updated in edit mode (e.g. Link case) - update edit control
			oInPlaceEdit._oEditControl.setValue(oInPlaceEdit._sOldText);
		}

		if (oContent.fireChange) {
			// fire change event
			oContent.fireChange({
				newValue : oInPlaceEdit._sOldText
			});
		} else {
			// fire InPlaceEdit change event
			oInPlaceEdit.fireChange({
				newValue : oInPlaceEdit._sOldText
			})
		}

		if (!oInPlaceEdit._bEditMode) {
			oInPlaceEdit._sOldText = undefined;
			oInPlaceEdit._sOldTextAvailable = false;
		}
	}

};

sap.ca.ui.InPlaceEdit.prototype._createEditButton = function() {
    var oInPlaceEdit = this;

	if (!oInPlaceEdit._oEditButton) {
		oInPlaceEdit._oEditButton = new sap.m.Button(oInPlaceEdit.getId() + "--Edit", {
            icon:"sap-icon://edit",
            type: sap.m.ButtonType.Transparent
        }).setParent(oInPlaceEdit);
		oInPlaceEdit._oEditButton.addStyleClass("sapCaUiIpeEBtn");
		oInPlaceEdit._oEditButton.attachEvent('press', this._handleEditButtonPress, oInPlaceEdit); // attach event this way to have the right this-reference in handler
	}

};


sap.ca.ui.InPlaceEdit.prototype._handleEditButtonPress = function(oEvent) {

	this._switchToEditMode();
	jQuery.sap.byId(this.getId()).addClass("sapCaUiIpeFocus");

};

sap.ca.ui.InPlaceEdit.prototype._handleTextFieldChange = function(oEvent) {

	var oContent = this.getContent();

	if (oContent.setText) {
		var sNewValue = oEvent.getParameter("newValue");
		oContent.setText(sNewValue);
		this.fireChange({
			newValue : sNewValue
		});
	}

};

sap.ca.ui.InPlaceEdit.prototype._handleContentChange = function(oEvent) {

	if (this._sOldText != oEvent.getParameter("newValue") && this.getUndoEnabled()) {
		jQuery.sap.byId(this.getId()).addClass("sapCaUiIpeUndo");
	} else {
		jQuery.sap.byId(this.getId()).removeClass("sapCaUiIpeUndo");
	}
	this.fireChange(oEvent.getParameters());

};

sap.ca.ui.InPlaceEdit.prototype._handleContentLiveChange = function(oEvent) {

	if (this._sOldText != oEvent.getParameter("liveValue") && this.getUndoEnabled()) {
		jQuery.sap.byId(this.getId()).addClass("sapCaUiIpeUndo");
	} else {
		jQuery.sap.byId(this.getId()).removeClass("sapCaUiIpeUndo");
	}

};

sap.ca.ui.InPlaceEdit.prototype._handleContentInvalidate = function() {

	if (!this._bEditMode) {
		//in edit mode TextField change must only checked by switch do display mode
		this.invalidate();
	} else {
		//if valueState changes -> class must be adopted on outer DIV but do not rerender
		switch (this.getValueState()) {
			case (sap.ui.core.ValueState.Error) :
				if (!jQuery.sap.byId(this.getId()).hasClass('sapUiIpeErr')) {
					jQuery.sap.byId(this.getId()).addClass('sapUiIpeErr');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeWarn');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeSucc');
				}
				break;
			case (sap.ui.core.ValueState.Success) :
				if (!jQuery.sap.byId(this.getId()).hasClass('sapUiIpeSucc')) {
					jQuery.sap.byId(this.getId()).addClass('sapUiIpeSucc');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeErr');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeWarn');
				}
				break;
			case (sap.ui.core.ValueState.Warning) :
				if (!jQuery.sap.byId(this.getId()).hasClass('sapUiIpeWarn')) {
					jQuery.sap.byId(this.getId()).addClass('sapUiIpeWarn');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeErr');
					jQuery.sap.byId(this.getId()).removeClass('sapUiIpeSucc');
				}
				break;
			default :
				jQuery.sap.byId(this.getId()).removeClass('sapUiIpeWarn');
				jQuery.sap.byId(this.getId()).removeClass('sapUiIpeErr');
				jQuery.sap.byId(this.getId()).removeClass('sapUiIpeSucc');
				break;
		}
	}

};
}; // end of sap/ca/ui/InPlaceEdit.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.Notes') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.Notes.
jQuery.sap.declare("sap.ca.ui.Notes");

jQuery.sap.require('sap.m.List'); // unlisted dependency retained



/**
 * Constructor for a new Notes.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getShowNoteInput showNoteInput} : boolean (default: true)</li>
 * <li>{@link #getTextMaxLength textMaxLength} : int (default: 1000)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.Notes#event:addNote addNote} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.List#constructor sap.m.List}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * This control is a List with the ability to render an additional control on top of it to add new notes. The developer is responsible to give the correct template to use to display notes (recommended are either the FeedListItem or the ExpansibleFeedListItem). The developer is also responsible to implement the code to send the notes to the backend system, by responding to the addNote event.
 * @extends sap.m.List
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.Notes
 */
sap.m.List.extend("sap.ca.ui.Notes", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"clear", "reset"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"showNoteInput" : {type : "boolean", group : "Misc", defaultValue : true},
		"textMaxLength" : {type : "int", group : "Misc", defaultValue : 1000}
	},
	events : {
		"addNote" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.Notes with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.Notes.extend
 * @function
 */

sap.ca.ui.Notes.M_EVENTS = {'addNote':'addNote'};


/**
 * Getter for property <code>showNoteInput</code>.
 * If set to true, this control will render an additional control to create new notes.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showNoteInput</code>
 * @public
 * @name sap.ca.ui.Notes#getShowNoteInput
 * @function
 */

/**
 * Setter for property <code>showNoteInput</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowNoteInput  new value for property <code>showNoteInput</code>
 * @return {sap.ca.ui.Notes} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Notes#setShowNoteInput
 * @function
 */


/**
 * Getter for property <code>textMaxLength</code>.
 * max text input length
 *
 * Default value is <code>1000</code>
 *
 * @return {int} the value of property <code>textMaxLength</code>
 * @public
 * @name sap.ca.ui.Notes#getTextMaxLength
 * @function
 */

/**
 * Setter for property <code>textMaxLength</code>.
 *
 * Default value is <code>1000</code> 
 *
 * @param {int} iTextMaxLength  new value for property <code>textMaxLength</code>
 * @return {sap.ca.ui.Notes} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Notes#setTextMaxLength
 * @function
 */


/**
 * press event for button
 * 
 * (oControlEvent) Event is fired when the user clicks on the control.
 * 
 * fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject] 
 *
 * @name sap.ca.ui.Notes#addNote
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'addNote' event of this <code>sap.ca.ui.Notes</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.Notes</code>.<br/> itself. 
 *  
 * press event for button
 * 
 * (oControlEvent) Event is fired when the user clicks on the control.
 * 
 * fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject] 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.Notes</code>.<br/> itself.
 *
 * @return {sap.ca.ui.Notes} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Notes#attachAddNote
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'addNote' event of this <code>sap.ca.ui.Notes</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.Notes} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.Notes#detachAddNote
 * @function
 */

/**
 * Fire event addNote to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.Notes} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.Notes#fireAddNote
 * @function
 */


/**
 * Clear the content of the inner text box
 *
 * @name sap.ca.ui.Notes.prototype.clear
 * @function

 * @type void
 * @public
 */


/**
 * Calls clear() and reset growing metadata
 *
 * @name sap.ca.ui.Notes.prototype.reset
 * @function

 * @type void
 * @public
 */


// Start of sap\ca\ui\Notes.js
jQuery.sap.require('sap.m.MessageToast'); // unlisted dependency retained
 
jQuery.sap.require('sap.ui.core.IconPool'); // unlisted dependency retained


sap.ca.ui.Notes.prototype.init = function() {
    if (sap.m.List.prototype.init) {
        sap.m.List.prototype.init.apply(this);
    }

    var textAreaDefaultHeight;
    var sFourRowHeight;
    var sThreeRowHeight;
    var iRowCount = 2;

    this._oTextArea = new sap.m.TextArea(this.getId()+"-textarea", {
        maxLength : this.getTextMaxLength(),
        placeholder : sap.ca.ui.utils.resourcebundle.getText("notes.addNotePlaceHolder"),
        liveChange : function(oEvent) {
            var _oTextArea = this.$().find("textarea");
            var oTextAreaDomRef = _oTextArea.get(0); // this.getDomRef();

            if (!jQuery.device.is.phone) {
                if (!textAreaDefaultHeight) {
                    textAreaDefaultHeight = oTextAreaDomRef.scrollHeight;
                }

                if (textAreaDefaultHeight < oTextAreaDomRef.scrollHeight) {
                    oTextAreaDomRef.style.overflow = "hidden";
                    _oTextArea.height(oTextAreaDomRef.scrollHeight);
                }

            } // end of not a phone
            else {
                if (!textAreaDefaultHeight) {
                    textAreaDefaultHeight = oTextAreaDomRef.scrollHeight;
                }

                if (textAreaDefaultHeight == oTextAreaDomRef.scrollHeight) {
                    _oTextArea.height(oTextAreaDomRef.scrollHeight);
                    oTextAreaDomRef.style.overflow = "hidden";
                }

                if (textAreaDefaultHeight < oTextAreaDomRef.scrollHeight
                        && !sThreeRowHeight) {
                    iRowCount = iRowCount + 1;
                    sThreeRowHeight = oTextAreaDomRef.scrollHeight;
                    _oTextArea.height(oTextAreaDomRef.scrollHeight);
                    oTextAreaDomRef.style.overflow = "hidden";

                }
                if (sThreeRowHeight < oTextAreaDomRef.scrollHeight
                        && !sFourRowHeight && sThreeRowHeight) {
                    iRowCount = iRowCount + 1;
                    sFourRowHeight = oTextAreaDomRef.scrollHeight;
                    _oTextArea.height(oTextAreaDomRef.scrollHeight);
                    oTextAreaDomRef.style.overflow = "hidden";
                }

                if (sFourRowHeight < oTextAreaDomRef.scrollHeight
                        && sFourRowHeight && sThreeRowHeight) {
                    iRowCount = iRowCount + 1;
                    _oTextArea.height(sFourRowHeight);
                    oTextAreaDomRef.style.overflow = "auto";
                }

            } // end of is phone
        } // liveChange
    });

    this._oTextArea.setParent(this);
    this._oTextArea.attachLiveChange(this.liveChangeMonitor,this);

    // create button
    this._oButton = new sap.m.Button(this.getId()+"-add", {
        //text : sap.ca.ui.utils.resourcebundle.getText("Add"),
        icon: sap.ui.core.IconPool.getIconURI("add"),
        type: sap.m.ButtonType.Emphasized,
        press : jQuery.proxy(function(event) {
            this.fireAddNote({
                value : this._oTextArea.getValue()
            });
            this._oTextArea.setValue('');
            this._oTextArea.setHeight('auto');
        }, this)
    });
    this._oButton.setParent(this);
};

sap.ca.ui.Notes.prototype.liveChangeMonitor = function(oEvent) 
{
	if (oEvent.mParameters.newValue.length === this._maxLength)
	{
		var messageText = sap.ca.ui.utils.resourcebundle.getText("TextOverlimit", [this._maxLength]);

		sap.m.MessageToast.show(messageText);
	}
};

sap.ca.ui.Notes.prototype.exit = function() {
    if (sap.m.List.prototype.exit) {
        sap.m.List.prototype.exit.apply(this);
    }

    this._oTextArea.destroy();
    this._oButton.destroy();
};

sap.ca.ui.Notes.prototype.setTextMaxLength = function(iTextMaxLength) {
    if (iTextMaxLength > 1000) 
    {
        console.error("Notes maximum length set to "+iTextMaxLength+", which is greater than the maximum length allowed. TextMaxLength will be reset to 1000 characters");
        iTextMaxLength = 1000;
    }

    this._maxLength = iTextMaxLength;

    this._oTextArea.setProperty("maxLength", iTextMaxLength, true);
    this.setProperty("textMaxLength", iTextMaxLength);
};


/**
 *  Clear the textarea content
 */
sap.ca.ui.Notes.prototype.clear = function() {
    this._oTextArea.setValue("");
};

/**
 *  Reset
 */
sap.ca.ui.Notes.prototype.reset = function() {
    this.clear();

    // reset growing metadata
    this._oGrowingDelegate && this._oGrowingDelegate.reset();
};
}; // end of sap/ca/ui/Notes.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.OverflowContainer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.OverflowContainer.
jQuery.sap.declare("sap.ca.ui.OverflowContainer");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new OverflowContainer.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getOverflowHeight overflowHeight} : sap.ui.core.CSSSize (default: '200px')</li>
 * <li>{@link #getExpanded expanded} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * 
 * The OverflowContainer allows the content of a control to be partially displayed before being fully expanded.
 * It will cut its content to a fixed height that can be defined. It is fully suitable within an IconTabBar.
 * 
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.OverflowContainer
 */
sap.ui.core.Control.extend("sap.ca.ui.OverflowContainer", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"overflowHeight" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '200px'},
		"expanded" : {type : "boolean", group : "Behavior", defaultValue : false}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content"}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.OverflowContainer with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.OverflowContainer.extend
 * @function
 */


/**
 * Getter for property <code>overflowHeight</code>.
 * 
 * The height of the container when not expanded. It should be determined by the application.
 * The default value is set to 200px.
 * 
 *
 * Default value is <code>200px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>overflowHeight</code>
 * @public
 * @name sap.ca.ui.OverflowContainer#getOverflowHeight
 * @function
 */

/**
 * Setter for property <code>overflowHeight</code>.
 *
 * Default value is <code>200px</code> 
 *
 * @param {sap.ui.core.CSSSize} sOverflowHeight  new value for property <code>overflowHeight</code>
 * @return {sap.ca.ui.OverflowContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverflowContainer#setOverflowHeight
 * @function
 */


/**
 * Getter for property <code>expanded</code>.
 * 
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>expanded</code>
 * @public
 * @name sap.ca.ui.OverflowContainer#getExpanded
 * @function
 */

/**
 * Setter for property <code>expanded</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bExpanded  new value for property <code>expanded</code>
 * @return {sap.ca.ui.OverflowContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverflowContainer#setExpanded
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * Controls to be embedded.
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @name sap.ca.ui.OverflowContainer#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.OverflowContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverflowContainer#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.OverflowContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverflowContainer#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @name sap.ca.ui.OverflowContainer#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.OverflowContainer#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.OverflowContainer#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.OverflowContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverflowContainer#destroyContent
 * @function
 */


// Start of sap\ca\ui\OverflowContainer.js
///**
// * This file defines behavior for the control,
// */

sap.ca.ui.OverflowContainer.prototype.init = function(){
    this._oExpandCollapseBtn = new sap.m.Button({
        icon: "sap-icon://slim-arrow-down",
        type: sap.m.ButtonType.Unstyled,
        tap: jQuery.proxy(this._toggleExpandCollapse, this)
    }).addStyleClass("sapCaUiOCBtn");
    this._oExpandCollapseBtn.setParent(this);
};

sap.ca.ui.OverflowContainer.prototype._toggleExpandCollapse = function(){
    var $container = this.$();
    var $content = jQuery.sap.byId(this.getId() + "-content");
    this.setProperty("expanded", !this.getExpanded(), true);
    var $overlay = jQuery.sap.byId(this.getId() + "-overlay");
    var bIsExpanded = this.getExpanded();
    if(bIsExpanded){
        // Expanded: no overlay
        $overlay.hide();
        this._oExpandCollapseBtn.setProperty("icon", "sap-icon://slim-arrow-up", false);
        $container.height($content.outerHeight(true));
    }
    else{
        // Collapse
        this._oExpandCollapseBtn.setProperty("icon","sap-icon://slim-arrow-down", false);
        $container.css("height", this.getOverflowHeight());
        $overlay.show();
    }
};

sap.ca.ui.OverflowContainer.prototype.onAfterRendering = function(){
    this._renderButtonVisibility();
    var buttonIcon = this.getExpanded() ? "sap-icon://slim-arrow-up" : "sap-icon://slim-arrow-down";
    this._oExpandCollapseBtn.setProperty("icon", buttonIcon, false);
};

sap.ca.ui.OverflowContainer.prototype._renderButtonVisibility = function(){
    var $content = jQuery.sap.byId(this.getId() + "-content");
    var $overlay = jQuery.sap.byId(this.getId() + "-overlay");
    var iContentHeight = $content.outerHeight(true);
    if (iContentHeight > this.$().outerHeight(true)){
        this._oExpandCollapseBtn.setVisible(true);
        $overlay.show();
    }
    else{
        $overlay.hide();
        var $container = this.$();
        if(iContentHeight > 0){
            $container.css("height", iContentHeight);
            if(!this.getExpanded()){
                this._oExpandCollapseBtn.setVisible(false);
            }
        }
        else{ // the current content height is zero
            this.invalidate();
        }
    }
};

sap.ca.ui.OverflowContainer.prototype._getButton = function(){
    return this._oExpandCollapseBtn;
};

sap.ca.ui.OverflowContainer.prototype.exit = function() {
    this._oExpandCollapseBtn.destroy();
};

}; // end of sap/ca/ui/OverflowContainer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.OverviewTile') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.OverviewTile.
jQuery.sap.declare("sap.ca.ui.OverviewTile");

jQuery.sap.require('sap.m.Tile'); // unlisted dependency retained



/**
 * Constructor for a new OverviewTile.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getTitle title} : string (default: 'null')</li>
 * <li>{@link #getIcon icon} : sap.ui.core.URI (default: 'null')</li>
 * <li>{@link #getContact contact} : string (default: 'null')</li>
 * <li>{@link #getAddress address} : string (default: 'null')</li>
 * <li>{@link #getOpportunities opportunities} : string (default: 'null')</li>
 * <li>{@link #getRating rating} : string (default: 'null')</li>
 * <li>{@link #getLastContact lastContact} : string (default: 'null')</li>
 * <li>{@link #getNextContact nextContact} : string (default: 'null')</li>
 * <li>{@link #getRevenue revenue} : string (default: 'null')</li>
 * <li>{@link #getVisible visible} : boolean (default: true)</li>
 * <li>{@link #getWidth width} : sap.ui.core.CSSSize</li>
 * <li>{@link #getContactActive contactActive} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.OverviewTile#event:contactPress contactPress} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.Tile#constructor sap.m.Tile}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Display aTile that presents an overview of a customer
 * @extends sap.m.Tile
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.OverviewTile
 */
sap.m.Tile.extend("sap.ca.ui.OverviewTile", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"init"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"title" : {type : "string", group : "Misc", defaultValue : 'null'},
		"icon" : {type : "sap.ui.core.URI", group : "Misc", defaultValue : 'null'},
		"contact" : {type : "string", group : "Misc", defaultValue : 'null'},
		"address" : {type : "string", group : "Misc", defaultValue : 'null'},
		"opportunities" : {type : "string", group : "Misc", defaultValue : 'null'},
		"rating" : {type : "string", group : "Misc", defaultValue : 'null'},
		"lastContact" : {type : "string", group : "Misc", defaultValue : 'null'},
		"nextContact" : {type : "string", group : "Misc", defaultValue : 'null'},
		"revenue" : {type : "string", group : "Misc", defaultValue : 'null'},
		"visible" : {type : "boolean", group : "Misc", defaultValue : true},
		"width" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : null},
		"contactActive" : {type : "boolean", group : "Behavior", defaultValue : false}
	},
	events : {
		"contactPress" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.OverviewTile with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.OverviewTile.extend
 * @function
 */

sap.ca.ui.OverviewTile.M_EVENTS = {'contactPress':'contactPress'};


/**
 * Getter for property <code>title</code>.
 * This property is used to set the title of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>title</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getTitle
 * @function
 */

/**
 * Setter for property <code>title</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setTitle
 * @function
 */


/**
 * Getter for property <code>icon</code>.
 * This property is used to set the image of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {sap.ui.core.URI} the value of property <code>icon</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getIcon
 * @function
 */

/**
 * Setter for property <code>icon</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {sap.ui.core.URI} sIcon  new value for property <code>icon</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setIcon
 * @function
 */


/**
 * Getter for property <code>contact</code>.
 * This property is used to set the contact of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>contact</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getContact
 * @function
 */

/**
 * Setter for property <code>contact</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sContact  new value for property <code>contact</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setContact
 * @function
 */


/**
 * Getter for property <code>address</code>.
 * This property is used to set the adress field in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>address</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getAddress
 * @function
 */

/**
 * Setter for property <code>address</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sAddress  new value for property <code>address</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setAddress
 * @function
 */


/**
 * Getter for property <code>opportunities</code>.
 * This property is used to set the opportunitiesfield in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>opportunities</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getOpportunities
 * @function
 */

/**
 * Setter for property <code>opportunities</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sOpportunities  new value for property <code>opportunities</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setOpportunities
 * @function
 */


/**
 * Getter for property <code>rating</code>.
 * This property is used to set the rating field in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>rating</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getRating
 * @function
 */

/**
 * Setter for property <code>rating</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sRating  new value for property <code>rating</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setRating
 * @function
 */


/**
 * Getter for property <code>lastContact</code>.
 * This property is used to set the last contact field in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>lastContact</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getLastContact
 * @function
 */

/**
 * Setter for property <code>lastContact</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sLastContact  new value for property <code>lastContact</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setLastContact
 * @function
 */


/**
 * Getter for property <code>nextContact</code>.
 * This property is used to set the next contact field in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>nextContact</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getNextContact
 * @function
 */

/**
 * Setter for property <code>nextContact</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sNextContact  new value for property <code>nextContact</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setNextContact
 * @function
 */


/**
 * Getter for property <code>revenue</code>.
 * This property is used to set the revenue to date field in the form of the tile
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>revenue</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getRevenue
 * @function
 */

/**
 * Setter for property <code>revenue</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sRevenue  new value for property <code>revenue</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setRevenue
 * @function
 */


/**
 * Getter for property <code>visible</code>.
 * 
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>visible</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getVisible
 * @function
 */

/**
 * Setter for property <code>visible</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bVisible  new value for property <code>visible</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setVisible
 * @function
 */


/**
 * Getter for property <code>width</code>.
 * 
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>width</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getWidth
 * @function
 */

/**
 * Setter for property <code>width</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setWidth
 * @function
 */


/**
 * Getter for property <code>contactActive</code>.
 * 
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>contactActive</code>
 * @public
 * @name sap.ca.ui.OverviewTile#getContactActive
 * @function
 */

/**
 * Setter for property <code>contactActive</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bContactActive  new value for property <code>contactActive</code>
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#setContactActive
 * @function
 */


/**
 * This event is fired when the end user clicks on the contact link. 
 *
 * @name sap.ca.ui.OverviewTile#contactPress
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'contactPress' event of this <code>sap.ca.ui.OverviewTile</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.OverviewTile</code>.<br/> itself. 
 *  
 * This event is fired when the end user clicks on the contact link. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.OverviewTile</code>.<br/> itself.
 *
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#attachContactPress
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'contactPress' event of this <code>sap.ca.ui.OverviewTile</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.OverviewTile#detachContactPress
 * @function
 */

/**
 * Fire event contactPress to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.OverviewTile} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.OverviewTile#fireContactPress
 * @function
 */


/**
 * 
 *
 * @name sap.ca.ui.OverviewTile.prototype.init
 * @function

 * @type void
 * @public
 */


// Start of sap\ca\ui\OverviewTile.js
///**
// * This file defines behavior for the control,
// */

jQuery.sap.require('sap.ui.core.IconPool'); // unlisted dependency retained




sap.ca.ui.OverviewTile.prototype.init = function(){
   this._address=new sap.m.Text({ maxLines: 1 });
   this._address.setParent(this);
   this._address.addStyleClass("sapCaUiOTAddress");

   this._oppLabel= new sap.m.Label();
   this._opp=new sap.m.Text({maxLines: 1});
   this._createFormLine(this._oppLabel, this._opp, "OverviewTile.opportunities");

   this._revenueLabel= new sap.m.Label();
   this._revenue=new sap.m.Text({maxLines: 1});
   this._createFormLine(this._revenueLabel, this._revenue, "OverviewTile.revenue");
    
    this._ratingLabel= new sap.m.Label();
    this._rating=new sap.m.Text({maxLines: 1});
    this._createFormLine(this._ratingLabel, this._rating, "OverviewTile.rating");

    this._lastCtxLabel= new sap.m.Label();
    this._lastCtx=new sap.m.Text({maxLines: 1});
    this._createFormLine(this._lastCtxLabel, this._lastCtx, "OverviewTile.lastAppointment");

    this._nextCtxLabel= new sap.m.Label();
    this._nextCtx=new sap.m.Text({maxLines: 1});
    this._createFormLine(this._nextCtxLabel, this._nextCtx, "OverviewTile.nextAppointment");
	this._title = new sap.m.Text({maxLines: 2});
	this._title.setParent(this);
    this._title.addStyleClass("sapCaUiOverviewTileTitle");

	this._ctxlink = new sap.m.Link(this.getId() + "-link");
	this._ctxlink.setParent(this);
    this._ctxlink.addStyleClass("sapCaUiOverviewTileContact");
	
	this._sapCaUiPath = jQuery.sap.getModulePath("sap.ca.ui");

    this._ctxlink.setEnabled(false);

};

sap.ca.ui.OverviewTile.prototype._createFormLine = function(oLabelCtrl, oTextCtrl, sLabelTextKey) {
    oLabelCtrl.setText(sap.ca.ui.utils.resourcebundle.getText(sLabelTextKey));
    oLabelCtrl.setParent(this);
    oLabelCtrl.addStyleClass("sapCaUiOTFormLbl");
    oLabelCtrl.setTextAlign(sap.ui.core.TextAlign.Right);
    oTextCtrl.setParent(this);
    oTextCtrl.addStyleClass("sapCaUiOTFormVal");
    oLabelCtrl.setLabelFor(oTextCtrl);
};

sap.ca.ui.OverviewTile.prototype._getImageCtrl = function() {
	return this._image;
};

sap.ca.ui.OverviewTile.prototype._getTitleCtrl = function() {
	return this._title;
};

sap.ca.ui.OverviewTile.prototype._getContactCtrl = function() {
	return this._ctxlink;
};

sap.ca.ui.OverviewTile.prototype._getAddressCtrl = function() {
	return this._address;
};

sap.ca.ui.OverviewTile.prototype._getOppLabelCtrl = function() {
	return this._oppLabel;
};

sap.ca.ui.OverviewTile.prototype._getOppCtrl = function() {
	return this._opp;
};

sap.ca.ui.OverviewTile.prototype._getRevenueLabelCtrl = function() {
	return this._revenueLabel;
};

sap.ca.ui.OverviewTile.prototype._getRevenueCtrl = function() {
	return this._revenue;
};

sap.ca.ui.OverviewTile.prototype._getRatingLabelCtrl = function() {
	return this._ratingLabel;
};

sap.ca.ui.OverviewTile.prototype._getRatingCtrl = function() {
	return this._rating;
};

sap.ca.ui.OverviewTile.prototype._getLastCtxCtrl = function() {
	return this._lastCtx;
};

sap.ca.ui.OverviewTile.prototype._getLastCtxLabelCtrl = function() {
	return this._lastCtxLabel;
};

sap.ca.ui.OverviewTile.prototype._getNextCtxCtrl = function() {
	return this._nextCtx;
};

sap.ca.ui.OverviewTile.prototype._getNextCtxLabelCtrl = function() {
	return this._nextCtxLabel;
};

/**
 * Called when the control is destroyed.
 * 
 * @private
 */
sap.ca.ui.OverviewTile.prototype.exit = function() {
	if (this._image) {
		this._image.destroy();
		this._image = null;
	}
	this._ctxlink.destroy();
	this._ctxlink =null;
	this._title.destroy();
	this._title= null;
	
	this._address.destroy();
	this._address=null;
	this._oppLabel.destroy();
	this._oppLabel=null;
	this._opp.destroy();
	this._opp=null;
	this._revenueLabel.destroy();
	this._revenueLabel=null;	
	this._revenue.destroy();
	this._revenue=null;
	this._ratingLabel.destroy();
	this._ratingLabel=null;
	this._rating.destroy();
	this._rating=null;
	this._lastCtxLabel.destroy();
	this._lastCtxLabel=null;
	this._lastCtx.destroy();
	this._lastCtx=null;
	this._nextCtxLabel.destroy();
	this._nextCtxLabel=null;
	this._nextCtx.destroy();
	this._nextCtx=null;
};
/**
 * Overrides the icon property of the Tile Control
 */
sap.ca.ui.OverviewTile.prototype.getIcon = function() {
	if(!this.getProperty("icon")) {
		this.setProperty("icon", this._sapCaUiPath + "/images/placeholder.png");
    }
	return this.getProperty("icon");

};

sap.ca.ui.OverviewTile.prototype.setTitle = function(iTitle){
	this.setProperty("title", iTitle);
	this._title.setText(iTitle);
};

sap.ca.ui.OverviewTile.prototype.setContact = function(iContact){
	this.setProperty("contact", iContact);
	this._ctxlink.setText(iContact);
};

sap.ca.ui.OverviewTile.prototype.setAddress = function(iAddress){
	this.setProperty("address", iAddress);
	this._address.setText(iAddress);
};

sap.ca.ui.OverviewTile.prototype.setOpportunities = function(iOpportunities){
	this.setProperty("opportunities", iOpportunities);
	this._opp.setText(iOpportunities);
};

sap.ca.ui.OverviewTile.prototype.setRevenue = function(iRevenue){
	this.setProperty("revenue", iRevenue);
	this._revenue.setText(iRevenue);
};

sap.ca.ui.OverviewTile.prototype.setRating = function(iRating){
	this.setProperty("rating", iRating);
	this._rating.setText(iRating);
};

sap.ca.ui.OverviewTile.prototype.setLastContact = function(iLastContact){
	this.setProperty("lastContact", iLastContact);
	this._lastCtx.setText(iLastContact);
};

sap.ca.ui.OverviewTile.prototype.setNextContact = function(iNextContact){
	this.setProperty("nextContact", iNextContact);
	this._nextCtx.setText(iNextContact);
};

sap.ca.ui.OverviewTile.prototype.setContactActive = function(bContactActive){
	var bActive = (bContactActive === true); // else undefined or null -> enabled
    this.setProperty("contactActive", bActive);
    this._ctxlink.setEnabled(bActive);
};

sap.ca.ui.OverviewTile.prototype.onBeforeRendering = function(){
	var mProperties = { 
			src : this.getIcon(),
            padding : "0 0 0 0",
			height : "3rem",
			width : "3rem",
			size : "3rem"
		};
	this._image = sap.m.ImageHelper.getImageControl(this.getId() + "-img", this._image, null , mProperties);
	//this._image.setParent(this);

};

sap.ca.ui.OverviewTile.prototype.ontap = function(oEvent){
	if(oEvent.target && oEvent.target.id === this._ctxlink.getId() && this.getContactActive()){
		this.fireContactPress(this._ctxlink);
	} else {
		sap.m.Tile.prototype.ontap.call(this);
	}
	
};


}; // end of sap/ca/ui/OverviewTile.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.PictureItem.
jQuery.sap.declare("sap.ca.ui.PictureItem");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new PictureItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getStatus status} : string</li>
 * <li>{@link #getSource source} : string</li>
 * <li>{@link #getName name} : string</li>
 * <li>{@link #getWidth width} : sap.ui.core.CSSSize (default: '62px')</li>
 * <li>{@link #getHeight height} : sap.ui.core.CSSSize (default: '62px')</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.PictureItem#event:loaded loaded} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * A picture / photo Item for AddPicture and PictureViewer Controls
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.PictureItem
 */
sap.ui.core.Control.extend("sap.ca.ui.PictureItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"status" : {type : "string", group : "Behavior", defaultValue : null},
		"source" : {type : "string", group : "Data", defaultValue : null},
		"name" : {type : "string", group : "Data", defaultValue : null},
		"width" : {type : "sap.ui.core.CSSSize", group : "Data", defaultValue : '62px', deprecated: true},
		"height" : {type : "sap.ui.core.CSSSize", group : "Data", defaultValue : '62px', deprecated: true}
	},
	events : {
		"loaded" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.PictureItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.PictureItem.extend
 * @function
 */

sap.ca.ui.PictureItem.M_EVENTS = {'loaded':'loaded'};


/**
 * Getter for property <code>status</code>.
 * The status of the picture / photo : Added, Deleted, Read
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>status</code>
 * @public
 * @name sap.ca.ui.PictureItem#getStatus
 * @function
 */

/**
 * Setter for property <code>status</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sStatus  new value for property <code>status</code>
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureItem#setStatus
 * @function
 */


/**
 * Getter for property <code>source</code>.
 * The content of the picture. Either the uri or base64 content.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>source</code>
 * @public
 * @name sap.ca.ui.PictureItem#getSource
 * @function
 */

/**
 * Setter for property <code>source</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSource  new value for property <code>source</code>
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureItem#setSource
 * @function
 */


/**
 * Getter for property <code>name</code>.
 * The original name of the picture.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>name</code>
 * @public
 * @name sap.ca.ui.PictureItem#getName
 * @function
 */

/**
 * Setter for property <code>name</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sName  new value for property <code>name</code>
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureItem#setName
 * @function
 */


/**
 * Getter for property <code>width</code>.
 * The width of the picture.
 *
 * Default value is <code>62px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>width</code>
 * @public
 * @deprecated Since version 1.16.2. 
 * Width is defined by the AddPicture control
 * @name sap.ca.ui.PictureItem#getWidth
 * @function
 */

/**
 * Setter for property <code>width</code>.
 *
 * Default value is <code>62px</code> 
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.2. 
 * Width is defined by the AddPicture control
 * @name sap.ca.ui.PictureItem#setWidth
 * @function
 */


/**
 * Getter for property <code>height</code>.
 * The height of the picture.
 *
 * Default value is <code>62px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>height</code>
 * @public
 * @deprecated Since version 1.16.2. 
 * Height is defined by the AddPicture control
 * @name sap.ca.ui.PictureItem#getHeight
 * @function
 */

/**
 * Setter for property <code>height</code>.
 *
 * Default value is <code>62px</code> 
 *
 * @param {sap.ui.core.CSSSize} sHeight  new value for property <code>height</code>
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.2. 
 * Height is defined by the AddPicture control
 * @name sap.ca.ui.PictureItem#setHeight
 * @function
 */


/**
 * Fired when the Image is really loaded 
 *
 * @name sap.ca.ui.PictureItem#loaded
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'loaded' event of this <code>sap.ca.ui.PictureItem</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.PictureItem</code>.<br/> itself. 
 *  
 * Fired when the Image is really loaded 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.PictureItem</code>.<br/> itself.
 *
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureItem#attachLoaded
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'loaded' event of this <code>sap.ca.ui.PictureItem</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureItem#detachLoaded
 * @function
 */

/**
 * Fire event loaded to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.PictureItem} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.PictureItem#fireLoaded
 * @function
 */


// Start of sap\ca\ui\PictureItem.js
/**
 * Status Object
 * @type {Object}
 */
sap.ca.ui.PictureItem.STATUS = {'ADD':'Added','DELETE':'Deleted','READ':'Read'};

/**
 * Initialize control
 */
sap.ca.ui.PictureItem.prototype.init = function() {
  this._oTapHandler = jQuery.proxy(this._onTap, this);
  this._oImage = new sap.m.Image({id:this.getId()+ "-image"});
  this._oImage.attachPress(this._oTapHandler);
  this._oImage.addStyleClass("sapCaUiPictureItemImage");
  this._iRenderCount = 0;
  this._sourceInfo = {isDataUri : false, mimeType : "", data : ""};
};



/**
 * Called when the control is destroyed
 */
sap.ca.ui.PictureItem.prototype.exit = function() {

    if (this._oImage) {
        this._oImage.detachPress(this._oTapHandler);
        this._oImage.destroy();
    }
    if (this._internalFile){
    	delete this._internalFile;
    }
};


/**
 * Set the source for the picture, either uri or base64 information
 * @override
 * @public
 * @param sValue {string}
 */
sap.ca.ui.PictureItem.prototype.setSource = function(sValue) {

    if (sValue == null || sValue == ""){
        jQuery.sap.log.warning("Cannot set a NULL or empty to the image source");
        return;
    }

	this._sourceInfo = this._getSourceInfo(sValue);
	
	this._oImage.setSrc(sValue);
    this.setProperty("source", sValue, false);
};

/**
 * Set the File object
 * @public
 * @param file {File}
 * @param oConfig {Object} Canvas config
 */
sap.ca.ui.PictureItem.prototype.setFile = function(file, oConfig) {

	var that = this;
	
	this._internalFile = file;

	// resize image
	var canvasHelper = new sap.ca.ui.utils.CanvasHelper({
		width: oConfig.width,
        height: oConfig.height,
        crop: oConfig.crop,
        quality: oConfig.quality,
        minWeight: oConfig.minWeight,
        done: function(oEvent) {
        	that.setSource(oEvent.getParameters().data);
        	that.fireLoaded();
        }
	});
	canvasHelper.resize(file);
	

};




/**
 * Returns the File object (if exists), data content can be retrieved in order to trigger the real upload
 * @return file {File}
 */
sap.ca.ui.PictureItem.prototype.getFile = function(file) {
	if (!this._internalFile){
		jQuery.sap.log.warning("no file has been set");
		return null;
	}
	
	return this._internalFile;
};

/**
 * Whether the picture source is a Data URI, containing base64 encoding
 * @return {boolean} returns true if the source is a Data URI rather than a URL
 */
sap.ca.ui.PictureItem.prototype.isSourceDataUri = function() {
    if (!this._sourceInfo)
        return false;

    return this._sourceInfo.isDataUri;
};

/**
 * Get the mime type for source Data URIs
 * @return {string} returns empty if the source is a URL rather than a Data URI
 */
sap.ca.ui.PictureItem.prototype.getMimeType = function() {

    return this._sourceInfo.mimeType;
};

/**
 * Get the base64 image encoding for source Data URIs
 * @return {string} returns empty if the source is a URL rather than a Data URI
 */
sap.ca.ui.PictureItem.prototype.getBase64Encoding = function() {

    return this._sourceInfo.data;
};

sap.ca.ui.PictureItem.prototype._resizeImage = function(){
    // scale and crop images to target width and height

	// set the default css settings
    var scaledWidth = "auto";
    var scaledHeight = "auto";

    // get the actual image size
    var $this = this.$();
    
    
    var domRef = jQuery.sap.domById(this.getId()+ "-image");
    if (domRef) {
        // check that we have usable sizes
        if (domRef.width == 0 || domRef.height == 0) {
            // needs some time to render the image in the dom (on ipad/iphone), lets try again later
            var rerender = jQuery.proxy(this.onAfterRendering, this);
            this._iRenderCount++;
            // prevent infinite loop, never seen, but you never know
            if (this._iRenderCount <= 5) {
                setTimeout(rerender, 100);
            }
            else {
                scaledWidth = $this.height(); // best default option
                this._iRenderCount = 0;
            }
        }
        else {

            // ensure that the smallest side fits, scale the smallest size first then the largest size
            if (domRef.width < domRef.height) {
                // get the scaling factor for the width, then scale the height
                var targetWidth = parseInt($this.width(), 10);
                scaledHeight = (targetWidth / domRef.width) * domRef.height;
            }
            else  {
                // get the scaling factor for the height, then scale the width
                var targetHeight = parseInt($this.height(), 10);
                scaledWidth = (targetHeight / domRef.height) * domRef.width;
            }
            this._iRenderCount = 0;
        }
        
        // set the css on the image
        var $image = this._oImage.$();
        $image.width(scaledWidth);
        $image.height(scaledHeight);
    }
};


/**
 * Called after the control has been rendered
 */
sap.ca.ui.PictureItem.prototype.onAfterRendering = function() {

	this._resizeImage();   
    var $image = this._oImage.$();
    var $this = this.$();
    $image.css({"margin-left":(($this.width() - $image.width()) / 2) + "px",
                "margin-top": (($this.height() - $image.height()) / 2) + "px"});
    
};



/**
 * Handler for tap event of picture item
 * @private
 */
sap.ca.ui.PictureItem.prototype._onTap = function() {

    var oAddPicture = sap.ui.getCore().byId(this._addPictureId);
    if (oAddPicture){
        oAddPicture._pictureTapped(this);
    }
};

/**
 * Handle the key up event for SPACE and ENTER.
 *
 * @param {jQuery.Event} oEvent - the keyboard event.
 * @private
 */
sap.ca.ui.PictureItem.prototype.onkeyup = function(oEvent) {
    if(oEvent.which == jQuery.sap.KeyCodes.SPACE || oEvent.which == jQuery.sap.KeyCodes.ENTER){
        this._onTap();
    }
};

/**
 * Get the source information for the picture
 * @private
 * @return {object}
 */
sap.ca.ui.PictureItem.prototype._getSourceInfo = function(sSource) {

	if (!sSource)
		return;
	
    var regex = /^data:(.+);base64,(.*)$/;

    var matches = sSource.match(regex);

    var sourceInfo;
    if (matches) {
        var sMimeType = matches[1];
        var sBase64 = matches[2];
        sourceInfo = { isDataUri : true, mimeType : sMimeType, data : sBase64}
    }
    else {
        sourceInfo = { isDataUri : false, mimeType : "", data : ""}
    }

    return sourceInfo;
};

}; // end of sap/ca/ui/PictureItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureTile') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.PictureTile.
jQuery.sap.declare("sap.ca.ui.PictureTile");

jQuery.sap.require('sap.m.CustomTile'); // unlisted dependency retained



/**
 * Constructor for a new PictureTile.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getHeight height} : sap.ui.core.CSSSize (default: '32px')</li>
 * <li>{@link #getWidth width} : sap.ui.core.CSSSize (default: '32px')</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul>
 * <li>{@link #getTileContent tileContent} : string | sap.ca.ui.PictureViewerItem</li></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.PictureTile#event:pictureDelete pictureDelete} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.CustomTile#constructor sap.m.CustomTile}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Tile control embedding an image and allowing custom sizing
 * @extends sap.m.CustomTile
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.PictureTile
 */
sap.m.CustomTile.extend("sap.ca.ui.PictureTile", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"height" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '32px'},
		"width" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '32px'}
	},
	associations : {
		"tileContent" : {type : "sap.ca.ui.PictureViewerItem", multiple : false}
	},
	events : {
		"pictureDelete" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.PictureTile with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.PictureTile.extend
 * @function
 */

sap.ca.ui.PictureTile.M_EVENTS = {'pictureDelete':'pictureDelete'};


/**
 * Getter for property <code>height</code>.
 * height (in pixels) of the picture viewer control.
 *
 * Default value is <code>32px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>height</code>
 * @public
 * @name sap.ca.ui.PictureTile#getHeight
 * @function
 */

/**
 * Setter for property <code>height</code>.
 *
 * Default value is <code>32px</code> 
 *
 * @param {sap.ui.core.CSSSize} sHeight  new value for property <code>height</code>
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#setHeight
 * @function
 */


/**
 * Getter for property <code>width</code>.
 * width (in pixels) of the picture viewer control.
 *
 * Default value is <code>32px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>width</code>
 * @public
 * @name sap.ca.ui.PictureTile#getWidth
 * @function
 */

/**
 * Setter for property <code>width</code>.
 *
 * Default value is <code>32px</code> 
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#setWidth
 * @function
 */


/**
 * Reference to one PictureViewerItem coming from the PictureViewer.
 *
 * @return {string} Id of the element which is the current target of the <code>tileContent</code> association, or null
 * @public
 * @name sap.ca.ui.PictureTile#getTileContent
 * @function
 */

/**
 * Reference to one PictureViewerItem coming from the PictureViewer.
 *
 * @param {string | sap.ca.ui.PictureViewerItem} vTileContent 
 *    Id of an element which becomes the new target of this <code>tileContent</code> association.
 *    Alternatively, an element instance may be given.
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#setTileContent
 * @function
 */


	
/**
 * Fired when the user deletes a picture 
 *
 * @name sap.ca.ui.PictureTile#pictureDelete
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'pictureDelete' event of this <code>sap.ca.ui.PictureTile</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.PictureTile</code>.<br/> itself. 
 *  
 * Fired when the user deletes a picture 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.PictureTile</code>.<br/> itself.
 *
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#attachPictureDelete
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'pictureDelete' event of this <code>sap.ca.ui.PictureTile</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#detachPictureDelete
 * @function
 */

/**
 * Fire event pictureDelete to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.PictureTile#firePictureDelete
 * @function
 */


// Start of sap\ca\ui\PictureTile.js

sap.ca.ui.PictureTile.prototype.init = function(oTileContent) {
	
	this._oDeletePictureButton = new sap.m.Button({
        icon:"sap-icon://sys-cancel",
        press: jQuery.proxy(this._deletePictureRequestHandler, this),
        type: sap.m.ButtonType.Transparent
    }).addStyleClass("sapCaUiPTDeleteButton");
	
	if (!jQuery.device.is.desktop) {
		 this.attachPress(this._tilePressedHandler);
		 this.attachBrowserEvent("swipe", jQuery.proxy(this._tileSwipedHandler, this));
		 this._oDeletePictureButton.addStyleClass("hide");
	}
};

    
/**
 * Reference to one PictureViewerItem coming from the PictureViewer.
 *
 * @override
 * @param {string | sap.ca.ui.PictureViewerItem} vTileContent
 *    Id of an element which becomes the new target of this <code>tileContent</code> association.
 *    Alternatively, an element instance may be given.
 * @return {sap.ca.ui.PictureTile} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureTile#setTileContent
 * @function
 */
sap.ca.ui.PictureTile.prototype.setTileContent = function(oTileContent) {
	this.setContent(null);
	if (oTileContent) {
        var image = oTileContent.getImage();
        
		if (jQuery.device.is.desktop) {
			this.setContent(image);
		} else {
			this.setContent(new sap.ca.ui.ZoomableScrollContainer({
				content : oTileContent.getImage()
			}));
		}
		
	} else {
		this.setContent(null);
	}
	this.setAssociation("tileContent", oTileContent);
};



/**
 * Sets the pixel size of the tile 
 * @param {int} iWidth width
 * @param {int} iHeight height
 * @private
 */ 
sap.ca.ui.PictureTile.prototype.setSize = function(iWidth,iHeight){

	this._width = iWidth;
	this._height = iHeight;
	
	var $this = this.$();
	if ($this){
		$this.css({width: iWidth+"px", height: iHeight+"px"});
		
		// adding this class later because display: inline-block is causing issue for width/height calculation
		jQuery.sap.byId(this.getId()+"-wrapper").addClass("sapCaUiPTWrapper");
	}
};


sap.ca.ui.PictureTile.prototype._tilePressedHandler = function (oEvent) {	
    this.switchVisibility();
};

sap.ca.ui.PictureTile.prototype.switchVisibility = function (bVisible) {
	var $delBtn = this._oDeletePictureButton.$();
	if (bVisible === undefined){
		$delBtn.toggleClass("hide");
	}
	else {
		$delBtn.toggleClass("hide", !bVisible);	
	}
	
	
};

sap.ca.ui.PictureTile.prototype._tileSwipedHandler = function (oEvent) {
    var $deleteBtn = this._oDeletePictureButton.$();
    if ($deleteBtn && !$deleteBtn.hasClass("hide")){
    	$deleteBtn.addClass("hide");
    		
    }	
};

/**
 * 
 */
sap.ca.ui.PictureTile.prototype._deletePictureRequestHandler = function () {

	this.firePictureDelete();
    
};


}; // end of sap/ca/ui/PictureTile.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureViewer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.PictureViewer.
jQuery.sap.declare("sap.ca.ui.PictureViewer");

jQuery.sap.require('sap.m.TileContainer'); // unlisted dependency retained



/**
 * Constructor for a new PictureViewer.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getTileScaling tileScaling} : float (default: 0.95)</li>
 * <li>{@link #getRemovable removable} : boolean (default: false)</li>
 * <li>{@link #getConfirmActive confirmActive} : boolean (default: false)</li>
 * <li>{@link #getConfirmText confirmText} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getItems items} : sap.ca.ui.PictureViewerItem[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.PictureViewer#event:pictureDeleted pictureDeleted} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.TileContainer#constructor sap.m.TileContainer}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Picture viewer control relying on the TileContainer control
 * @extends sap.m.TileContainer
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.PictureViewer
 */
sap.m.TileContainer.extend("sap.ca.ui.PictureViewer", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"tileScaling" : {type : "float", group : "Misc", defaultValue : 0.95},
		"removable" : {type : "boolean", group : "Misc", defaultValue : false},
		"confirmActive" : {type : "boolean", group : "Misc", defaultValue : false},
		"confirmText" : {type : "string", group : "Misc", defaultValue : null}
	},
	defaultAggregation : "items",
	aggregations : {
    	"items" : {type : "sap.ca.ui.PictureViewerItem", multiple : true, singularName : "item"}
	},
	events : {
		"pictureDeleted" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.PictureViewer with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.PictureViewer.extend
 * @function
 */

sap.ca.ui.PictureViewer.M_EVENTS = {'pictureDeleted':'pictureDeleted'};


/**
 * Getter for property <code>tileScaling</code>.
 * Percentage of the space occupied by the image in the picture viewer control. Please note that if the factor is too close to 1, the navigation arrows usually displayed in desktop mode will not be available
 *
 * Default value is <code>0.95</code>
 *
 * @return {float} the value of property <code>tileScaling</code>
 * @public
 * @name sap.ca.ui.PictureViewer#getTileScaling
 * @function
 */

/**
 * Setter for property <code>tileScaling</code>.
 *
 * Default value is <code>0.95</code> 
 *
 * @param {float} fTileScaling  new value for property <code>tileScaling</code>
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#setTileScaling
 * @function
 */


/**
 * Getter for property <code>removable</code>.
 * Defines whether or not you can remove a picture
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>removable</code>
 * @public
 * @name sap.ca.ui.PictureViewer#getRemovable
 * @function
 */

/**
 * Setter for property <code>removable</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bRemovable  new value for property <code>removable</code>
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#setRemovable
 * @function
 */


/**
 * Getter for property <code>confirmActive</code>.
 * Defines whether or not a confirm dialog shows up before deleting a picture
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>confirmActive</code>
 * @public
 * @name sap.ca.ui.PictureViewer#getConfirmActive
 * @function
 */

/**
 * Setter for property <code>confirmActive</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bConfirmActive  new value for property <code>confirmActive</code>
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#setConfirmActive
 * @function
 */


/**
 * Getter for property <code>confirmText</code>.
 * If confirmation dialog is active, this is the text to display to confirm the deletion. A default value is provided
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>confirmText</code>
 * @public
 * @name sap.ca.ui.PictureViewer#getConfirmText
 * @function
 */

/**
 * Setter for property <code>confirmText</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sConfirmText  new value for property <code>confirmText</code>
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#setConfirmText
 * @function
 */


/**
 * Getter for aggregation <code>items</code>.<br/>
 * Aggregation of PictureViewerItem that contains either a picture URI or the actual Image control.
 * 
 * @return {sap.ca.ui.PictureViewerItem[]}
 * @public
 * @name sap.ca.ui.PictureViewer#getItems
 * @function
 */


/**
 * Inserts a item into the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.PictureViewerItem}
 *          oItem the item to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the item should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the item is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the item is inserted at 
 *             the last position        
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#insertItem
 * @function
 */

/**
 * Adds some item <code>oItem</code> 
 * to the aggregation named <code>items</code>.
 *
 * @param {sap.ca.ui.PictureViewerItem}
 *            oItem the item to add; if empty, nothing is inserted
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#addItem
 * @function
 */

/**
 * Removes an item from the aggregation named <code>items</code>.
 *
 * @param {int | string | sap.ca.ui.PictureViewerItem} vItem the item to remove or its index or id
 * @return {sap.ca.ui.PictureViewerItem} the removed item or null
 * @public
 * @name sap.ca.ui.PictureViewer#removeItem
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>items</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ca.ui.PictureViewerItem[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.PictureViewer#removeAllItems
 * @function
 */

/**
 * Checks for the provided <code>sap.ca.ui.PictureViewerItem</code> in the aggregation named <code>items</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ca.ui.PictureViewerItem}
 *            oItem the item whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.PictureViewer#indexOfItem
 * @function
 */
	

/**
 * Destroys all the items in the aggregation 
 * named <code>items</code>.
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#destroyItems
 * @function
 */


/**
 * Thrown when user delete an image 
 *
 * @name sap.ca.ui.PictureViewer#pictureDeleted
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'pictureDeleted' event of this <code>sap.ca.ui.PictureViewer</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.PictureViewer</code>.<br/> itself. 
 *  
 * Thrown when user delete an image 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.PictureViewer</code>.<br/> itself.
 *
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#attachPictureDeleted
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'pictureDeleted' event of this <code>sap.ca.ui.PictureViewer</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#detachPictureDeleted
 * @function
 */

/**
 * Fire event pictureDeleted to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.PictureViewer#firePictureDeleted
 * @function
 */


// Start of sap\ca\ui\PictureViewer.js
jQuery.sap.declare("sap.ca.ui.PictureViewer");
jQuery.sap.require('sap.ui.core.ResizeHandler'); // unlisted dependency retained

jQuery.sap.require('sap.m.TileContainer'); // unlisted dependency retained




sap.ca.ui.PictureViewer.prototype.init = function () {

    sap.m.TileContainer.prototype.init.apply(this);

    this._oBundle = sap.ca.ui.utils.resourcebundle;
    this.$blocker = undefined;

    this.setEditable(false);

    if (sap.ui.getCore().isMobile()){
		jQuery(window).bind("tap", jQuery.proxy(this._reset, this));
        var oStaticArea = sap.ui.getCore().getStaticAreaRef();
        this.$blocker = jQuery("<div class='sapCaPVBly sapUiBLy'></div>").css("visibility", "hidden");
        jQuery(oStaticArea).append(this.$blocker);
	}
    if (sap.ui.getCore().isMobile()) {
        //sap.ui.Device.orientation.attachHandler(jQuery.proxy(this._onOrientationChange, this));
    }
    else {
        jQuery(window).bind("resize", jQuery.proxy(this._resize, this));
    }

    this.addStyleClass("sapCaPW");
    
    // onBeforeRendering() is not called the first time
    this.addStyleClass("sapCaPWRendering");


};

sap.ca.ui.PictureViewer.prototype.exit = function () {

    //might not be defined
    if (this.$blocker && this.$blocker.remove) {
        this.$blocker.remove();
    }

    if (sap.ui.getCore().isMobile()) {
        //sap.ui.Device.orientation.detachHandler(jQuery.proxy(this._onOrientationChange, this));
    }
    else {
        jQuery(window).unbind("resize", jQuery.proxy(this._resize, this));
    }

    sap.m.TileContainer.prototype.exit.apply(this);

	if (!jQuery.device.is.desktop){
		jQuery(window).unbind("tap", jQuery.proxy(this._reset, this));	
	}
};

/**
 * Set the percentage of the space occupied by the image in the picture viewer control.
 * Please note that if the factor is too close to 1, the navigation arrows usually displayed in desktop mode will not be available
 * @override
 * @public
 * @param fTileScale
 */
sap.ca.ui.PictureViewer.prototype.setTileScaling = function (fTileScale) {
    if (fTileScale < 0 || fTileScale > 1) {
        fTileScale = 0.75;
        jQuery.sap.log.error("Tile Scaling should be a float value between 0 and 1 and not " + fTileScale
            + ". Setting it to 0.75 by default.")
    }
    this.setProperty('tileScaling', fTileScale);
};

/**
 * Adds some item <code>oItem</code>
 * to the aggregation named <code>items</code>.
 *
 * @override
 * @param {sap.ca.ui.PictureViewerItem}
    *            oItem the item to add; if empty, nothing is inserted
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#addItem
 * @function
 *
 * @deprecated Use aggregation "tiles"
 */
sap.ca.ui.PictureViewer.prototype.addItem = function (oItem) {
    this.insertItem(oItem, this.getItems().length)
};

/**
 * Inserts a item into the aggregation named <code>items</code>.
 * When adding a new item to the aggregation, a sap.ca.ui.PictureTile is actually created
 * with its own ID and added to the internal TileContainer.
 *
 * @override
 * @param {sap.ca.ui.PictureViewerItem}
    *          oItem the item to insert; if empty, nothing is inserted
 * @param {int}
    *             iIndex the <code>0</code>-based index the item should be inserted at; for
 *             a negative value of <code>iIndex</code>, the item is inserted at position 0; for a value
 *             greater than the current size of the aggregation, the item is inserted at
 *             the last position
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#insertItem
 * @function
 *
 * @deprecated Use aggregation "tiles"
 */
sap.ca.ui.PictureViewer.prototype.insertItem = function (oItem, iIndex) {

    var tileToAdd = new sap.ca.ui.PictureTile({
    	tileContent:oItem
    });
    tileToAdd.attachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler, this));

    this.insertTile(tileToAdd, iIndex);
    this.insertAggregation("items", oItem, iIndex);

    return this;
};



sap.ca.ui.PictureViewer.prototype.insertTile = function (oTile, iIndex) {

	oTile.attachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler, this));
	sap.m.TileContainer.prototype.insertTile.apply(this, arguments);
};


sap.ca.ui.PictureViewer.prototype.deleteTile = function (oTile) {
	sap.m.TileContainer.prototype.deleteTile.apply(this, arguments);
	
	oTile.destroy();
};


/**
 * Removes the picture at index <code>iIndex</code> from the <code>items</code> aggregation.
 *
 * @override
 * @param {sap.ca.ui.PictureViewerItem}
    *          iIndex the index of the picture to delete; if empty, the current picture is deleted
 * @param {int}
    *             iIndex the <code>0</code>-based index of the picture collection to delete;
 *             if <code>iIndex</code> is out of range or empty, the current image will be deleted.
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#deletePicture
 * @function
 */
sap.ca.ui.PictureViewer.prototype.deletePicture = function (iIndex) {

    var pictureTileIndexToDelete, pictureTileToDelete, numberOfPictures;
    numberOfPictures = this.getTiles().length;

    if (typeof iIndex != "number" || iIndex < 0 || iIndex >= numberOfPictures) {
        pictureTileIndexToDelete = this.getPageFirstTileIndex();
    } 
    else {
        pictureTileIndexToDelete = iIndex;
    }

    if (pictureTileIndexToDelete > -1) {
        pictureTileToDelete = this.getTiles()[pictureTileIndexToDelete];
        pictureTileToDelete.detachPictureDelete(jQuery.proxy(this._deletePictureRequestHandler, this));
        this.deleteTile(pictureTileToDelete);
        this.removeAggregation("items", pictureTileIndexToDelete, true);
    }
    else {
    	jQuery.sap.log.warning("Cannot find and delete a picture at index : " + iIndex);
    }

    return this;
};

/**
 * Select the picture at index <code>iIndex</code> from the <code>items</code> aggregation.
 *
 * @override
 * @param {sap.ca.ui.PictureViewerItem}
    *          iIndex the index of the picture to select; if empty, the first picture is selected
 * @param {int}
    *             iIndex the <code>0</code>-based index of the aggregation to select; for
 *             a negative value of <code>iIndex</code>, the picture at position 0 is selected; for a value
 *             greater than the current size of the aggregation, the selected picture at the last position is selected
 * @return {sap.ca.ui.PictureViewer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewer#selectPicture
 * @function
 */
sap.ca.ui.PictureViewer.prototype.selectPicture = function (iIndex) {

    var numberOfPictures = this.getTiles().length;

    if (typeof iIndex != "number") {
        iIndex = 0;
    }
    else if (iIndex < 0) {
        iIndex = 0;
    }
    else if (iIndex >= numberOfPictures) {
        iIndex = numberOfPictures - 1;
    }

    if (this._bRendered) {
    	this.addStyleClass("sapCaPWRendering");
    }
    else {    	
    }
    this._selectedIndex = iIndex;
    
    
    return this;
};
sap.ca.ui.PictureViewer.prototype.setSelectedIndex = function (iIndex) {
	this.selectPicture(iIndex);
}

/**
 * Gets the current picture index.
 *
 * @override
 * @return {sap.ca.ui.PictureViewer} the current picture index
 * @public
 * @name sap.ca.ui.PictureViewer#getCurrentPictureIndex
 * @function
 */
sap.ca.ui.PictureViewer.prototype.getCurrentPictureIndex = function () {
    return this.getPageFirstTileIndex();
};


/**
 * Handler for Delete button press
 *
 * Pops up a confirmation dialog if needed and/or proceed to the actual delete
 *
 * @param oEvent
 * @private
 */
sap.ca.ui.PictureViewer.prototype._deletePictureRequestHandler = function (oEvent) {

    var oTile = oEvent.getSource();

    // TODO: replace by new i18n keys when allowed to
    if (this.getConfirmActive()){

        var sQuestion = this.getConfirmText();
        if (!sQuestion || sQuestion == ""){
            sQuestion = this._oBundle.getText("FileUploader.deleteQuestion");
        }
        sap.ca.ui.dialog.confirmation.open({
            question : sQuestion,
            title : this._oBundle.getText("FileUploader.deleteFile"),
            confirmButtonLabel : this._oBundle.getText("dialog.ok")
        }, jQuery.proxy(function(r){

            if (r.isConfirmed)
                this._internalDelete(oTile);

        }, this));
    }
    else{
         this._internalDelete(oTile);
    }

};

/**
 * Deletes a Picture
 *
 * @param oTile
 * @private
 */
sap.ca.ui.PictureViewer.prototype._internalDelete = function (oTile) {
    var pictureTileIndexToDelete = this.indexOfTile(oTile);

    this.deleteTile(oTile);

    this.firePictureDeleted({index:pictureTileIndexToDelete});
};



/**
 * Get rid of potential visible "delete" button 
 * 
 * Only used on mobile devices
 * 
 */
sap.ca.ui.PictureViewer.prototype._reset = function (oEvent) {
	var i = this.getCurrentPictureIndex();
	
	var aTiles = this.getTiles();
	if (i > -1 && aTiles && aTiles.length > i){
		var oTile = aTiles[i];
		if (oTile){
			
			var $target = jQuery(oEvent.target);
			var $this = this.$();
			if ($this.length > 0 && $target.length > 0){
				
				
				var $parent = $target.closest(this.$());
				
				if ($parent.length === 0){ // the "tap" was outside the PictureViewer
					oTile.switchVisibility(false);
				}
				
			}
		}
		
	}
};

/**
 * Specify whether or not you can delete a picture.
 * If FALSE the delete button will never be visible. Default value is TRUE
 * @override
 * @public
 */
sap.ca.ui.PictureViewer.prototype.setRemovable = function (bValue) {
	
	this.setProperty("removable",bValue,true);	
	this.toggleStyleClass("sapCaPWEditable",bValue);
	
};

sap.ca.ui.PictureViewer.prototype.setEditable = function(bValue){
	// set Editable to false no matter what
	sap.m.TileContainer.prototype.setEditable.call(this, false);	
};


/**
 * Returns the dimension (width and height) of a tile
 * @returns {object} width and height of a tile
 * @private
 */
sap.ca.ui.PictureViewer.prototype._getTileDimension = function() {

    if (!this._bRendered)
        return;

    var $scroller = jQuery.sap.byId(this.getId()+"-scrl");
    var oTileDim = {
        width  : $scroller.width(),
        height : $scroller.height()
    };
    return oTileDim;
};


sap.ca.ui.PictureViewer.prototype.onBeforeRendering = function() {

    this.addStyleClass("sapCaPWRendering");
    
};

/**
 * Handles the internal event onAfterRendering
 * @private
 */
sap.ca.ui.PictureViewer.prototype.onAfterRendering = function() {
	
	
	this._bRendered = true;
	//init resizing
	//this._sResizeListenerId = sap.ui.core.ResizeHandler.register(this.getDomRef().parentElement,  jQuery.proxy(this._resize, this));
    

	//init the dimensions to the container scoll area 
	this._applyDimension();
	this.$().toggleClass("sapCaPWEditable",this.getRemovable() === true);
	var that = this;
	this._sInitialResizeTimeoutId = setTimeout(function() {			
			that.addStyleClass("sapCaPWRendering");
			that._applyPageStartIndex(that._selectedIndex);
			
			that._update(false);
			
		}, this._iInitialResizeTimeout);
	
	//Set initial focus
	if(jQuery.device.is.desktop) {
		var oFocusTile = this.getTiles()[0],
			iTimeout = this._iInitialResizeTimeout;
		if(!!oFocusTile) {
			
			setTimeout(jQuery.proxy(function() {
				this._findTile(oFocusTile.$()).focus();
			},this),iTimeout); 
		}
	}
	
};


/**
 * @override
 */
sap.ca.ui.PictureViewer.prototype._update = function(bAnimated) {
	
	sap.m.TileContainer.prototype._update.apply(this, arguments);
	
	this.removeStyleClass("sapCaPWRendering");
	if (sap.ui.getCore().isMobile()){
		var $blocker = this.$blocker;
		setTimeout(jQuery.proxy(function() {
			$blocker.fadeOut(200, function(){$(this).css("visibility", "hidden").css("z-index", 0)});	
		},this),250); 
		
	}
	
};


/**
 * Applies the containers dimensions
 * @private
 */
sap.ca.ui.PictureViewer.prototype._applyDimension = function() {
    var oDim = this._getContainerDimension(),
        sId = this.getId(),
        $this = this.$(),
        oThisPos,
        iOffset = 10,
        iTopOffset = 60,
        $Content = jQuery.sap.byId( sId + "-cnt"),
        contentPos,
        contentOuterHeight,
        pagerHeight = jQuery.sap.byId( sId + "-pager").outerHeight();

    jQuery.sap.byId( sId + "-scrl").css({
        width : oDim.outerwidth + "px",
        height : (oDim.outerheight - pagerHeight) + "px"
    });

    $Content.css({
        height : (oDim.outerheight - pagerHeight) + "px",
        visibility : "visible"
    });

    $this.css("visibility","visible");
    oThisPos = $this.position();

    contentPos  = $Content.position();
    contentOuterHeight = $Content.outerHeight();

    if (jQuery.device.is.phone) {
        iOffset = 2;        
    } else if (jQuery.device.is.desktop) {
        iOffset = 0;        
    }

    jQuery.sap.byId( sId + "-blind").css({
        top : (contentPos.top + iOffset) + "px",
        left : (contentPos.left + iOffset) + "px",
        width : ($Content.outerWidth() - iOffset) + "px",
        height : (contentOuterHeight - iOffset) + "px"
    });

    jQuery.sap.byId( sId + "-rightedge").css({
        top : (oThisPos.top + iOffset + iTopOffset) + "px",
        right : iOffset + "px",
        height : (contentOuterHeight - iOffset - iTopOffset) + "px"
    });

    jQuery.sap.byId( sId + "-leftedge").css({
        top : (oThisPos.top + iOffset + iTopOffset) + "px",
        left : (oThisPos.left + iOffset) + "px",
        height : (contentOuterHeight - iOffset - iTopOffset) + "px"
    });
};


/**
 *
 * Adding overlay to hide blinking while switching orientation
 *
 * @private
 */
sap.ca.ui.PictureViewer.prototype.showBlockerLayer = function(callback) {

	// get higher z-index
	if (sap.ui.getCore().isMobile()){
		var zindex = 20;
		jQuery(sap.ui.getCore().getStaticAreaRef()).children().each(function(index, value){
			var z = parseInt(jQuery(value).css("z-index"));
			if (!isNaN(z)){
				zindex = Math.max(zindex, z);	
			}		
		});	
		jQuery.sap.log.debug("blocker layer z-index calculated : " + zindex+1);
	    this.$blocker.css("z-index", zindex+1).css("visibility", "visible").fadeIn(200, function(){
	    																					if (callback) 
																								callback.call();
	    																					});
	}
	else {
		if (callback) 
			callback.call();
	}
	

};



}; // end of sap/ca/ui/PictureViewer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.PictureViewerItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.PictureViewerItem.
jQuery.sap.declare("sap.ca.ui.PictureViewerItem");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new PictureViewer.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getSrc src} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getImage image} : sap.m.Image</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Picture viewer control relying on the TileContainer control
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.PictureViewerItem
 */
sap.ui.core.Control.extend("sap.ca.ui.PictureViewerItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"src" : {type : "string", group : "Misc", defaultValue : null}
	},
	aggregations : {
    	"image" : {type : "sap.m.Image", multiple : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.PictureViewerItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.PictureViewerItem.extend
 * @function
 */


/**
 * Getter for property <code>src</code>.
 * Image source url.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>src</code>
 * @public
 * @name sap.ca.ui.PictureViewerItem#getSrc
 * @function
 */

/**
 * Setter for property <code>src</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSrc  new value for property <code>src</code>
 * @return {sap.ca.ui.PictureViewerItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewerItem#setSrc
 * @function
 */


/**
 * Getter for aggregation <code>image</code>.<br/>
 * Pass in an existing Image control to be used inside the PictureViewer
 * 
 * @return {sap.m.Image}
 * @public
 * @name sap.ca.ui.PictureViewerItem#getImage
 * @function
 */


/**
 * Setter for the aggregated <code>image</code>.
 * @param oImage {sap.m.Image}
 * @return {sap.ca.ui.PictureViewerItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewerItem#setImage
 * @function
 */
	

/**
 * Destroys the image in the aggregation 
 * named <code>image</code>.
 * @return {sap.ca.ui.PictureViewerItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewerItem#destroyImage
 * @function
 */


// Start of sap\ca\ui\PictureViewerItem.js
/**
 * Setter for property <code>src</code>.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @param {string} sSrc  new value for property <code>src</code>
 * @return {sap.ca.ui.PictureViewerItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.PictureViewerItem#setSrc
 * @function
 */
sap.ca.ui.PictureViewerItem.prototype.setSrc = function(sSrc) {
	this.setProperty("src", sSrc);
	// Also create or update the internal image
	var oImage = this.getImage();
	if (oImage == null) {
		oImage = new sap.m.Image()
	}
	oImage.setSrc(sSrc);
	this.setImage(oImage);
	return this;
};

/**
 * Called when the control is destroyed
 */
sap.ca.ui.PictureViewerItem.prototype.exit = function() {
    var oImage = this.getImage();
    if (oImage) {
        oImage.destroy();
    }
};
}; // end of sap/ca/ui/PictureViewerItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.TabContainerOverflow') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.TabContainerOverflow.
jQuery.sap.declare("sap.ca.ui.TabContainerOverflow");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new TabContainerOverflow.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getShowSelection showSelection} : boolean (default: true)</li>
 * <li>{@link #getExpandable expandable} : boolean (default: true)</li>
 * <li>{@link #getExpanded expanded} : boolean (default: true)</li>
 * <li>{@link #getFullyExpanded fullyExpanded} : boolean (default: false)</li>
 * <li>{@link #getSelectedKey selectedKey} : string (default: 'null')</li>
 * <li>{@link #getVisible visible} : boolean (default: true)</li>
 * <li>{@link #getOverflowHeight overflowHeight} : string (default: "50px")</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getItems items} : sap.m.IconTab[]</li>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.TabContainerOverflow#event:select select} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.TabContainerOverflow#event:expand expand} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Add your documentation for the newTabContainerOverflow
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.TabContainerOverflow
 */
sap.ui.core.Control.extend("sap.ca.ui.TabContainerOverflow", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"showSelection" : {type : "boolean", group : "Misc", defaultValue : true, deprecated: true},
		"expandable" : {type : "boolean", group : "Misc", defaultValue : true},
		"expanded" : {type : "boolean", group : "Misc", defaultValue : true},
		"fullyExpanded" : {type : "boolean", group : "Misc", defaultValue : false},
		"selectedKey" : {type : "string", group : "Data", defaultValue : 'null'},
		"visible" : {type : "boolean", group : "Behavior", defaultValue : true},
		"overflowHeight" : {type : "string", group : "Misc", defaultValue : "50px"}
	},
	aggregations : {
    	"items" : {type : "sap.m.IconTab", multiple : true, singularName : "item"}, 
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content"}
	},
	events : {
		"select" : {}, 
		"expand" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.TabContainerOverflow with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.TabContainerOverflow.extend
 * @function
 */

sap.ca.ui.TabContainerOverflow.M_EVENTS = {'select':'select','expand':'expand'};


/**
 * Getter for property <code>showSelection</code>.
 * 
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showSelection</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * 
 * [Enter additional information for deprecation of showSelection]
 * @name sap.ca.ui.TabContainerOverflow#getShowSelection
 * @function
 */

/**
 * Setter for property <code>showSelection</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowSelection  new value for property <code>showSelection</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * 
 * [Enter additional information for deprecation of showSelection]
 * @name sap.ca.ui.TabContainerOverflow#setShowSelection
 * @function
 */


/**
 * Getter for property <code>expandable</code>.
 * 
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>expandable</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getExpandable
 * @function
 */

/**
 * Setter for property <code>expandable</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bExpandable  new value for property <code>expandable</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setExpandable
 * @function
 */


/**
 * Getter for property <code>expanded</code>.
 * 
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>expanded</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getExpanded
 * @function
 */

/**
 * Setter for property <code>expanded</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bExpanded  new value for property <code>expanded</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setExpanded
 * @function
 */


/**
 * Getter for property <code>fullyExpanded</code>.
 * 
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>fullyExpanded</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getFullyExpanded
 * @function
 */

/**
 * Setter for property <code>fullyExpanded</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bFullyExpanded  new value for property <code>fullyExpanded</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setFullyExpanded
 * @function
 */


/**
 * Getter for property <code>selectedKey</code>.
 * 
 *
 * Default value is <code>null</code>
 *
 * @return {string} the value of property <code>selectedKey</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getSelectedKey
 * @function
 */

/**
 * Setter for property <code>selectedKey</code>.
 *
 * Default value is <code>null</code> 
 *
 * @param {string} sSelectedKey  new value for property <code>selectedKey</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setSelectedKey
 * @function
 */


/**
 * Getter for property <code>visible</code>.
 * 
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>visible</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getVisible
 * @function
 */

/**
 * Setter for property <code>visible</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bVisible  new value for property <code>visible</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setVisible
 * @function
 */


/**
 * Getter for property <code>overflowHeight</code>.
 * 
 *
 * Default value is <code>"50px"</code>
 *
 * @return {string} the value of property <code>overflowHeight</code>
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getOverflowHeight
 * @function
 */

/**
 * Setter for property <code>overflowHeight</code>.
 *
 * Default value is <code>"50px"</code> 
 *
 * @param {string} sOverflowHeight  new value for property <code>overflowHeight</code>
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#setOverflowHeight
 * @function
 */


/**
 * Getter for aggregation <code>items</code>.<br/>
 * 
 * 
 * @return {sap.m.IconTab[]}
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getItems
 * @function
 */


/**
 * Inserts a item into the aggregation named <code>items</code>.
 *
 * @param {sap.m.IconTab}
 *          oItem the item to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the item should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the item is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the item is inserted at 
 *             the last position        
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#insertItem
 * @function
 */

/**
 * Adds some item <code>oItem</code> 
 * to the aggregation named <code>items</code>.
 *
 * @param {sap.m.IconTab}
 *            oItem the item to add; if empty, nothing is inserted
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#addItem
 * @function
 */

/**
 * Removes an item from the aggregation named <code>items</code>.
 *
 * @param {int | string | sap.m.IconTab} vItem the item to remove or its index or id
 * @return {sap.m.IconTab} the removed item or null
 * @public
 * @name sap.ca.ui.TabContainerOverflow#removeItem
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>items</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.m.IconTab[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.TabContainerOverflow#removeAllItems
 * @function
 */

/**
 * Checks for the provided <code>sap.m.IconTab</code> in the aggregation named <code>items</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.m.IconTab}
 *            oItem the item whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.TabContainerOverflow#indexOfItem
 * @function
 */
	

/**
 * Destroys all the items in the aggregation 
 * named <code>items</code>.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#destroyItems
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @name sap.ca.ui.TabContainerOverflow#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @name sap.ca.ui.TabContainerOverflow#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.TabContainerOverflow#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.TabContainerOverflow#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#destroyContent
 * @function
 */


/**
 *  
 *
 * @name sap.ca.ui.TabContainerOverflow#select
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'select' event of this <code>sap.ca.ui.TabContainerOverflow</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.TabContainerOverflow</code>.<br/> itself. 
 *  
 *  
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.TabContainerOverflow</code>.<br/> itself.
 *
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#attachSelect
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'select' event of this <code>sap.ca.ui.TabContainerOverflow</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#detachSelect
 * @function
 */

/**
 * Fire event select to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.TabContainerOverflow#fireSelect
 * @function
 */


/**
 *  
 *
 * @name sap.ca.ui.TabContainerOverflow#expand
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'expand' event of this <code>sap.ca.ui.TabContainerOverflow</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.TabContainerOverflow</code>.<br/> itself. 
 *  
 *  
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.TabContainerOverflow</code>.<br/> itself.
 *
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#attachExpand
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'expand' event of this <code>sap.ca.ui.TabContainerOverflow</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.TabContainerOverflow#detachExpand
 * @function
 */

/**
 * Fire event expand to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.TabContainerOverflow} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.TabContainerOverflow#fireExpand
 * @function
 */


// Start of sap\ca\ui\TabContainerOverflow.js


// Provides control sap.ca.ui.TabContainerOverflow.
jQuery.sap.declare("sap.ca.ui.TabContainerOverflow");
jQuery.sap.require('sap.m.library'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained




/*sap.ui.core.Control.extend("sap.ca.ui.TabContainerOverflow", { metadata : {

	// ---- object ----

	// ---- control specific ----
	//library : "sap.m",
	properties : {
		"showSelection" : {type : "boolean", group : "Misc", defaultValue : true, deprecated: true},
		"expandable" : {type : "boolean", group : "Misc", defaultValue : true},
		"expanded" : {type : "boolean", group : "Misc", defaultValue : true},
		"fullyExpanded" : {type : "boolean", group : "Misc", defaultValue : false},
		"selectedKey" : {type : "string", group : "Data", defaultValue : null},
		"visible" : {type : "boolean", group : "Behavior", defaultValue : true},
		"overflowHeight" : {type : "string", group : "Misc", defaultValue : "50px"}
	},
	aggregations : {
    	"items" : {type : "sap.m.IconTab", multiple : true, singularName : "item"}, 
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content"}
	},
	events : {
		"select" : {}, 
		"expand" : {}
	}
}});


sap.ca.ui.TabContainerOverflow.M_EVENTS = {'select':'select','expand':'expand'};*/

sap.ca.ui.TabContainerOverflow.prototype.init = function() {
	this.moreLessButton = new sap.m.Button({
		 id: this.getId() + "-overlayButton",
			icon: "sap-icon://slim-arrow-down",
			type: sap.m.ButtonType.Unstyled,
			press: jQuery.proxy(this.partialToggleExpandCollapse,this)
		});
	
};

/**
 * Exit
 */
sap.ca.ui.TabContainerOverflow.prototype.exit = function() {

};

sap.ca.ui.TabContainerOverflow.prototype.onBeforeRendering = function() {
	if (this.getItems().length > 0) {
		if (!this.oSelectedItem) {
			this.oSelectedItem = this.getItems()[0];
		}
		this.setProperty("selectedKey", this.oSelectedItem.getKey(), true);
	}
};

/**
 * setSelectedItem
 */
sap.ca.ui.TabContainerOverflow.prototype.setSelectedItem = function(oItem) {

	if (!oItem.getEnabled()) {
		return;
	}
	var $content = jQuery.sap.byId(this.getId() + "-content");
	
	this.oSelectedItem.$().removeClass("sapMITSelected");

	//click on already selected item leads to expanding/collapsing of the content (if expandable enabled)
	if (this.oSelectedItem === oItem && this.getExpandable()) {
		this.toggleExpandCollapse();
	//click on other item leads to showing the right content of this item
	} else {
		this.setFullyExpanded(false);
		this.moreLessButton.setIcon("sap-icon://slim-arrow-down");
		if ($content.length > 0) {
			$content.empty();
		}
		this.oSelectedItem = oItem;
		var oSelectedItemContent = this.oSelectedItem.getContent();
		this.oSelectedItem.$().addClass("sapMITSelected");

		//if item has own content, this content is shown
		if (oSelectedItemContent.length > 0) {
			this._rerenderContent(oSelectedItemContent);
		//if item has not own content, general content of the icontabbar is shown
		} else {
			this._rerenderContent(this.getContent());
		}
		//if content is not expanded, content will be expanded (first click on item always leads to expanding the right content)
		if (this.getExpanded() === false) {
			this.toggleExpandCollapse();
		}
		this.adjustArrow();
		this.moreLessButton.rerender();
		this.onTransitionEnded();
	}

	this.setProperty("selectedKey", this.oSelectedItem.getKey(), true);

	this.fireSelect({
		selectedItem: this.oSelectedItem,
		selectedKey: this.oSelectedItem.getKey(),
		item: this.oSelectedItem,
		key: this.oSelectedItem.getKey()
	});

};

sap.ca.ui.TabContainerOverflow.prototype._rerenderContent = function(oContent) {
	var $content = jQuery.sap.byId(this.getId() + "-content");
	if (oContent.length > 0) {
		var rm = sap.ui.getCore().createRenderManager();
		for (var i = 0; i < oContent.length; i++) {
			rm.renderControl(oContent[i]);
		}
		rm.flush($content[0]);
		rm.destroy();
	}
};

/**
 * adjustArrow
 */
sap.ca.ui.TabContainerOverflow.prototype.adjustArrow = function(){
	var $arrow = jQuery.sap.byId(this.getId() + "-arrow"),
		$item;
	if (this.oSelectedItem) {
		$item = this.oSelectedItem.$();
		if ($item.length > 0) {
			$item.siblings().removeClass("sapMITSelected");
			$item.addClass("sapMITSelected");
			var iLeft = $item[0].offsetLeft + $item.outerWidth() / 2 - $arrow.width() / 2;
			$arrow.css("left", iLeft + "px");
		}
	}
};

sap.ca.ui.TabContainerOverflow.prototype.renderButtonVisibility = function(){
	var $content = jQuery.sap.byId(this.getId() + "-content");
	var $overlay = jQuery.sap.byId(this.getId() + "-overlay");
	var $overlayButton = jQuery.sap.byId(this.getId() + "-overlayButton");
	var oldHeight=$content.height();
	$content.css({height:"auto"});
	var autoHeight=$content.height();
	$content.css({height:this.getOverflowHeight()});
	var overflowHeight=$content.height();
	$content.css({height: oldHeight});
	if (autoHeight>overflowHeight){
		$overlay.show();
		$overlayButton.show();
	}
	else{
		$overlay.hide();
		$overlayButton.hide();
	}
};

/**
 * afterRendering
 */
sap.ca.ui.TabContainerOverflow.prototype.onAfterRendering = function(){
	this.adjustArrow();
	this.onTransitionEnded();
	var $content = jQuery.sap.byId(this.getId() + "-content");
	$content.css({overflow:"hidden"});
	this.renderButtonVisibility();
};

sap.ca.ui.TabContainerOverflow.prototype.destroyItems = function() {
	this.oSelectedItem = null;
	this.destroyAggregation("items");
};

/**
 * Called after the theme has been switched, required for new width calc
 * @private
 */
sap.ca.ui.TabContainerOverflow.prototype.onThemeChanged = function(oEvent){
	this.adjustArrow();
};

sap.ca.ui.TabContainerOverflow.prototype.onTransitionEnded = function() {
	var $content = jQuery.sap.byId(this.getId() + "-content");
	var $container = jQuery.sap.byId(this.getId() + "-containerContent");
	var $overlay = jQuery.sap.byId(this.getId() + "-overlay");
	var $overlayButton = jQuery.sap.byId(this.getId() + "-overlayButton");
	var bExpanded = this.getExpanded();
	var bFullyExpanded = this.getFullyExpanded();
	if (bExpanded) { // expanding
		this.renderButtonVisibility();
		jQuery.sap.byId(this.getId() + "-arrow").show();
		$content.css("display", "block");
		if(bFullyExpanded){
			$content.css({height:"auto"});
		}
		else{
			$content.css({height:this.getOverflowHeight()});
		}
	} else { // collapsing
		$content.css("display", "none");
	}
	$overlay.css("bottom","0px");
	$overlayButton.css("bottom","0px");
	$container.toggleClass("sapMITBContentClosed", !bExpanded);

};

sap.ca.ui.TabContainerOverflow.prototype.toggleExpandCollapse = function() {
	var bExpand = !this.getExpanded();
	var bFullyExpanded = this.getFullyExpanded();
	var $content = jQuery.sap.byId(this.getId() + "-content");
	var $overlay = jQuery.sap.byId(this.getId() + "-overlay");
	var $overlayButton = jQuery.sap.byId(this.getId() + "-overlayButton");
	var $arrow = jQuery.sap.byId(this.getId() + "-arrow");
	var $selectedTab = jQuery.sap.byId(this._getItemByKey(this.getItems(), this.getSelectedKey()).getId());
	$selectedTab.toggleClass("sapMITBContentTabSelected", bExpand);
	$selectedTab.toggleClass("sapMITSelected", bExpand);
	if (bExpand) {
		if (!bFullyExpanded){
			$content.show();
			$content.animate({height:this.getOverflowHeight()},400);
			this.renderButtonVisibility();
		}
		else{
			$content.slideDown('400', jQuery.proxy(this.onTransitionEnded, this));
		}
		$arrow.show();
		
	} else {
		$arrow.hide();
		$overlayButton.hide();
		$overlay.hide();
		$content.slideUp('400', jQuery.proxy(this.onTransitionEnded, this));
	}
	this.setProperty("expanded", bExpand, true);
	
	
	this.fireExpand({
		expand: bExpand,
		collapse: !bExpand
	});

};

sap.ca.ui.TabContainerOverflow.prototype._getItemByKey = function(aItems, sKey) {
	for (var i = 0; i < aItems.length; i++) {
		if (aItems[i] instanceof sap.m.IconTabFilter) {
			if (aItems[i].getKey() === sKey) {
			return aItems[i];
			}
		}
		
	}
};


sap.ca.ui.TabContainerOverflow.prototype._checkTextOnly = function(aItems) {
	if (aItems.length > 0) {
		for (var i = 0; i < aItems.length; i++) {
			if (aItems[i] instanceof sap.m.IconTabFilter) {
				if (aItems[i].getIcon()) {
					return false;
				}
			}
		}
	}
	return true;
};

sap.ca.ui.TabContainerOverflow.prototype._checkNoText = function(aItems) {
	if (aItems.length > 0) {
		for (var i = 0; i < aItems.length; i++) {
			if (aItems[i] instanceof sap.m.IconTabFilter) {
				if (aItems[i].getText().length > 0) {
					return false;
				}
			}
		}
	}
	return true;
};

//Item23 specific
sap.ca.ui.TabContainerOverflow.prototype.partialToggleExpandCollapse = function() {
	var $content = jQuery.sap.byId(this.getId() + "-content");
	var bFullyExpanded = this.getFullyExpanded();
	
	if (!bFullyExpanded) {
		this.moreLessButton.setIcon("sap-icon://slim-arrow-up");
		$content.css({height:"auto"});
		var oldHeight=$content.height();
		$content.css({height:this.getOverflowHeight()});
		$content.animate({height: oldHeight},400);
		this.moreLessButton.rerender();
		this.setProperty("fullyExpanded", true, true);
	} else {
		this.moreLessButton.setIcon("sap-icon://slim-arrow-down");
		$content.animate({height:this.getOverflowHeight()},400);
		this.moreLessButton.rerender();
		this.setProperty("fullyExpanded", false, true);
	}


};



}; // end of sap/ca/ui/TabContainerOverflow.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.ZoomableScrollContainer') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.ZoomableScrollContainer.
jQuery.sap.declare("sap.ca.ui.ZoomableScrollContainer");

jQuery.sap.require('sap.m.ScrollContainer'); // unlisted dependency retained



/**
 * Constructor for a new ZoomableScrollContainer.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getZoomable zoomable} : boolean (default: true)</li>
 * <li>{@link #getInitialScale initialScale} : float (default: 1)</li>
 * <li>{@link #getMinScale minScale} : float (default: 1)</li>
 * <li>{@link #getMaxScale maxScale} : float (default: 4)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.ScrollContainer#constructor sap.m.ScrollContainer}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Based on a ScrollContainer, it allows you to pinch and zoom on mobile devices
 * @extends sap.m.ScrollContainer
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer
 */
sap.m.ScrollContainer.extend("sap.ca.ui.ZoomableScrollContainer", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"zoomable" : {type : "boolean", group : "Misc", defaultValue : true},
		"initialScale" : {type : "float", group : "Misc", defaultValue : 1},
		"minScale" : {type : "float", group : "Misc", defaultValue : 1},
		"maxScale" : {type : "float", group : "Misc", defaultValue : 4}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.ZoomableScrollContainer with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.ZoomableScrollContainer.extend
 * @function
 */


/**
 * Getter for property <code>zoomable</code>.
 * Activate or not the zooming functionality. If FALSE, it acts exactly as a basic ScrollContainer.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>zoomable</code>
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#getZoomable
 * @function
 */

/**
 * Setter for property <code>zoomable</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bZoomable  new value for property <code>zoomable</code>
 * @return {sap.ca.ui.ZoomableScrollContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#setZoomable
 * @function
 */


/**
 * Getter for property <code>initialScale</code>.
 * Initial scaling factor
 *
 * Default value is <code>1</code>
 *
 * @return {float} the value of property <code>initialScale</code>
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#getInitialScale
 * @function
 */

/**
 * Setter for property <code>initialScale</code>.
 *
 * Default value is <code>1</code> 
 *
 * @param {float} fInitialScale  new value for property <code>initialScale</code>
 * @return {sap.ca.ui.ZoomableScrollContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#setInitialScale
 * @function
 */


/**
 * Getter for property <code>minScale</code>.
 * Lowest scaling factor allowed
 *
 * Default value is <code>1</code>
 *
 * @return {float} the value of property <code>minScale</code>
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#getMinScale
 * @function
 */

/**
 * Setter for property <code>minScale</code>.
 *
 * Default value is <code>1</code> 
 *
 * @param {float} fMinScale  new value for property <code>minScale</code>
 * @return {sap.ca.ui.ZoomableScrollContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#setMinScale
 * @function
 */


/**
 * Getter for property <code>maxScale</code>.
 * Highest scaling factor allowed
 *
 * Default value is <code>4</code>
 *
 * @return {float} the value of property <code>maxScale</code>
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#getMaxScale
 * @function
 */

/**
 * Setter for property <code>maxScale</code>.
 *
 * Default value is <code>4</code> 
 *
 * @param {float} fMaxScale  new value for property <code>maxScale</code>
 * @return {sap.ca.ui.ZoomableScrollContainer} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.ZoomableScrollContainer#setMaxScale
 * @function
 */


// Start of sap\ca\ui\ZoomableScrollContainer.js


sap.ca.ui.ZoomableScrollContainer.prototype.init = function() {
    sap.m.ScrollContainer.prototype.init.apply(this);
};

sap.ca.ui.ZoomableScrollContainer.prototype.onAfterRendering = function() {

    var fnCallback = this.getScrollDelegate().onAfterRendering;

    var fScale = this.getInitialScale();
    var fMin = this.getMinScale();
    var fMax = this.getMaxScale();
    var bZoomable = this.getZoomable();


    this.getScrollDelegate().onAfterRendering = function(){
        fnCallback.call(this);
        this._scroller.scale = fScale;
        this._scroller.options.zoom = bZoomable;
        this._scroller.options.zoomMin = fMin;
        this._scroller.options.zoomMax = fMax;
        this._scroller.zoom(0, 0, fScale);

        this._scroller.options.onZoom = function(oEvent) {
            // "this" is the scroller
        };
        this._scroller.options.onZoomStart = function(oEvent) {
        };
    };
};

}; // end of sap/ca/ui/ZoomableScrollContainer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.BarListItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.BarListItem.
jQuery.sap.declare("sap.ca.ui.charts.BarListItem");

jQuery.sap.require('sap.m.ListItemBase'); // unlisted dependency retained



/**
 * Constructor for a new BarListItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getAxis axis} : string</li>
 * <li>{@link #getGroup group} : string</li>
 * <li>{@link #getValue value} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.ListItemBase#constructor sap.m.ListItemBase}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * The display list item consists of a label and a value.
 * @extends sap.m.ListItemBase
 *
 * @author SAP AG 
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.BarListItem
 */
sap.m.ListItemBase.extend("sap.ca.ui.charts.BarListItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"axis" : {type : "string", group : "Misc", defaultValue : null},
		"group" : {type : "string", group : "Misc", defaultValue : null},
		"value" : {type : "string", group : "Data", defaultValue : null}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.BarListItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.BarListItem.extend
 * @function
 */


/**
 * Getter for property <code>axis</code>.
 * List item label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>axis</code>
 * @public
 * @name sap.ca.ui.charts.BarListItem#getAxis
 * @function
 */

/**
 * Setter for property <code>axis</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sAxis  new value for property <code>axis</code>
 * @return {sap.ca.ui.charts.BarListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BarListItem#setAxis
 * @function
 */


/**
 * Getter for property <code>group</code>.
 * List item label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>group</code>
 * @public
 * @name sap.ca.ui.charts.BarListItem#getGroup
 * @function
 */

/**
 * Setter for property <code>group</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sGroup  new value for property <code>group</code>
 * @return {sap.ca.ui.charts.BarListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BarListItem#setGroup
 * @function
 */


/**
 * Getter for property <code>value</code>.
 * List item value
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>value</code>
 * @public
 * @name sap.ca.ui.charts.BarListItem#getValue
 * @function
 */

/**
 * Setter for property <code>value</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sValue  new value for property <code>value</code>
 * @return {sap.ca.ui.charts.BarListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BarListItem#setValue
 * @function
 */


// Start of sap\ca\ui\charts\BarListItem.js
///**
// * This file defines behavior for the control,
// */
//sap.m.DisplayListItem.prototype.init = function(){
//   // do something for initialization...
//};

}; // end of sap/ca/ui/charts/BarListItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.BubbleChartRenderer') ) {
jQuery.sap.declare("sap.ca.ui.charts.BubbleChartRenderer");


/**
 * @class BubbleChart2 renderer.
 * @static
 */
sap.ca.ui.charts.BubbleChartRenderer = sap.ca.ui.charts.ChartRenderer;

}; // end of sap/ca/ui/charts/BubbleChartRenderer.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartPopover') ) {
  jQuery.sap.declare('sap.ca.ui.charts.ChartPopover');
jQuery.sap.require('sap.m.Label'); // unlisted dependency retained

jQuery.sap.require('sap.m.List'); // unlisted dependency retained

jQuery.sap.require('sap.m.ResponsivePopover'); // unlisted dependency retained

jQuery.sap.require('sap.m.StandardListItem'); // unlisted dependency retained


jQuery.sap.require('sap.ui.model.json.JSONModel'); // unlisted dependency retained


/**
 * ChartPopover provides a popover used with charts to display chart selections. The selection can be added and removed.
 * Below is an example how to use with your chart:
 * 
 * var oPopover = new sap.ca.ui.charts.ChartPopover(<POPOVER_ID>, <ITEM_TEMPLATE>);
 * 
 * onChartClick = function(oEvent) {
 *    if ( !oPopover.isOpen() ) {
 *       oPopover.resetSelection();
 *          oPopover.openBy(this);
 *       }
 *          
 *       var sKey = <UNIQUE_KEY>;
 *       var sName = <NAME_TO_DISPLAY>;
 *       var sValue = <VALUE_TO_DISPLAY>;
 *
 *       if ( oPopover.getSelectionIndexFor(sKey) !== -1 ) {
 *          oPopover.removeSelection(sKey);
 *           
 *       } else {
 *          oPopover.addSelection({
 *             key:    sKey,
 *             name:   sName,
 *             value:  sValue
 *          });
 *       }
 *    }); 
 * }
 * 
 * @author I071883
 */

sap.ca.ui.charts.ChartPopover = function(sId, oData) {
   if ( typeof sId === "undefined" ) {
      throw new Error("The 'id' is undefined!");
   }
   
   this._oPopover = new sap.m.ResponsivePopover(sId, oData);
   if(!jQuery.device.is.phone){
       this._oPopover._oControl.oPopup.setAutoClose(false);
   }
   this._oPopover.setContentWidth('100%');
   this._oPopover.setContentHeight('100%');
   this._oPopover.addStyleClass('sapCaUiChartPopOver');

};

/**
 * Returns true if the popover is open, otherwise false.
 * 
 * @returns {boolean} true if the popover is open, otherwise false
 * 
 */
sap.ca.ui.charts.ChartPopover.prototype.isOpen = function() {
   return this._oPopover.isOpen();
};

/**
 * Opens the popover.
 */
sap.ca.ui.charts.ChartPopover.prototype.openBy = function(oControl, bSkipInstanceManager) {
   this._oPopover.openBy(oControl, bSkipInstanceManager);
};

/**
 * Closes the popover.
 */
sap.ca.ui.charts.ChartPopover.prototype.close = function() {
   this._oPopover.close();
};

/**
 * Returns the instance of the popover.
 */
sap.ca.ui.charts.ChartPopover.prototype.getControl = function() {
   return this._oPopover;
};

}; // end of sap/ca/ui/charts/ChartPopover.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartToolBar') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.ChartToolBar.
jQuery.sap.declare("sap.ca.ui.charts.ChartToolBar");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new charts/ChartToolBar.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getShowPersonalization showPersonalization} : boolean (default: false)</li>
 * <li>{@link #getShowFullScreen showFullScreen} : boolean (default: false)</li>
 * <li>{@link #getShowLegend showLegend} : boolean (default: true)</li>
 * <li>{@link #getChartTitle chartTitle} : string (default: '')</li>
 * <li>{@link #getFirstDimensionPath firstDimensionPath} : string (default: '')</li>
 * <li>{@link #getFirstDimensionKeyPath firstDimensionKeyPath} : string (default: '')</li>
 * <li>{@link #getFirstDimensionTextPath firstDimensionTextPath} : string (default: '')</li>
 * <li>{@link #getSecondDimensionPath secondDimensionPath} : string (default: '')</li>
 * <li>{@link #getSecondDimensionKeyPath secondDimensionKeyPath} : string (default: '')</li>
 * <li>{@link #getSecondDimensionTextPath secondDimensionTextPath} : string (default: '')</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getCharts charts} : sap.ui.core.Control[]</li>
 * <li>{@link #getToolBar toolBar} : sap.m.Bar</li></ul>
 * </li>
 * <li>Associations
 * <ul>
 * <li>{@link #getSelectedChart selectedChart} : string | sap.ui.core.Control</li>
 * <li>{@link #getFirstDimensionSelect firstDimensionSelect} : string | sap.m.Select</li>
 * <li>{@link #getSecondDimensionSelect secondDimensionSelect} : string | sap.m.Select</li></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.charts.ChartToolBar#event:personalizationPressed personalizationPressed} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.charts.ChartToolBar#event:firstDimensionKeySelected firstDimensionKeySelected} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.charts.ChartToolBar#event:secondDimensionKeySelected secondDimensionKeySelected} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * ToolBar used for displaying one chart amongst several and provide additional features:
 * - 2 select boxes for selecting dimensions
 * - fullscreen toggle
 * - personalization icon
 * - showLegend toggle
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.ChartToolBar
 */
sap.ui.core.Control.extend("sap.ca.ui.charts.ChartToolBar", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"showPersonalization" : {type : "boolean", group : "Misc", defaultValue : false},
		"showFullScreen" : {type : "boolean", group : "Misc", defaultValue : false},
		"showLegend" : {type : "boolean", group : "Misc", defaultValue : true},
		"chartTitle" : {type : "string", group : "Misc", defaultValue : ''},
		"firstDimensionPath" : {type : "string", group : "Misc", defaultValue : ''},
		"firstDimensionKeyPath" : {type : "string", group : "Misc", defaultValue : ''},
		"firstDimensionTextPath" : {type : "string", group : "Misc", defaultValue : ''},
		"secondDimensionPath" : {type : "string", group : "Misc", defaultValue : ''},
		"secondDimensionKeyPath" : {type : "string", group : "Misc", defaultValue : ''},
		"secondDimensionTextPath" : {type : "string", group : "Misc", defaultValue : ''}
	},
	aggregations : {
    	"charts" : {type : "sap.ui.core.Control", multiple : true, singularName : "chart"}, 
    	"toolBar" : {type : "sap.m.Bar", multiple : false}
	},
	associations : {
		"selectedChart" : {type : "sap.ui.core.Control", multiple : false}, 
		"firstDimensionSelect" : {type : "sap.m.Select", multiple : false}, 
		"secondDimensionSelect" : {type : "sap.m.Select", multiple : false}
	},
	events : {
		"personalizationPressed" : {}, 
		"firstDimensionKeySelected" : {}, 
		"secondDimensionKeySelected" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.ChartToolBar with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.ChartToolBar.extend
 * @function
 */

sap.ca.ui.charts.ChartToolBar.M_EVENTS = {'personalizationPressed':'personalizationPressed','firstDimensionKeySelected':'firstDimensionKeySelected','secondDimensionKeySelected':'secondDimensionKeySelected'};


/**
 * Getter for property <code>showPersonalization</code>.
 * Display or not the personalization icon into the ChartToolBar
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showPersonalization</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getShowPersonalization
 * @function
 */

/**
 * Setter for property <code>showPersonalization</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowPersonalization  new value for property <code>showPersonalization</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setShowPersonalization
 * @function
 */


/**
 * Getter for property <code>showFullScreen</code>.
 * Display or not the personalization icon into the ChartToolBar
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showFullScreen</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getShowFullScreen
 * @function
 */

/**
 * Setter for property <code>showFullScreen</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowFullScreen  new value for property <code>showFullScreen</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setShowFullScreen
 * @function
 */


/**
 * Getter for property <code>showLegend</code>.
 * Display or not the legend on the contained charts.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showLegend</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getShowLegend
 * @function
 */

/**
 * Setter for property <code>showLegend</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowLegend  new value for property <code>showLegend</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setShowLegend
 * @function
 */


/**
 * Getter for property <code>chartTitle</code>.
 * The string to display instead of the select boxes if there are no dimensions to display
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>chartTitle</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getChartTitle
 * @function
 */

/**
 * Setter for property <code>chartTitle</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sChartTitle  new value for property <code>chartTitle</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setChartTitle
 * @function
 */


/**
 * Getter for property <code>firstDimensionPath</code>.
 * Model path to the dimensions to display into the first select box
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>firstDimensionPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getFirstDimensionPath
 * @function
 */

/**
 * Setter for property <code>firstDimensionPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFirstDimensionPath  new value for property <code>firstDimensionPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setFirstDimensionPath
 * @function
 */


/**
 * Getter for property <code>firstDimensionKeyPath</code>.
 * Model path to the first select box items key
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>firstDimensionKeyPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getFirstDimensionKeyPath
 * @function
 */

/**
 * Setter for property <code>firstDimensionKeyPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFirstDimensionKeyPath  new value for property <code>firstDimensionKeyPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setFirstDimensionKeyPath
 * @function
 */


/**
 * Getter for property <code>firstDimensionTextPath</code>.
 * Model path to the first select box items displayed text
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>firstDimensionTextPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getFirstDimensionTextPath
 * @function
 */

/**
 * Setter for property <code>firstDimensionTextPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFirstDimensionTextPath  new value for property <code>firstDimensionTextPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setFirstDimensionTextPath
 * @function
 */


/**
 * Getter for property <code>secondDimensionPath</code>.
 * Model path to the dimensions to display into the second select box
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>secondDimensionPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getSecondDimensionPath
 * @function
 */

/**
 * Setter for property <code>secondDimensionPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSecondDimensionPath  new value for property <code>secondDimensionPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setSecondDimensionPath
 * @function
 */


/**
 * Getter for property <code>secondDimensionKeyPath</code>.
 * Model path to the second select box items key
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>secondDimensionKeyPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getSecondDimensionKeyPath
 * @function
 */

/**
 * Setter for property <code>secondDimensionKeyPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSecondDimensionKeyPath  new value for property <code>secondDimensionKeyPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setSecondDimensionKeyPath
 * @function
 */


/**
 * Getter for property <code>secondDimensionTextPath</code>.
 * Model path to the displayed select box items displayed text
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>secondDimensionTextPath</code>
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getSecondDimensionTextPath
 * @function
 */

/**
 * Setter for property <code>secondDimensionTextPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSecondDimensionTextPath  new value for property <code>secondDimensionTextPath</code>
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setSecondDimensionTextPath
 * @function
 */


/**
 * Getter for aggregation <code>charts</code>.<br/>
 * The charts to display. Theses charts are sap.ui.core/Control that implements the following properties:
 * - showLegend: boolean
 * - icon: string (expected a string such as "sap-icon://line-chart")
 * 
 * If the inserted control is an sap.m.Table, the icon is automatically set to "sap-icon://table-chart"
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getCharts
 * @function
 */


/**
 * Inserts a chart into the aggregation named <code>charts</code>.
 *
 * @param {sap.ui.core.Control}
 *          oChart the chart to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the chart should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the chart is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the chart is inserted at 
 *             the last position        
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#insertChart
 * @function
 */

/**
 * Adds some chart <code>oChart</code> 
 * to the aggregation named <code>charts</code>.
 *
 * @param {sap.ui.core.Control}
 *            oChart the chart to add; if empty, nothing is inserted
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#addChart
 * @function
 */

/**
 * Removes an chart from the aggregation named <code>charts</code>.
 *
 * @param {int | string | sap.ui.core.Control} vChart the chart to remove or its index or id
 * @return {sap.ui.core.Control} the removed chart or null
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#removeChart
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>charts</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#removeAllCharts
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>charts</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oChart the chart whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#indexOfChart
 * @function
 */
	

/**
 * Destroys all the charts in the aggregation 
 * named <code>charts</code>.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#destroyCharts
 * @function
 */


/**
 * Getter for aggregation <code>toolBar</code>.<br/>
 * The composite sap.m.Bar used for rendering select boxes and icons.
 * 
 * @return {sap.m.Bar}
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getToolBar
 * @function
 */


/**
 * Setter for the aggregated <code>toolBar</code>.
 * @param oToolBar {sap.m.Bar}
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setToolBar
 * @function
 */
	

/**
 * Destroys the toolBar in the aggregation 
 * named <code>toolBar</code>.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#destroyToolBar
 * @function
 */


/**
 * The ui5 control displayed
 *
 * @return {string} Id of the element which is the current target of the <code>selectedChart</code> association, or null
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getSelectedChart
 * @function
 */

/**
 * The ui5 control displayed
 *
 * @param {string | sap.ui.core.Control} vSelectedChart 
 *    Id of an element which becomes the new target of this <code>selectedChart</code> association.
 *    Alternatively, an element instance may be given.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setSelectedChart
 * @function
 */


	
/**
 * The sap.m.Select inserted into the toolBar for handling the firstDimension selection
 *
 * @return {string} Id of the element which is the current target of the <code>firstDimensionSelect</code> association, or null
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getFirstDimensionSelect
 * @function
 */

/**
 * The sap.m.Select inserted into the toolBar for handling the firstDimension selection
 *
 * @param {string | sap.m.Select} vFirstDimensionSelect 
 *    Id of an element which becomes the new target of this <code>firstDimensionSelect</code> association.
 *    Alternatively, an element instance may be given.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setFirstDimensionSelect
 * @function
 */


	
/**
 * The sap.m.Select inserted into the toolBar for handling the secondDimension selection
 *
 * @return {string} Id of the element which is the current target of the <code>secondDimensionSelect</code> association, or null
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#getSecondDimensionSelect
 * @function
 */

/**
 * The sap.m.Select inserted into the toolBar for handling the secondDimension selection
 *
 * @param {string | sap.m.Select} vSecondDimensionSelect 
 *    Id of an element which becomes the new target of this <code>secondDimensionSelect</code> association.
 *    Alternatively, an element instance may be given.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#setSecondDimensionSelect
 * @function
 */


	
/**
 * Event fired when a user clicks on the personalization icon 
 *
 * @name sap.ca.ui.charts.ChartToolBar#personalizationPressed
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'personalizationPressed' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself. 
 *  
 * Event fired when a user clicks on the personalization icon 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#attachPersonalizationPressed
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'personalizationPressed' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#detachPersonalizationPressed
 * @function
 */

/**
 * Fire event personalizationPressed to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.ChartToolBar#firePersonalizationPressed
 * @function
 */


/**
 * Event fired when a user selects an item from the first select box.
 * This event is providing the item selectedKey as parameter 
 *
 * @name sap.ca.ui.charts.ChartToolBar#firstDimensionKeySelected
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'firstDimensionKeySelected' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself. 
 *  
 * Event fired when a user selects an item from the first select box.
 * This event is providing the item selectedKey as parameter 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#attachFirstDimensionKeySelected
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'firstDimensionKeySelected' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#detachFirstDimensionKeySelected
 * @function
 */

/**
 * Fire event firstDimensionKeySelected to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.ChartToolBar#fireFirstDimensionKeySelected
 * @function
 */


/**
 * Event fired when a user selects an item from the second select box.
 * This event is providing the item selectedKey as parameter 
 *
 * @name sap.ca.ui.charts.ChartToolBar#secondDimensionKeySelected
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'secondDimensionKeySelected' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself. 
 *  
 * Event fired when a user selects an item from the second select box.
 * This event is providing the item selectedKey as parameter 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#attachSecondDimensionKeySelected
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'secondDimensionKeySelected' event of this <code>sap.ca.ui.charts.ChartToolBar</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ChartToolBar#detachSecondDimensionKeySelected
 * @function
 */

/**
 * Fire event secondDimensionKeySelected to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.ChartToolBar} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.ChartToolBar#fireSecondDimensionKeySelected
 * @function
 */


// Start of sap\ca\ui\charts\ChartToolBar.js
jQuery.sap.declare("sap.ca.ui.charts.ChartToolBar");
jQuery.sap.require('sap.m.Popover'); // unlisted dependency retained

jQuery.sap.require('sap.m.Button'); // unlisted dependency retained

jQuery.sap.require('sap.m.Bar'); // unlisted dependency retained

jQuery.sap.require('sap.m.Select'); // unlisted dependency retained

jQuery.sap.require('sap.m.Dialog'); // unlisted dependency retained




//called right after Control instantiation
sap.ca.ui.charts.ChartToolBar.prototype.init = function () {

    /*
    chart icons are stored so they are created onces, used several times
     */
    this._aChartIcons = [];

    /*
    buttons that are always there
     */
    this._oShowLegendButton = new sap.m.Button({
        icon: "sap-icon://menu",
        type: sap.m.ButtonType.Transparent,
        press: jQuery.proxy(this._onLegendButtonPress, this)
    }).addStyleClass("legendIcon");

    this._oShowAllChartButton = new sap.m.Button({
        type: sap.m.ButtonType.Transparent,
        press: jQuery.proxy(this._onShowAllChartPress, this)
    }).addStyleClass("allChartsIcon");

    this._oChartTitle = new sap.m.Label();

    /*
     buttons that depends on the control configuration
     */

    this._oPersonalizationButton = null;                //will be created if personalization is set to true
    this._oShowLegendAndPersonalizationPopover = null;  //will be created if personalization is set to true
    this._oShowLegendButtonSmall = null;                //will be created when personalization status is known
    this._oShowLegendButtonClone = null;                //will be created when personalization status is known
    this._oFullScreenButton =  null;                    //will be created if fullscreen is set to true
    this._oFullScreenExitButton =  null;                //will be created if fullscreen is set to true
    this._oFullScreenDialog =  null;                    //will be created if fullscreen is set to true

    /*
    buttons references
     */
    this._oActiveChartButton = null;

    /*
     dimension switch
     */
    this._oFirstDimensionSelect =  new sap.m.Select({
        width:"auto",
        change : jQuery.proxy(function (oEvent) {
        this.fireEvent("firstDimensionKeySelected", {
            selectedKey: oEvent.getParameter("selectedItem").getKey()
        });
    }, this)});
    this.setAssociation("firstDimensionSelect", this._oFirstDimensionSelect, false);

    this._oSecondDimensionSelect =  new sap.m.Select({
        width:"auto",
        change : jQuery.proxy(function (oEvent) {
        this.fireEvent("secondDimensionKeySelected", {
            selectedKey: oEvent.getParameter("selectedItem").getKey()
        });
    }, this)});
    this.setAssociation("secondDimensionSelect", this._oSecondDimensionSelect, false);

    this._oSecondDimensionTemplate = new sap.ui.core.Item();
    this._oFirstDimensionTemplate = new sap.ui.core.Item();

    /*
    containers
     */
    this._oAllChartList = new sap.m.List({
        mode: sap.m.ListMode.SingleSelectMaster,
        showSeparators: sap.m.ListSeparators.None,
        includeItemInSelection: true,
        width:"20em",
        select: jQuery.proxy(function (oEvent) {
            var sChartId = oEvent.getParameter("listItem").getCustomData()[0].getValue();
            this._switchChart(sChartId);
        }, this)
    });

    this._oShowAllChartPopover = new sap.m.Popover({
        placement: sap.m.PlacementType.Bottom,
        showHeader: false,
        content: [this._oAllChartList]
    }).addStyleClass("sapCaUiChartToolBarShowAllChartListPopover");

    this._oToolBar = new sap.m.Bar({
        translucent: true,
        width:"100%",
        contentLeft: [this._oChartTitle, this._oFirstDimensionSelect, this._oSecondDimensionSelect]
    }).addStyleClass("iconBar");

    //for binding propagation
    this.setAggregation("toolBar", this._oToolBar);

    /*
    resize handler
     */
    this.sResizeListenerId = null;
    if (jQuery.device.is.desktop) {
        this.sResizeListenerId = sap.ui.core.ResizeHandler.register(this, jQuery.proxy(this._setSelectMaxWidth, this));
    } else {
        sap.ui.Device.orientation.attachHandler(this._setSelectMaxWidth, this);
        sap.ui.Device.resize.attachHandler(this._setSelectMaxWidth, this);
    }
};

sap.ca.ui.charts.ChartToolBar.prototype.setToolBar = function (oObject, bSuppressInvalidate) {
   this.setAggregation("toolBar", oObject, bSuppressInvalidate);
   jQuery.sap.log.warning("ChartToolBar: the built-in toolBar aggregation content should not be overridden");
};

sap.ca.ui.charts.ChartToolBar.prototype.setChartTitle = function (sValue) {

    this._oChartTitle.setText(sValue);

    this.setProperty("chartTitle", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setShowLegend = function (bValue) {
    this.setProperty("showLegend", bValue);

    //propagate to all charts
    var aCharts = this.getAggregation("charts");

  if (aCharts) {
    for (var i = 0; i < aCharts.length; i++) {
        if (aCharts[i].setShowLegend)  {
            aCharts[i].setShowLegend(bValue);
            jQuery.sap.log.info("ChartToolBar: propagate showLegend to chart id " + aCharts[i].getId());
        }
        else {
            jQuery.sap.log.info("ChartToolBar: chart id " + aCharts[i].getId()+" is missing the showLegend property");
        }
    }
  }
};

sap.ca.ui.charts.ChartToolBar.prototype.setShowFullScreen = function (bValue) {
   if (bValue && ! this._oFullScreenButton && ! this._oFullScreenExitButton ) {
      this._oFullScreenButton =  new sap.m.Button({
          icon: "sap-icon://full-screen",
          type: sap.m.ButtonType.Transparent,
          visible:true,
          press: jQuery.proxy(this._onFullScreenPress, this)
      });

       this._oFullScreenExitButton =  new sap.m.Button({
           icon: "sap-icon://exit-full-screen",
           type: sap.m.ButtonType.Transparent,
           visible: false,
           press: jQuery.proxy(this._onFullScreenExitPress, this)
       });
   }

    this.setProperty("showFullScreen", bValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setFirstDimensionPath = function (sValue, bInvalidate) {
    this._oFirstDimensionSelect.bindAggregation("items", {path:sValue, template: this._oFirstDimensionTemplate});
    this.setProperty("firstDimensionPath", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setFirstDimensionKeyPath = function (sValue, bInvalidate) {
    this._oFirstDimensionTemplate.bindProperty("key", {path: sValue});
    this.setProperty("firstDimensionKeyPath", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setFirstDimensionTextPath = function (sValue, bInvalidate) {
    this._oFirstDimensionTemplate.bindProperty("text", {path: sValue});
    this.setProperty("firstDimensionTextPath", sValue);
};


sap.ca.ui.charts.ChartToolBar.prototype.setSecondDimensionPath = function (sValue, bInvalidate) {
    this._oSecondDimensionSelect.bindAggregation("items", {path:sValue, template: this._oSecondDimensionTemplate});
    this.setProperty("secondDimensionPath", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setSecondDimensionKeyPath = function (sValue, bInvalidate) {
    this._oSecondDimensionTemplate.bindProperty("key", {path: sValue});
    this.setProperty("secondDimensionKeyPath", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setSecondDimensionTextPath = function (sValue, bInvalidate) {
    this._oSecondDimensionTemplate.bindProperty("text", {path: sValue});
    this.setProperty("secondDimensionTextPath", sValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.setShowPersonalization = function (bValue) {

    //there is some personalization
    //display the personalization button
    //creates the personalizationAndLegend popover (for S sizes)
    //creates the _oShowLegendButtonSmall button (for S sizes)
    if (bValue) {
        if (! this._oPersonalizationButton) {
            this._oPersonalizationButton = new sap.m.Button({
                icon: "sap-icon://person-placeholder",
                type: sap.m.ButtonType.Transparent,
                press: jQuery.proxy(this.firePersonalizationPressed, this)
            }).addStyleClass("personalizationIcon");
        }

        if (! this._oShowLegendAndPersonalizationPopover) {
            if (!  this._oShowLegendButtonClone) {
                this._oShowLegendButtonClone = this._oShowLegendButton.clone();
            }

            this._oShowLegendAndPersonalizationPopover = new sap.m.Popover({
                placement: sap.m.PlacementType.Bottom,
                showHeader: false,
                content: [this._oShowLegendButtonClone, this._oPersonalizationButton.clone()]
            });
        }

        if (! this._oShowLegendButtonSmall) {
            this._oShowLegendButtonSmall = new sap.m.Button({
                icon: "sap-icon://overflow",
                type: sap.m.ButtonType.Transparent,
                press: jQuery.proxy(function () {
                    this._oShowLegendAndPersonalizationPopover.openBy(this._oShowLegendButtonSmall)
                }, this)
            }).addStyleClass("legendSmallIcon");
        }
    }

    //no personalization
    //creates the _oShowLegendButtonSmall button (for S sizes)
    else if (! this._oShowLegendButtonSmall) {
            this._oShowLegendButtonSmall = this._oShowLegendButton.clone()
                .removeStyleClass("legendIcon")
                .addStyleClass("legendSmallIcon");
    }

    this.setProperty("showPersonalization", bValue);
};

sap.ca.ui.charts.ChartToolBar.prototype.onBeforeRendering = function () {
  //todo should be optimized
    /*
     Chart Tool Bar
     contentLeft:
          | FirstDimensionSelect
          | SecondDimensionSelect
          OR
          | chartTitle if there are no dimensions provided
     contentMiddle:
        nothing
     contentRight
         0 - 2: chart/table icons
         3: show all charts icon (hidden by default)
         4: showLegend
         5: showLegend Small
         6: personalisation (optional)
         7: fullScreen (optional)
     */

    //content left management
    this._oFirstDimensionSelect.setVisible(this._oFirstDimensionSelect.getItems().length > 0);
    this._oSecondDimensionSelect.setVisible(this._oSecondDimensionSelect.getItems().length > 0);
    this._oChartTitle.setVisible(this._oFirstDimensionSelect.getItems().length == 0 && this._oSecondDimensionSelect.getItems().length == 0);

    //content right management
    this._oToolBar.removeContentRight();
    var iChart = 0;

    //first insert the chart icons if there are more than 1 chart
    if (this._aChartIcons.length >  1) {
        for (iChart = 0; iChart < this._aChartIcons.length; iChart++) {
            this._oToolBar.insertContentRight(this._aChartIcons[iChart], iChart);
        }

        this._oToolBar.insertContentRight(this._oShowAllChartButton, iChart++);
    }

    //then the behavior handling icons are displayed if there are some charts
    if (this._aChartIcons.length >  0) {
        this._oToolBar.insertContentRight(this._oShowLegendButton, iChart++);
        this._oToolBar.insertContentRight(this._oShowLegendButtonSmall, iChart++);
    }

    if (this.getShowPersonalization()) {
        this._oToolBar.insertContentRight(this._oPersonalizationButton, iChart++);
    }
    if (this.getShowFullScreen()) {
        this._oToolBar.insertContentRight(this._oFullScreenButton, iChart++);
        this._oToolBar.insertContentRight(this._oFullScreenExitButton, iChart++);
    }
};

sap.ca.ui.charts.ChartToolBar.prototype.onAfterRendering = function () {
    this._setSelectMaxWidth();
};

sap.ca.ui.charts.ChartToolBar.prototype.exit = function () {

    //remove resize handler
    if (jQuery.device.is.desktop && this.sResizeListenerId) {
        sap.ui.core.ResizeHandler.deregister(this.sResizeListenerId);
        this.sResizeListenerId = null;
    }
    else {
        sap.ui.Device.orientation.detachHandler(this._setSelectMaxWidth, this);
        sap.ui.Device.resize.detachHandler(this._setSelectMaxWidth, this);
    }

    if (this._oFirstDimensionTemplate) {
        this._oFirstDimensionTemplate.destroy();
        this._oFirstDimensionTemplate = null;
    }

    if (this._oSecondDimensionTemplate) {
        this._oSecondDimensionTemplate.destroy();
        this._oSecondDimensionTemplate = null;
    }

    //containers last
    if (this._oShowAllChartPopover) {
        this._oShowAllChartPopover.destroy();
        this._oShowAllChartPopover = null;
    }

    if (this._oShowLegendAndPersonalizationPopover) {
        this._oShowLegendAndPersonalizationPopover.destroy();
        this._oShowLegendAndPersonalizationPopover = null;
    }

    if (this._oFullScreenDialog) {
        this._oFullScreenDialog.destroy();
        this._oFullScreenDialog = null;
    }

   if (jQuery.device.is.desktop) {
        if (this.sResizeListenerId) {
            sap.ui.core.ResizeHandler.deregister(this.sResizeListenerId);
            this.sResizeListenerId = null;
        }
    }
    else {
        sap.ui.Device.orientation.detachHandler(this._setSelectMaxWidth, this);
        sap.ui.Device.resize.detachHandler(this._setSelectMaxWidth, this);
    }
};

//@overrides insert a chart into the charts aggregation
sap.ca.ui.charts.ChartToolBar.prototype.addChart = function (oObject, bSuppressInvalidate) {
    this._onAddingChart(oObject);
};

//@overrides remove all charts from the charts aggregation
sap.ca.ui.charts.ChartToolBar.prototype.removeAllCharts = function () {
    for (var i = 0; i < this._aChartIcons.length; i++) {
        if (this._aChartIcons.destroy) {
            this._aChartIcons.destroy();
        }
    }

    this._aChartIcons = [];
    this._oAllChartList.removeAllItems();

    return this.removeAllAggregation("charts");
};


//@overrides remove all charts from the charts aggregation
sap.ca.ui.charts.ChartToolBar.prototype.removeChart = function (iIndex) {
    jQuery.sap.log.error("ChartToolBar: removeChart method is not supported, doing removeAllCharts instead");
    return this.removeAllCharts();
};


//@overrides insert a chart into the charts aggregation
sap.ca.ui.charts.ChartToolBar.prototype.insertChart = function (oObject, iIndex, bSuppressInvalidate) {
    jQuery.sap.log.error("ChartToolBar: insertChart method is not supported, doing addChart instead");
    this._onAddingChart(oObject);
};

//@overrides insert a chart into the charts aggregation
sap.ca.ui.charts.ChartToolBar.prototype.insertChart = function (oObject, iIndex, bSuppressInvalidate) {
    this._onAddingChart(oObject);
};


//@overrides insert a chart into the charts association
//set the icon of the showAllChart button to the last selected Chart
sap.ca.ui.charts.ChartToolBar.prototype.setSelectedChart = function (sId, bSuppressInvalidate) {
    var oChart = null;

    if (sId instanceof sap.ui.core.Control) {
        oChart = sId;
    }
    else {
        oChart = this._findChartById(sId);
    }

    //show/hide the showLegend buttons
    var bShowTable = ! (oChart instanceof sap.m.Table);             //hide if table, show if chart
    this._oShowLegendButton.setEnabled(bShowTable);                 //XL-L cases
    if (this.getShowPersonalization()) {
        if (this._oShowLegendButtonClone) {
            this._oShowLegendButtonClone.setEnabled(bShowTable);    //S case with personalization
        }
    }
    else {
        if (this._oShowLegendButtonSmall) {
            this._oShowLegendButtonSmall.setEnabled(bShowTable);    //S case without personalization
        }
    }

    if (oChart instanceof sap.m.Table) {
        this._oShowAllChartButton.setIcon("sap-icon://table-chart");
    }
    else if (oChart.getIcon) {
            this._oShowAllChartButton.setIcon(oChart.getIcon());
    }
    else {
        jQuery.sap.log.error("ChartToolBar:control id "+ oChart.getId() +" is not a sap.m.Table and has no getIcon method");
    }
    this.setAssociation("selectedChart", oChart, bSuppressInvalidate);
};

//@overrides set the firstDimensionSelect control
sap.ca.ui.charts.ChartToolBar.prototype.setFirstDimensionSelect = function (sId, bSuppressInvalidate) {
    jQuery.sap.log.error("ChartToolBar: setFirstDimensionSelect method is not supported");
};

//@overrides set the secondDimensionSelect control
sap.ca.ui.charts.ChartToolBar.prototype.setSecondDimensionSelect = function (sId, bSuppressInvalidate) {
    jQuery.sap.log.error("ChartToolBar: setSecondDimensionSelect method is not supported");
};

//private methods  ------------------------------------------------------------------------------------//
//if the 2 selects are filled they should take 50% of the available space, or 100% if only 1 selector is filled
sap.ca.ui.charts.ChartToolBar.prototype._setSelectMaxWidth = function () {
    if (this._oFirstDimensionSelect.getItems().length > 0) {
        var $toolbar = this._oToolBar.$();
        var availableSpace = $toolbar.width() - $toolbar.find(".sapMBarRight").width();

        if (this._oSecondDimensionSelect.getItems().length > 0) {
            availableSpace = Math.floor(availableSpace / 2);
            this._oFirstDimensionSelect.setMaxWidth(availableSpace+"px");
            this._oSecondDimensionSelect.setMaxWidth(availableSpace+"px");
        }
        else {
            this._oFirstDimensionSelect.setMaxWidth(availableSpace+"px");
        }
    }
};

//takes the icon from the inserted chart
sap.ca.ui.charts.ChartToolBar.prototype._onAddingChart = function (oChart) {

  //overrides the chart showLegend property with the control one
  if (oChart.setShowLegend) {
      oChart.setShowLegend(this.getShowLegend());
  }

    this.addAggregation("charts", oChart);

    //creates the icon button
    var oButtonIcon = new sap.m.Button({
        type: sap.m.ButtonType.Transparent,
        customData: [
            new sap.ui.core.CustomData({
                key : 'chartId',
                value : oChart.getId()
            })
        ],
        press: jQuery.proxy(function (oEvent) {
            var sChartId = oEvent.getSource().getCustomData()[0].getValue();
            this._switchChart(sChartId);
        }, this)
    }).addStyleClass("chartIcon");

     //if this is a table, then creates the icon on the fly
    if (oChart instanceof sap.m.Table) {
        oButtonIcon.setIcon("sap-icon://table-chart");
    }
    else  if (oChart.getIcon) {
        oButtonIcon.setIcon(oChart.getIcon());
    }
    else {
        jQuery.sap.log.error("ChartToolBar: inserted control id "+ oChart.getId() +" is not a sap.m.Table and has no getIcon method");
    }

    //add  the icon to the icon bar
    this._aChartIcons.push(oButtonIcon);

    //add the icon to the chart icon list (into the showAllChart popover)
    var oShowAllItem = new sap.m.StandardListItem({
        icon: oButtonIcon.getIcon(),
        title: this._findChartName(oChart),
        customData: [
            new sap.ui.core.CustomData({
                key : 'chartId',
                value : oChart.getId()
            })
        ]
    });
    this._oAllChartList.addItem(oShowAllItem);

    //the first added chart is the selected and active one
    if (this.getAggregation("charts").length == 1) {
        this.setSelectedChart(oChart);
        this._oActiveChartButton = oButtonIcon.addStyleClass("activeButton");
    }
};

sap.ca.ui.charts.ChartToolBar.prototype._findChartName = function (oChart) {

    var sLabel = "";

    //ideal case
    if (oChart.getLabel) {
        sLabel = oChart.getLabel();
    }
    //table case
    else if (oChart instanceof sap.m.Table) {
        sLabel = sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Table");
    }
    else {
        jQuery.sap.log.error("ChartToolBar: can't find chart label for chart id "+oChart.getId())
    }

    return sLabel;
};

//retrieve the chart from the charts aggregation which id match the give sId
sap.ca.ui.charts.ChartToolBar.prototype._findChartById = function (sId) {
    var oChart = null;

    var aCharts =  this.getAggregation("charts");

    if (aCharts) {
        for (var i = 0; ! oChart &&  i < aCharts.length; i++) {
            if (aCharts[i].getId() === sId) {
                oChart = aCharts[i];
            }
        }
    }

    return oChart;
};

//fired on press on the showLegend button: toggle showLegend property
sap.ca.ui.charts.ChartToolBar.prototype._onLegendButtonPress = function (oEvent) {
    this.setShowLegend(! this.getShowLegend());

    //fix: on tablet, the popover remains open, thus close it
    if (this._oShowLegendAndPersonalizationPopover && this._oShowLegendAndPersonalizationPopover.isOpen()) {
        this._oShowLegendAndPersonalizationPopover.close();
    }
};

//fired on press on the showLegend button: toggle showLegend property
sap.ca.ui.charts.ChartToolBar.prototype._onFullScreenExitPress = function (oEvent) {
    jQuery.sap.log.info("ChartToolBar: exiting fullscreen");

    this._oFullScreenButton.setVisible(true);
    this._oFullScreenExitButton.setVisible(false);

    this._oFullScreenDialog.close();
    this.invalidate();
};

//fired on press on the showLegend button: toggle showLegend property
sap.ca.ui.charts.ChartToolBar.prototype._onFullScreenPress = function (oEvent) {
    jQuery.sap.log.info("ChartToolBar: toggle to fullscreen");

    this._oFullScreenButton.setVisible(false);
    this._oFullScreenExitButton.setVisible(true);
    this._oToolBar.rerender();

    if (!this._oFullScreenDialog) {
    	this._oFullScreenDialog = new sap.ca.ui.Overlay();
    }

    this._oFullScreenDialog.open( this );
    this.invalidate();
};

//when a user is pressing on an chat icon either from the bar or from the all charts popover
//can be called either from the button icon (toolbar) or from the showAllChart popover (standardListItem)
//the origin is abstracted by using only the chartId
sap.ca.ui.charts.ChartToolBar.prototype._switchChart = function (sChartId) {

    //find the corresponding pressed chart icon from the toolbar
    var oRelatedButton = null;
    for (var i = 0; ! oRelatedButton && i < this._aChartIcons.length; i++) {
        if (this._aChartIcons[i].getCustomData()[0].getValue() === sChartId) {
            oRelatedButton = this._aChartIcons[i];
        }
    }

    if (oRelatedButton) {
        if (this._oActiveChartButton) {
            this._oActiveChartButton.removeStyleClass("activeButton");
        }

        this._oActiveChartButton = oRelatedButton;
        this._oActiveChartButton.addStyleClass("activeButton");
    }

    var oChart = this._findChartById(sChartId);

    this.setSelectedChart(oChart);

    //fix: on tablet, the popover remains open, thus close it
    if (this._oShowAllChartPopover.isOpen()) {
        this._oShowAllChartPopover.close();
    }

    jQuery.sap.log.info("ChartToolBar: switch to chart id "+sChartId);
};

//fired when a user clicks on the showAllChart button
sap.ca.ui.charts.ChartToolBar.prototype._onShowAllChartPress = function (oEvent) {
   this._oShowAllChartPopover.openBy(this._oShowAllChartButton);
};

}; // end of sap/ca/ui/charts/ChartToolBar.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartType') ) {
jQuery.sap.declare("sap.ca.ui.charts.ChartType");


/**
 * @class Types of chart supported in the sap.ca library.
 *
 * @version 1.16.4-SNAPSHOT
 * @static
 * @public
 */
sap.ca.ui.charts.ChartType = {

    /**
     * A Bar Chart using "viz/bar" chart
     * @public
     */
    Bar: "Bar",

    /**
     * A Stacked Bar Chart using "viz/stacked_bar" chart
     * @public
     */
    StackedBar: "StackedBar",

    /**
     * A 100% Stacked Bar Chart using "viz/100_stacked_bar" chart
     * @public
     */
    StackedBar100: "StackedBar100",

    /**
     * A Dual Stacked Bar Chart using "viz/dual_stacked_bar" chart
     * @public
     */
    DualStackedBar: "DualStackedBar",

    /**
     * A 100% Dual Stacked Bar Chart using "viz/100_dual_stacked_bar" chart
     * @public
     */
    DualStackedBar100: "DualStackedBar100",

    /**
     * A Column Chart using "viz/column" chart
     * @public
     */
    Column: "Column",

    /**
     * A Stacked Column Chart using "viz/stacked_column" chart
     * @public
     */
    StackedColumn: "StackedColumn",

    /**
     * A 100% Stacked Column Chart using "viz/100_stacked_column" chart
     * @public
     */
    StackedColumn100: "StackedColumn100",

    /**
     * A Dual Stacked Column Chart using "viz/dual_stacked_column" chart
     * @public
     */
    DualStackedColumn: "DualStackedColumn",

    /**
     * A 100% Dual Stacked Column Chart using "viz/100_dual_stacked_column" chart
     * @public
     */
    DualStackedColumn100: "DualStackedColumn100",

    /**
     * A Line Chart using "viz/line" chart
     * @public
     */
    Line: "Line",

    /**
     * A Combination chart using "viz/combination" chart
     * @public
     */
    Combination: "Combination",

    /**
     * A Bubble chart using "viz/bubble" chart
     * @public
     */
    Bubble: "Bubble"

};

sap.ca.ui.charts.ChartType.M_CHARTPROPERTIES = {
    "Bar": {
        name: "Bar",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Bar"),
        stacked: false,
        icon: "sap-icon://horizontal-bar-chart",
        scroll: {
            vertical: true,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "StackedBar": {
        name: "StackedColumn",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.StackedBar"),
        vizType : "viz/stacked_bar",
        stacked: true,
        icon: "sap-icon://horizontal-stacked-chart",
        scroll: {
            vertical: true,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "StackedBar100": {
        name: "StackedColumn100",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.StackedBar100"),
        vizType : "viz/100_stacked_bar",
        stacked: true,
        icon: "sap-icon://full-stacked-chart",
        scroll: {
            vertical: true,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "DualStackedBar": {
        name: "DualStackedColumn",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.DualStackedBar"),
        vizType : "viz/dual_stacked_bar",
        stacked: true,
        icon: "sap-icon://horizontal-stacked-chart",
        scroll: {
            vertical: true,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : true,
        alignScales : true
    },
    "DualStackedBar100": {
        name: "DualStackedColumn100",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.DualStackedBar100"),
        vizType : "viz/100_dual_stacked_bar",
        stacked: true,
        icon: "sap-icon://full-stacked-chart",
        scroll: {
            vertical: true,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : true,
        alignScales : false
    },
    "Column": {
        name: "Column",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Column"),
        stacked: false,
        icon: "sap-icon://vertical-bar-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "StackedColumn": {
        name: "StackedColumn",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.StackedColumn"),
        stacked: true,
        icon: "sap-icon://vertical-stacked-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "StackedColumn100": {
        name: "StackedColumn100",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.StackedColumn100"),
        stacked: true,
        icon: "sap-icon://full-stacked-column-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "DualStackedColumn": {
        name: "DualStackedColumn",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.DualStackedColumn"),
        stacked: true,
        icon: "sap-icon://vertical-stacked-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : true,
        alignScales : true
    },
    "DualStackedColumn100": {
        name: "DualStackedColumn100",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.DualStackedColumn100"),
        stacked: true,
        icon: "sap-icon://full-stacked-column-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : true,
        alignScales : false
    },
    "Line": {
        name: "Line",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Line"),
        stacked: false,
        icon: "sap-icon://line-chart",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : true,
        dataLabelPosition : "outside",
        dualAxis : false
    },
    "Combination": {
        name: "Combination",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Combination"),
        stacked: true,
        icon: "sap-icon://business-objects-experience",
        scroll: {
            vertical: false,
            horizontal: true
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    },
    "Bubble": {
        name: "Bubble",
        displayLabel: sap.ca.ui.utils.resourcebundle.getText("ChartToolBar.ChartName.Bubble"),
        stacked: true,
        icon: "sap-icon://bubble-chart",
        scroll: {
            vertical: false,
            horizontal: false
        },
        showHoverLine : false,
        dataLabelPosition : "inside",
        dualAxis : false
    }
}

sap.ca.ui.charts.ChartType.getChartProperties = function (oChartType) {
    var oChartProperties = sap.ca.ui.charts.ChartType.M_CHARTPROPERTIES[oChartType];
    if (oChartProperties == null) {
        jQuery.sap.log.error("Unknown Chart Type " + oChartType + " is not a recognized type");
    }
    return oChartProperties;
}

}; // end of sap/ca/ui/charts/ChartType.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ClusterListItem') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.ClusterListItem.
jQuery.sap.declare("sap.ca.ui.charts.ClusterListItem");

jQuery.sap.require('sap.m.ListItemBase'); // unlisted dependency retained



/**
 * Constructor for a new ClusterListItem.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getTitle title} : string</li>
 * <li>{@link #getItems items} : object</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.ListItemBase#constructor sap.m.ListItemBase}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * The cluster list item consists of a title and items.
 * @extends sap.m.ListItemBase
 *
 * @author SAP AG 
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.ClusterListItem
 */
sap.m.ListItemBase.extend("sap.ca.ui.charts.ClusterListItem", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"title" : {type : "string", group : "Misc", defaultValue : null},
		"items" : {type : "object", group : "Data", defaultValue : null}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.ClusterListItem with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.ClusterListItem.extend
 * @function
 */


/**
 * Getter for property <code>title</code>.
 * Title
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>title</code>
 * @public
 * @name sap.ca.ui.charts.ClusterListItem#getTitle
 * @function
 */

/**
 * Setter for property <code>title</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.charts.ClusterListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ClusterListItem#setTitle
 * @function
 */


/**
 * Getter for property <code>items</code>.
 * Items
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>items</code>
 * @public
 * @name sap.ca.ui.charts.ClusterListItem#getItems
 * @function
 */

/**
 * Setter for property <code>items</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oItems  new value for property <code>items</code>
 * @return {sap.ca.ui.charts.ClusterListItem} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.ClusterListItem#setItems
 * @function
 */


// Start of sap\ca\ui\charts\ClusterListItem.js
jQuery.sap.require('sap.m.ListItemBase'); // unlisted dependency retained

sap.ca.ui.charts.ClusterListItem.prototype.init = function() {
    sap.m.ListItemBase.prototype.init.apply(this, arguments);
    this.addStyleClass("sapCaUiCLI");
};

}; // end of sap/ca/ui/charts/ClusterListItem.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.dialog.Confirm.controller') ) {
  jQuery.sap.declare('sap.ca.ui.dialog.Confirm.controller');

sap.ui.controller("sap.ca.ui.dialog.Confirm", {
	_CONFIRM_NOTE_ID: "TXA_NOTE",
	_CONFIRM_BUTTON_ID: "BTN_CONFIRM",
	_CONFIRM_DIALOG_ID: "DLG_CONFIRM",
	_CONFIRM_VERTICALLAYOUT_SM_ID: "VLT_ADDINFO",
	_CONFIRM_TEXT_EMPTYLINE: "TXT_EMPTYLINE",
	_bNoteMandatory: false,
	_sPreviousInput: "",
/**
* Called when a controller is instantiated and its View controls (if available) are already created.
* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.
* @memberOf About
*/
	onInit: function() {
		if (jQuery.device.is.phone === false) {
			var oDlg = this.getView().byId(this._CONFIRM_DIALOG_ID);
			oDlg.setContentWidth("25em"); 
		}
		
		//set visible binding
		var oVerticalLayout = this.getView().byId(this._CONFIRM_VERTICALLAYOUT_SM_ID);
		oVerticalLayout.bindProperty("visible", {
			path:'/additionalInformation',
			formatter: function(oInfo) {
				return (oInfo && oInfo.length>0) ? true : false;
			}
		});
		var oEmptyText = this.getView().byId(this._CONFIRM_TEXT_EMPTYLINE);
		oEmptyText.bindProperty("visible", {
			path:'/additionalInformation',
			formatter: function(oInfo) {
				return (oInfo && oInfo.length>0) ? false : true;
			}
		});
	},
	
	onBeforeOpenDialog: function(){
		//remove previous note value
		var oTXANote = this.getView().byId(this._CONFIRM_NOTE_ID);
		oTXANote.setValue(""); 
		this._sPreviousInput = "";
		
		//get the noteMandatory property via model
		this._bNoteMandatory = false;
		var oDlgModel = this.getView().byId(this._CONFIRM_DIALOG_ID).getModel();
		if (oDlgModel) {
			this._bNoteMandatory = oDlgModel.getProperty("/noteMandatory");
			//set the confirm button correspondingly
			if (this._bNoteMandatory) { 
				this.enableConfirmButton(false);
				oTXANote.setPlaceholder(sap.ca.ui.utils.resourcebundle.getText("YMSG_TEXT_NOTE_MANDATORY"));
			} else {
				this.enableConfirmButton(true);
				oTXANote.setPlaceholder(sap.ca.ui.utils.resourcebundle.getText("YMSG_TEXT_NOTE"));
			}
			
			//set note visible or not
			if (this._bNoteMandatory) {
				oTXANote.setVisible(true);
			} else {
				if (oDlgModel.getProperty("/showNote")) {
					oTXANote.setVisible(true);
				} else {
					oTXANote.setVisible(false);
				}
			}
		}
	},
	
	onConfirmDialog: function(oEvent) {
		var oTXANote = this.getView().byId(this._CONFIRM_NOTE_ID);
		var oResult = {
				isConfirmed: true,
				sNote: oTXANote.getValue()
		};
		sap.ca.ui.dialog.factory.closeDialog(this._CONFIRM_DIALOG_ID, oResult);
	},
	
	onCancelDialog: function(oEvent) {
		var oResult = {
				isConfirmed: false
		};
		sap.ca.ui.dialog.factory.closeDialog(this._CONFIRM_DIALOG_ID, oResult);
	},
	
	onNoteInput: function(oEvent) {
		var sNewValue = oEvent.getParameters().value?oEvent.getParameters().value:oEvent.getParameters().newValue;
		sNewValue = jQuery.trim(sNewValue); //remove the starting and ending white spaces
		if (sNewValue && !this._sPreviousInput) {
			//set the confirm button enabled
			this.enableConfirmButton(true);
		} else {
			if (this._sPreviousInput && !sNewValue && this._bNoteMandatory) {
				//set the confirm button disabled
				this.enableConfirmButton(false);
			}
		}
		this._sPreviousInput = (sNewValue)?sNewValue:"";
	},
	
	enableConfirmButton: function(bEnabled) {
		var oBTNConfirm = this.getView().byId(this._CONFIRM_BUTTON_ID);
		if (oBTNConfirm.getEnabled() !== bEnabled) {
			oBTNConfirm.setEnabled(bEnabled);
//			if (!bEnabled) { //make the button in disabled/enabled style
//				oBTNConfirm.addStyleClass("sapMBtnDisabled");
//			} else {
//				oBTNConfirm.removeStyleClass("sapMBtnDisabled");
//			}
			oBTNConfirm.rerender(); //rerender to SHOW button in the dialog is enabled/disabled
		}
	},
	
	formatVisible: function(sText) {
		if (sText && sText.length>0) return true;
		return false;
	}
/**
* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered
* (NOT before the first rendering! onInit() is used for that one!).
* @memberOf About
*/
//	onBeforeRendering: function() {
//
//	},

/**
* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.
* This hook is the same one that SAPUI5 controls get after being rendered.
* @memberOf About
*/
//	onAfterRendering: function() {
//
//	},

/**
* Called when the Controller is destroyed. Use this one to free resources and finalize activities.
* @memberOf About
*/
//	onExit: function() {
//
//	}

});
}; // end of sap/ca/ui/dialog/Confirm.controller.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.dialog.Forward.controller') ) {
  jQuery.sap.declare('sap.ca.ui.dialog.Forward.controller');

sap.ui.controller("sap.ca.ui.dialog.Forward", {
	_FORWARD_DIALOG_ID: "DLG_FORWARD",
	_SEARCH_FIELD_ID: "SFD_FORWARD",
	_FORWARDER_LIST_ID: "LST_AGENTS",
	_FORWARDER_ITEM_ID: "ITM_AGENT",
/**
* Called when a controller is instantiated and its View controls (if available) are already created.
* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.
* @memberOf About
*/
	onInit: function() {
		var agentlist = this.getView().byId(this._FORWARDER_LIST_ID);
		agentlist.bindProperty("showNoData", {
			path:'/agents',
			formatter: function(arrFoundAgents) {
				return (arrFoundAgents === undefined) ? false : true;
			}
		});
		
		var agentItem = this.getView().byId(this._FORWARDER_ITEM_ID);
		agentItem.bindProperty("icon", {
			path:'ImageURL',
			formatter: function(sURL) {
				return (sURL) ? sURL : "sap-icon://person-placeholder";
			}
		});
	},
	
	onBeforeOpenDialog: function() {
		//NOTE: the Forward Dialog is currently only opened by APPs, there is NO internal navigation back to this Dialog.
		//e.g. from Forward Confirmation Dialog back to this dialog. 
		//For the internal navigation, need to check if the state of the dialog should be kept.
		
		//remove previous search value
		var fldSearch = this.getView().byId(this._SEARCH_FIELD_ID);
		fldSearch.setValue("");
		fldSearch.focus();
		
		//remove the previous startExernalSearch function and set it from Dialog model
		this.startExternalSearch = undefined;
		var oDlgModel = this.getView().byId(this._FORWARD_DIALOG_ID).getModel();
		if (oDlgModel) {
			this.startExternalSearch = oDlgModel.getProperty("/startExternalSearch");
		}
		
		this._oSelectedAgent = null;
	},
	
	onStartSearch: function(oEvent) {
		var sSearchTerm = oEvent.getParameters().query;
		if (sSearchTerm) {//search term is NOT empty
			if (this.startExternalSearch) {
				this.startExternalSearch(sSearchTerm);
			} else { //Special Case: if there is NO external search provided, handle it as there is no result is found
				this.setAgents(null); 
			}
		} else { //search term is EMPTY
			//set the dialog back to initial state
			this.setAgents(undefined); 
		}
	},
	
	onSelectAgent: function(oEvent) {
		var oSelectedItem = oEvent.getParameters().listItem;
		if (oSelectedItem && oSelectedItem.getBindingContext()) {
			//1. close the current dialog at first
			this.getView().byId(this._FORWARD_DIALOG_ID).close();
			//2. open the confirmation dialog
			var oSelectedAgent = oSelectedItem.getBindingContext().getObject();
			sap.ca.ui.dialog.confirmation.open({
				question : sap.ca.ui.utils.resourcebundle.getText("forward.question", oSelectedAgent.FullName),
				showNote : true,
				title : sap.ca.ui.utils.resourcebundle.getText("forward.title"),
				confirmButtonLabel : sap.ca.ui.utils.resourcebundle.getText("dialog.ok"),
				agent : oSelectedAgent //further property for the confirmation dialog
			}, this.forwardConfirmClose);
		}
	},
	
	onCancelDialog: function() {
		var oResult = {
				bConfirmed: false
		};
		sap.ca.ui.dialog.factory.closeDialog("DLG_FORWARD", oResult);
	},
	
	setAgents: function(arr) {
		this.getView().byId(this._FORWARD_DIALOG_ID).getModel().setProperty("/agents", arr);//set new agents value
		this.getView().byId(this._FORWARDER_LIST_ID).rerender();
	},
	
	forwardConfirmClose: function(oResult) {
		var oNewResult = {};
		//call the APP forward close function
		if (oResult && oResult.isConfirmed) {
			oNewResult = {
					bConfirmed: true,
					sNote: oResult.sNote,
					oAgentToBeForwarded: this.agent //this is the confirmation dialog object
			}
		} else {
			oNewResult = {
					bConfirmed: false
			};
		}
		sap.ca.ui.dialog.factory.closeDialog("DLG_FORWARD", oNewResult);
	}
/**
* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered
* (NOT before the first rendering! onInit() is used for that one!).
* @memberOf About
*/
//	onBeforeRendering: function() {
//
//	},

/**
* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.
* This hook is the same one that SAPUI5 controls get after being rendered.
* @memberOf About
*/
//	onAfterRendering: function() {
//
//	},

/**
* Called when the Controller is destroyed. Use this one to free resources and finalize activities.
* @memberOf About
*/
//	onExit: function() {
//
//	}

});
}; // end of sap/ca/ui/dialog/Forward.controller.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.dialog.SelectItem.controller') ) {
  jQuery.sap.declare('sap.ca.ui.dialog.SelectItem.controller');

sap.ui.controller("sap.ca.ui.dialog.SelectItem", {
	_SELECTITEM_DIALOG_ID: "DLG_SLTITEM",
	_SELECTITEM_LIST_ID: "LST_ITEMS",
/**
* Called when a controller is instantiated and its View controls (if available) are already created.
* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.
* @memberOf About
*/
//	onInit: function() {
//		
//	},
	
	onBeforeOpenDialog: function() {
		//set default selection
		var oDlgModel = this.getView().byId(this._SELECTITEM_DIALOG_ID).getModel();
		if (oDlgModel) {
			var iDefaultIndex = oDlgModel.getProperty("/defaultIndex");
			//set the default selection
			var lstItems = this.getView().byId(this._SELECTITEM_LIST_ID);
			var arrItems = lstItems.getItems();
			if (arrItems && iDefaultIndex >= 0 && iDefaultIndex < arrItems.length) {
				lstItems.setSelectedItem(arrItems[iDefaultIndex], true); //mark the selection on UI
			}
		}
	},
	
	onSelectionChange: function(oEvent) {
		var oSelectedItem = oEvent.getParameters().listItem;
		if (oSelectedItem && oSelectedItem.getBindingContext()) {
			//1. close the current dialog at first
			this.getView().byId(this._SELECTITEM_DIALOG_ID).close();
			//2. open the confirmation dialog
			var oSelectedObject = oSelectedItem.getBindingContext().getObject();
			var oResult = {
					selectedIndex: oEvent.getParameters().listItem.getParent().indexOfItem(oSelectedItem),
					selectedItem: oSelectedObject
			};
			sap.ca.ui.dialog.factory.closeDialog(this._SELECTITEM_DIALOG_ID, oResult);
		}
	},
	
	onCancelDialog: function() {
		var oResult = {
				selectedIndex: -1,
				selectedItem: null
		};
		sap.ca.ui.dialog.factory.closeDialog(this._SELECTITEM_DIALOG_ID, oResult);
	}
/**
* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered
* (NOT before the first rendering! onInit() is used for that one!).
* @memberOf About
*/
//	onBeforeRendering: function() {
//
//	},

/**
* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.
* This hook is the same one that SAPUI5 controls get after being rendered.
* @memberOf About
*/
//	onAfterRendering: function() {
//
//	},

/**
* Called when the Controller is destroyed. Use this one to free resources and finalize activities.
* @memberOf About
*/
//	onExit: function() {
//
//	}

});
}; // end of sap/ca/ui/dialog/SelectItem.controller.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.message.message') ) {
jQuery.sap.declare("sap.ca.ui.message.message");

jQuery.sap.require('sap.m.MessageToast'); // unlisted dependency retained


jQuery.sap.require('sap.ui.core.library'); // unlisted dependency retained


sap.ca.ui.message = (function() {
	var _oType = {
		ERROR : {
			title : sap.ca.ui.utils.resourcebundle.getText("messagetype.error"),
			valueState : sap.ui.core.ValueState.Error
		},
		WARNING : {
			title : sap.ca.ui.utils.resourcebundle.getText("messagetype.warning"),
			valueState : sap.ui.core.ValueState.Warning
		},
		SUCCESS : {
			title : sap.ca.ui.utils.resourcebundle.getText("messagetype.success"),
			valueState : sap.ui.core.ValueState.Success
		},
		INFO : {
			title : sap.ca.ui.utils.resourcebundle.getText("messagetype.info"),
			valueState : sap.ui.core.ValueState.None
		}
	};

	var _getString = function(value) {
		var result = (jQuery.type( value ) === "string") ? value : "";
		// trim string
		return jQuery.trim(result);
	};
	
	var _getState = function(value) {
		var result = (value) ? value : sap.ui.core.ValueState.None;
		return result;
	};
	
	var _getIcon = function(value) {
		var result = (value && value === _oType.INFO) ? "sap-icon://hint" : "";
		return result;
	};
	
	var _initAndOpen = function(oSettings, fnClose) {
		var _oSettings = {};
		if (oSettings) {
			if (oSettings.type) {
				_oSettings.title = _getString(oSettings.type.title);
				_oSettings.state = _getState(oSettings.type.valueState);
				_oSettings.icon = _getIcon(oSettings.type);
				_oSettings.message = _getString(oSettings.message);
				//get and set Details, and Details should be not the same text as Message
				var sDetails = _getString(oSettings.details);
				_oSettings.details = (sDetails && sDetails !== _oSettings.message) ? sDetails : "";
				_oSettings.showLink = (_oSettings.details) ? true : false;
				_oSettings.showDetails = false; //invisible as default
			}
		}
		sap.ca.ui.dialog.factory.showMessageBox(_oSettings, fnClose);
	};
	
	return {
		showMessageBox : function(oSettings, fnClose) {
			_initAndOpen(oSettings, fnClose);
		},
		
		showMessageToast : function(sMessage) {
			sap.m.MessageToast.show(sMessage);
		}, 
		
		Type : _oType
	}
}());
}; // end of sap/ca/ui/message/message.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.DateFormat') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.DateFormat
jQuery.sap.declare("sap.ca.ui.model.format.DateFormat");
jQuery.sap.require('sap.ui.core.format.DateFormat'); // unlisted dependency retained



/**
 * Constructor for DateFormat - must not be used: To get a DateFormat instance, please use getInstance, getDateTimeInstance or getTimeInstance.
 *
 * @class
 * The DateFormat is a static class for formatting and parsing date and time values according
 * to a set of format options.
 * 
 * It uses sap.ui.core.format.DateFormat to format and parse dates, and adds a new style daysAgo for Date instances.
 * With this style:
 * <ul>
 * <li>For today: "Today" will be displayed (localized)</li>
 * <li>For yesterday: "1 day ago" will be displayed (localized)</li>
 * <li>Between 2 days and 6 days in the past: "x days ago" will be displayed (localized)</li>
 * <li>In the future or more than 6 days in the past: the date will be formatted with a medium style</li> 
 * </ul>
 * The daysAgo style can be formatted in UTC.
 *
 * Supported format options are pattern based on Unicode LDML Date Format notation.
 * If no pattern is specified a default pattern according to the locale settings is used.
 *
 * @public
 * @see http://unicode.org/reports/tr35/#Date_Field_Symbol_Table
 */
sap.ca.ui.model.format.DateFormat = function() {
	// Do not use the constructor
	throw new Error();	
};


/**
 * @see sap.ca.ui.model.format.DateFormat.getDateInstance
 */
sap.ca.ui.model.format.DateFormat.getInstance = function(oFormatOptions, oLocale) {
	return this.getDateInstance(oFormatOptions, oLocale);
};

/**
 * Get a date instance of the DateFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.pattern] a data pattern in LDML format. It is not verified whether the pattern represents only a date.  
 * @param {string} [oFormatOptions.style] either empty or 'short, 'medium', 'long' or 'daysAgo'. If no pattern is given, a locale dependent default date pattern of that style is used from the LocaleData class.    
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.DateFormat} date instance of the DateFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.DateFormat.getDateInstance = function(oFormatOptions, oLocale) {
	return this.createInstance(oFormatOptions, oLocale, "Date");
};

/**
 * Get a datetime instance of the DateFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.pattern] a datetime pattern in LDML format. It is not verified whether the pattern represents a full datetime.  
 * @param {string} [oFormatOptions.style] either empty or 'short, 'medium' or 'long'. If no pattern is given, a locale dependent default datetime pattern of that style is used from the LocaleData class.    
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.DateFormat} datetime instance of the DateFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.DateFormat.getDateTimeInstance = function(oFormatOptions, oLocale) {
	return this.createInstance(oFormatOptions, oLocale, "DateTime");
};

/**
 * Get a time instance of the DateFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.pattern] a time pattern in LDML format. It is not verified whether the pattern only represents a time.  
 * @param {string} [oFormatOptions.style] either empty or 'short, 'medium' or 'long'. If no pattern is given, a locale dependent default time pattern of that style is used from the LocaleData class.    
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.DateFormat} time instance of the DateFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.DateFormat.getTimeInstance = function(oFormatOptions, oLocale) {
	return this.createInstance(oFormatOptions, oLocale, "Time");
};

/**
 * Create instance of the DateFormat.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.DateFormat} time instance of the DateFormat
 * @static
 * @private
 */
sap.ca.ui.model.format.DateFormat.createInstance = function(oFormatOptions, oLocale, sType) {
	// Create an instance of the DateFormat
	var oFormat = jQuery.sap.newObject(this.prototype);
	
	switch (sType) {
		case "Date":
			// Handle optional parameters
			if (! (oFormatOptions instanceof sap.ui.core.Locale) && oFormatOptions) {
				if (oFormatOptions.style && oFormatOptions.style === "daysAgo") {
					oFormatOptions.style = "medium";
					oFormat.daysAgo = true;
				}
			}
			oFormat.innerFormat = sap.ui.core.format.DateFormat.getDateInstance(oFormatOptions, oLocale);
			break;
		case "DateTime":
			oFormat.innerFormat = sap.ui.core.format.DateFormat.getDateTimeInstance(oFormatOptions, oLocale);
			break;
		case "Time":
			oFormat.innerFormat = sap.ui.core.format.DateFormat.getTimeInstance(oFormatOptions, oLocale);
			break;
	}
		
	return oFormat;
};

/**
 * Format a date according to the given format options.
 * 
 * If oValue contains a JSON date ("/Date(milliseconds)/"), it will be converted to a Date before to be formatted.
 *
 * @param {Date|string} oValue the vale to format
 * @param {boolean} bUTC whether to use UTC
 * @return {string} the formatted output value
 * @public
 */
sap.ca.ui.model.format.DateFormat.prototype.format = function(oDate, bUTC) {
	// Convert the date if it's a string from mockup data or from the XSEngine.
	oDate = this.convertToDate(oDate);
	
	if (this.daysAgo && this.daysAgo === true) {
		return this.formatDaysAgo(oDate, bUTC);
	} else {
		return this.innerFormat.format(oDate, bUTC);
	}
};

/**
 * Parse a string which is formatted according to the given format options.
 * The strings specific to the daysAgo style will not be well-parsed.
 *
 * @param {string} sValue the string containing a formatted date/time value
 * @return {Date} the parsed value
 * @public
 */
sap.ca.ui.model.format.DateFormat.prototype.parse = function(oValue) {
	return this.innerFormat.parse(oValue);
};


/**
 * Format a date by indicating the number of calendar days between now and this date (if we are less than 7 days in the past).
 * The medium style will be used else.
 *
 * @param {Date} oDate the date to format
 * @param {boolean} bUTC to indicate if we should compare oDate to now in UTC or not 
 * @return {String} the formatted value
 * @private
 */
sap.ca.ui.model.format.DateFormat.prototype.formatDaysAgo = function(oDate, bUTC) {
	var result; 
	var daysAgo = 0, timePast, oToday = new Date();
	
	var todayYear  = bUTC ? oToday.getUTCFullYear()  : oToday.getFullYear();
	var todayMonth = bUTC ? oToday.getUTCMonth() : oToday.getMonth();
	var todayDate  = bUTC ? oToday.getUTCDate()  : oToday.getDate();

	var dateYear  = bUTC ? oDate.getUTCFullYear()  : oDate.getFullYear();
	var dateMonth = bUTC ? oDate.getUTCMonth() : oDate.getMonth();
	var dateDate  = bUTC ? oDate.getUTCDate()  : oDate.getDate();

	// Use UTC dates to avoid issues with daylight saving time (UTC does not observes DST).
	var todayUTC = Date.UTC(todayYear, todayMonth, todayDate);
	var dateUTC = Date.UTC(dateYear, dateMonth, dateDate);
	timePast = todayUTC.valueOf() - dateUTC.valueOf();
	daysAgo = Math.floor(timePast / (24 * 60 * 60 * 1000));

	if (daysAgo == 0) {
		// Today
		result = sap.ca.ui.utils.resourcebundle.getText("DateFormatter.Today");
	} else if (daysAgo == 1) {
		// Yesterday
		result = sap.ca.ui.utils.resourcebundle.getText("DateFormatter.Yesterday");
	} else if (daysAgo > 1 && daysAgo <=6) {
		// Between 2 and 6 days ago
		result = sap.ca.ui.utils.resourcebundle.getText("DateFormatter.DaysAgo", [ daysAgo ]);
	} else {
		// daysAgo < 0 or daysAgo > 6
		// Format using the medium date style.
		result = this.innerFormat.format(oDate, bUTC);
	}
	
	return result;
	
};

/**
 * Converts a string /Date(milliseconds)/ into a Date
 *
 * @param {Object} sDate the string /Date(milliseconds)/ or Date
 * @return {Date} the Date result object
 * @private
 */
sap.ca.ui.model.format.DateFormat.prototype.convertToDate = function(sDate) {
	var oDate = sDate;
	if (typeof sDate === "string") {
		// Handle the format /Date(milliseconds)/
		if (sDate.indexOf("Date") != -1) {
			sDate = sDate.substring(sDate.indexOf("(") + 1, sDate
					.indexOf(")"));
			sDate = new Number(sDate);
		}
		oDate = new Date(sDate);
	}
	return oDate;
};


}; // end of sap/ca/ui/model/format/DateFormat.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.FormattingLibrary') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.FormattingLibrary
jQuery.sap.declare("sap.ca.ui.model.format.FormattingLibrary");


sap.ca.ui.model.format.FormattingLibrary = {};


/**
 * Returns the icon name based on the given mime type
 *
 * @param sMimeType the mime type of the file attachment
 * @return {string} the icon string as "sap-icon://icon-name"
 */
sap.ca.ui.model.format.FormattingLibrary.formatAttachmentIcon = function (sMimeType) {

    var myMap = {}; // Create empty map
    myMap["application/msword"] = "sap-icon://doc-attachment";
    myMap["application/vnd.openxmlformats-officedocument.wordprocessingml.document"] = "sap-icon://doc-attachment";
    myMap["application/rtf"] = "sap-icon://doc-attachment";
    myMap["application/pdf"] = "sap-icon://pdf-attachment";
    myMap["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"] = "sap-icon://excel-attachment";
    myMap["application/msexcel"] = "sap-icon://excel-attachment";
    myMap["application/vnd.ms-powerpoint"] = "sap-icon://ppt-attachment";
    myMap["application/vnd.openxmlformats-officedocument.presentationml.presentation"] = "sap-icon://ppt-attachment";
    myMap["application/vnd.openxmlformats-officedocument.presentationml.slideshow"] = "sap-icon://ppt-attachment";
    myMap["application/mspowerpoint"] = "sap-icon://ppt-attachment";
    myMap["application/xml"] = "sap-icon://attachment-html";
    myMap["application/xhtml+xml"] = "sap-icon://attachment-html";
    myMap["application/x-httpd-php"] = "sap-icon://attachment-html";
    myMap["application/x-javascript"] = "sap-icon://attachment-html";
    myMap["application/gzip"] = "sap-icon://attachment-zip-file";
    myMap["application/x-rar-compressed"] = "sap-icon://attachment-zip-file";
    myMap["application/x-tar"] = "sap-icon://attachment-zip-file";
    myMap["application/zip"] = "sap-icon://attachment-zip-file";
    myMap["audio/voxware"] = "sap-icon://attachment-audio";
    myMap["audio/x-aiff"] = "sap-icon://attachment-audio";
    myMap["audio/x-midi"] = "sap-icon://attachment-audio";
    myMap["audio/x-mpeg"] = "sap-icon://attachment-audio";
    myMap["audio/x-pn-realaudio"] = "sap-icon://attachment-audio";
    myMap["audio/x-pn-realaudio-plugin"] = "sap-icon://attachment-audio";
    myMap["audio/x-qt-stream"] = "sap-icon://attachment-audio";
    myMap["audio/x-wav"] = "sap-icon://attachment-audio";
    myMap["image/png"] = "sap-icon://attachment-photo";
    myMap["image/tiff"] = "sap-icon://attachment-photo";
    myMap["image/bmp"] = "sap-icon://attachment-photo";
    myMap["image/jpeg"] = "sap-icon://attachment-photo";
    myMap["image/gif"] = "sap-icon://attachment-photo";
    myMap["text/plain"] = "sap-icon://attachment-text-file";
    myMap["text/comma-separated-values"] = "sap-icon://attachment-text-file";
    myMap["text/css"] = "sap-icon://attachment-text-file";
    myMap["text/html"] = "sap-icon://attachment-text-file";
    myMap["text/javascript"] = "sap-icon://attachment-text-file";
    myMap["text/plain"] = "sap-icon://attachment-text-file";
    myMap["text/richtext"] = "sap-icon://attachment-text-file";
    myMap["text/rtf"] = "sap-icon://attachment-text-file";
    myMap["text/tab-separated-values"] = "sap-icon://attachment-text-file";
    myMap["text/xml"] = "sap-icon://attachment-text-file";
    myMap["video/mpeg"] = "sap-icon://attachment-video";
    myMap["video/quicktime"] = "sap-icon://attachment-video";
    myMap["video/x-msvideo"] = "sap-icon://attachment-video";
    myMap["application/x-shockwave-flash"] = "sap-icon://attachment-video";


    var iconName = myMap[sMimeType];
    if (iconName) {
        return iconName;
    }
    return "sap-icon://document";
};


/**
 * Returns the best option for the attachment title
 *
 * @param sDescription {string} The description of the attachment
 * @param sFileType {string} The file type of the attachment
 * @return {string} Returns the description if valid, otherwise returns filetype
 */
sap.ca.ui.model.format.FormattingLibrary.formatAttachmentTitle = function(sDescription, sFileType) {
    if (sDescription) {
        return sDescription;
    }
    return sFileType;
};


/**
 * Returns a ValueState object based on the given integer value
 *  1 : ValueState.Warning
 *  2 : ValueState.Success
 *  3 : ValueState.Error
 *
 * @param iStatusValue {int} The status as an integer
 * @return {sap.ui.core.ValueState} Returns the ValueStatus object or ValueState.None
 */
sap.ca.ui.model.format.FormattingLibrary.formatStatus = function (iStatusValue) {

    var oStatus = sap.ui.core.ValueState.None;

    if (iStatusValue !== null) {
        var oEquivalent = {
            1 : "Warning",
            2 : "Success",
            3 : "Error"
        };

        if (oEquivalent[iStatusValue])
            oStatus = sap.ui.core.ValueState[oEquivalent[iStatusValue]];
    }

    return oStatus;
};


/**
 * ID and Description Formatting
 *
 * @param sDescription {string} The description
 * @param sID {string} The Id
 * @return {string} Returns either the ID, Description or ID + Description depending on the validity of the inputs
 */
sap.ca.ui.model.format.FormattingLibrary.commonIDFormatter = function(sDescription, sID) {
    if (sID){
        if (sDescription){
            return sap.ca.ui.utils.resourcebundle.getText("FormattingLibrary.DescriptionAndId", [sDescription, sID]);
        }
        return sID;
    }
    if (sDescription){
        return sDescription;
    }
    return "";

};




}; // end of sap/ca/ui/model/format/FormattingLibrary.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.NumberFormat') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.NumberFormat
jQuery.sap.declare("sap.ca.ui.model.format.NumberFormat");

jQuery.sap.require('sap.ui.core.LocaleData'); // unlisted dependency retained




/**
 * Constructor for NumberFormat - must not be used: To get a NumberFormat instance, please use getInstance.
 *
 * @class
 * The NumberFormat is a class for formatting and parsing number values according
 * to a set of format options.
 * If no pattern is specified a default pattern according to the locale settings is used.
 *
 * The sap.ca NumberFormat has the following differences with UI5 sap.ui.core.format.NumberFormat
 *    - A style formatOptions has been added with 2 styles:
 *       - standard
 *       - short :  12345 formatted as 1.2 K (based on CLDR decimalFormat-short specifications)
 *    - UI5 MaxFractionDigit and MinFractionDigit options have been replaced with a single
 *      decimals format option which specifies the exact number of decimals that will be
 *      displayed
 *    - A shortDecimal FormatOption has been added which applies only in short style
 *    - rounding has been improved
 *
 */
sap.ca.ui.model.format.NumberFormat = function() {
    // Do not use the constructor
    throw new Error();
};


sap.ca.ui.model.format.NumberFormat.oValueInfo = {
    oDefaultFormatOptions: {
        style: "standard"
    }
};


/**
 * @see sap.ui.core.format.NumberFormat.getInstance
 */
sap.ca.ui.model.format.NumberFormat.getInstance = function(oFormatOptions, oLocale) {
    return this.createInstance(oFormatOptions, oLocale, this.oValueInfo);
};


/**
 * Create instance of the NumberFormat.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.style] style to use to format number : "short" or "standard".
 * @param {number} [oFormatOptions.decimals] number of decimals to display in standard style.
 * @param {number} [oFormatOptions.shortDecimals] number of decimals to display in short style.
 * @param {object} [oFormatOptions.*] All sap.ui.core.format.NumberFormat formatOptions are also supported
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.NumberFormat} instance of the NumberFormat
 * @static
 * @private
 */
sap.ca.ui.model.format.NumberFormat.createInstance = function(oFormatOptions, oLocale, oInfo) {
    // Create an instance of the NumberFormat
    var oFormat = jQuery.sap.newObject(this.prototype);

    // Handle optional parameters
    if ( oFormatOptions instanceof sap.ui.core.Locale ) {
        oLocale = oFormatOptions;
        oFormatOptions = undefined;
    }

    // Get Locale and LocaleData to use
    if (!oLocale) {
        oLocale = sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();
    }
    oFormat.oLocale = oLocale;
    oFormat.oLocaleData = sap.ui.core.LocaleData.getInstance(oLocale);

    // Extend the default format options with custom format options
    oFormat.oFormatOptions  = jQuery.extend(false, {}, oInfo.oDefaultFormatOptions, oFormatOptions);
    oFormat.oFormatOptions.formatStyle = "standard";

    oFormat.init();
    return oFormat;
};

/**
 * Initialize format
 */
sap.ca.ui.model.format.NumberFormat.prototype.init = function() {

};


/**
 * Format a number according to the given format options.
 *
 * @param {Number} oValue the value to format
 * @return {string} the formatted output value
 * @public
 */
sap.ca.ui.model.format.NumberFormat.prototype.format = function(oValue) {

    var result = "";

    // resolve format style
    var formatter = "format_" + this.oFormatOptions.style;
    if (this[formatter]) {
        result = this[formatter](oValue);
    }
    else {
        // fallback
        result = this.format_standard(oValue);
    }

    return result;
};

sap.ca.ui.model.format.NumberFormat.prototype.format_standard = function (oValue) {
    // pass the value and format options
    var formatOptions = sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions, this.oLocale);
    return sap.ca.ui.model.format.FormatHelper.formatNumber(oValue, formatOptions);
};


sap.ca.ui.model.format.NumberFormat.prototype.format_short = function (oValue) {
    var formatOptions;
    var shortCldrFormats;
    var shortFormat;

    // returns a shortFormat object extracted from cldr short decimal format containing
    //  - magnitude : the number by which value should be divided to get the short value
    //  - formatString : the cldr format string, e.g. "0.0 K"
    //  - valueSubString : the substring to replace with the actual value in this formatString, e.g. "0.0"
    //  - decimals : number of decimals used in this format string. E.g. 1 for "0.0 K", 0 for "000 M"
    //
    // Example of cldr short decimal format for japanese.
    //        "decimalFormat-short":{
    //            "1000":"0",
    //             "10000":"0.0",
    //             "100000":"00",
    //             "1000000":"000",
    //             "10000000":"0000",
    //             "100000000":"0.0",
    //             "1000000000":"00",
    //             "10000000000":"000",
    //             "100000000000":"0000",
    //             "1000000000000":"0.0",
    //             "10000000000000":"00",
    //             "100000000000000":"000"}

    function getShortFormat(value) {
        var shortFormat;

          if (!shortCldrFormats) {
            shortCldrFormats = sap.ui.core.LocaleData.getInstance(formatOptions.locale)._get("decimalFormat-short");
            if (!shortCldrFormats){
                var sdLocale = new sap.ui.core.Locale("en");
                shortCldrFormats = sap.ui.core.LocaleData.getInstance(sdLocale)._get("decimalFormat-short");
            }
        }

        if (shortCldrFormats) {
            var key = 1;
            while( Math.abs(value) >= key*10 && key < 1e14) {
                key = key*10;
            }

            var shortCldrFormat = shortCldrFormats[key.toString()];
            shortFormat = {};
            if (!shortCldrFormat ||  shortCldrFormat == "0") {
                //no short format or special "0" format => number doesn't need to be shortified
                shortFormat.magnitude = 1;
            }
            else {
                shortFormat.formatString = shortCldrFormat;
                var match = shortCldrFormat.match(/0+\.*0*/);
                if (match) {
                    //to get magnitude, we need to remove from key the number of zeros
                    //contained in valueSubString before decimal separator minus 1
                    //    "0.0" => magnitude = key
                    //    "00"  => magnitude = key / 10
                    //    "000" => magnitude = key / 100
                    shortFormat.valueSubString = match[0];
                    var decimalSeparatorPosition =  shortFormat.valueSubString.indexOf(".");
                    if (decimalSeparatorPosition == -1) {
                        shortFormat.decimals = 0;
                        shortFormat.magnitude = key * Math.pow(10,1-shortFormat.valueSubString.length);
                    }
                    else {
                        shortFormat.decimals = shortFormat.valueSubString.length -  decimalSeparatorPosition -1;
                        shortFormat.magnitude = key * Math.pow(10,1-decimalSeparatorPosition);
                    }
                }
                else {
                    //value pattern has not be recognized
                    //we cannot shortify
                    shortFormat.magnitude = 1;
                }
            }
        }
        return shortFormat;
    }

    var numValue = sap.ca.ui.model.format.FormatHelper.toNumeric(oValue);
    if (!isFinite(numValue)) {
        return "";
    }
    var result = "";
    formatOptions = sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions, this.oLocale);

    //we first need to get the magnitude: ie the number by which value should be divided to get the short value
    //this is locale dependant and must then be extracted from cldr data:
    //   - in western languages, value will be divided by powers of 1000 (K, M, G, T...)
    //   - in japanese, value will be divided by powers of 10000.
    shortFormat = getShortFormat(numValue);
    //no short format has been found for value and locale, use standard format
    if (!shortFormat) {
        return this.format_standard(oValue);
    }
    var shortValue =  numValue / shortFormat.magnitude;

    // shortValue must first be rounded as rounding may induce a change of scale (999.999 = "1.0 K" if decimals <3).
    // Number of decimals to use for rounding is:
    //    - decimals if magnitude == 1 (number not "shortified")
    //    - else shortDecimals if specified
    //    - else number of decimal of the CLDR "decimalFormat-short" pattern
    var roundingOptions = {};
    roundingOptions.shortRounding = formatOptions.shortRounding;
    roundingOptions.rounding = formatOptions.rounding;
    if (shortFormat.magnitude == 1) {
        roundingOptions.formatStyle  = "standard";
        roundingOptions.decimals =  formatOptions.decimals;
    }
    else if (formatOptions.shortDecimals){
        roundingOptions.formatStyle  = "short";
        roundingOptions.shortDecimals = formatOptions.shortDecimals;
    }
    else {
        roundingOptions.formatStyle  = "short";
        roundingOptions.shortDecimals = shortFormat.decimals;
    }

    shortValue = sap.ca.ui.model.format.FormatHelper.roundNumber(shortValue, roundingOptions);

    //Rounding may have changed the magnitude, so we recompute it.
    shortFormat = getShortFormat(shortValue*shortFormat.magnitude);

    //magnitude = 1 means that number doesn't need to be shortified, standard format must be applied
    if (!shortFormat || shortFormat.magnitude == 1 ) {
        result = this.format_standard(oValue);
    }
    else {
        //Recompute short value with updated magnitude
        shortValue = sap.ca.ui.model.format.FormatHelper.roundNumber(numValue / shortFormat.magnitude, roundingOptions);

        //We have now have the correct shortValue, formatting can be done
        //   - if shortDecimals has not been explicitly given
        //   - get it from shortFormat
        if (!formatOptions.shortDecimals) {
            formatOptions.shortDecimals =  shortFormat.decimals;
        }
        //format the shortValue
        formatOptions.formatStyle = "short";
        result = sap.ca.ui.model.format.FormatHelper.formatNumber(shortValue, formatOptions);
        //inject formatted shortValue in the formatString
        result = shortFormat.formatString.replace(shortFormat.valueSubString,result);
        //formatString may contain '.' (quoted to differentiate them decimal separator)
        //which must be replaced with .
        result = result.replace(/'.'/g, ".");

    }
    return result;
};


/**
 * Parse a string which is formatted according to the given format options.
 *
 * @param {string} sValue the string containing a formatted value
 * @return {number} the parsed value
 * @public
 */
sap.ca.ui.model.format.NumberFormat.prototype.parse = function(sValue) {
    var formatter = sap.ui.core.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale);
    return formatter.parse(sValue);
};


/**
 * Format a value with the percent according to the cldr currency format.
 *
 * @param {sValue} the string containing a value
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.NumberFormat.prototype.format_percentage = function(sValue) {
    var result;
    // Default decimals value set to zero, else decimals is left unchanged
    if(this.oFormatOptions.decimals === undefined){
        this.oFormatOptions.decimals = 0;
    }
    // Multiply the decimal by 100
    var numValue = sap.ca.ui.model.format.FormatHelper.toNumeric(sValue);
    numValue = numValue*100.;
    // Format the value itself
    var formattedValue = this.format_standard(numValue);
    // We fetch the cldr percent format associated with the locale
    var percentCldrFormats = sap.ui.core.LocaleData.getInstance(this.oLocale)._get("percentFormat");
    if (!percentCldrFormats){
        // The fallback cldr percent format is the one associated with "en" locale
        var sdLocale = new sap.ui.core.Locale("en");
        percentCldrFormats = sap.ui.core.LocaleData.getInstance(sdLocale)._get("percentFormat");
    }

    var standard = percentCldrFormats["standard"];
    if (standard === undefined || standard == "") {
        result = formattedValue;
        jQuery.sap.log.error("no percent format available for the current locale");
    }
    else {
        // Example of a typical cldr percent format
        //
        // "percentFormat" : {"standard" : "#,##0%" }
        var valuePattern = /[\.0,#]+/;
        // The % symbol may change position, but must be retained.
        var tmp = standard.replace(valuePattern, formattedValue);
        // We retrieve the % symbol
        var percentSign = sap.ui.core.LocaleData.getInstance(this.oLocale)._get("symbols-latn-percentSign");
        if (!percentSign){
            // The fallback cldr % symbol is the one associated with "en" locale
            var sdLocale = new sap.ui.core.Locale("en");
            percentSign = sap.ui.core.LocaleData.getInstance(sdLocale)._get("symbols-latn-percentSign");
        }
        result = tmp.replace(/\u0025/, percentSign);
    }
    return result;
};
}; // end of sap/ca/ui/model/format/NumberFormat.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.QuantityFormat') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.QuantityFormat
jQuery.sap.declare("sap.ca.ui.model.format.QuantityFormat");


jQuery.sap.require('sap.ui.core.format.NumberFormat'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.LocaleData'); // unlisted dependency retained



/**
 * Constructor for QuantityFormat - must not be used: To get a QuantityFormat instance, please use getInstance.
 *
 * @class
 * The QuantityFormat is a static class for formatting and parsing file size values according
 * to a set of format options.
 *
 * If no pattern is specified a default pattern according to the locale settings is used.
 *
 * @public
 */
sap.ca.ui.model.format.QuantityFormat = function() {
    // Do not use the constructor
    throw new Error();
};


sap.ca.ui.model.format.QuantityFormat.oValueInfo = {
    oDefaultFormatOptions: {
        style: "standard",
        minFractionDigits: 0
    }
};

/*
 JSON Model containing NW default definition of number of decimals to use per Unit.
 As this is the NW default definition (without customization) standard definition, it is shared between all apps.
 It will be loaded with  model/unit.json file the first time it's requested.
 */
sap.ca.ui.model.format.QuantityFormat.oQuantityModel = null;

/**
 * Get a instance of the QuantityFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.style] either empty or 'standard or 'short'. If no pattern is given, a locale dependent default pattern of that style is used from the LocaleData class.
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.QuantityFormat} instance of the QuantityFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.QuantityFormat.getInstance = function(unitCode, oFormatOptions, oLocale) {
    return this.createInstance(unitCode, oFormatOptions, oLocale, this.oValueInfo);
};


/**
 * Create instance of the QuantityFormat.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.QuantityFormat} time instance of the QuantityFormat
 * @static
 * @private
 */
sap.ca.ui.model.format.QuantityFormat.createInstance = function(unitCode, oFormatOptions, oLocale, oInfo) {
    // Create an instance of the QuantityFormat
    var oFormat = jQuery.sap.newObject(this.prototype);

    // Handle optional parameters
    if ( oFormatOptions instanceof sap.ui.core.Locale ) {
        oLocale = oFormatOptions;
        oFormatOptions = undefined;
    }

    // Get Locale and LocaleData to use
    if (!oLocale) {
        oFormat.oLocale = sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();
    }
    else{
        oFormat.oLocale = new sap.ui.core.Locale(oLocale);
    }
    oFormat.oLocaleData = sap.ui.core.LocaleData.getInstance(oFormat.oLocale);

    // Extend the default format options with custom format options
    oFormat.oFormatOptions = jQuery.extend(false, {}, oInfo.oDefaultFormatOptions, oFormatOptions);

    oFormat.init(unitCode, oFormatOptions);

    return oFormat;
};

/**
 * Initialize unit format
 */
sap.ca.ui.model.format.QuantityFormat.prototype.init = function(unitCode, oFormatOptions) {
    // Rules Decimals "Precedence": if decimals are options defined it should override default and currency (defined)
    if(oFormatOptions){
        if(oFormatOptions.minFractionDigits != undefined){
            this.oFormatOptions.minFractionDigits = sap.ca.ui.model.format.FormatHelper.toNumeric(oFormatOptions.minFractionDigits);
            return;
        }
    }
    if(unitCode){
        //load model with unit formatting exceptions
        if (!sap.ca.ui.model.format.QuantityFormat.oQuantityModel) {
            sap.ca.ui.model.format.QuantityFormat.oQuantityModel = new sap.ui.model.json.JSONModel();
            var path = jQuery.sap.getModulePath("sap.ca.ui");
            sap.ca.ui.model.format.QuantityFormat.oQuantityModel.loadData(path + "/model/unit.json", "", false);
        }
        var data = sap.ca.ui.model.format.QuantityFormat.oQuantityModel.getData();
        var len =  data.length;
        var i = 0, stop = 0;
        for (i = 0; i < len; i++) {
            if (data[i].ISOCode === unitCode) {
                this.oFormatOptions.minFractionDigits = data[i].Decimals;
                stop = 1;
                return;
            }
        }
        // in case we didn't find the code it might be
         for (i = 0; i < len; i++) {
            if (data[i].Code === unitCode) {
                this.oFormatOptions.minFractionDigits = data[i].Decimals;
                break;
            }
        }
    }
};


/**
 * Format a value according to the given format options.
 *
 * @param {object} oValue the value to format
 * @return {string} the formatted output value
 * @public
 */
sap.ca.ui.model.format.QuantityFormat.prototype.format = function(oValue) {
    // defer number formatting so that so can benefit from other options
    if(this.oFormatOptions.style === "short"){
        this.oFormatOptions.decimals = this.oFormatOptions.minFractionDigits;
        return sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale).format(oValue);
    }
    else{
        var numValue  = sap.ca.ui.model.format.FormatHelper.toNumeric(oValue);
        if (!isFinite(numValue)) {
            return "";
        }

        var str, n, count = 0;
        var extraPrecision = 3; // We only accept three more digits

        if (numValue > 1e20) {
            return sap.ca.ui.model.format.QuantityFormat.getInstance({style:"short"}).format(numValue);
        }
        else {
            str = numValue.toFixed(this.oFormatOptions.minFractionDigits + extraPrecision);
            // Remove trailing 0's but not
            n = str.length - 1;
            while (str.charAt(n) === '0' && count <= extraPrecision ) {
                ++count;
                --n;
            }
            str = str.substring(0, n + 1);
            return sap.ui.core.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale).format(str);
        }
    }
};


/**
 * Parse a string which is formatted according to the given format options.
 *
 * @param {string} sValue the string containing a formatted value
 * @return {number} the parsed value
 * @public
 */
sap.ca.ui.model.format.QuantityFormat.prototype.parse = function(sValue) {
    var formatter = sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale);
    return formatter.parse(sValue);
};

/**
 * Convenience static function
 * Format an quantity in short Style.
 * Number of decimals will be set :
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given unit
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} unitCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.QuantityFormat.FormatQuantityShort = function(oValue, unitCode, minFractionDigits) {
    return sap.ca.ui.model.format.QuantityFormat.getInstance(unitCode, {style: "short", minFractionDigits: minFractionDigits}).format(oValue);
};

/**
 * Convenience static function
 * Format an quantity in standard Style.
 * Number of decimals will be set :
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given unit
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} unitCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.QuantityFormat.FormatQuantityStandard = function(oValue, unitCode, minFractionDigits) {
    return sap.ca.ui.model.format.QuantityFormat.getInstance(unitCode, {style:"standard", minFractionDigits:minFractionDigits}).format(oValue);
};
}; // end of sap/ca/ui/model/format/QuantityFormat.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.type.Date') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides the base implementation for all model implementations
jQuery.sap.declare("sap.ca.ui.model.type.Date");
jQuery.sap.require('sap.ui.model.SimpleType'); // unlisted dependency retained



/**
 * Constructor for a Date type.
 *
 * @class
 * This class represents date simple types.
 *
 * @extends sap.ui.model.SimpleType
 *
 * @author SAP AG 
 *
 * @constructor
 * @public
 * @param {object} [oFormatOptions] options used to create a DateFormat for formatting / parsing. Supports the same options as {@link sap.ca.ui.model.format.DateFormat.getDateInstance DateFormat.getDateInstance}.
 * 			 You can use an extra boolean option UTC to format in UTC ({style: "short", UTC: true}).
 * @param {object} [oFormatOptions.source] additional set of options used to create a second DateFormat object for conversions between 
 *           string values in the data source (e.g. model) and Date. This second format object is used to convert from a model string to Date before 
 *           converting the Date to string with the primary format object. Vice versa, this 'source' format is also used to format an already parsed 
 *           external value (e.g. user input) into the string format expected by the data source.
 *           Supports the same set of options as {@link sap.ca.ui.model.format.DateFormat.getDateInstance DateFormat.getDateInstance}.
 * @param {object} [oConstraints] value constraints. 
 * @param {Date|string} [oConstraints.minimum] smallest value allowed for this type. Values for constraints must use the same type as configured via <code>oFormatOptions.source</code>  
 * @param {Date|string} [oConstraints.maximum] largest value allowed for this type. Values for constraints must use the same type as configured via <code>oFormatOptions.source</code>  
 * @name sap.ca.ui.model.type.Date
 */
sap.ui.model.SimpleType.extend("sap.ca.ui.model.type.Date", /** @lends sap.ca.ui.model.type.Date */ {
	
	constructor : function () {
		sap.ui.model.SimpleType.apply(this, arguments);
		this.sName = "Date";
	}

});

/**
 * Creates a new subclass of class sap.ca.ui.model.type.Date with name <code>sClassName</code>
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * For a detailed description of <code>oClassInfo</code> or <code>FNMetaImpl</code> 
 * see {@link sap.ui.base.Object.extend Object.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] alternative constructor for a metadata object
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.model.type.Date.extend
 * @function
 */

/**
 * @see sap.ui.model.SimpleType.prototype.formatValue
 */
sap.ca.ui.model.type.Date.prototype.formatValue = function(oValue, sInternalType) {
	switch(sInternalType) {
		case "string":
			if (oValue == null) {
				return "";
			}
			if (this.oInputFormat) {
				if (this.oFormatOptions.source.pattern == "timestamp") {
					if(typeof(oValue) != "number"){
						if (isNaN(oValue)) {
							throw new sap.ui.model.FormatException("Cannot format date: " + oValue + " is not a valid Timestamp");
						}else{
							oValue = parseInt(oValue, 10);
						}
					}
					oValue= new Date(oValue);
				}else{
					if (oValue == "") {
						return "";
					}
					oValue = this.oInputFormat.parse(oValue);
					if (oValue == null) {
						throw new sap.ui.model.FormatException("Cannot format date: " + oValue + " has the wrong format");
					}
				}
			}
			return this.oOutputFormat.format(oValue, this.bUTC);
		default:
			throw new sap.ui.model.FormatException("Don't know how to format Date to " + sInternalType);
	}
};

/**
 * @see sap.ui.model.SimpleType.prototype.parseValue
 */
sap.ca.ui.model.type.Date.prototype.parseValue = function(oValue, sInternalType) {
	var oResult;
	switch(sInternalType) {
		case "string":
			if (oValue === "") {
				return null;
			}
			oResult = this.oOutputFormat.parse(oValue);
			if (!oResult) {
				throw new sap.ui.model.ParseException(oValue + " is not a valid Date value");
			}
			if (this.oInputFormat) {
				if (this.oFormatOptions.source.pattern == "timestamp") {
					oResult = oResult.getTime();
				}else{
					oResult = this.oInputFormat.format(oResult);
				}
			}
			return oResult;
		default:
			throw new sap.ui.model.ParseException("Don't know how to parse Date from " + sInternalType);
	}
};

/**
 * @see sap.ui.model.SimpleType.prototype.validateValue
 */
sap.ca.ui.model.type.Date.prototype.validateValue = function(oValue) {
	if (this.oConstraints) {
		var aViolatedConstraints = [],
			oInputFormat = this.oInputFormat;

		// convert date into date object to compare
		if (oInputFormat && this.oFormatOptions.source.pattern != "timestamp"){
			oValue = oInputFormat.parse(oValue);
		}

		jQuery.each(this.oConstraints, function(sName, oContent) {
			if (oInputFormat){
				oContent = oInputFormat.parse(oContent);
			}
			switch (sName) {
				case "minimum":
					if (oValue < oContent) {
						aViolatedConstraints.push("minimum");
					}
					break;
				case "maximum":
					if (oValue > oContent) {
						aViolatedConstraints.push("maximum");
					}
			}
		});
		if (aViolatedConstraints.length > 0) {
			throw new sap.ui.model.ValidateException("Validation of type constraints failed", aViolatedConstraints);
		}
	}
};

/**
 * @see sap.ui.model.SimpleType.prototype.setFormatOptions
 * A boolean formatOption UTC allow to format dates in UTC.
 */
sap.ca.ui.model.type.Date.prototype.setFormatOptions = function(oFormatOptions) {
	this.oFormatOptions = oFormatOptions;
	if (oFormatOptions && oFormatOptions.UTC === true) {
		delete oFormatOptions.UTC;
		this.bUTC = true;
	} else {
		this.bUTC = false;
	}
	this._handleLocalizationChange();
};

/**
 * @protected
 */
sap.ca.ui.model.type.Date.prototype.getOutputPattern = function() {

	return this.oOutputFormat.oFormatOptions.pattern;

};

/**
 * Called by the framework when any localization setting changed
 * @private
 */
sap.ca.ui.model.type.Date.prototype._handleLocalizationChange = function() {
	// recreate formatters
	this.oOutputFormat = sap.ca.ui.model.format.DateFormat.getInstance(this.oFormatOptions);
	if (this.oFormatOptions.source) {
		this.oInputFormat = sap.ca.ui.model.format.DateFormat.getInstance(this.oFormatOptions.source);
	}
};


}; // end of sap/ca/ui/model/type/Date.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.type.DateTime') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides the base implementation for all model implementations
jQuery.sap.declare("sap.ca.ui.model.type.DateTime");


/**
 * Constructor for a DateTime type.
 *
 * @class
 * This class represents datetime simple types.
 *
 * @extends sap.ca.ui.model.type.Date
 *
 * @author SAP AG
 *
 * @constructor
 * @public
 * @param {object} [oFormatOptions] options used to create a DateFormat for formatting / parsing to/from external values and 
 *           optionally for a second DateFormat to convert between the data source format (Model) and the internally used JavaScript Date.format. 
 *           For both DateFormat objects, the same options are supported as for {@link sap.ca.ui.model.format.DateFormat.getDateTimeInstance DateFormat.getDateTimeInstance}.
 *           You can use an extra boolean option UTC to format in UTC ({style: "short", UTC: true}).

 *           Note that this differs from the base type.
 * @param {object} [oConstraints] value constraints. Supports the same kind of constraints as its base type Date, but note the different format options (Date vs. DateTime) 
 * @name sap.ca.ui.model.type.DateTime
 */
sap.ca.ui.model.type.Date.extend("sap.ca.ui.model.type.DateTime", /** @lends sap.ca.ui.model.type.DateTime */ {
	
	constructor : function () {
		sap.ca.ui.model.type.Date.apply(this, arguments);
		this.sName = "DateTime";
	}

});

/**
 * Creates a new subclass of class sap.ca.ui.model.type.DateTime with name <code>sClassName</code>
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * For a detailed description of <code>oClassInfo</code> or <code>FNMetaImpl</code> 
 * see {@link sap.ui.base.Object.extend Object.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] alternative constructor for a metadata object
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.model.type.DateTime.extend
 * @function
 */

/**
 * Called by the framework when any localization setting changed
 * @see sap.ui.model.Date.prototype._handleLocalizationChange
 * @private
 */
sap.ca.ui.model.type.DateTime.prototype._handleLocalizationChange = function() {
	this.oOutputFormat = sap.ca.ui.model.format.DateFormat.getDateTimeInstance(this.oFormatOptions);
	if (this.oFormatOptions.source) {
		this.oInputFormat = sap.ca.ui.model.format.DateFormat.getDateTimeInstance(this.oFormatOptions.source);
	}
};


}; // end of sap/ca/ui/model/type/DateTime.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.type.Number') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides the base implementation for all model implementations
jQuery.sap.declare("sap.ca.ui.model.type.Number");
jQuery.sap.require('sap.ui.model.SimpleType'); // unlisted dependency retained



/**
 * Constructor for a Number type.
 *
 * @class
 * This class represents number simple types.
 *
 * @extends sap.ui.model.SimpleType
 *
 * @author SAP AG
 * @version 1.15.1-SNAPSHOT
 *
 * @constructor
 * @public
 * @param {object} [oFormatOptions] formatting options. Supports the same options as {@link sap.ui.core.format.NumberFormat.getNumberInstance NumberFormat.getNumberInstance}
 * @param {object} [oConstraint]s value constraints.
 * @param {number} [oConstraints.minimum] smallest value allowed for this type
 * @param {numbers} [oConstraints.maximum] largest value allowed for this type
 * @name sap.ca.ui.model.type.Number
 */
sap.ui.model.SimpleType.extend("sap.ca.ui.model.type.Number", /** @lends sap.ca.ui.model.type.Number  */ {

    constructor : function () {
        sap.ui.model.SimpleType.apply(this, arguments);
        this.sName = "Number";
    }

});

/**
 * Creates a new subclass of class sap.ca.ui.model.type.Number with name <code>sClassName</code>
 * and enriches it with the information contained in <code>oClassInfo</code>.
 *
 * For a detailed description of <code>oClassInfo</code> or <code>FNMetaImpl</code>
 * see {@link sap.ui.base.Object.extend Object.extend}.
 *
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class
 * @param {function} [FNMetaImpl] alternative constructor for a metadata object
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.model.type.Number.extend
 * @function
 */

/**
 * @see sap.ui.model.SimpleType.prototype.formatValue
 */
sap.ca.ui.model.type.Number.prototype.formatValue = function(fValue, sInternalType) {
    if (fValue == undefined || fValue == null) {
        return null;
    }
    switch(sInternalType) {
        case "string":
            return this.oFormat.format(fValue);
        case "int":
            return Math.floor(fValue);
        case "float":
            return fValue;
        default:
            throw new sap.ui.model.FormatException("Don't know how to format Number to " + sInternalType);
    }
};

/**
 * @see sap.ui.model.SimpleType.prototype.parseValue
 */
sap.ca.ui.model.type.Number.prototype.parseValue = function(oValue, sInternalType) {
    var iResult;
    switch(sInternalType) {
        case "string":
            iResult = this.oFormat.parse(oValue);
            if (isNaN(iResult)) {
                throw new sap.ui.model.ParseException(oValue + " is not a valid Number value");
            }
            return iResult;
        case "int":
        case "float":
            return oValue;
        default:
            throw new sap.ui.model.ParseException("Don't know how to parse Number from " + sInternalType);
    }
};

/**
 * @see sap.ui.model.SimpleType.prototype.validateValue
 */
sap.ca.ui.model.type.Number.prototype.validateValue = function(iValue) {
    if (this.oConstraints) {
        var aViolatedConstraints = [];
        jQuery.each(this.oConstraints, function(sName, oContent) {
            switch (sName) {
                case "minimum":
                    if (iValue < oContent) {
                        aViolatedConstraints.push("minimum");
                    }
                    break;
                case "maximum":
                    if (iValue > oContent) {
                        aViolatedConstraints.push("maximum");
                    }
            }
        });
        if (aViolatedConstraints.length > 0) {
            throw new sap.ui.model.ValidateException("Validation of type constraints failed", aViolatedConstraints);
        }
    }
};

/**
 * @see sap.ui.model.SimpleType.prototype.setFormatOptions
 */
sap.ca.ui.model.type.Number.prototype.setFormatOptions = function(oFormatOptions) {
    this.oFormatOptions = oFormatOptions;
    this._handleLocalizationChange();
};

/**
 * Called by the framework when any localization setting changed
 * @private
 */
sap.ca.ui.model.type.Number.prototype._handleLocalizationChange = function() {
    this.oFormat = sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions);
};

}; // end of sap/ca/ui/model/type/Number.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.type.Time') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 * 
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides the base implementation for all model implementations
jQuery.sap.declare("sap.ca.ui.model.type.Time");


/**
 * Constructor for a Time type.
 *
 * @class
 * This class represents time simple types.
 *
 * @extends sap.ca.ui.model.type.Date
 *
 * @author SAP AG
 *
 * @constructor
 * @public
 * @param {object} [oFormatOptions] options used to create a DateFormat for formatting / parsing to/from external values and 
 *           optionally for a second DateFormat to convert between the data source format (Model) and the internally used JavaScript Date.format. 
 *           For both DateFormat objects, the same options are supported as for {@link sap.ca.ui.model.format.DateFormat.getTimeInstance DateFormat.getTimeInstance}.
 *           You can use an extra boolean option UTC to format in UTC ({style: "short", UTC: true}).
 *           Note that this differs from the base type.
 * @param {object} [oConstraints] value constraints. Supports the same kind of constraints as its base type Date, but note the different format options (Date vs. Time) 
 * @name sap.ca.ui.model.type.Time
 */
sap.ca.ui.model.type.Date.extend("sap.ca.ui.model.type.Time", /** @lends sap.ca.ui.model.type.Time */ {
	
	constructor : function () {
		sap.ca.ui.model.type.Date.apply(this, arguments);
		this.sName = "Time";
	}

});

/**
 * Creates a new subclass of class sap.ca.ui.model.type.Time with name <code>sClassName</code>
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * For a detailed description of <code>oClassInfo</code> or <code>FNMetaImpl</code> 
 * see {@link sap.ui.base.Object.extend Object.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] alternative constructor for a metadata object
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.model.type.Time.extend
 * @function
 */

/**
 * Called by the framework when any localization setting changed
 * @see sap.ui.model.SimpleType.prototype._handleLocalizationChange
 * @private
 */
sap.ca.ui.model.type.Time.prototype._handleLocalizationChange = function() {
	this.oOutputFormat = sap.ca.ui.model.format.DateFormat.getTimeInstance(this.oFormatOptions);
	if (this.oFormatOptions.source) {
		this.oInputFormat = sap.ca.ui.model.format.DateFormat.getTimeInstance(this.oFormatOptions.source);
	}
};

}; // end of sap/ca/ui/model/type/Time.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.quickoverview.Quickoverview') ) {
jQuery.sap.declare("sap.ca.ui.quickoverview.Quickoverview");
jQuery.sap.require('sap.ui.base.Object'); // unlisted dependency retained



sap.ca.ui.quickoverview.QuickviewUtils = (function() {
	var _INIT = "initstuff";

	return ({

		getAttrValue : function(sValue, oModel) {
			// take over the value or read the value-'path' from model in case
			// model is provided
			//deep attributes:  oModel.getData()["deeptest"]["deepattr1"]

			if (!sValue) {
				return "";
			}
			var iBrStart = sValue.indexOf('{');
			var iBrEnd = sValue.indexOf('}')
			if (iBrStart > -1 && oModel) {
				// read modelattribute

				var sPath = sValue;
				sPath = sPath.substring(iBrStart + 1);
				sPath = sPath.substring(0, iBrEnd - 1);

				sPath = sPath.replace(/\//g, ".")
				// remove the first '.'
				var sFirstChar = sPath.substring(0, 1)
				if (sFirstChar === ".") {
					sPath = sPath.substring(1)
				}

				var sPathValue = oModel.getData()[sPath];
				return sPathValue;
			} else {
				return sValue;
			}

		}

	});
}());

sap.ca.ui.quickoverview.QuickviewBase = (function() {
	var _QVPOPOVERID = "qvPopover";
	var _QVVIEWNAME = "qvView";
	var _QVBACKBUTTON = "qvBackBtn";
	var _QVTITLE =  "qvTitle"; 	
	var _QVNAVCNT =  "qvNavCnt";
	var _QVINITPAGE = "p1";
	var _DEFAULTHEIGHT = "38rem";
	var _oApp = null;
	
//  todo: replace 'byId() statements - rather use the following variable 	
//	var _oQvControls = {};
//	_oQvControls.oPopover = null;
	

	var getViewName = function() {
		return "sap.ca.ui.quickoverview.Quickview";
	};
	
	var showHideBackButton = function(){
		//compare current displayed page with initial page
		var oBackButton = sap.ui.getCore().byId(_QVBACKBUTTON);
		var oNav = sap.ui.getCore().byId(_QVNAVCNT);
		oBackButton.setVisible((oNav.getCurrentPage().sId !== oNav.getInitialPage()));
		
	};
	
	
	var configureQvView = function(oQvView, oConfig, oQvPage, oQuickoverview) {
		//hosting view: set model for application attributes
		oQvView.setModel(oConfig.oModel);
		
		//hosting controller: set additional properties
		var oController = oQvView.getController();
		configController(oController, oConfig, oQuickoverview);
		
		//configure quickoverview...embed subview etc.
		var oQvViewSetup = oController.configureView();
		
		//popover Title and popoverheight
		configPopover( oConfig.title, oQvPage, oConfig.popoverHeight);
		
		//call application 'exit'
		var sCallback = oConfig.afterQvConfigured;
		if ( typeof(sCallback) == "function"){
			sCallback(oQvViewSetup.oQvView, oQvViewSetup.oSubView);
		}	
		
	};
	

	var configPopover = function(sTitle, oPage, sHeight) {
		if (!sTitle) {
			sTitle = sap.ca.ui.utils.resourcebundle
					.getText("Quickoverview.popovertitle")
		}

		var oTitle = sap.ui.getCore().byId(_QVTITLE);
		oTitle.setText(sTitle);
		//set title also for page: ( during 'backnavigation'
		//this page title will be taken for the popover title ) 
		oPage.setTitle(sTitle);

		
		var sThisHeight = sHeight;
		if (!sThisHeight)
			{ 
				sThisHeight = _DEFAULTHEIGHT;
			}

		var oPopover = sap.ui.getCore().byId(_QVPOPOVERID);
		
		oPopover.setContentHeight(sThisHeight);
		oPage.qvHeight = sThisHeight; //hack to buffer popoverheight !
	};
	
	
	var setPopoverTitleFromPage = function(oPage){
		var oTitle = sap.ui.getCore().byId(_QVTITLE);
		oTitle.setText(oPage.getTitle());
	};
	
	var setPopoverHeightFromPage = function(oPage){
		var oPopover = sap.ui.getCore().byId(_QVPOPOVERID);
		oPopover.setContentHeight(oPage.qvHeight);
	};

	var configController = function(oController, oConfig, oQuickoverview) {
		//QUICKOVERVIEW HOSTVIEW controller: add configuration properties 
		var sEmpty = "";
		oController.viewConfig = {};
		oController.viewConfig.headerNoIcon = (oConfig.headerNoIcon) ? oConfig.headerNoIcon
				: false;		
		oController.viewConfig.headerTitle = (oConfig.headerTitle) ? oConfig.headerTitle
				: sEmpty;
		oController.viewConfig.headerSubTitle = (oConfig.headerSubTitle) ? oConfig.headerSubTitle
				: sEmpty;
		oController.viewConfig.headerImgURL = (oConfig.headerImgURL) ? oConfig.headerImgURL	: sEmpty;
		oController.viewConfig.subViewName = (oConfig.subViewName) ? oConfig.subViewName : sEmpty;
		oController.viewConfig.quickOverview = oQuickoverview;
		oController.viewConfig.beforeExtNav = (oConfig.beforeExtNav) ? oConfig.beforeExtNav : sEmpty;
		oController.viewConfig.beforeExtNavSubHdr = (oConfig.beforeExtNavSubHdr) ? oConfig.beforeExtNavSubHdr : sEmpty;		

	};

	// create initial popover and page and view
	var createQVPopover = function() {

		var popoverId = _QVPOPOVERID;
		var oPopover = sap.ui.getCore().byId(popoverId);
		if (!oPopover) {

			// add nav container + page + view
			var oNavContainer = new sap.m.NavContainer(_QVNAVCNT, {
				initialPage : _QVINITPAGE,
				height : "100%",
				pages : [ new sap.m.Page(_QVINITPAGE, {
					showHeader : false,
					enableScrolling : true,
					content : [ new sap.ui.view({
						id : "qvView",
						viewName : "sap.ca.ui.quickoverview.Quickview",
						type : sap.ui.core.mvc.ViewType.XML
					})
					]
				}) ]
			});

			
			var fAfterNavigate = function(oData) {
				
				var sPageId;
				if (oData.mParameters.isBack) {
					// destroy and remove previous page
					sPageId = oData.mParameters.fromId;
					var oPrevPage = this.getPage(sPageId);
					if ( oPrevPage ) {
						oPrevPage.destroy();
						this.removePage(sPageId);						
					}

					//update popover title
					setPopoverTitleFromPage(this.getPage(oData.mParameters.toId));
					setPopoverHeightFromPage(this.getPage(oData.mParameters.toId));					
				} else if (oData.mParameters.isBackToTop) {
					// destroy and remove previous page stack
					var count = this.getPages().length;
					for ( var i = count - 1; i > -1; i--) {
						sPageId = this.getPages()[i].sId;
						if (sPageId !== this.getInitialPage()) {
							this.getPage(sPageId).destroy();
							this.removePage(sPageId);
						}
					}
				}
				showHideBackButton();

			}
			oNavContainer.attachAfterNavigate(fAfterNavigate);

			//prepare header
			var oBackButton = new sap.m.Button({
				id : _QVBACKBUTTON,
				icon : "sap-icon://nav-back",
				visible : false,
				tap : function() {
					var nav = sap.ui.getCore().byId(_QVNAVCNT);
					nav.back();
				}
			});
			
			var oTitle = new sap.m.Label({
				id : _QVTITLE,
				visible : true
			});
		
			var oCustHeader = new sap.m.Bar({	
				translucent : false,
				contentLeft : oBackButton,
				contentMiddle : oTitle
			});

			oPopover = new sap.m.ResponsivePopover(popoverId, {
				customHeader : oCustHeader,
				//modal : true, //required for analyzing
				showHeader : true,
				placement : sap.m.PlacementType.Right,
				verticalScrolling : true,
				contentWidth : "20em", // "320px", // width of an IPhone
				contentHeight : _DEFAULTHEIGHT,
				content : oNavContainer
			});
			
			
			var fnPopoverClose = function() {
				var nav = sap.ui.getCore().byId(_QVNAVCNT);
				nav.backToTop();
				showHideBackButton();				
			};
			oPopover.attachAfterClose(fnPopoverClose);
			
			//load stylesheet for object header icon coloring
			//"sap/ca/ui/themes/base/QuickOverview.css"
			var sPath = jQuery.sap.getModulePath("sap/ca/ui") + "/themes/base/QuickOverview.css";
			jQuery.sap.includeStyleSheet(sPath);			
			
		}

		return oPopover;
	};

	return ({

		initQVPopover : function(oParentCard) {
			var oPopover = createQVPopover();
		},

		openQVPopover : function(oSourceControl, oConfig, oLocation,
				oQuickoverview) {

			// set additional attributes to the viewcontroller
			var oView = sap.ui.getCore().byId(_QVVIEWNAME);
			var oPage = sap.ui.getCore().byId(_QVINITPAGE);
			
			//set up content of popover
			configureQvView(oView, oConfig, oPage, oQuickoverview);

			//open popover ...with placement! 
			try {
				// jQuery.sap.history.addVirtualHistory();
				// fix: dynamic calculation of placement type
				var oPopover = sap.ui.getCore().byId(_QVPOPOVERID);				
				if (!oLocation) {
					var $link = oSourceControl.$ ? oSourceControl.$()
						: jQuery(oSourceControl);
					var iScreenWidth = $(window).width();
					var iOffsetLeft = $link.offset().left;

					var sPlacement = sap.m.PlacementType.Left;
				
					if (iOffsetLeft < iScreenWidth / 2) {
						sPlacement = sap.m.PlacementType.Right;
						var iControlWidth = $link.width();
						oPopover.setOffsetX(-iControlWidth + 50);
					} else {
						oPopover.setOffsetX(0);
					}
					oPopover.setOffsetY(0);
					oPopover.setPlacement(sPlacement);
				}
				else {
					oPopover.setOffsetX(oLocation.offsetX);
					oPopover.setOffsetY(oLocation.offsetY);		
					oPopover.setPlacement(oLocation.placement);					
				}
				oPopover.openBy(oSourceControl);
			} catch (err) {
				// jQuery.sap.log.error(sap.ca.common.uilib.dialogResourceBundle.getText("YMSG_BC_ERROR",
				// [err.message]));
			}
		},

		navQVPopover : function(oConfig, oQuickoverview) {

			//create target (Quickview ) view
			var oView = new sap.ui.view({
				viewName : "sap.ca.ui.quickoverview.Quickview",
				type : sap.ui.core.mvc.ViewType.XML
			});
			
			//create target page
			var oPage = new sap.m.Page({
				showHeader : false,
				enableScrolling : true,
				content : [ oView ]
			});			
			
			//set up content of popover
			configureQvView(oView, oConfig, oPage, oQuickoverview);
			
			var nav = sap.ui.getCore().byId(_QVNAVCNT);
			nav.addPage(oPage);
			nav.to(oPage.getId(), "show");

		},


	});
}());

// ///////////////////////////////////////////////
// Public Interface: sap.ca.ui.quickoverview...
// ///////////////////////////////////////////////
sap.ui.base.Object.extend("sap.ca.ui.quickoverview.Quickoverview", {

	iControlType : 0, // popover
	oConfig : {}, // QV Configuration
	oParentCard : undefined,
	oSourceControl : undefined,

	// Public interface: constructor
	constructor : function(oConfig, oApp, oParentCard) {
		if (!oConfig)
			return;

		//SIL - TODO - filter/verify the incoming parameters!
		this.oInitialConfig = oConfig;

		// init
		sap.ca.ui.quickoverview.QuickviewBase.initQVPopover(this.oParentCard);
	},

	// Public interface: openBy - initially called when opening the popover
	openBy : function(oSourceControl, oLocation) {
		if (!this.oInitialConfig)
			return;
		this.oSourceControl = oSourceControl;
		
		// use ResponsivePopover
		sap.ca.ui.quickoverview.QuickviewBase.openQVPopover(oSourceControl,
				this.oInitialConfig, oLocation, this);

		return;
	},

	navigateTo : function(oConfig) {
		sap.ca.ui.quickoverview.QuickviewBase.navQVPopover(oConfig, this);

	},

});
}; // end of sap/ca/ui/quickoverview/Quickoverview.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.utils.CanvasHelper') ) {
jQuery.sap.declare("sap.ca.ui.utils.CanvasHelper");




sap.ui.base.ManagedObject.extend("sap.ca.ui.utils.CanvasHelper", {
	
	metadata: {
		properties: {
			"width": {type: "int", group : "Appearance"},
			"height": {type: "int", group : "Appearance"},
			"crop": {type: "boolean", group : "Appearance"},
			"quality": {type: "int", group : "Appearance"},
            "minWeight": {type: "int", group : "Appearance"}
		},
		events:{
			"done": {}
		}
	},
	
	_newsize: function(w, h, W, H, C) {
        var c = C ? 'h' : '';
        if ((W && w > W) || (H && h > H)) {
            var r = w / h;
            if ((r >= 1 || H === 0) && W && !C) {
                w = W;
                h = (W / r) >> 0;
            } else if (C && r <= (W / H)) {
                w = W;
                h = (W / r) >> 0;
                c = 'w';
            } else {
                w = (H * r) >> 0;
                h = H;
            }
        }
        return {
            'width': w,
            'height': h,
            'cropped': c
        };
    },
    
    /**
     * NOT USED YET
     */
    _dataURLtoBlob: function(data) {
        var mimeString = data.split(',')[0].split(':')[1].split(';')[0];
        var byteString = atob(data.split(',')[1]);
        var ab = new ArrayBuffer(byteString.length);
        var ia = new Uint8Array(ab);
        for (var i = 0; i < byteString.length; i++) {
            ia[i] = byteString.charCodeAt(i);
        }
        var bb = (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder);
        if (bb) {   
            bb = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder)();
            bb.append(ab);
            return bb.getBlob(mimeString);
        } 
        else { 
            bb = new Blob([ab], {
                'type': (mimeString)
            });
            return bb;
        }
    },
    
    /**
     * Detect subsampling in loaded image.
     * In iOS, larger images than 2M pixels may be subsampled in rendering.
     */
    _detectSubsampling: function(img) {
        var iw = img.width, ih = img.height;
        if (iw * ih > (1024*1024)) { // subsampling may happen over megapixel image
            var canvas = document.createElement('canvas');
            canvas.width = canvas.height = 1;
            var ctx = canvas.getContext('2d');
            ctx.drawImage(img, -iw + 1, 0);
            // subsampled image becomes half smaller in rendering size.
            // check alpha channel value to confirm image is covering edge pixel or not.
            // if alpha value is 0 image is not covering, hence subsampled.
            return ctx.getImageData(0, 0, 1, 1).data[3] === 0;
        } 
        else {
            return false;
        }
    },
    
    /**
     * Transform canvas coordination according to specified frame size and orientation
     * Orientation value is from EXIF tag
     */
    _transformCoordinate: function(canvas, width, height, orientation) {
        if (orientation >= 5 && orientation <= 8){
            canvas.width = height;
            canvas.height = width;
        }
        else{
            canvas.width = width;
            canvas.height = height;
        }
        var ctx = canvas.getContext('2d');
        switch (orientation) {
            case 1:
                // nothing
                break;
            case 2:
                // horizontal flip
                ctx.translate(width, 0);
                ctx.scale(-1, 1);
                break;
            case 3:
                // 180 rotate left
                ctx.translate(width, height);
                ctx.rotate(Math.PI);
                break;
            case 4:
                // vertical flip
                ctx.translate(0, height);
                ctx.scale(1, -1);
                break;
            case 5:
                // vertical flip + 90 rotate right
                ctx.rotate(0.5 * Math.PI);
                ctx.scale(1, -1);
                break;
            case 6:
                // 90 rotate right
                ctx.rotate(0.5 * Math.PI);
                ctx.translate(0, -height);
                break;
            case 7:
                // horizontal flip + 90 rotate right
                ctx.rotate(0.5 * Math.PI);
                ctx.translate(width, -height);
                ctx.scale(-1, 1);
                break;
            case 8:
                // 90 rotate left
                ctx.rotate(-0.5 * Math.PI);
                ctx.translate(-width, 0);
                break;
            default:
                break;
        }
    },
    
    /**
     * Detecting vertical squash in loaded image.
     * Fixes a bug which squash image vertically while drawing into canvas for some images.
     */
    _detectVerticalSquash: function(img, iw, ih) {
        var canvas = document.createElement('canvas');
        canvas.width = 1;
        canvas.height = ih;
        var ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0);
        var data = ctx.getImageData(0, 0, 1, ih).data;
        // search image edge pixel position in case it is squashed vertically.
        var sy = 0;
        var ey = ih;
        var py = ih;
        while (py > sy) {
            var alpha = data[(py - 1) * 4 + 3];
            if (alpha === 0) {
                ey = py;
            } else {
                sy = py;
            }
            py = (ey + sy) >> 1;
        }
        var ratio = py / ih;
        return ratio === 0 ? 1 : ratio;
    },

    _keepRatio: function(iw, ih){
        if (iw > ih){
            this.setHeight(Math.round(this.getHeight() * (ih / iw)));
        }
        else if (iw < ih){
            this.setWidth(Math.round(this.getWidth() * (iw / ih)));
        }
    },

    
   /**
    * Loads the image into the canvas, resize it and fire an event
    * 
    */
    resize: function(file){
    	var self = this;

        var reader = new FileReader();
        reader.onloadend = function(e) {

            var dataURL = e.target.result;

            if (file.size / 1024 < self.getMinWeight()){
                jQuery.sap.log.info("Image is light, no resize is needed");
                self.fireDone({data: dataURL});
            }
            else{

                var byteString = atob(dataURL.split(',')[1]);
                var binary = new sap.ca.ui.utils.BinaryUtil(byteString, 0, byteString.length);
                var exif = sap.ca.ui.utils.exif.readFromBinary(binary);

                var img = new Image();
                img.onload = function(e) {

                    var iw = img.width, ih = img.height;

                    self._keepRatio(iw, ih);

                    var orientation = exif['Orientation'] || 1;

                    var size = (orientation >= 5 && orientation <= 8)
                            ? self._newsize(img.height, img.width, self.getWidth(), self.getHeight(), self.getCrop())
                            : self._newsize(img.width, img.height, self.getWidth(), self.getHeight(), self.getCrop());


                    var width = size.width, height = size.height;

                    var canvas = document.createElement("canvas");
                    var ctx = canvas.getContext("2d");
                    ctx.save();
                    self._transformCoordinate(canvas, width, height, orientation);

                    // over image size
                    if (self._detectSubsampling(img)) {
                        iw /= 2;
                        ih /= 2;
                    }
                    var d = 1024; // size of tiling canvas
                    var tmpCanvas = document.createElement('canvas');
                    tmpCanvas.width = tmpCanvas.height = d;
                    var tmpCtx = tmpCanvas.getContext('2d');
                    var vertSquashRatio = self._detectVerticalSquash(img, iw, ih);
                    var sy = 0;
                    while (sy < ih) {
                        var sh = sy + d > ih ? ih - sy : d;
                        var sx = 0;
                        while (sx < iw) {
                            var sw = sx + d > iw ? iw - sx : d;
                            tmpCtx.clearRect(0, 0, d, d);
                            tmpCtx.drawImage(img, -sx, -sy);
                            var dx = Math.floor(sx * width / iw);
                            var dw = Math.ceil(sw * width / iw);
                            var dy = Math.floor(sy * height / ih / vertSquashRatio);
                            var dh = Math.ceil(sh * height / ih / vertSquashRatio);
                            ctx.drawImage(tmpCanvas, 0, 0, sw, sh, dx, dy, dw, dh);
                            sx += d;
                        }
                        sy += d;
                    }
                    ctx.restore();
                    tmpCanvas = tmpCtx = null;

                    var newcanvas = document.createElement('canvas');
                    newcanvas.width = size.cropped === 'h' ? height : width;
                    newcanvas.height = size.cropped === 'w' ? width : height;
                    var x = size.cropped === 'h' ? (height - width) * .5 : 0;
                    var y = size.cropped === 'w' ? (width - height) * .5 : 0;
                    var newctx = newcanvas.getContext('2d');
                    newctx.drawImage(canvas, x, y, width, height);

                    jQuery.sap.log.info(file, file.type);
                    if (file.type === "image/png") {
                        var data = newcanvas.toDataURL(file.type);
                    } else {
                        var data = newcanvas.toDataURL("image/jpeg", (self.getQuality() * .01));
                    }

                    self.fireDone({data: data, width: newcanvas.width, height: newcanvas.height});

                };
                img.src = dataURL;
            }

        };
        reader.readAsDataURL(file);
    }
    
    
    
    
	
});

}; // end of sap/ca/ui/utils/CanvasHelper.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.AddPicture') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.AddPicture.
jQuery.sap.declare("sap.ca.ui.AddPicture");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new AddPicture.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getButtonPageType buttonPageType} : string (default: 'Tab')</li>
 * <li>{@link #getEditable editable} : boolean (default: true)</li>
 * <li>{@link #getMaxPictureNumber maxPictureNumber} : int (default: 10)</li>
 * <li>{@link #getUploadUrl uploadUrl} : string</li>
 * <li>{@link #getWidth width} : sap.ui.core.CSSSize (default: '100%')</li>
 * <li>{@link #getText text} : string</li>
 * <li>{@link #getPictureAlign pictureAlign} : sap.ui.core.TextAlign (default: sap.ui.core.TextAlign.Left)</li>
 * <li>{@link #getItemSize itemSize} : int (default: 64)</li>
 * <li>{@link #getCompression compression} : string (default: 'low')</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getPictures pictures} : sap.ca.ui.PictureItem[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.AddPicture#event:show show} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.AddPicture#event:pictureAdded pictureAdded} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.AddPicture#event:maxPictureLimitReached maxPictureLimitReached} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.AddPicture#event:imageUploadFailed imageUploadFailed} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Enables users to add pictures into a form. Contains PictureItem controls that describe the media.
 * It is designed to be used simultaneously with the PictureViewer control
 * @extends sap.ui.core.Control
 *
 * @author SAP AG 
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.AddPicture
 */
sap.ui.core.Control.extend("sap.ca.ui.AddPicture", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"buttonPageType" : {type : "string", group : "Appearance", defaultValue : 'Tab'},
		"editable" : {type : "boolean", group : "Appearance", defaultValue : true},
		"maxPictureNumber" : {type : "int", group : "Behavior", defaultValue : 10},
		"uploadUrl" : {type : "string", group : "Misc", defaultValue : null},
		"width" : {type : "sap.ui.core.CSSSize", group : "Appearance", defaultValue : '100%'},
		"text" : {type : "string", group : "Appearance", defaultValue : null},
		"pictureAlign" : {type : "sap.ui.core.TextAlign", group : "Appearance", defaultValue : sap.ui.core.TextAlign.Left},
		"itemSize" : {type : "int", group : "Appearance", defaultValue : 64},
		"compression" : {type : "string", group : "Appearance", defaultValue : 'low'}
	},
	aggregations : {
    	"pictures" : {type : "sap.ca.ui.PictureItem", multiple : true, singularName : "picture", bindable : "bindable"}
	},
	events : {
		"show" : {}, 
		"pictureAdded" : {}, 
		"maxPictureLimitReached" : {}, 
		"imageUploadFailed" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.AddPicture with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.AddPicture.extend
 * @function
 */

sap.ca.ui.AddPicture.M_EVENTS = {'show':'show','pictureAdded':'pictureAdded','maxPictureLimitReached':'maxPictureLimitReached','imageUploadFailed':'imageUploadFailed'};


/**
 * Getter for property <code>buttonPageType</code>.
 * The page container type in which the button is embedded : Tab or Form
 *
 * Default value is <code>Tab</code>
 *
 * @return {string} the value of property <code>buttonPageType</code>
 * @public
 * @name sap.ca.ui.AddPicture#getButtonPageType
 * @function
 */

/**
 * Setter for property <code>buttonPageType</code>.
 *
 * Default value is <code>Tab</code> 
 *
 * @param {string} sButtonPageType  new value for property <code>buttonPageType</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setButtonPageType
 * @function
 */


/**
 * Getter for property <code>editable</code>.
 * Defines whether the button should appear or not.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>editable</code>
 * @public
 * @name sap.ca.ui.AddPicture#getEditable
 * @function
 */

/**
 * Setter for property <code>editable</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bEditable  new value for property <code>editable</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setEditable
 * @function
 */


/**
 * Getter for property <code>maxPictureNumber</code>.
 * Defines the maximum number of pictures you can add. Default is set to 10
 *
 * Default value is <code>10</code>
 *
 * @return {int} the value of property <code>maxPictureNumber</code>
 * @public
 * @name sap.ca.ui.AddPicture#getMaxPictureNumber
 * @function
 */

/**
 * Setter for property <code>maxPictureNumber</code>.
 *
 * Default value is <code>10</code> 
 *
 * @param {int} iMaxPictureNumber  new value for property <code>maxPictureNumber</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setMaxPictureNumber
 * @function
 */


/**
 * Getter for property <code>uploadUrl</code>.
 * Url of server we wish to upload to, only used as a fallback when FileReader is not supported by the browser
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>uploadUrl</code>
 * @public
 * @name sap.ca.ui.AddPicture#getUploadUrl
 * @function
 */

/**
 * Setter for property <code>uploadUrl</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sUploadUrl  new value for property <code>uploadUrl</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setUploadUrl
 * @function
 */


/**
 * Getter for property <code>width</code>.
 * The width of the control.
 *
 * Default value is <code>100%</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>width</code>
 * @public
 * @name sap.ca.ui.AddPicture#getWidth
 * @function
 */

/**
 * Setter for property <code>width</code>.
 *
 * Default value is <code>100%</code> 
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setWidth
 * @function
 */


/**
 * Getter for property <code>text</code>.
 * The text of the button.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>text</code>
 * @public
 * @name sap.ca.ui.AddPicture#getText
 * @function
 */

/**
 * Setter for property <code>text</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sText  new value for property <code>text</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setText
 * @function
 */


/**
 * Getter for property <code>pictureAlign</code>.
 * The alignment of the pictures
 *
 * Default value is <code>Left</code>
 *
 * @return {sap.ui.core.TextAlign} the value of property <code>pictureAlign</code>
 * @public
 * @name sap.ca.ui.AddPicture#getPictureAlign
 * @function
 */

/**
 * Setter for property <code>pictureAlign</code>.
 *
 * Default value is <code>Left</code> 
 *
 * @param {sap.ui.core.TextAlign} oPictureAlign  new value for property <code>pictureAlign</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setPictureAlign
 * @function
 */


/**
 * Getter for property <code>itemSize</code>.
 * Defines thumbnail size (height / width) in Pixels
 *
 * Default value is <code>64</code>
 *
 * @return {int} the value of property <code>itemSize</code>
 * @public
 * @name sap.ca.ui.AddPicture#getItemSize
 * @function
 */

/**
 * Setter for property <code>itemSize</code>.
 *
 * Default value is <code>64</code> 
 *
 * @param {int} iItemSize  new value for property <code>itemSize</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setItemSize
 * @function
 */


/**
 * Getter for property <code>compression</code>.
 * Defines whether or not you want to maximize the compression. Possible values : "Low" (thumbnail size) or "High" (screen size)
 *
 * Default value is <code>low</code>
 *
 * @return {string} the value of property <code>compression</code>
 * @public
 * @name sap.ca.ui.AddPicture#getCompression
 * @function
 */

/**
 * Setter for property <code>compression</code>.
 *
 * Default value is <code>low</code> 
 *
 * @param {string} sCompression  new value for property <code>compression</code>
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#setCompression
 * @function
 */


/**
 * Getter for aggregation <code>pictures</code>.<br/>
 * The list of pictures
 * 
 * @return {sap.ca.ui.PictureItem[]}
 * @public
 * @name sap.ca.ui.AddPicture#getPictures
 * @function
 */


/**
 * Inserts a picture into the aggregation named <code>pictures</code>.
 *
 * @param {sap.ca.ui.PictureItem}
 *          oPicture the picture to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the picture should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the picture is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the picture is inserted at 
 *             the last position        
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#insertPicture
 * @function
 */

/**
 * Adds some picture <code>oPicture</code> 
 * to the aggregation named <code>pictures</code>.
 *
 * @param {sap.ca.ui.PictureItem}
 *            oPicture the picture to add; if empty, nothing is inserted
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#addPicture
 * @function
 */

/**
 * Removes an picture from the aggregation named <code>pictures</code>.
 *
 * @param {int | string | sap.ca.ui.PictureItem} vPicture the picture to remove or its index or id
 * @return {sap.ca.ui.PictureItem} the removed picture or null
 * @public
 * @name sap.ca.ui.AddPicture#removePicture
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>pictures</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ca.ui.PictureItem[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.AddPicture#removeAllPictures
 * @function
 */

/**
 * Checks for the provided <code>sap.ca.ui.PictureItem</code> in the aggregation named <code>pictures</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ca.ui.PictureItem}
 *            oPicture the picture whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.AddPicture#indexOfPicture
 * @function
 */
	

/**
 * Destroys all the pictures in the aggregation 
 * named <code>pictures</code>.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#destroyPictures
 * @function
 */


/**
 * Binder for aggregation <code>pictures</code>.
 *
 * @param {string} sPath path to a list in the model 
 * @param {sap.ui.core.Element} oTemplate the control template for this aggregation
 * @param {sap.ui.model.Sorter} oSorter the initial sort order (optional)
 * @param {array} aFilters the predefined filters for this aggregation (optional)
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#bindPictures
 * @function
 */

/**
 * Unbinder for aggregation <code>pictures</code>.
 *
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#unbindPictures
 * @function
 */


/**
 * Indicates that the user wishes to view the picture 
 *
 * @name sap.ca.ui.AddPicture#show
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'show' event of this <code>sap.ca.ui.AddPicture</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.AddPicture</code>.<br/> itself. 
 *  
 * Indicates that the user wishes to view the picture 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.AddPicture</code>.<br/> itself.
 *
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#attachShow
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'show' event of this <code>sap.ca.ui.AddPicture</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#detachShow
 * @function
 */

/**
 * Fire event show to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.AddPicture#fireShow
 * @function
 */


/**
 * Indicates that the image upload failed, only used as a fallback when FileReader is not supported by the browser 
 *
 * @name sap.ca.ui.AddPicture#pictureAdded
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'pictureAdded' event of this <code>sap.ca.ui.AddPicture</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.AddPicture</code>.<br/> itself. 
 *  
 * Indicates that the image upload failed, only used as a fallback when FileReader is not supported by the browser 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.AddPicture</code>.<br/> itself.
 *
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#attachPictureAdded
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'pictureAdded' event of this <code>sap.ca.ui.AddPicture</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#detachPictureAdded
 * @function
 */

/**
 * Fire event pictureAdded to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.AddPicture#firePictureAdded
 * @function
 */


/**
 * Indicates that the limit number of pictures has been reached 
 *
 * @name sap.ca.ui.AddPicture#maxPictureLimitReached
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'maxPictureLimitReached' event of this <code>sap.ca.ui.AddPicture</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.AddPicture</code>.<br/> itself. 
 *  
 * Indicates that the limit number of pictures has been reached 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.AddPicture</code>.<br/> itself.
 *
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#attachMaxPictureLimitReached
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'maxPictureLimitReached' event of this <code>sap.ca.ui.AddPicture</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#detachMaxPictureLimitReached
 * @function
 */

/**
 * Fire event maxPictureLimitReached to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.AddPicture#fireMaxPictureLimitReached
 * @function
 */


/**
 * Indicates that the image upload failed, only used as a fallback when FileReader is not supported by the browser 
 *
 * @name sap.ca.ui.AddPicture#imageUploadFailed
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'imageUploadFailed' event of this <code>sap.ca.ui.AddPicture</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.AddPicture</code>.<br/> itself. 
 *  
 * Indicates that the image upload failed, only used as a fallback when FileReader is not supported by the browser 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.AddPicture</code>.<br/> itself.
 *
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#attachImageUploadFailed
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'imageUploadFailed' event of this <code>sap.ca.ui.AddPicture</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.AddPicture#detachImageUploadFailed
 * @function
 */

/**
 * Fire event imageUploadFailed to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.AddPicture} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.AddPicture#fireImageUploadFailed
 * @function
 */


// Start of sap\ca\ui\AddPicture.js





sap.ca.ui.AddPicture.BUTTON_PAGE_TYPE = {'TAB':'Tab','FORM':'Form'};

/**
 * Initialise control.
 */
sap.ca.ui.AddPicture.prototype.init = function(){

    // proxy to keep the "this" pointer
    var fireCaptureInput = jQuery.proxy(this._clickCaptureInput, this);

    // Add Button
    this._oButton = new sap.m.Button(this.getId()+"-add", {
        press:fireCaptureInput,
        icon:"sap-icon://add",
        type: sap.m.ButtonType.Transparent,
        width : "100%"
    });
    this._oButton.addStyleClass("sapCaUiAddPictureButton");

    // set the default button text (sets the property at the same time)
    this.setText(sap.ca.ui.utils.resourcebundle.getText("addPicture.text"));

    // for testing iFrame in other browsers
    this._forceUpload = false;

};

/**
 * Called when the control is destroyed
 */
sap.ca.ui.AddPicture.prototype.exit = function() {

    if (this._oButton) {    	
        this._oButton.destroy();
    }

    if (!window.FileReader || this._forceUpload) {
        jQuery.sap.byId(this.getId()+"-capture").fileupload('destroy');
    }
};

/**
 * Called after the control has been rendered
 */
sap.ca.ui.AddPicture.prototype.onAfterRendering = function(){

    // client side file upload support? // not IE9 for example
    if (!window.FileReader || this._forceUpload) {
        // check the URL for upload
        var sURL = this.getUploadUrl();
        // if the URL is empty we can not upload
        if (null==sURL || sURL.length==0) {
            jQuery.sap.log.error("AddPicture: The 'uploadUrl' property has not been set or is empty, and is required for this browser");
        }
        else {
            jQuery.sap.byId(this.getId()+"-capture").fileupload({
                url : sURL,
                add : jQuery.proxy(this._handleServerUpload, this),
                done : jQuery.proxy(this._handleServerUploadComplete, this),
                fail : jQuery.proxy(this._handleServerUploadFail, this)
            });
        }
    }
    else {
        // supported browsers
        var inputCapture = jQuery.sap.domById(this.getId() + "-capture"); // input object
        if (inputCapture)
            inputCapture.onchange = jQuery.proxy(this._handleClientUpload, this);
    }

    //if max limit of pictures reached
    var iNbPict = this.getPictures().length;
    if (inputCapture){
        inputCapture.visibility = iNbPict >= this.getMaxPictureNumber();
    }
};


/**
 * Set the text for the button
 * @override
 * @public
 * @param sValue {string}
 */
sap.ca.ui.AddPicture.prototype.setText = function(sValue) {

    this._oButton.setText(sValue);
    this.setProperty("text", sValue);
};


/**
 * Accessor for the button control used by the renderer
 * @return {sap.m.Button} The button control
 * @private
 */
sap.ca.ui.AddPicture.prototype._getButton = function() {

    return this._oButton;
};

/**
 * Handler for the input change event
 * @private
 */
sap.ca.ui.AddPicture.prototype._handleClientUpload = function () {
    var input = jQuery.sap.domById(this.getId() + "-capture"); // input object
    var files = input.files;

    // files not supported
    if (!files) {
        jQuery.sap.log.error("HTML5 files property not supported on input element for this browser")
    }
    // other browsers
    else {
        // Loop through the FileList and render image files as thumbnails.
        for (var i = 0, f; f = files[i]; i++) {

            // Only process image files.
            if (!f.type.match('image.*')) {
                continue;
            }

            this._readFile(f);
        }
    }
};


/**
 * Handler for server upload
 * @private
 */
sap.ca.ui.AddPicture.prototype._handleServerUpload = function (event, data) {
    try {
        // upload
        data.submit();
    }
    catch(error) {
        this.fireImageUploadFailed({
            reason : "Submit Error",
            response : data
        });
    }
};

/**
 * Handler for server upload complete
 * @private
 */
sap.ca.ui.AddPicture.prototype._handleServerUploadComplete = function (event, data) {

    var errorStatus = null;

    // check that we have a result object
    if (null!=data && null!=data.result) {

        var fileName = null;
        if (null!=data.files && data.files.length===1) {
            fileName = data.files[0].name;
        }

        // the response is inside <html><body><pre> when using the iFrame
        try {


            var $result = data.result.find("pre");
            if ($result.length === 0){
                $result = $('pre', data.result);
            }

            var imageSource = $result.text();
            if (null!=imageSource && imageSource.indexOf("data:image/") === 0) {
                this._createAndAddPictureItem(imageSource, fileName);
            }
            // if the browser supports XHR then the result is good
            else if (null!=data.result.indexOf && data.result.indexOf("data:image/") === 0) {
                // create the image using the data returned from the server
                this._createAndAddPictureItem(data.result, fileName);
            }
            // it could be a HTML page returned (error case) - session timeout, not logged on
            else if (null!=data.result[0] && null!=data.result[0].title) {
                errorStatus = data.result[0].title;
            }
        }
        catch (e) {
            jQuery.sap.log.error("Error while retrieving upload response from iframe");
            errorStatus = "No response found";
        }
    }
    else {
        errorStatus = "Invalid response";
    }

    // provide information on event so that custom error message can be used
    if (null!=errorStatus) {
        this.fireImageUploadFailed({
            reason : errorStatus,
            response : data
        });
    }

};

/**
 * Handler for server upload complete
 * @private
 */
sap.ca.ui.AddPicture.prototype._handleServerUploadFail = function (event, data) {

    this.fireImageUploadFailed({
        reason : "Upload Failed",
        response : data
    });

};

/**
 * File reader
 * @private
 */
sap.ca.ui.AddPicture.prototype._readFile = function (f) {
	this._createAndAddPictureItemFromFile(f);  
};



/**
 * Handler for the input click event
 * @private
 */
sap.ca.ui.AddPicture.prototype._clickCaptureInput = function (oEvent) {

    //if max limit of pictures reached, fire event.
    var iNbPict = this.getPictures().length;
    if ( iNbPict >= this.getMaxPictureNumber()){
        // fire max limit reached
        this.fireMaxPictureLimitReached({
            Limit : iNbPict
        });
    } else  {
        jQuery.sap.domById(this.getId()+ '-capture').click();
    }
};


/**
 * Create and add a new PictureItem
 * @private
 */
sap.ca.ui.AddPicture.prototype._createAndAddPictureItem = function (imageSource, filename) {

    var oPictureItem = new sap.ca.ui.PictureItem({ status : sap.ca.ui.PictureItem.STATUS.ADD, 
    												name : filename, source: imageSource 
    											});
    this.addPicture(oPictureItem);
    this.firePictureAdded({
        pictureItem : oPictureItem
    });
};

/**
 * Create and add a new PictureItem
 * @private
 */
sap.ca.ui.AddPicture.prototype._createAndAddPictureItemFromFile = function (file) {

    var oPictureItem = new sap.ca.ui.PictureItem({ status : sap.ca.ui.PictureItem.STATUS.ADD, name : file.name });
    
    var that = this;
    oPictureItem.attachLoaded(function(){
        that.addPicture(oPictureItem);

        that.firePictureAdded({
            pictureItem : oPictureItem
        });
    });
    
    oPictureItem.setFile(file, this._getConfig());
};


sap.ca.ui.AddPicture.prototype._getConfig = function() {
	
	var compression = this.getCompression();
    var oConfig = {};
    switch (compression){
        case "high":
            // do NOT crop on IE otherwise you get black area in your image
            oConfig = {width: 320, height: 320, crop: sap.ui.getCore().isMobile() , quality: 72};
            oConfig.minWeight = 50;
    		break;
    	case "low":
    	default:
    		if (jQuery.device.is.desktop){
                oConfig = {width: 1024, height: 1024, crop: false, quality: 144};
    	    }
    	    else {
                oConfig = {width: 800, height: 800, crop: false, quality: 144};
    	    }
            oConfig.minWeight = 150;
    		break;
    }

    
    return oConfig;
};


/**
 * Control fires show event caused by the picture item
 * @private
 */
sap.ca.ui.AddPicture.prototype._pictureTapped = function (oPictureItem) {
    this.fireShow({
        pictureItem : oPictureItem
    });
};


sap.ca.ui.AddPicture.prototype.ontouchstart = function(oEvent) {
	
	if (!jQuery.device.is.desktop && oEvent.target.id === this.getId()+"-capture") {
		this._oButton._activeButton();
	}
	
};

sap.ca.ui.AddPicture.prototype.ontouchend = function(oEvent) {
	if (!jQuery.device.is.desktop){
		this._oButton._inactiveButton();
	}
			
};

sap.ca.ui.AddPicture.prototype.ontouchcancel = function(oEvent) {
	if (!jQuery.device.is.desktop){
		this._oButton._inactiveButton();
	}
			
};


/**
 * Function is called when tap occurs on button.
 * 
 * @private
 */
sap.ca.ui.AddPicture.prototype.ontap = function(oEvent) {

	if (!jQuery.device.is.desktop && oEvent.target.id === this.getId()+"-capture") {
		this._oButton.fireTap();
	}
};

}; // end of sap/ca/ui/AddPicture.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.DatePicker') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.DatePicker.
jQuery.sap.declare("sap.ca.ui.DatePicker");

jQuery.sap.require('sap.m.InputBase'); // unlisted dependency retained



/**
 * Constructor for a new DatePicker.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getFirstDayOffset firstDayOffset} : int (default: 0)</li>
 * <li>{@link #getDateValue dateValue} : string</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.m.InputBase#constructor sap.m.InputBase}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Allows end users to interact with dates.
 * Entries can directly be written in, or selected from a calendar pad.
 * @extends sap.m.InputBase
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.DatePicker
 */
sap.m.InputBase.extend("sap.ca.ui.DatePicker", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"getDate"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"firstDayOffset" : {type : "int", group : "Data", defaultValue : 0},
		"dateValue" : {type : "string", group : "Misc", defaultValue : null}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.DatePicker with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.DatePicker.extend
 * @function
 */


/**
 * Getter for property <code>firstDayOffset</code>.
 * This property is used to offset the first day of the week (0 = sunday). Returns int, default 0
 *
 * Default value is <code>0</code>
 *
 * @return {int} the value of property <code>firstDayOffset</code>
 * @public
 * @name sap.ca.ui.DatePicker#getFirstDayOffset
 * @function
 */

/**
 * Setter for property <code>firstDayOffset</code>.
 *
 * Default value is <code>0</code> 
 *
 * @param {int} iFirstDayOffset  new value for property <code>firstDayOffset</code>
 * @return {sap.ca.ui.DatePicker} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.DatePicker#setFirstDayOffset
 * @function
 */


/**
 * Getter for property <code>dateValue</code>.
 * This is a date string formatted as per the format for the control. If there is no valid input for the control, this value will be null.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>dateValue</code>
 * @public
 * @name sap.ca.ui.DatePicker#getDateValue
 * @function
 */

/**
 * Setter for property <code>dateValue</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sDateValue  new value for property <code>dateValue</code>
 * @return {sap.ca.ui.DatePicker} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.DatePicker#setDateValue
 * @function
 */


/**
 * returns selected date as a Date object
 *
 * @name sap.ca.ui.DatePicker.prototype.getDate
 * @function

 * @type object
 * @public
 */


// Start of sap\ca\ui\DatePicker.js
///**
// * This file defines behavior for the control,
// */

jQuery.sap.require('sap.me.Calendar'); // unlisted dependency retained




sap.ca.ui.DatePicker.prototype.init = function() {
    if (sap.m.InputBase.prototype.init) {
        sap.m.InputBase.prototype.init.apply(this, arguments);
    }
    
    this.dateObj = null;
		
    // initialize the calendar
    this._oCalendar = new sap.me.Calendar({
        firstDayOffset : this.getFirstDayOffset(),
        tapOnDate : jQuery.proxy(function(oEvent) 
        {
        	if (!this._dateType)
        	{
        	    this._setUpDateType();
        	}
        
        	var dateTapped = oEvent.getParameters().date;
        	this.dateObj = new Date(dateTapped);
        	var tempString = this._dateType.formatValue(dateTapped, "string");
        	this.setDateValue(tempString);
        
            this.setValue(tempString);
            this.fireChange(false);
            this._closeCalendar();
        }, this)
    });
    
    this._oCalendar.setEnableMultiselection(false);


    //Cancel button 
    this._datePickerCancelBtn = new sap.m.Button({
        text : sap.ca.ui.utils.resourcebundle.getText("dialog.cancel"),
        width : "100%",
        press : jQuery.proxy(function() {
            this._closeCalendar();
        }, this)
    });

    if (jQuery.device.is.phone ) {
        //       initialize the Dialog for phone & Tablet
        this._oDatePickerDialogMobile = new sap.m.Dialog({
            title : sap.ca.ui.utils.resourcebundle.getText("datepicker.title"),
            leftButton : this._datePickerCancelBtn,
            stretchOnPhone : true,
            content : [ this._oCalendar ]
        });
    } else {
        //        initialize the Popover for desktop    
        this._oDatePickerPopoverDesktop = new sap.m.ResponsivePopover({
            title : sap.ca.ui.utils.resourcebundle.getText("datepicker.title"),
            placement : sap.m.PlacementType.Auto,
            enableScrolling : false,
            contentWidth: "20rem",
            contentHeight: "390px",
            content : [ this._oCalendar ]
        });
        
    }

};


sap.ca.ui.DatePicker.prototype._setUpDateType = function ()
{
	var needsDateType = true;

    var oBindingInfo = this.getBindingInfo("value");
    if (oBindingInfo) 
    {
        var oBindingType = oBindingInfo.type;
        	
        if (oBindingType && (oBindingType instanceof sap.ca.ui.model.type.Date))
        {
        	this._dateType = oBindingType;
        	
        	needsDateType = false;
        }
    }

	if (needsDateType)
	{
		this._dateType = new sap.ca.ui.model.type.Date();
	}

};



sap.ca.ui.DatePicker.prototype.setFirstDayOffset = function(iFirstDayOffset){
	this._oCalendar.setProperty("firstDayOffset", iFirstDayOffset, true); 
	this.setProperty("firstDayOffset", iFirstDayOffset);
};


sap.ca.ui.DatePicker.prototype.fireChange = function(bUpdateDateObj) 
{
	if (!this._dateType)
	{
	    this._setUpDateType();
	}
	
	var currentInput = this.getValue();
	
	var tempDate = this._validateDate(currentInput);
	
	if(bUpdateDateObj || bUpdateDateObj===undefined){
	this.dateObj = tempDate;
	}

	this.setDateValue(tempDate);
	
	var dateYYYYMMDD = null;

	if (tempDate)
	{
		dateYYYYMMDD = this._toDateStringYYYYMMDD(tempDate);
	}

	this.fireEvent("change", {newValue:currentInput,
							  newYyyymmdd:dateYYYYMMDD,
							  invalidValue: tempDate ? false : true});
	return this;
};		    
		    
		    

sap.ca.ui.DatePicker.prototype.exit = function() {
    if (sap.m.InputBase.prototype.exit) {
        sap.m.InputBase.prototype.exit.apply(this);
    }
    if (this._oDatePickerPopoverDesktop) {
        this._oDatePickerPopoverDesktop.destroy();
    }
    if (this._oDatePickerDialogMobile) {
        this._oDatePickerDialogMobile.destroy();
    }
    if(this._datePickerCancelBtn){
    this._datePickerCancelBtn.destroy();
    }
    
    if(this._oCalendarIcon){
    this._oCalendarIcon.destroy();
    }
    
};

sap.ca.ui.DatePicker.prototype._closeCalendar = function() {
    if (jQuery.device.is.phone ) {
        this._oDatePickerDialogMobile.close();
    } else {
        this._oDatePickerPopoverDesktop.close();
    }
};

sap.ca.ui.DatePicker.prototype._getCalendarIcon = function() {
    if (!this._oCalendarIcon) {
        var u = sap.ui.core.IconPool.getIconURI("appointment-2");
        this._oCalendarIcon = sap.ui.core.IconPool.createControlByURI({
            id : this.getId() + "__ci",
            src : u,
            press : jQuery.proxy(this._calendarIconPress, this)
        });
        this._oCalendarIcon.addStyleClass("sapCaUiDatePickerCalendarIcon");

    }
    return this._oCalendarIcon;
};

sap.ca.ui.DatePicker.prototype._calendarIconPress = function() 
{
	if (this.getEditable())
	{
		if (!this._dateType)
		{
		    this._setUpDateType();
		}
	
		var currentInput = this.getValue();
	
		var tempDate = this._validateDate(currentInput);
		this.setProperty("dateValue", tempDate, true);
	
		if (tempDate && !this.dateObj)
			this.dateObj = tempDate;
		if (tempDate)
		{
	    	this._oCalendar.toggleDatesSelection(this._oCalendar.getSelectedDates(),false);
	    	this._oCalendar.setCurrentDate(this.dateObj);
	    	this._oCalendar.toggleDatesSelection([this.dateObj],true);
		}
	
	    if (jQuery.device.is.phone ) 
	    {
	        this._oDatePickerDialogMobile.open();
	    } 
	    else 
	    {
	        this._oDatePickerPopoverDesktop.openBy(this._oCalendarIcon);
	    }
    }

};


// Date Validation Routines

sap.ca.ui.DatePicker.prototype._validateDate = function(inputString)
{
	if (!inputString)
	{
		return inputString;
	}
	
	var tempString = null;
	
	try
	{
		tempString = this._dateType.parseValue(inputString, "string");
	}
	catch(err)
	{
	}
	
	return tempString;
};


sap.ca.ui.DatePicker.prototype._toDateStringYYYYMMDD = function(dateString)
{
	var tempDate = new Date(dateString);

	var yearComponent = "" + tempDate.getFullYear();
	
	var monthComponent = "" + (tempDate.getMonth() + 1);
	
	var dayComponent = "" + tempDate.getDate();
	
	while (yearComponent.length < 4)
	{
		yearComponent = "0" + yearComponent;
	}
	
	while (monthComponent.length < 2)
	{
		monthComponent = "0" + monthComponent;
	}
	
	while (dayComponent.length < 2)
	{
		dayComponent = "0" + dayComponent;
	}
	
	return yearComponent + monthComponent + dayComponent;
};


sap.ca.ui.DatePicker.prototype.getDate = function()
{
return this.dateObj;
};

}; // end of sap/ca/ui/DatePicker.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ChartFormatter') ) {
  jQuery.sap.declare('sap.ca.ui.charts.ChartFormatter');



// Default formatting functions
sap.ca.ui.charts.DefaultFormatterFunction = {
    SHORTNUMBER: "ShortNumber",
    STANDARDNUMBER: "StandardNumber",
    SHORTDATE: "ShortDate",
    MEDIUMDATE: "MediumDate",
    LONGDATE: "LongDate",
    DAYSAGODATE: "DaysAgoDate"
};

sap.ca.ui.charts.ChartFormatter = function () {
    if (sap.ca.ui.charts.ChartFormatter.caller != sap.ca.ui.charts.ChartFormatter.getInstance) {
        throw new Error("This object cannot be instantiated");
    }
    this.formatFunctions = [];
};

sap.ca.ui.charts.ChartFormatter.getInstance = function () {
    if (!this.instance) {
        this.instance = new sap.ca.ui.charts.ChartFormatter();
    }
    return this.instance;
};

sap.ca.ui.charts.ChartFormatter.prototype.addFormatter = function (oChart, sLabel, formatter) {
    /*
      viz formatting is based on format strings:
      If a format string is specified on a label or tooltip, the global formatting function
      will be called with 2 params :  value to format, format string.
      Thus when a new formatter is added, we return the format string that must be added
      on chart label.
      In the global formatting function (format), we just call the formatter associated
      to the format string
     */

    if (typeof formatter != "string" && typeof formatter != "function") {
        jQuery.sap.log.error("Cannot add formatter : formatter must be a string or a function");
        return null;
    }

    if (oChart && sLabel) {
        //build a format string for the chart and label
        var formatString = this._getFormatString(oChart, sLabel, formatter);
        //register the formmatter for this format string
        this._pushToFormatFunctions(formatString, formatter);
        this._customizeFormatter();
        //return format string to calling chart
        return formatString;
    }
    else {
        jQuery.sap.log.error("Cannot add formatter : chart and label must be set");
        return null;
    }
};

// Set our global formatting function as viz formatting function
sap.ca.ui.charts.ChartFormatter.prototype._customizeFormatter = function () {
    sap.viz.api.env.Format.numericFormatter(this);
};

sap.ca.ui.charts.ChartFormatter.prototype.format = function (value, formatString) {
    if (formatString) {
        if (this.formatFunctions[formatString]) {
            return this.formatFunctions[formatString](value);
        }
        else {
            var formattedValue;
            if (this._legacyBubbleFormatter != null && typeof _legacyBubbleFormatter == "function") {
                formattedValue =  _legacyBubbleFormatter(value, formatString);
                if (formattedValue && formattedValue != value) {
                    return formattedValue;
                }
            }
            return value;
        }
    } else {
        return value;
    }
};

sap.ca.ui.charts.ChartFormatter.prototype._getFormatString = function (oChart, sLabel, formatter) {
    var formatString="";
    //if formatter is a default formatting function, we just return the string id of this function.
    //No need to prefix it with chart id, as we don't want to duplicate default formatting functions
    if (typeof formatter == "string") {
        formatString = formatter;
    }
    //for custom formatting functions, we return "Chart id+ slabel"
    //we don't check for uniqueness of sLabel : chart may want to use the same formatter for different labels.
    else {
        formatString = oChart.getId() + sLabel;
    }
    return formatString;
};

sap.ca.ui.charts.ChartFormatter.prototype._pushToFormatFunctions = function (formatString, formatter) {
    //default formatters
    if (typeof formatter == "string") {
        switch (formatter) {
            case sap.ca.ui.charts.DefaultFormatterFunction.SHORTNUMBER :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getShortNumberFormatter();
                break;
            case sap.ca.ui.charts.DefaultFormatterFunction.STANDARDNUMBER :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getStandardNumberFormatter();
                break;
            case sap.ca.ui.charts.DefaultFormatterFunction.SHORTDATE :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getShortDateFormatter();
                break;
            case sap.ca.ui.charts.DefaultFormatterFunction.MEDIUMDATE :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getMediumDateFormatter();
                break;
            case sap.ca.ui.charts.DefaultFormatterFunction.LONGDATE :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getLongDateFormatter();
                break;
            case sap.ca.ui.charts.DefaultFormatterFunction.DAYSAGODATE :
                if (!this.formatFunctions[formatString])this.formatFunctions[formatString] = this._getDaysAgoDateFormatter();
                break;
        }
    }
    //custom formatters
    else {
        this.formatFunctions[formatString] = formatter;
    }

};

/**
 *  ==============================================
 *  Implementation of default formatting functions
 *  ==============================================
 **/

sap.ca.ui.charts.ChartFormatter.prototype._getShortNumberFormatter = function () {
    var numberFormatter = sap.ca.ui.model.format.NumberFormat.getInstance({style: 'short'});
    return jQuery.proxy(numberFormatter.format, numberFormatter);
};

sap.ca.ui.charts.ChartFormatter.prototype._getStandardNumberFormatter = function () {
    var numberFormatter = sap.ca.ui.model.format.NumberFormat.getInstance({style: 'Standard'});
    return jQuery.proxy(numberFormatter.format, numberFormatter);
};

/**
 * As viz charts only accept number values, the following date formatters are designed
 * to work with dates expressed as timestamps (number of milliseconds since 01/01/1970).
 * Use Date.getTime() to get this timestamp from a date.
 */
sap.ca.ui.charts.ChartFormatter.prototype._getShortDateFormatter = function () {
    var formatDate = function(value) {
        if (!this.shortDateType) {
            this.shortDateType = new sap.ca.ui.model.type.Date({style: 'short',source: {pattern: "timestamp"}});
        }
        return this.shortDateType.formatValue(value,"string");
    };
    return jQuery.proxy(formatDate, this);
};

sap.ca.ui.charts.ChartFormatter.prototype._getMediumDateFormatter = function () {
    var formatDate = function(value) {
        if (!this.mediumDateType) {
            this.mediumDateType = new sap.ca.ui.model.type.Date({style: 'medium',source: {pattern: "timestamp"}});
        }
        return this.mediumDateType.formatValue(value,"string");
    };
    return jQuery.proxy(formatDate, this);
};

sap.ca.ui.charts.ChartFormatter.prototype._getLongDateFormatter = function () {
    var formatDate = function(value) {
        if (!this.longDateType) {
            this.longDateType = new sap.ca.ui.model.type.Date({style: 'long',source: {pattern: "timestamp"}});
        }
        return this.longDateType.formatValue(value,"string");
    };
    return jQuery.proxy(formatDate, this);
};

sap.ca.ui.charts.ChartFormatter.prototype._getDaysAgoDateFormatter = function () {
    var formatDate = function(value) {
        if (!this.daysAgoDateType) {
            this.daysAgoDateType = new sap.ca.ui.model.type.Date({style: 'daysAgo',source: {pattern: "timestamp"}});
        }
        return this.daysAgoDateType.formatValue(value,"string");
    };
    return jQuery.proxy(formatDate, this);
};

}; // end of sap/ca/ui/charts/ChartFormatter.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.ClusterList') ) {
jQuery.sap.declare("sap.ca.ui.charts.ClusterList");
jQuery.sap.require('sap.m.List'); // unlisted dependency retained


jQuery.sap.require('sap.ui.model.json.JSONModel'); // unlisted dependency retained

jQuery.sap.require('sap.ui.core.Element'); // unlisted dependency retained



sap.ui.core.Element.extend("sap.ca.ui.charts.ClusterList", {
    metadata: {
        publicMethods : ["getControl",
            "isEmpty",
            "reset",
            "createObject",
            "removeObject",
            "getObject",
            "hasObject",
            "count",
            "update",
            "getGroupIndexFor",
            "addGroup",
            "removeGroup",
            "getItemIndexFor",
            "addItemTo",
            "removeItemFrom",
            "getNumberOfItemsFor"]
    }
});

sap.ca.ui.charts.ClusterList.prototype.init = function() {
  var oModel = new sap.ui.model.json.JSONModel({"items": []});
    this._sModelName = this.getId()+"-Model";
    this.setModel(oModel, this._sModelName);
   var oItemTemplate = new sap.ca.ui.charts.ClusterListItem({
    title: "{title}",
    items: "{items}"
  });

  this._oList = new sap.m.List({
    inset: true
  });
  this._oList.setModel(this.getModel(this._sModelName));
  this._oList.bindAggregation("items", "/items", oItemTemplate);
};

sap.ca.ui.charts.ClusterList.prototype.getControl = function() {
  return this._oList;
};

sap.ca.ui.charts.ClusterList.prototype.isEmpty = function() {
  var oGroups = this.getModel(this._sModelName).getProperty("/items");
  return oGroups.length === 0;
};

sap.ca.ui.charts.ClusterList.prototype.reset = function() {
    this.getModel(this._sModelName).setProperty("/items", []);
};

sap.ca.ui.charts.ClusterList.prototype.destroy = function(bSuppressInvalidate) {
    sap.ui.core.Element.prototype.destroy.apply(this, bSuppressInvalidate);
    this.reset();
    if (this._oList){
        this._oList.destroy(bSuppressInvalidate);
    }
};

//////////////////////////////////////////////////////////////////////////////////////////////
//
// NEW API
//
//////////////////////////////////////////////////////////////////////////////////////////////

sap.ca.ui.charts.ClusterList.prototype.createObject = function(sPath) {
  if (typeof sPath === "undefined") {
    throw new Error("The 'path' is undefined!");
  }

  var oObject = undefined;
  var oItems =  this.getModel(this._sModelName).getProperty("/items");
  sPath.split(".").forEach(function(sKey, nIndex, oArray) {
    var bFound = false;
    $.each(oItems, function(nIndex, oItem) {
      if (oItem["key"] === sKey) {
        oObject = oItem;
        oItems = oItem["items"];
        bFound = true;
        return false;
      }
    });
    if (!bFound) {
      oObject = {
        key: sKey,
        items: []
      }
      oItems.push(oObject);
      oItems = oObject["items"];
    }
  });

  return oObject;
};

sap.ca.ui.charts.ClusterList.prototype.removeObject = function(sPath) {
  if (typeof sPath === "undefined") {
    throw new Error("The 'path' is undefined!");
  }

  var oItems =  this.getModel(this._sModelName).getProperty("/items");
  var nObjectIndex = -1;
  sPath.split(".").forEach(function(sKey, nIndex, oArray) {
    $.each(oItems, function(nItemIndex, oItem) {
      if (oItem["key"] === sKey) {
        if (nIndex < oArray.length - 1) {
          oItems = oItem["items"];

        } else {
          nObjectIndex = nItemIndex;
        }
        return false;
      }
    });
  });

  if (nObjectIndex !== -1) {
    oItems.splice(nObjectIndex, 1);
  }
};

sap.ca.ui.charts.ClusterList.prototype.getObject = function(sPath) {
  if (typeof sPath === "undefined") {
    throw new Error("The 'path' is undefined!");
  }

  var oResult = undefined;

  var oItems = this.getModel(this._sModelName).getProperty("/items");
  sPath.split(".").forEach(function(sKey, nIndex, oArray) {
    if (typeof oItems === "undefined") {
      return true;
    }
    var bFound = false;
    $.each(oItems, function(nIndex, oItem) {
      if (oItem["key"] === sKey) {
        oItems = oItem["items"];
        bFound = true;
        return false;
      }
    });
    if (bFound) {
      oResult = oItems;
    } else {
      oResult = undefined;
      return false;
    }
  });

  return oResult;
};


sap.ca.ui.charts.ClusterList.prototype.hasObject = function(sPath) {
  if (typeof sPath === "undefined") {
    throw new Error("The 'path' is undefined!");
  }

  if (sPath.indexOf(".") === -1) {
    return typeof this.getObject(sPath) !== "undefined";
  }

  var oItems = this.getObject(sPath.substring(0, sPath.lastIndexOf(".")));
  if (typeof oItems === "undefined") {
    return false;
  }

  var sKey = sPath.substring(sPath.lastIndexOf(".") + 1);

  var bResult = false;
  $.each(oItems, function(nIndex, oItem) {
    if (oItem["key"] === sKey) {
      bResult = true;
      return false;
    }
  });
  return bResult;
};

sap.ca.ui.charts.ClusterList.prototype.count = function(sPath) {
  if (typeof sPath === "undefined") {
    throw new Error("The 'path' is undefined!");
  }

  var oObject = this.getObject(sPath);
  if (typeof oObject === "undefined") {
    return 0;
  }
  return oObject.length;
};

sap.ca.ui.charts.ClusterList.prototype.update = function() {
   this.getModel(this._sModelName).updateBindings(true);
};

sap.ca.ui.charts.ClusterList.prototype.getGroupIndexFor = function(aGroupKey) {
  if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
    throw new Error("The group 'key' is undefined!");
  }
  var nResult = -1;
  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  $.each(oGroups, function(nIndex, oGroup) {
    if (oGroup["key"].toString() === aGroupKey.toString()) {
      nResult = nIndex;
      return false;
    }
  });

  return nResult;
};

sap.ca.ui.charts.ClusterList.prototype.addGroup = function(oData) {
  if (Array.isArray(oData)) {
    for (var nIndex in oData) {
      this._addGroup(oData[nIndex]);
    }
  } else {
    this._addGroup(oData);
  }
};

sap.ca.ui.charts.ClusterList.prototype._addGroup = function(oData) {
  var aKey = oData["key"];
  if (typeof aKey === "undefined"   || !Array.isArray(aKey) || aKey.length === 0) {
    throw new Error("The group 'key' is undefined!");
  }

    if (this.getGroupIndexFor(aKey) !== -1) {
        throw new Error("Group already exist with '" + aKey.toString() + "' key!");
    }

  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  if (!oData.hasOwnProperty("items")) {
    oData["items"] = [];
  }
  oData["key"] = aKey.toString();

  if(!oData.hasOwnProperty("subgroups")) {
      //create the array of sub groups
      oData["subgroups"] = [];
  }
   //manage multiple dimensions
   if (aKey.length > 1) {
      //clone the array aKey
      var aParentKey = aKey.slice(0);
       // get the key of the parent group
       aParentKey.splice(aKey.length - 1, 1);
       // get the index of the parent group
      var nParentIndex = this.getGroupIndexFor(aParentKey);
      if (nParentIndex === -1) {
          throw new Error("Group does not exist for '" + aParentKey.toString() + "' key!");
      }
     // get the parent group
      var oParentGroup = oGroups[nParentIndex];
      //get the array of groups in the parent group
      var aSubgroups = oParentGroup["subgroups"];
      if (typeof aSubgroups === "undefined" || !Array.isArray(aSubgroups)) {
          throw new Error("The group 'subgroups' is undefined!");
      }
       //save the group key in the parent group
       aSubgroups.push(aKey.toString());
  }
  oGroups.push(oData);
  this.getModel(this._sModelName).setProperty("/items", oGroups);
};

sap.ca.ui.charts.ClusterList.prototype.removeGroup = function(aGroupKey) {
    if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
        throw new Error("The group 'key' is undefined!");
    }

  var nIndex = this.getGroupIndexFor(aGroupKey);
  if (nIndex === -1) {
    throw new Error("Group does not exist for '" + aGroupKey.toString() + "' key!");
  }

  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
   oGroups.splice(nIndex, 1);
    if (aGroupKey.length > 1) {
        //clone the array aGroupKey
        var aParentKey = aGroupKey.slice(0);
        for(var i = aGroupKey.length - 1; i >0; i--){
            var sCurrentGroupKey = aParentKey.toString();
            //get the  key of the parent group
            aParentKey.splice(i, 1);
            // get index of the parent group
            var nParentIndex = this.getGroupIndexFor(aParentKey);
            if (nParentIndex !== -1) {
                // get the parent group
                var oParentGroup = oGroups[nParentIndex];
                //get the array of groups in the parent group
                var aSubGroups = oParentGroup["subgroups"];
                var nSubGroupIndex = -1;
                $.each(aSubGroups, function(nIndex, sSubGroup) {
                    //search the current group key in the parent group
                    if (sSubGroup === sCurrentGroupKey) {
                        nSubGroupIndex = nIndex;
                    }
                });
                if (nSubGroupIndex !== -1) {
                    //remove the group key in the parent group
                    aSubGroups.splice(nSubGroupIndex, 1);
                    //check if parent group does not contain any group
                    if (aSubGroups.length === 0)  {
                        //remove the parent group
                        oGroups.splice(nParentIndex, 1);
                    }
                }
            }
        }
    }
    this.getModel(this._sModelName).setProperty("/items", oGroups);
};

sap.ca.ui.charts.ClusterList.prototype.getItemIndexFor = function(aGroupKey, sItemKey) {
  if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
    throw new Error("The group 'key' is undefined!");
  }

  if (typeof sItemKey === "undefined") {
    throw new Error("The item 'key' is undefined!");
  }

  var nGroupIndex = this.getGroupIndexFor(aGroupKey);
  if (nGroupIndex === -1) {
    throw new Error("Group does not exist for '" + aGroupKey.toString() + "' key!");
  }

  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  var oGroup = oGroups[nGroupIndex];

  var nResult = -1;
  var oItems = oGroup["items"];
  $.each(oItems, function(nIndex, oItem) {
    if (oItem["key"] === sItemKey) {
      nResult = nIndex;
      return false;
    }
  });

  return nResult;
};

sap.ca.ui.charts.ClusterList.prototype.addItemTo = function(aGroupKey, oData) {
  if (Array.isArray(oData)) {
    for (var nIndex in oData) {
      this._addItemTo(aGroupKey, oData[nIndex]);
    }
  } else {
    this._addItemTo(aGroupKey, oData);
  }
   this.getModel(this._sModelName).updateBindings(true);
};

sap.ca.ui.charts.ClusterList.prototype._addItemTo = function(aGroupKey, oData) {
    if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
        throw new Error("The group 'key' is undefined!");
    }

  if (this.getItemIndexFor(aGroupKey, oData["key"]) !== -1) {
    throw new Error("Item already exist with '" + oData["key"] + "' key!");
  }

  var nIndex = this.getGroupIndexFor(aGroupKey);
  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  var oGroup = oGroups[nIndex];
  oGroup["items"].push(oData);
  oGroups[nIndex] = oGroup;
   this.getModel(this._sModelName).setProperty("/items", oGroups);
};

sap.ca.ui.charts.ClusterList.prototype.removeItemFrom = function(aGroupKey, sItemKey) {
    if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
        throw new Error("The group 'key' is undefined!");
    }

  if (typeof sItemKey === "undefined") {
    throw new Error("The item 'key' is undefined!");
  }

  var nGroupIndex = this.getGroupIndexFor(aGroupKey);
  if (nGroupIndex === -1) {
    throw new Error("Group does not exist for '" + aGroupKey.toString() + "' key!");
  }

  var nItemIndex = this.getItemIndexFor(aGroupKey, sItemKey);
  if (nItemIndex === -1) {
    throw new Error("Item does not exist for '" + sItemKey + "' key!");
  }

  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  var oGroup = oGroups[nGroupIndex];
  var oItems = oGroup["items"];
  oItems.splice(nItemIndex, 1);
  oGroup["items"] = oItems;
  oGroups[nGroupIndex] = oGroup;
   this.getModel(this._sModelName).setProperty("/items", oGroups);
   this.getModel(this._sModelName).updateBindings(true);
};

sap.ca.ui.charts.ClusterList.prototype.getNumberOfItemsFor = function(aGroupKey) {
  if (typeof aGroupKey === "undefined" || !Array.isArray(aGroupKey) || aGroupKey.length === 0) {
    throw new Error("The group 'key' is undefined!");
  }

  var nGroupIndex = this.getGroupIndexFor(aGroupKey);
  if (nGroupIndex === -1) {
    throw new Error("Group does not exist for '" + aGroupKey.toString() + "' key!");
  }

  var oGroups =  this.getModel(this._sModelName).getProperty("/items");
  var oGroup = oGroups[nGroupIndex];
  var oItems = oGroup["items"];
  return oItems.length;
};
}; // end of sap/ca/ui/charts/ClusterList.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.AmountFormat') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.AmountFormat
jQuery.sap.declare("sap.ca.ui.model.format.AmountFormat");

jQuery.sap.require('sap.ui.core.LocaleData'); // unlisted dependency retained





/**
 * Constructor for AmountFormat - must not be used: To get a AmountFormat instance, please use getInstance.
 *
 * @class
 * The AmountFormat is a static class for formatting and parsing file size values according
 * to a set of format options.
 *
 * If no pattern is specified a default pattern according to the locale settings is used.
 *
 * @public
 */
sap.ca.ui.model.format.AmountFormat = function() {
    // Do not use the constructor
    throw new Error();
};

sap.ca.ui.model.format.AmountFormat.oValueInfo = {
    oDefaultFormatOptions: {
        style: "standard",
        decimals: 2
    }
};

/*
JSON Model containing ISO standard definition of number of decimals to use per currency.
As this is the ISO standard definition, it is shared between all apps.
It will be loaded with  model/currency.json file the first time it's requested.
 */
sap.ca.ui.model.format.AmountFormat.oCurrencyModel = null;


/**
 * Get a instance of the AmountFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {string} [oFormatOptions.style] either empty or 'standard or 'short'. If no pattern is given, a locale dependent default pattern of that style is used from the LocaleData class.
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.AmountFormat} instance of the AmountFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.AmountFormat.getInstance = function(currencyCode, oFormatOptions, oLocale) {
    return this.createInstance(currencyCode, oFormatOptions, oLocale, this.oValueInfo);
};


/**
 * Create instance of the AmountFormat.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ui.core.format.AmountFormat} time instance of the AmountFormat
 * @static
 * @private
 */
sap.ca.ui.model.format.AmountFormat.createInstance = function(currencyCode, oFormatOptions, oLocale, oInfo) {
    // Create an instance of the AmountFormat
    var oFormat = jQuery.sap.newObject(this.prototype);

    // Handle optional parameters
    if ( oFormatOptions instanceof sap.ui.core.Locale ) {
        oLocale = oFormatOptions;
        oFormatOptions = undefined;
    }

    // Get Locale and LocaleData to use
    if (!oLocale) {
        oFormat.oLocale = sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();
    }
    else{
        oFormat.oLocale = new sap.ui.core.Locale(oLocale);
    }
    oFormat.oLocaleData = sap.ui.core.LocaleData.getInstance(oFormat.oLocale);

    // Extend the default format options with custom format options
    oFormat.oFormatOptions = jQuery.extend(false, {}, oInfo.oDefaultFormatOptions, oFormatOptions);

    oFormat.init(currencyCode, oFormatOptions);

    return oFormat;
};

/**
 * Initialize currency format
 */
sap.ca.ui.model.format.AmountFormat.prototype.init = function(currencyCode, oFormatOptions) {
    // Rules Decimals "Precedence": if decimals are options defined it should override default and currency (defined)
    if(oFormatOptions){
        if(oFormatOptions.decimals != undefined){
            return;
        }
    }
    if(currencyCode){
        //load model with currency formatting exceptions
        if (!sap.ca.ui.model.format.AmountFormat.oCurrencyModel){
            sap.ca.ui.model.format.AmountFormat.oCurrencyModel = new sap.ui.model.json.JSONModel();
            var path = jQuery.sap.getModulePath("sap.ca.ui");
            sap.ca.ui.model.format.AmountFormat.oCurrencyModel.loadData(path + "/model/currency.json", "", false);
        }

        var data = sap.ca.ui.model.format.AmountFormat.oCurrencyModel.getData();
        for (var i = 0; i < data.length; i++) {
            if (data[i].Name === currencyCode) {
                this.oFormatOptions.decimals = data[i].Decimals;
                break;
            }
        }
    }
};


/**
 * Format a date according to the given format options.
 *
 * @param {Currency} oValue the value to format
 * @return {string} the formatted output value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.prototype.format = function(oValue) {
    var formatter = sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale);
    return formatter.format(oValue);
};

/**
 * Parse a string which is formatted according to the given format options.
 *
 * @param {string} sValue the string containing a formatted value
 * @return {number} the parsed value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.prototype.parse = function(sValue) {
    var formatter = sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale);
    return formatter.parse(sValue);
};

/**
 * Convenience static function
 * Format an amount in short Style.
 * Number of decimals will be set :
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given currency
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} currencyCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.FormatAmountShort = function(oValue, currencyCode, decimals) {
    return sap.ca.ui.model.format.AmountFormat.getInstance(currencyCode,{style:"short", decimals:decimals}).format(oValue);
};


/**
 * Convenience static function
 * Format an amount in standard Style.
 * Number of decimals will be set:
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given currency
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} currencyCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.FormatAmountStandard = function(oValue, currencyCode, decimals) {
    return sap.ca.ui.model.format.AmountFormat.getInstance(currencyCode,{style:"standard", decimals:decimals}).format(oValue);
};


/**
 * Format a amount with the currency code according to the cldr currency format.
 *
 * @param {sValue} the string containing a formatted value
 * @param {sCurrencyCode} the string containing a currency code
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.prototype.formatWithCurrency = function(sValue, sCurrencyCode) {
    var result;
    // First of all, we format the value itself
    var formattedValue = this.format(sValue);
    // We fetch the cldr currency format associated with the locale
    var currencyCldrFormats = sap.ui.core.LocaleData.getInstance(this.oLocale)._get("currencyFormat");
    if (!currencyCldrFormats){
        // The fallback cldr currency format is the one associated with "en" locale
        var sdLocale = new sap.ui.core.Locale("en");
        currencyCldrFormats = sap.ui.core.LocaleData.getInstance(sdLocale)._get("currencyFormat");
    }

    var standard = currencyCldrFormats["standard"];
    if (standard === undefined || standard == "") {
        result = formattedValue;
        jQuery.sap.log.error("no currency format available for the current locale");
    }
    else {
        // In addition to a standard currency format,
        // in which negative currency amounts might typically be displayed as something like -$3.27,
        // locales may provide an "accounting" form,
        // in which for "en_US" the same example would appear as ($3.27).
        // Example of a typical cldr currency format
        //                                   positive   negative
        //                                   |-------| |--------|
        // "currencyFormat" : {"standard" : "#,##0.00;-#,##0.00" }
        var separationIndex = standard.indexOf(";");
        var tmp = "";
        var valuePattern = /[\.0,#]+/;
        var positiveFormat;
        if(separationIndex != -1) {
            // We only handle positive pattern at the moment.
            // Therefore, only the standard positive part is used.
             positiveFormat = standard.substring(0, separationIndex);
        }
        else {
            // There is not special accounting formatting for negative values
            positiveFormat = standard;
        }
        //replace the number pattern witth the formatted value
        tmp = positiveFormat.replace(valuePattern, formattedValue);

        //As we are using currency codes and not currency symbols, we must add white space
        //between currency and number when the format doesn't already contain one
        //General currency sign in format is: \u00A4
        var spaceNeededBefore= /[\.0,#]+\u00A4/;
        if (positiveFormat.match(spaceNeededBefore)) {
            sCurrencyCode = " "+sCurrencyCode;
        }
        var spaceNeededAfter=  /\u00A4[\.0,#]+/;
        if (positiveFormat.match(spaceNeededAfter)) {
            sCurrencyCode = sCurrencyCode + " ";
        }

        result = tmp.replace(/\u00A4/, sCurrencyCode);
    }
    return result;
};

/**
 * Convenience static function
 * Format an amount in short Style with the currency code according to the cldr currency format.
 * Number of decimals will be set :
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given currency
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} sCurrencyCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.FormatAmountShortWithCurrency = function(sValue, sCurrencyCode, decimals) {
    return sap.ca.ui.model.format.AmountFormat.getInstance(sCurrencyCode,{style:"short", decimals:decimals}).formatWithCurrency(sValue, sCurrencyCode);
};


/**
 * Convenience static function
 * Format an amount in standard Style with the currency code according to the cldr currency format.
 * Number of decimals will be set:
 *          Using Decimals if specified
 *          else using the standard number of decimal for the given currency
 *
 * @param {string} sValue the string containing a formatted value
 * @param {string} sCurrencyCode
 * @param {string} decimals
 * @return {string} the formatted value
 * @public
 */
sap.ca.ui.model.format.AmountFormat.FormatAmountStandardWithCurrency = function(sValue, sCurrencyCode, decimals) {
    return sap.ca.ui.model.format.AmountFormat.getInstance(sCurrencyCode,{style:"standard", decimals:decimals}).formatWithCurrency(sValue, sCurrencyCode);
};
}; // end of sap/ca/ui/model/format/AmountFormat.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.format.FileSizeFormat') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

// Provides class sap.ca.ui.model.format.FileSizeFormat
jQuery.sap.declare("sap.ca.ui.model.format.FileSizeFormat");

jQuery.sap.require('sap.ui.core.LocaleData'); // unlisted dependency retained





/**
 * Constructor for FileSizeFormat - must not be used: To get a FileSizeFormat instance, please use getInstance.
 *
 * @class
 * The FileSizeFormat is a static class for formatting and parsing file size values according
 * to a set of format options.
 *
 * Simplified logic:
 *  display in kB for 1e3 <= bytes < 1e6
 *  display in MB for 1e6 <= bytes < 1e9
 *  ...
 *
 *
 * @public
 */
sap.ca.ui.model.format.FileSizeFormat = function() {
    // Do not use the constructor
    throw new Error();
};


sap.ca.ui.model.format.FileSizeFormat.oValueInfo = {
    oDefaultFormatOptions: {
        style: "short",
        shortDecimals: function (value) { return (Math.abs(value) < 10 ? 1 : 0) }
    }
};


/**
 * Get a instance of the FileSizeFormat, which can be used for formatting.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {number} [oFormatOptions.shortDecimals] number of decimals to use.
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.FileSizeFormat} instance of the FileSizeFormat
 * @static
 * @public
 */
sap.ca.ui.model.format.FileSizeFormat.getInstance = function(oFormatOptions, oLocale) {
    return this.createInstance(oFormatOptions, oLocale, this.oValueInfo);
};


/**
 * Create instance of the FileSizeFormat.
 *
 * @param {object} [oFormatOptions] Object which defines the format options
 * @param {sap.ui.core.Locale} [oLocale] Locale to ask for locale specific texts/settings
 * @return {sap.ca.ui.model.format.FileSizeFormat} instance of the FileSizeFormat
 * @static
 * @private
 */
sap.ca.ui.model.format.FileSizeFormat.createInstance = function(oFormatOptions, oLocale, oInfo) {
    // Create an instance of the FileSizeFormat
    var oFormat = jQuery.sap.newObject(this.prototype);

    // Handle optional parameters
    if ( oFormatOptions instanceof sap.ui.core.Locale ) {
        oLocale = oFormatOptions;
        oFormatOptions = undefined;
    }

    // Get Locale and LocaleData to use
    if (!oLocale) {
        oLocale = sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();
    }
    oFormat.oLocale = oLocale;
    oFormat.oLocaleData = sap.ui.core.LocaleData.getInstance(oLocale);

    // Extend the default format options with custom format options
    oFormat.oFormatOptions = jQuery.extend(false, {}, oInfo.oDefaultFormatOptions, oFormatOptions);

    oFormat.init();
    return oFormat;
};

/**
 * Initialize format
 */
sap.ca.ui.model.format.FileSizeFormat.prototype.init = function() {
};


/**
 * Format according to the given format options.
 *
 * @param {FileSize} oValue the value to format
 * @return {string} the formatted output value
 * @public
 */
sap.ca.ui.model.format.FileSizeFormat.prototype.format = function(oValue) {

    // Simplified logic:
    //  display in kB for 1e3 <= bytes < 1e6
    //  display in MB for 1e6 <= bytes < 1e9
    //  ...
    var numBytes = sap.ca.ui.model.format.FormatHelper.toNumeric(oValue);
    if (!isFinite(numBytes)) {
        return "";
    }
    var formatOptions = sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions);
    var result = "";
    if (isFinite(numBytes)) {
        numBytes = numBytes.toFixed(0); // support only integer number of bytes
        var mag = sap.ca.ui.model.format.FormatHelper.getMagnitude(numBytes);
        if (mag.value == 1) {
            if (Math.abs(numBytes) < 2) {
                // non-breaking space
                result = numBytes + "\u00A0" +  sap.ca.ui.utils.resourcebundle.getText("FileSize.Byte");
            }
            else {
                result = numBytes + "\u00A0" +  sap.ca.ui.utils.resourcebundle.getText("FileSize.Bytes");
            }
        }
        else {
            formatOptions.formatStyle = "short";
            var roundedValue = sap.ca.ui.model.format.FormatHelper.roundNumber(numBytes / mag.value, formatOptions);
            if ((mag.value < 1e24) && (Math.abs(roundedValue) >= 1000)) {
                // Rounding may induce a change of scale.
                mag = sap.ca.ui.model.format.FormatHelper.getMagnitude(roundedValue * mag.value);
                roundedValue = sap.ca.ui.model.format.FormatHelper.roundNumber(numBytes / mag.value, formatOptions);
            }
            result = sap.ca.ui.model.format.FormatHelper.formatNumber(roundedValue, formatOptions);
            result += "\u00A0" +  sap.ca.ui.utils.resourcebundle.getText("FileSize." + mag.suffix + "bytes");
        }
    }
    return result
};


/**
 * Parse a string which is formatted according to the given format options.
 *
 * @param {string} sValue the string containing a formatted value
 * @return {number} the parsed value
 * @public
 */
sap.ca.ui.model.format.FileSizeFormat.prototype.parse = function(sValue) {
    var formatter = sap.ca.ui.model.format.NumberFormat.getInstance(this.oFormatOptions, this.oLocale);
    return formatter.parse(sValue);
};
}; // end of sap/ca/ui/model/format/FileSizeFormat.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.model.type.FileSize') ) {
/*!
 * (c) Copyright 2009-2013 SAP AG. All rights reserved
 */

jQuery.sap.declare("sap.ca.ui.model.type.FileSize");

jQuery.sap.require('sap.ui.model.SimpleType'); // unlisted dependency retained




/**
 * Constructor for a FileSize type.
 *
 * @class
 * This class represents file size types.
 *
 * @extends sap.ui.model.SimpleType
 *
 * @author SAP AG
 *
 * @constructor
 * @public
 * @param {object} [oFormatOptions] formatting options. Supports the same options as {@link sap.ui.core.format.NumberFormat.getFloatInstance NumberFormat.getFloatInstance}
 * @param {object} [oConstraint]s value constraints.
 * @param {float} [oConstraints.minimum] smallest value allowed for this type
 * @param {float} [oConstraints.maximum] largest value allowed for this type
 * @name sap.ca.ui.model.type.FileSize
 */
sap.ui.model.SimpleType.extend("sap.ca.ui.model.type.FileSize", /** @lends sap.ca.ui.model.type.FileSize */ {

    constructor : function () {
        sap.ui.model.SimpleType.apply(this, arguments);
        this.sName = "FileSize";
    }

});

/**
 * Creates a new subclass of class sap.ca.ui.model.type.FileSize with name <code>sClassName</code>
 * and enriches it with the information contained in <code>oClassInfo</code>.
 *
 * For a detailed description of <code>oClassInfo</code> or <code>FNMetaImpl</code>
 * see {@link sap.ui.base.Object.extend Object.extend}.
 *
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class
 * @param {function} [FNMetaImpl] alternative constructor for a metadata object
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.model.type.FileSize.extend
 * @function
 */

/**
 * @see sap.ui.model.SimpleType.prototype.formatValue
 */
sap.ca.ui.model.type.FileSize.prototype.formatValue = function(fValue, sInternalType) {
    if (fValue == undefined || fValue == null) {
        return null;
    }
    switch(sInternalType) {
        case "string":
            return this.oFormat.format(fValue);
        case "int":
            return Math.floor(fValue);
        case "float":
            return fValue;
        default:
            throw new sap.ui.model.FormatException("Don't know how to format FileSize to " + sInternalType);
    }
};

/**
 * @see sap.ui.model.SimpleType.prototype.parseValue
 */
sap.ca.ui.model.type.FileSize.prototype.parseValue = function(oValue, sInternalType) {
    var iResult;
    switch(sInternalType) {
        case "string":
            iResult = this.oFormat.parse(oValue);
            if (isNaN(iResult)) {
                throw new sap.ui.model.ParseException(oValue + " is not a valid FileSize value");
            }
            return iResult;
        case "int":
        case "float":
            return oValue;
        default:
            throw new sap.ui.model.ParseException("Don't know how to parse FileSize from " + sInternalType);
    }
};

/**
 * @see sap.ui.model.SimpleType.prototype.validateValue
 */
sap.ca.ui.model.type.FileSize.prototype.validateValue = function(iValue) {
    if (this.oConstraints) {
        var aViolatedConstraints = [];
        jQuery.each(this.oConstraints, function(sName, oContent) {
            switch (sName) {
                case "minimum":
                    if (iValue < oContent) {
                        aViolatedConstraints.push("minimum");
                    }
                    break;
                case "maximum":
                    if (iValue > oContent) {
                        aViolatedConstraints.push("maximum");
                    }
            }
        });
        if (aViolatedConstraints.length > 0) {
            throw new sap.ui.model.ValidateException("Validation of type constraints failed", aViolatedConstraints);
        }
    }
};


/**
 * @see sap.ui.model.SimpleType.prototype.setFormatOptions
 */
sap.ca.ui.model.type.FileSize.prototype.setFormatOptions = function(oFormatOptions) {
    this.oFormatOptions = oFormatOptions;
    this._handleLocalizationChange();
};

/**
 * Called by the framework when any localization setting changed
 * @private
 */
sap.ca.ui.model.type.FileSize.prototype._handleLocalizationChange = function() {
    this.oFormat = sap.ca.ui.model.format.FileSizeFormat.getInstance(this.oFormatOptions);
};

}; // end of sap/ca/ui/model/type/FileSize.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.quickoverview.CompanyLaunch') ) {
jQuery.sap.declare("sap.ca.ui.quickoverview.CompanyLaunch");
jQuery.sap.require('sap.ui.base.Object'); // unlisted dependency retained



sap.ui.base.Object
		.extend(
				"sap.ca.ui.quickoverview.CompanyLaunch",
				{

					// Public interface: constructor
					constructor : function(oConfig) {
						// create an explicit model - merge information from the
						// application in case an application model is provided

						var utils = sap.ca.ui.quickoverview.QuickviewUtils;

						//handle image
						var sImgUrl = oConfig.imgurl;
						if ( !sImgUrl )
							{
							 sImgUrl = "sap-icon://account";
							}							
						
						var oCompData = {
							imgurl : sImgUrl,								
							companyname : utils.getAttrValue(oConfig.companyname,
									oConfig.oModel),
							companyphone : utils.getAttrValue(
									oConfig.companyphone, oConfig.oModel),	
							companyaddress : utils.getAttrValue(
									oConfig.companyaddress, oConfig.oModel),
							maincontactname : utils.getAttrValue(oConfig.maincontactname,
									oConfig.oModel),
							maincontactmobile : utils.getAttrValue(
									oConfig.maincontactmobile, oConfig.oModel),
							maincontactphone : utils.getAttrValue(oConfig.maincontactphone,
									oConfig.oModel),
							maincontactemail : utils.getAttrValue(oConfig.maincontactemail,
									oConfig.oModel),
							maincontactemailsubj : utils.getAttrValue(oConfig.maincontactemailsubj,
									oConfig.oModel),

						};

						var oCompModel = new sap.ui.model.json.JSONModel(
								oCompData);

						var oQVConfig = {
							popoverHeight : "34rem",
							title : utils.getAttrValue(oConfig.title,
										oConfig.oModel),
							headerTitle : utils.getAttrValue(oConfig.companyname,
									oConfig.oModel),
							headerSubTitle : utils.getAttrValue(
									oConfig.maincontactname, oConfig.oModel),
							headerImgURL : sImgUrl,
							subViewName : "sap.ca.ui.quickoverview.Company",
							oModel : oCompModel,
							beforeExtNav : oConfig.beforeExtNav,							
						};

						this.oQuickView = new sap.ca.ui.quickoverview.Quickoverview(
								oQVConfig);

					},

					// Public interface: openBy
					openBy : function(oSourceControl, sPlacement) {

						this.oQuickView.openBy(oSourceControl);

						return;
					},
					
				});
}; // end of sap/ca/ui/quickoverview/CompanyLaunch.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.quickoverview.Employee.controller') ) {
  jQuery.sap.declare('sap.ca.ui.quickoverview.Employee.controller');


sap.ui.controller("sap.ca.ui.quickoverview.Employee", {
	
	onTapSMS: function(oEvent) {
		sap.m.URLHelper.triggerSms(this.byId("qvContactMobile").getText());
	},

	onTapPhone: function(oEvent) {
		sap.m.URLHelper.triggerTel(oEvent.getSource().getText());
		
	},

	onTapEmail: function(oEvent) {
		//
		var sSubject = "";
		var oModel = this.getView().getModel();
		if (oModel && oModel.getData()) { 
			sSubject = (oModel.getData().contactemailsubj) ? oModel.getData().contactemailsubj : "";
		}
		sap.m.URLHelper.triggerEmail(oEvent.getSource().getText(), sSubject);
	},
	
	//trigger navigation to company
	onCompanyPress: function(oEvent) {

		var oCompData = this.getView().getModel().getData().companycard;
		if(!oCompData){	return;	}
		
		var oCompModel = new sap.ui.model.json.JSONModel(oCompData);

		var oQVConfig = {
				popoverHeight : "34rem",
				title : oCompData.title,
				headerTitle : oCompData.companyname,
				headerSubTitle : oCompData.maincontactname,
				headerImgURL : oCompData.imgurl,
				subViewName : "sap.ca.ui.quickoverview.Company",
				oModel : oCompModel,
				beforeExtNav : oCompData.beforeExtNav 
			};

		this.QuickViewHandler.navigateTo(oQVConfig);
	},
	
	onBeforeRendering : function () {
		
		var oCompLink = this.byId("qvCompLink");
		var oCompData = this.getView().getModel().getData().companycard;
		var bCompData = (oCompData) ? true : false;
		oCompLink.setEnabled(bCompData);
		
		var oContactSMS = this.byId("qvContactSMS");
		if (oContactSMS)
			{
				oContactSMS.setVisible(this.byId("qvContactMobile").getText() !== "");
			}
		
		
	}

});
}; // end of sap/ca/ui/quickoverview/Employee.controller.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.quickoverview.EmployeeLaunch') ) {
jQuery.sap.declare("sap.ca.ui.quickoverview.EmployeeLaunch");
jQuery.sap.require('sap.ui.base.Object'); // unlisted dependency retained



sap.ui.base.Object
		.extend(
				"sap.ca.ui.quickoverview.EmployeeLaunch",
				{

					// Public interface: constructor
					constructor : function(oConfig) {
						// create an explicit model - merge information from the
						// application in
						// case an application model is provided

						var utils = sap.ca.ui.quickoverview.QuickviewUtils;

						//handle employee image
						var sImgUrl = oConfig.imgurl;
						if ( !sImgUrl )
							{
							 sImgUrl = "sap-icon://person-placeholder";
							}	
						
						var oEmpData = {
							imgurl : sImgUrl,
							department : utils.getAttrValue(oConfig.department,
									oConfig.oModel),
							contactmobile : utils.getAttrValue(
									oConfig.contactmobile, oConfig.oModel),
							contactphone : utils.getAttrValue(oConfig.contactphone,
									oConfig.oModel),
							companyname : utils.getAttrValue(
									oConfig.companyname, oConfig.oModel),
							contactemail : utils.getAttrValue(oConfig.contactemail,
									oConfig.oModel),
							contactemailsubj : utils.getAttrValue(oConfig.contactemailsubj,
									oConfig.oModel),
							companyaddress : utils.getAttrValue(
									oConfig.companyaddress, oConfig.oModel),
						};
						

						
						if (oConfig.companycard) {
							//handle image
							var sCompImgUrl = oConfig.companycard.imgurl;
							if ( !sCompImgUrl )
								{
								 sCompImgUrl = "sap-icon://account";
								 
								}							
							var oCompData = 
							{
									title  : utils.getAttrValue(oConfig.companycard.title, oConfig.oModel),
									beforeExtNav : oConfig.companycard.beforeExtNav,
									imgurl : sCompImgUrl,								
									companyname : utils.getAttrValue(oConfig.companyname, oConfig.oModel),
									companyphone : utils.getAttrValue(
											oConfig.companycard.companyphone, oConfig.oModel),	
									companyaddress : utils.getAttrValue(
											oConfig.companyaddress, oConfig.oModel),
									maincontactname : utils.getAttrValue(oConfig.companycard.maincontactname,
											oConfig.oModel),
									maincontactmobile : utils.getAttrValue(
											oConfig.companycard.maincontactmobile, oConfig.oModel),
									maincontactphone : utils.getAttrValue(oConfig.companycard.maincontactphone,
											oConfig.oModel),
									maincontactemail : utils.getAttrValue(oConfig.companycard.maincontactemail,
											oConfig.oModel),
									maincontactemailsubj : utils.getAttrValue(oConfig.companycard.maincontactemailsubj,
											oConfig.oModel),
									}
							
							oEmpData.companycard = oCompData;
						}

						var oEmpModel = new sap.ui.model.json.JSONModel(
								oEmpData);
						
						var oQVConfig = {
							popoverHeight : "32rem",
							title : utils.getAttrValue(oConfig.title,
									oConfig.oModel),
							headerTitle : utils.getAttrValue(oConfig.name,
									oConfig.oModel),
							headerSubTitle : utils.getAttrValue(
									oConfig.department, oConfig.oModel),
							headerImgURL : sImgUrl,
							subViewName : "sap.ca.ui.quickoverview.Employee",
							oModel : oEmpModel,
							beforeExtNav : oConfig.beforeExtNav,
						};

						this.oQuickView = new sap.ca.ui.quickoverview.Quickoverview(
								oQVConfig);

					},

					// Public interface: openBy
					openBy : function(oSourceControl, sPlacement) {

						this.oQuickView.openBy(oSourceControl);
						return;
					}
				});
}; // end of sap/ca/ui/quickoverview/EmployeeLaunch.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.FileUpload') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.FileUpload.
jQuery.sap.declare("sap.ca.ui.FileUpload");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new FileUpload.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getUploadUrl uploadUrl} : string</li>
 * <li>{@link #getFileName fileName} : string</li>
 * <li>{@link #getSize size} : string</li>
 * <li>{@link #getUrl url} : string</li>
 * <li>{@link #getUploadedDate uploadedDate} : string</li>
 * <li>{@link #getContributor contributor} : string</li>
 * <li>{@link #getFileExtension fileExtension} : string</li>
 * <li>{@link #getMimeType mimeType} : string</li>
 * <li>{@link #getItems items} : string</li>
 * <li>{@link #getUploadEnabled uploadEnabled} : boolean</li>
 * <li>{@link #getEditMode editMode} : boolean (default: false)</li>
 * <li>{@link #getFileId fileId} : string</li>
 * <li>{@link #getXsrfToken xsrfToken} : string</li>
 * <li>{@link #getUseMultipart useMultipart} : boolean (default: false)</li>
 * <li>{@link #getAcceptRequestHeader acceptRequestHeader} : string (default: 'application/json')</li>
 * <li>{@link #getEncodeUrl encodeUrl} : string</li>
 * <li>{@link #getRenameEnabled renameEnabled} : boolean</li>
 * <li>{@link #getShowNoData showNoData} : boolean (default: false)</li>
 * <li>{@link #getShowAttachmentsLabelInEditMode showAttachmentsLabelInEditMode} : boolean (default: true)</li>
 * <li>{@link #getUseEditControls useEditControls} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getUploadProgressLabel uploadProgressLabel} : sap.m.Label</li>
 * <li>{@link #getAttachmentNumberLabel attachmentNumberLabel} : sap.m.Label</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.FileUpload#event:deleteFile deleteFile} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:renameFile renameFile} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:uploadFile uploadFile} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:fileUploadFailed fileUploadFailed} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:beforeUploadFile beforeUploadFile} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:saveClicked saveClicked} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.FileUpload#event:cancelClicked cancelClicked} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Allows you to display a list of uploaded files. You can also upload a new one, edit or delete them
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.FileUpload
 */
sap.ui.core.Control.extend("sap.ca.ui.FileUpload", { metadata : {

	// ---- object ----
	publicMethods : [
		// methods
		"removeFile", "abandonPendingRenames", "commitPendingRenames", "commitFileUpload", "setCustomHeader", "removeCustomHeader", "preventEdits"
	],

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"uploadUrl" : {type : "string", group : "Misc", defaultValue : null},
		"fileName" : {type : "string", group : "Misc", defaultValue : null},
		"size" : {type : "string", group : "Misc", defaultValue : null},
		"url" : {type : "string", group : "Misc", defaultValue : null},
		"uploadedDate" : {type : "string", group : "Misc", defaultValue : null},
		"contributor" : {type : "string", group : "Misc", defaultValue : null},
		"fileExtension" : {type : "string", group : "Misc", defaultValue : null},
		"mimeType" : {type : "string", group : "Misc", defaultValue : null},
		"items" : {type : "string", group : "Misc", defaultValue : null},
		"uploadEnabled" : {type : "boolean", group : "Misc", defaultValue : null},
		"editMode" : {type : "boolean", group : "Misc", defaultValue : false},
		"fileId" : {type : "string", group : "Misc", defaultValue : null},
		"xsrfToken" : {type : "string", group : "Misc", defaultValue : null},
		"useMultipart" : {type : "boolean", group : "Misc", defaultValue : false},
		"acceptRequestHeader" : {type : "string", group : "Misc", defaultValue : 'application/json'},
		"encodeUrl" : {type : "string", group : "Misc", defaultValue : null},
		"renameEnabled" : {type : "boolean", group : "Misc", defaultValue : null},
		"showNoData" : {type : "boolean", group : "Misc", defaultValue : false},
		"showAttachmentsLabelInEditMode" : {type : "boolean", group : "Misc", defaultValue : true},
		"useEditControls" : {type : "boolean", group : "Misc", defaultValue : false}
	},
	aggregations : {
    	"fileList" : {type : "sap.m.List", multiple : false, visibility : "hidden"}, 
    	"oProgressText" : {type : "sap.m.Text", multiple : false, visibility : "hidden"}, 
    	"uploadProgressLabel" : {type : "sap.m.Label", multiple : false}, 
    	"attachmentNumberLabel" : {type : "sap.m.Label", multiple : false}, 
    	"toolBar" : {type : "sap.m.Toolbar", multiple : false, visibility : "hidden"}
	},
	events : {
		"deleteFile" : {}, 
		"renameFile" : {}, 
		"uploadFile" : {}, 
		"fileUploadFailed" : {}, 
		"beforeUploadFile" : {}, 
		"saveClicked" : {}, 
		"cancelClicked" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.FileUpload with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.FileUpload.extend
 * @function
 */

sap.ca.ui.FileUpload.M_EVENTS = {'deleteFile':'deleteFile','renameFile':'renameFile','uploadFile':'uploadFile','fileUploadFailed':'fileUploadFailed','beforeUploadFile':'beforeUploadFile','saveClicked':'saveClicked','cancelClicked':'cancelClicked'};


/**
 * Getter for property <code>uploadUrl</code>.
 * Url of server we wish to upload to
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>uploadUrl</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUploadUrl
 * @function
 */

/**
 * Setter for property <code>uploadUrl</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sUploadUrl  new value for property <code>uploadUrl</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUploadUrl
 * @function
 */


/**
 * Getter for property <code>fileName</code>.
 * Relative path in model, pointing to property that stores the name of a file.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>fileName</code>
 * @public
 * @name sap.ca.ui.FileUpload#getFileName
 * @function
 */

/**
 * Setter for property <code>fileName</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFileName  new value for property <code>fileName</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setFileName
 * @function
 */


/**
 * Getter for property <code>size</code>.
 * Relative path in model, pointing to property that stores the size of a file.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>size</code>
 * @public
 * @name sap.ca.ui.FileUpload#getSize
 * @function
 */

/**
 * Setter for property <code>size</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sSize  new value for property <code>size</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setSize
 * @function
 */


/**
 * Getter for property <code>url</code>.
 * Relative path in model, pointing to property that stores the url at which the file is stored.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>url</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUrl
 * @function
 */

/**
 * Setter for property <code>url</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sUrl  new value for property <code>url</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUrl
 * @function
 */


/**
 * Getter for property <code>uploadedDate</code>.
 * Relative path in model, pointing to property that stores the date at which a file was uploaded.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>uploadedDate</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUploadedDate
 * @function
 */

/**
 * Setter for property <code>uploadedDate</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sUploadedDate  new value for property <code>uploadedDate</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUploadedDate
 * @function
 */


/**
 * Getter for property <code>contributor</code>.
 * Relative path in model, pointing to property that stores the name of the person who uploaded the file.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>contributor</code>
 * @public
 * @name sap.ca.ui.FileUpload#getContributor
 * @function
 */

/**
 * Setter for property <code>contributor</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sContributor  new value for property <code>contributor</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setContributor
 * @function
 */


/**
 * Getter for property <code>fileExtension</code>.
 * Relative path in model, pointing to property that stores the uploaded files extension. Note: either fileExtension or mimeType may be used, but mimeType is preferable.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>fileExtension</code>
 * @public
 * @name sap.ca.ui.FileUpload#getFileExtension
 * @function
 */

/**
 * Setter for property <code>fileExtension</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFileExtension  new value for property <code>fileExtension</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setFileExtension
 * @function
 */


/**
 * Getter for property <code>mimeType</code>.
 * Relative path in model, pointing to property that stores the file's mimeType. Note: either fileExtension or mimeType may be used, but mimeType is preferable.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>mimeType</code>
 * @public
 * @name sap.ca.ui.FileUpload#getMimeType
 * @function
 */

/**
 * Setter for property <code>mimeType</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sMimeType  new value for property <code>mimeType</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setMimeType
 * @function
 */


/**
 * Getter for property <code>items</code>.
 * The base path in the model for the control. Avoid trailing forward slashes in value, as per default value.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>items</code>
 * @public
 * @name sap.ca.ui.FileUpload#getItems
 * @function
 */

/**
 * Setter for property <code>items</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sItems  new value for property <code>items</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setItems
 * @function
 */


/**
 * Getter for property <code>uploadEnabled</code>.
 * This property enables & disables the ability to upload a file
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {boolean} the value of property <code>uploadEnabled</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUploadEnabled
 * @function
 */

/**
 * Setter for property <code>uploadEnabled</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {boolean} bUploadEnabled  new value for property <code>uploadEnabled</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUploadEnabled
 * @function
 */


/**
 * Getter for property <code>editMode</code>.
 * Property to allow toggling between edit and view screens.
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>editMode</code>
 * @public
 * @name sap.ca.ui.FileUpload#getEditMode
 * @function
 */

/**
 * Setter for property <code>editMode</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bEditMode  new value for property <code>editMode</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setEditMode
 * @function
 */


/**
 * Getter for property <code>fileId</code>.
 * An identifier property name that is used to uniquely reference the file on the server.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>fileId</code>
 * @public
 * @name sap.ca.ui.FileUpload#getFileId
 * @function
 */

/**
 * Setter for property <code>fileId</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sFileId  new value for property <code>fileId</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setFileId
 * @function
 */


/**
 * Getter for property <code>xsrfToken</code>.
 * The XSRF token the control should use when making the upload request. If it is not set, the control will not use a security token.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>xsrfToken</code>
 * @public
 * @name sap.ca.ui.FileUpload#getXsrfToken
 * @function
 */

/**
 * Setter for property <code>xsrfToken</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sXsrfToken  new value for property <code>xsrfToken</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setXsrfToken
 * @function
 */


/**
 * Getter for property <code>useMultipart</code>.
 * Indicates if the control should send multipart/form data request when uploading
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>useMultipart</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUseMultipart
 * @function
 */

/**
 * Setter for property <code>useMultipart</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bUseMultipart  new value for property <code>useMultipart</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUseMultipart
 * @function
 */


/**
 * Getter for property <code>acceptRequestHeader</code>.
 * The Accept request header the control should use when sending the upload request
 *
 * Default value is <code>application/json</code>
 *
 * @return {string} the value of property <code>acceptRequestHeader</code>
 * @public
 * @name sap.ca.ui.FileUpload#getAcceptRequestHeader
 * @function
 */

/**
 * Setter for property <code>acceptRequestHeader</code>.
 *
 * Default value is <code>application/json</code> 
 *
 * @param {string} sAcceptRequestHeader  new value for property <code>acceptRequestHeader</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setAcceptRequestHeader
 * @function
 */


/**
 * Getter for property <code>encodeUrl</code>.
 * Url of server that will base64 encode the file
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>encodeUrl</code>
 * @public
 * @name sap.ca.ui.FileUpload#getEncodeUrl
 * @function
 */

/**
 * Setter for property <code>encodeUrl</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sEncodeUrl  new value for property <code>encodeUrl</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setEncodeUrl
 * @function
 */


/**
 * Getter for property <code>renameEnabled</code>.
 * 
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {boolean} the value of property <code>renameEnabled</code>
 * @public
 * @name sap.ca.ui.FileUpload#getRenameEnabled
 * @function
 */

/**
 * Setter for property <code>renameEnabled</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {boolean} bRenameEnabled  new value for property <code>renameEnabled</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setRenameEnabled
 * @function
 */


/**
 * Getter for property <code>showNoData</code>.
 * Show the label "No data" when the control doesn't have files
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showNoData</code>
 * @public
 * @name sap.ca.ui.FileUpload#getShowNoData
 * @function
 */

/**
 * Setter for property <code>showNoData</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowNoData  new value for property <code>showNoData</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setShowNoData
 * @function
 */


/**
 * Getter for property <code>showAttachmentsLabelInEditMode</code>.
 * Show the Attachments label in edit mode
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showAttachmentsLabelInEditMode</code>
 * @public
 * @name sap.ca.ui.FileUpload#getShowAttachmentsLabelInEditMode
 * @function
 */

/**
 * Setter for property <code>showAttachmentsLabelInEditMode</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowAttachmentsLabelInEditMode  new value for property <code>showAttachmentsLabelInEditMode</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setShowAttachmentsLabelInEditMode
 * @function
 */


/**
 * Getter for property <code>useEditControls</code>.
 * Show the edit user controls which include the save, edit and cancel button. Previously, these buttons were controlled by the app but this approach has now been deprecated.
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>useEditControls</code>
 * @public
 * @name sap.ca.ui.FileUpload#getUseEditControls
 * @function
 */

/**
 * Setter for property <code>useEditControls</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bUseEditControls  new value for property <code>useEditControls</code>
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUseEditControls
 * @function
 */


/**
 * Getter for aggregation <code>uploadProgressLabel</code>.<br/>
 * 
 * 
 * @return {sap.m.Label}
 * @public
 * @name sap.ca.ui.FileUpload#getUploadProgressLabel
 * @function
 */


/**
 * Setter for the aggregated <code>uploadProgressLabel</code>.
 * @param oUploadProgressLabel {sap.m.Label}
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setUploadProgressLabel
 * @function
 */
	

/**
 * Destroys the uploadProgressLabel in the aggregation 
 * named <code>uploadProgressLabel</code>.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#destroyUploadProgressLabel
 * @function
 */


/**
 * Getter for aggregation <code>attachmentNumberLabel</code>.<br/>
 * 
 * 
 * @return {sap.m.Label}
 * @public
 * @name sap.ca.ui.FileUpload#getAttachmentNumberLabel
 * @function
 */


/**
 * Setter for the aggregated <code>attachmentNumberLabel</code>.
 * @param oAttachmentNumberLabel {sap.m.Label}
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#setAttachmentNumberLabel
 * @function
 */
	

/**
 * Destroys the attachmentNumberLabel in the aggregation 
 * named <code>attachmentNumberLabel</code>.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#destroyAttachmentNumberLabel
 * @function
 */


/**
 * Fired when a file deletion event occurs typically by clicking a the delete icon. The file descriptor json for the file to be deleted is passed in the event data 
 *
 * @name sap.ca.ui.FileUpload#deleteFile
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'deleteFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when a file deletion event occurs typically by clicking a the delete icon. The file descriptor json for the file to be deleted is passed in the event data 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachDeleteFile
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'deleteFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachDeleteFile
 * @function
 */

/**
 * Fire event deleteFile to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireDeleteFile
 * @function
 */


/**
 * Fired when a file is renamed. The file descripter json for the file to be renamed is passed in the event data and also a property, newFilename, that contains the new filename. 
 *
 * @name sap.ca.ui.FileUpload#renameFile
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'renameFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when a file is renamed. The file descripter json for the file to be renamed is passed in the event data and also a property, newFilename, that contains the new filename. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachRenameFile
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'renameFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachRenameFile
 * @function
 */

/**
 * Fire event renameFile to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireRenameFile
 * @function
 */


/**
 * Fired when a file is uploaded and the response comes back from service. The service response for the file to be added to the list is passed in the event data and the consumer must format it in the correct json structure and pass it back to the control using commitUploadFile method. 
 *
 * @name sap.ca.ui.FileUpload#uploadFile
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'uploadFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when a file is uploaded and the response comes back from service. The service response for the file to be added to the list is passed in the event data and the consumer must format it in the correct json structure and pass it back to the control using commitUploadFile method. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachUploadFile
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'uploadFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachUploadFile
 * @function
 */

/**
 * Fire event uploadFile to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireUploadFile
 * @function
 */


/**
 * Fired when a file fails to upload. The error code and response data is passed in this event. The consumer should handle the error by showing the appropriate message. 
 *
 * @name sap.ca.ui.FileUpload#fileUploadFailed
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'fileUploadFailed' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when a file fails to upload. The error code and response data is passed in this event. The consumer should handle the error by showing the appropriate message. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachFileUploadFailed
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'fileUploadFailed' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachFileUploadFailed
 * @function
 */

/**
 * Fire event fileUploadFailed to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireFileUploadFailed
 * @function
 */


/**
 * Fired just before the control is about to make a file upload request. The data passed is the file object selected by the user. You may handle this event to attach custom headers for example if your service implementation requires it. 
 *
 * @name sap.ca.ui.FileUpload#beforeUploadFile
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'beforeUploadFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired just before the control is about to make a file upload request. The data passed is the file object selected by the user. You may handle this event to attach custom headers for example if your service implementation requires it. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachBeforeUploadFile
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'beforeUploadFile' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachBeforeUploadFile
 * @function
 */

/**
 * Fire event beforeUploadFile to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireBeforeUploadFile
 * @function
 */


/**
 * Fired when the save button is clicked. The consumer should handle the event and save all the file renames to backend. 
 *
 * @name sap.ca.ui.FileUpload#saveClicked
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'saveClicked' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when the save button is clicked. The consumer should handle the event and save all the file renames to backend. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachSaveClicked
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'saveClicked' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachSaveClicked
 * @function
 */

/**
 * Fire event saveClicked to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireSaveClicked
 * @function
 */


/**
 * Fired when the cancel button is clicked. The consumer may handle the event if required. 
 *
 * @name sap.ca.ui.FileUpload#cancelClicked
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'cancelClicked' event of this <code>sap.ca.ui.FileUpload</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.FileUpload</code>.<br/> itself. 
 *  
 * Fired when the cancel button is clicked. The consumer may handle the event if required. 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.FileUpload</code>.<br/> itself.
 *
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#attachCancelClicked
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'cancelClicked' event of this <code>sap.ca.ui.FileUpload</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.FileUpload#detachCancelClicked
 * @function
 */

/**
 * Fire event cancelClicked to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.FileUpload} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.FileUpload#fireCancelClicked
 * @function
 */


/**
 * Remove the specified file from the control
 *
 * @name sap.ca.ui.FileUpload.prototype.removeFile
 * @function

 * @type void
 * @public
 */


/**
 * Commit any pending renames to update the filenames
 *
 * @name sap.ca.ui.FileUpload.prototype.abandonPendingRenames
 * @function

 * @type void
 * @public
 */


/**
 * Commit the pending renames so the filename is updated in the model
 *
 * @name sap.ca.ui.FileUpload.prototype.commitPendingRenames
 * @function

 * @type void
 * @public
 */


/**
 * Commit the file upload by sending the control the JSON structure of the file descriptor.
 *
 * @name sap.ca.ui.FileUpload.prototype.commitFileUpload
 * @function

 * @type void
 * @public
 */


/**
 * method to set a custom header for a request. Takes the header name and the value as parameters.
 *
 * @name sap.ca.ui.FileUpload.prototype.setCustomHeader
 * @function

 * @type void
 * @public
 */


/**
 * method to remove request headers set. Takes name of header to remove.
 *
 * @name sap.ca.ui.FileUpload.prototype.removeCustomHeader
 * @function

 * @type void
 * @public
 */


/**
 * Enable/Disable editing while in edit mode, typically to be used during saves or deletes and other server updates
 *
 * @name sap.ca.ui.FileUpload.prototype.preventEdits
 * @function

 * @type void
 * @public
 */


// Start of sap\ca\ui\FileUpload.js
/**
 * This file defines behavior for the control,
 */
jQuery.sap.declare("sap.ca.ui.FileUpload");





var Formatter = sap.ca.ui.model.format.FileSizeFormat.getInstance();

//************** Control events handlers *********************

sap.ca.ui.FileUpload.prototype.init = function() {

    this._oCustomHeaderArray = [];
    this._oBundle = sap.ca.ui.utils.resourcebundle;

    // initialise the localisation texts as private properties
    this._sUploadText = this._oBundle.getText("FileUploader.upload");
    this._sOverallUploadingText = this._oBundle.getText("FileUploader.uploadingOutOf", ["{filesUploaded} "," {filesToUpload}"]);
    this._sOutOf = this._oBundle.getText("FileUploader.outOf");
    this._sDeleteFile = this._oBundle.getText("FileUploader.deleteFile");
    this._sContinue = this._oBundle.getText("FileUploader.continue");
    this._sDeleteQuestion = this._oBundle.getText("FileUploader.deleteQuestion");

    var oControl = this;

    this._oAddButton = new sap.m.Button({
        icon: "sap-icon://add",
        type: sap.m.ButtonType.Transparent,
        press :  jQuery.proxy(function() {
            jQuery.sap.domById(this.getId()+ '-upload').click();
        }, this)
    });

    this._oEditButton = new sap.m.Button({
        icon: "sap-icon://edit",
        type: sap.m.ButtonType.Transparent,
        press : jQuery.proxy( this._editButtonClicked, this)
    });

    this._oSaveButton = new sap.m.Button({
        type: sap.m.ButtonType.Transparent,
        text : sap.ca.ui.utils.resourcebundle.getText("FileUploader.save"),
        press : jQuery.proxy( this._saveButtonClicked, this)
    });


    this._oCancelButton = new sap.m.Button({
        type: sap.m.ButtonType.Transparent,
        text : sap.ca.ui.utils.resourcebundle.getText("FileUploader.cancel"),
        press : jQuery.proxy(this._cancelButtonClicked, this)
    });

    this._oToolBar = new sap.m.Toolbar({
        width : '55%',
        content : [
            this._oAddButton
            , this._oEditButton
            , this._oSaveButton
            , this._oCancelButton
        ]
    }).addStyleClass('sapCaUiFUToolbar');

    this._oProgressLabel = new sap.m.Label(this.getId() + "-progress", {
        text : {
            path : "uploadPercent",
            formatter : function(value) {
                var sBindingContext = this.getBindingContext().getPath();
                var path = sBindingContext + "/uploadPercent";
                var percent = this.getModel().getProperty(path);
                var sValue =  oControl._oBundle.getText("FileUploader.uploading", [percent]);
                return sValue;
            }
        },
        visible : {path: "isUploading",
            formatter: function(oValue){
                if(oControl._isIE9OrBelow()){
                    return false;
                }
                return oValue;
            }
        }
    });

    this._oNumberOfAttachmentsLabel = new sap.m.Label(this.getId() + "-attachmentLabel", {design: sap.m.LabelDesign.Standard}).addStyleClass("sapCaUiFileUploadAttachmentLabel");
    this._oFileSizeLabel = new sap.m.Label(this.getId() + "-fileSizeLabel").addStyleClass("sapCaUiFileUploadFileSizeText");
    this._oUploadedDateLabel = new sap.m.Label(this.getId() + "-uploadedDate",	{visible : "{isUploaded}"});
    this._oUploadingProgressLabel = new sap.m.Label(this.getId() + "-uploadProgressLabel",{
        design: sap.m.LabelDesign.Bold,
        text: oControl._sOverallUploadingText
    }).addStyleClass("sapCaUiFileUploadProgressLabel");
    this._oFileExtensionLabel = new sap.m.Label(this.getId() + "-extension", {text :"{parsedFileExtension}"}).addStyleClass('sapCaUiFUExtension');
    this._oFileNameLabel = new sap.m.Link(this.getId() + "-filename", { target : "_blank" }).addStyleClass('sapCaUiFileUploadFileLoadedText');
    this._oFileNameEditBox =  new sap.m.Input(this.getId() + "-editFileName", {type: sap.m.Input.Text}).addStyleClass('sapCaUiFileUploadEditBox');
    this._oFileNameEditBox.attachChange(this, this._nameChanged);

    this._oDateSizeHL = new sap.ui.layout.HorizontalLayout(this.getId() + "-ba-datesizelayout", {
        content : [ this._oUploadedDateLabel,
            this._oFileSizeLabel,
            this._oProgressLabel ],
        allowWrapping: true
    }).addStyleClass('sapCaUiFUInnerHL');

    this._oInputExtensionHL = new sap.ui.layout.HorizontalLayout({
        content:[
            this._oFileNameEditBox,
            this._oFileExtensionLabel
        ],
        allowWrapping: true}).addStyleClass("sapCaUiInnerEditHL");

    var oInnerLayout = new sap.ui.layout.VerticalLayout(this.getId() + "-ba-inner", {
        content : [ this._oFileNameLabel,
            this._oInputExtensionHL,
            this._oDateSizeHL ]
    }).addStyleClass('sapCaUiFUInner');

    this._oItemIcon = new sap.ui.core.Icon(this.getId() + "-icon", {visible: "{isUploaded}"	}).setWidth('2.5rem').setHeight('2.5rem').addStyleClass("sapCaUiFileUploadItemIcon");

    var _oDeleteIcon = sap.ui.core.IconPool.createControlByURI({
        id : this.getId() + "-deleteIcon",
        src : sap.ui.core.IconPool.getIconURI("sys-cancel"),
        press : jQuery.proxy(this._handleDelete, this),
        visible : "{isDeleteVisible}",
        enabled : "{isEditEnabled}"
    }).addStyleClass("sapCaUiFileUploadDeleteIcon");
    var _oCancelIcon = sap.ui.core.IconPool.createControlByURI({
        id : this.getId() + "-cancelIcon",
        src : sap.ui.core.IconPool.getIconURI("sys-cancel-2"),
        visible : "{isUploading}",
        press: jQuery.proxy(function(oEv) {
            // remove the current item and stop uploading
            var oControl = oEv.getSource();
            var sPath = oControl.getBindingContext().getPath();
            var fnAbort = oControl.getModel().getProperty(sPath + "/abortUpl");
            fnAbort();
            var aTokens = sPath.split('/');
            var nInd = aTokens[aTokens.length-1];
            var oItems = oControl.getModel().getProperty(this.getItems());
            oItems.splice(nInd,1);
            oControl.getModel().setProperty(this.getItems(), oItems);
            oControl.getModel().setProperty(this.getItems()+"/filesToUpload", oControl.getModel().getProperty(this.getItems()+"/filesToUpload")-1);
            this._maintainUploadingProgress();
        }, this)
    }).addStyleClass("sapCaUiFileUploadCancelIcon");

    var oHL = new sap.ui.layout.HorizontalLayout(this.getId() + "-ba-hl", {
        content : [
            new sap.m.BusyIndicator({
                id : this.getId() + "-indicator",
                visible : "{isUploading}"
            }).setSize('2.5rem').addStyleClass('sapCaUiFileUploadloadingIcon'),
            this._oItemIcon,
            oInnerLayout,
            _oDeleteIcon,
            _oCancelIcon],
        allowWrapping: true
    }).addStyleClass("sapCaUiFUItemHL");

    this._oViewPageList = new sap.m.List();
    this._oViewPageList.addStyleClass("sapCaFileUploadListBorder");

    this._oTemplate = new sap.m.CustomListItem({content : [ oHL ]});

    this.setAggregation("attachmentNumberLabel", this._oNumberOfAttachmentsLabel);
    this.setAggregation("fileList", this._oViewPageList);
    this.setAggregation("uploadProgressLabel", this._oUploadingProgressLabel);
    this.setAggregation("toolBar", this._oToolBar);
};


sap.ca.ui.FileUpload.prototype.onAfterRendering = function() {
    var sUploadUrl = this.getUploadUrl();
    //Set if the "No data" label have to be displayed.
    this._oViewPageList.setShowNoData(this.getShowNoData());

    var sId = this.getId();
    // escape the jQuery selector for initialisation of the file uploader
    sId = sId.replace(/[#;&,.+*~':"!^$[\]()=>|\/]/g, "\\$&");
    sId = '#' + sId + '-upload';

    // for IE9 or below, we need to first send the multipart/form request to the base64
    // encoder service
    if (this._isIE9OrBelow() && !this.getUseMultipart()) {
        if (this.getEncodeUrl() === "") {
            jQuery.sap.log.warning("FileUpload: encodeUrl property is empty (required by IE9 to base64 encode the file before sending it)")
        }

        sUploadUrl = this.getEncodeUrl();
    }

    jQuery(sId).fileupload({
        multipart : this.getUseMultipart(),
        url : sUploadUrl,
        add : jQuery.proxy(function(e, data) {
            this.onAdd(e, data);
        }, this),
        send : jQuery.proxy(function(e, data) {
            this.sending(e, data);
        }, this),
        progress : jQuery.proxy(function(e, data) {
            this.calculateProgress(e, data);
        }, this),
        done : jQuery.proxy(function(e, data) {
            this.uploadDone(e, data);
        }, this),
        fail: jQuery.proxy(function(e, data) {
            this.handleUploadFailure(e,data);
        }, this),
        beforeSend: jQuery.proxy(function(xhr, data) {
            //allow consumer to handle before file upload in case they want to set custom headers based on file info
            this.fireBeforeUploadFile(data.files[0]);
            this._setRequestHeaders(xhr);
        }, this)
    });

    //this fix is required for IE10 xhr2 fileupload with multipart=false support
    //it was taken from this commit in the jQuery FileUpload control
    //https://github.com/blueimp/jQuery-File-Upload/commit/41d50543c6392118323a39320b3cf62594546106
    //TODO: this should be removed once we have approval to update to the latest release of jQuery FileUpload
    $.support.xhrFileUpload = !!(window.ProgressEvent && window.FileReader);
};

sap.ca.ui.FileUpload.prototype.exit = function() {

    this._oViewPageList.destroy();
    this._oViewPageList = null;
    this._oTemplate.destroy();
    this._oTemplate = null;
    this._oFileNameLabel.destroy();
    this._oFileNameLabel = null;
    this._oUploadedDateLabel.destroy();
    this._oUploadedDateLabel = null;
    this._oProgressLabel.destroy();
    this._oProgressLabel = null;
    if (this._oInputExtensionHL){
        this._oInputExtensionHL.destroy();
        this._oInputExtensionHL = null;
    }
    if (this._oDateSizeHL){
        this._oDateSizeHL.destroy();
        this._oDateSizeHL = null;
    }};




//****************** API METHODS *****************************

/**
 * Enable/Disable editing while in edit mode, typically to be used during saves
 * or deletes and other server updates
 */
sap.ca.ui.FileUpload.prototype.preventEdits = function(bLock) {
    var listContext = this.getItems();
    this.getModel().setProperty(listContext + "/isEditEnabled", !bLock);
};

/**
 * removes file from list by id
 * @param fileId
 */
sap.ca.ui.FileUpload.prototype.removeFile = function(fileId) {

    //this is a backwards compatibility fix as previously, passing an array
    //used to work and now it does not (due to strict equal change below)
    if ((fileId instanceof Array) && fileId.length > 0) {
        fileId = fileId[0];
    }

    var oNewItems = [];
    var oItems = this.getModel().getProperty(this.getItems());

    for(var i=0;i<oItems.length;i++){
        if(oItems[i][this.getFileId()] !==  fileId){
            oNewItems.push(oItems[i]);
        }
    }

    // preserve the state for remaining uploads
    oNewItems.isUploading = oItems.isUploading;
    oNewItems.filesToUpload = oItems.filesToUpload;
    oNewItems.filesUploaded = oItems.filesUploaded;
    oNewItems.isEditMode = oItems.isEditMode;

    this.getModel().setProperty(this.getItems(), oNewItems);
    this.commitPendingRenames(true);  //update model with any changes to filenames which have not been handled before delete
};

/**
 * sets the Control's model
 * @param model
 */
sap.ca.ui.FileUpload.prototype.setModel = function(model)
{
    sap.ui.core.Control.prototype.setModel.call(this, model);

    // set the initial states of the existing files
    jQuery.each(this.getModel().getProperty(this.getItems()),
        jQuery.proxy(function(index, value) {
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isUploaded", true);
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isUploading", false);
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isPending", false);
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isDeleteVisible", false);

            // add states to allow succesful rename of files
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isPendingFileRename", false);
            this.getModel().setProperty(
                this.getItems() + "/" + index + "/isFileNameSwapped", false);

            this.getModel().setProperty(this.getItems() + "/" + index + "/isHiddenFile", false);

            // we need to parse the file type from the filename.

            // split the filename into an array, the final index contains the file extension
            var sParsedFileExtension = this.getModel().getProperty(this.getItems() +"/" + index + "/" + this.getFileName()).split(".");

            // case to deal with a file that has no extension, return an empty string for the extension
            if( sParsedFileExtension.length === 1){
                sParsedFileExtension =  "";

                // If a[0] == "" and a.length == 2 it's a hidden file with no extension ie. .htaccess
            }else if(sParsedFileExtension[0] === "" && sParsedFileExtension.length === 2){
                this.getModel().setProperty(this.getItems() + "/" + index + "/isHiddenFile", true);
                sParsedFileExtension =  "";

                // otherwise pop off everything at the front of the array, and we know have the file extension
            }else{
                sParsedFileExtension = "." + sParsedFileExtension.pop();
            }

            this.getModel().setProperty(
                this.getItems() + "/" + index + "/parsedFileExtension", sParsedFileExtension);
            var isUploadedBinding = this.getModel().bindProperty(this.getItems() + "/" + index + "/isUploaded");
            isUploadedBinding.attachChange(this.getItems(), this._isUploadedChange);
        }, this)
    );

    // initialise overall state of the control
    this.getModel().setProperty(this.getItems() + "/isUploading", false);
    this.getModel().setProperty(this.getItems() + "/filesToUpload", 0);
    this.getModel().setProperty(this.getItems() + "/filesUploaded", 1);
    this.getModel().setProperty(this.getItems() + "/isEditEnabled", true);
    this.getModel().setProperty(this.getItems() + "/isRenameEnabled", this.getRenameEnabled());

    var isEditBinding = this.getModel().bindProperty(this.getItems() + "/isEditMode");
    isEditBinding.attachChange(this.getItems(), this._isEditChange);
    this.getModel().setProperty(this.getItems() + "/isEditMode", this.getEditMode());

    this._oNumberOfAttachmentsLabel.bindProperty("text", this.getProperty("items") + "/length", function(length){
        var sLabelText = sap.ca.ui.utils.resourcebundle.getText("FileUploader.attachments") + " (" + length + ")";
        return sLabelText;
    });

    this._oFileSizeLabel.bindProperty("visible",{parts: [ {path: this.getItems() + "/isEditMode"}, {path: "isUploaded"}],
        formatter: jQuery.proxy(function(bEditMode, bIsUploaded){
            // if it's IE9 or below hide the upload
            if(this._isIE9OrBelow()){
                return bEditMode && bIsUploaded;
            }
            return bEditMode;
        }, this)
    });

    if (this.getShowAttachmentsLabelInEditMode()) {
        this._oNumberOfAttachmentsLabel.bindProperty("visible", this.getProperty("items") + "/isEditMode");
    } else {
        this._oNumberOfAttachmentsLabel.setVisible(false);
    }

    this._oUploadingProgressLabel.bindProperty("visible", this.getProperty("items") + '/isUploading');
    this._oUploadingProgressLabel.bindElement(this.getProperty("items"));
    this._oNumberOfAttachmentsLabel.bindElement(this.getProperty("items"));

    this._oViewPageList.bindItems(this.getProperty("items"), this._oTemplate, null, null);
};


/**
 * sets a custom request http header
 * @param sHeader
 * @param sValue
 */
sap.ca.ui.FileUpload.prototype.setCustomHeader = function (sHeader, sValue){
    if(this._oCustomHeaderArray === []){
        this._oCusomHeaderArray.push({
            key: sHeader,
            value: sValue
        });
    }else{
        var nLength = this._oCustomHeaderArray.length;
        for(var i = 0; i< nLength; i++){
            if(this._oCustomHeaderArray[i].key === sHeader){
                this._oCustomHeaderArray[i].value = sValue;
                return;
            }
        }

        this._oCustomHeaderArray.push({
            key: sHeader,
            value: sValue
        });
    }
};

/**
 * removes a custom http request header
 * @param sHeader
 */
sap.ca.ui.FileUpload.prototype.removeCustomHeader = function(sHeader){
    var nIndex = -1;
    for(var i = 0; i < this._oCustomHeaderArray.length; i++){
        if(this._oCustomHeaderArray[i].key === sHeader){
            nIndex = i;
        }
    }
    if(nIndex !== -1){
        this._oCustomHeaderArray.splice(nIndex, 1);
    }
};

/**
 * commits file upload for the provided file descriptor
 * @param data
 */
sap.ca.ui.FileUpload.prototype.commitFileUpload = function(data) {
    // Remove encodings of the format file%name - to file name
    var uploadedFileName = decodeURI(data[this.getFileName()]);
    //  format the size
    data.size = Formatter.format(data.size);
    var dataLength = this.getModel().getProperty(this.getItems() + "/").length;

    for ( var i = 0; i < dataLength; i++) {

        // if the uploaded filename matches one in the local model, update the status
        // even if there are multiple files uploaded with the same name we can tolerate this
        // since we update all properties
        var path = this.getItems() + "/" + i;
        if (this.getModel().getProperty(path + "/" + this.getFileName()) === uploadedFileName &&
            this.getModel().getProperty(path + "/isUploading")) {

            this.getModel().setProperty(path + "/" + this.getFileId(),
                data[this.getFileId()]);
            this.getModel().setProperty(path + "/" + this.getFileExtension(),
                data[this.getFileExtension()]);
            this.getModel().setProperty(path + "/" + this.getMimeType(),
                data[this.getMimeType()]);
            this.getModel().setProperty(path + "/" + this.getContributor(),
                data[this.getContributor()]);
            this.getModel().setProperty(path + "/" + this.getUploadedDate(),
                data[this.getUploadedDate()]);
            this.getModel().setProperty(path + "/" + this.getFileName(),
                data[this.getFileName()]);
            this.getModel().setProperty(path + "/" + this.getUrl(),
                data[this.getUrl()]);
            this.getModel().setProperty(path + "/" + this.getFileId(),
                data[this.getFileId()]);
            this.getModel().setProperty(path + "/" + this.getSize(),
                data[this.getSize()]);


            this.getModel().setProperty(path + "/isHiddenFile", false);

            // we need to parse the file type from the filename.
            // split the filename into an array, the final index contains the file extension
            var sParsedFileExtension = uploadedFileName.split(".");

            // case to deal with a file that has no extension, return an empty string for the extension
            if( sParsedFileExtension.length === 1){
                sParsedFileExtension =  "";

                // If a[0] == "" and a.length == 2 it's a hidden file with no extension ie. .htaccess
            }else if(sParsedFileExtension[0] === "" && sParsedFileExtension.length === 2){
                sParsedFileExtension =  "";
                this.getModel().setProperty(path + "/isHiddenFile", true);

                // otherwise pop off everything at the front of the array, and we know have the file extension
            }else{
                sParsedFileExtension = "." + sParsedFileExtension.pop();
            }
            this.getModel().setProperty(path + "/parsedFileExtension", sParsedFileExtension );

            this.getModel().setProperty(path + "/isPending", false);
            this.getModel().setProperty(path + "/isUploading", false);
            this.getModel().setProperty(path + "/isUploaded", true);
            // no longer need the abort href
            this.getModel().setProperty(path + "/abortUpl", undefined);
            this.getModel().setProperty(this.getItems()+"/filesUploaded", this.getModel().getProperty(this.getItems()+"/filesUploaded")+1);
            this._maintainUploadingProgress();
        }
    }
};

/**
 * Changes to filenames are set into the model as the new filename TODO: This is
 * not sufficent, we would also need to update the URLs for the renamed files
 *
 * @param bDontToggleEdit - indicates the edit mode should not be toggled
 */
sap.ca.ui.FileUpload.prototype.commitPendingRenames = function(bDontToggleEdit) {
    var listContext = this.getItems();
    var oItems = this.getModel().getProperty(listContext);

    for(var i=0;i<oItems.length;i++){
        if(oItems[i].newFilename !== undefined && oItems[i][this.getFileName()] !==  oItems[i].newFilename){
            var bFileHidden = oItems[i]["isHiddenFile"];
            var sNewFileName = "";
            if( oItems[i].isPendingFileRename){
                // append the extension to the new fileName
                if(bFileHidden){
                    sNewFileName = "." + oItems[i].newFilename;
                }else{
                    sNewFileName = oItems[i].newFilename + oItems[i]["parsedFileExtension"];
                }
            }
            else if( oItems[i].isFileNameSwapped){
                if(bFileHidden){
                    sNewFileName = "." + oItems[i][this.getFileName()];
                }else{
                    sNewFileName = oItems[i][this.getFileName()] + oItems[i]["parsedFileExtension"];
                }
            }
            this.getModel().setProperty(listContext + "/" + i + "/" + this.getFileName(), sNewFileName);
            this.getModel().setProperty(listContext + "/" + i + "/newFilename", undefined);
        }

        oItems[i].isPendingFileRename = false;
        oItems[i].isFileNameSwapped = false;
    }

    //toggle edit mode if required and if control is using edit controls
    if (!bDontToggleEdit && this.getUseEditControls()) {
        this.preventEdits(false);
        this._oSaveButton.setEnabled(true);
        this._oCancelButton.setEnabled(true);
        this._toggleEdit();
    }
};

/**
 * Changes to filenames rolled back to the model versions
 */
sap.ca.ui.FileUpload.prototype.abandonPendingRenames = function() {
    var listContext = this.getItems();
    var oItems = this.getModel().getProperty(listContext);

    // refresh no longer enough
    for(var i = 0; i < oItems.length; i++){
        if( oItems[i].isFileNameSwapped){
            // swap back the items so they display correctly
            oItems[i][this.getFileName()] = oItems[i].newFilename;
        }
        // reset everything
        oItems[i].isPendingFileRename = false;
        oItems[i].isFileNameSwapped = false;
    }

    this.getModel().refresh(true);

    if (this.getUseEditControls()) {
        this._toggleEdit();
    }
};

//*******************SETTERS*****************

sap.ca.ui.FileUpload.prototype._setUploadedDateBinding = function(sDatePath, sContributorPath, sSize) {
    var sDate = (sDatePath === null) ? this.getUploadedDate() : sDatePath;
    var sDateFormatted = "{path: '"+sDate+"', type:'sap.ca.ui.model.type.Date', formatOptions : { style:'medium'}}";
    var sContributor = (sContributorPath === null) ? this.getContributor() : sContributorPath;
    sSize = (sSize === null) ? this.getSize() : sSize;

    var sAttachedText;
    if (this._isPhone()){
        sAttachedText = this._oBundle.getText("FileUploader.attached_phone", [sDateFormatted,"{"+sContributor+"}"]);
    }
    else {
        sAttachedText = this._oBundle.getText("FileUploader.attached", [sDateFormatted,"{"+sContributor+"}"]);
    }
    this._oUploadedDateLabel.setText(sAttachedText);
    this._oFileSizeLabel.setText(" ({"+sSize+"})");
};

/**
 * sets the items control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setItems = function(oValue) {

    var oldItems = this.getItems();
    if (oldItems !== oValue) {
        this._oFileNameLabel.bindProperty("visible", {parts: [ {path:oValue + "/isEditMode"}, {path: "isUploading"}], formatter: function(bEdit, bUpl){
            return !bEdit || bUpl;
        }});
        this._oInputExtensionHL.bindProperty("visible", {parts: [{path: oValue + "/isEditMode"}, {path: "isUploading"}], formatter: function (bEdit, bUpl) {
            return bEdit && !bUpl;
        }});
        this._oDateSizeHL.bindProperty("visible", {parts: [{path: oValue + "/isEditMode"}, {path: "isUploading"}], formatter: function (bEdit, bUpl) {
            return !(bEdit && !bUpl);
        }});
        this._oFileNameEditBox.bindProperty("enabled", {parts: [{path: oValue + "/isEditEnabled"}, {path: oValue + "/isRenameEnabled"}], formatter: function(bEdit, bRename){
            return bEdit && bRename;
        }});
        this.setProperty("items", oValue);
    }
};

/**
 * sets the fileName control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setFileName = function(oValue) {
    var oldname = this.getFileName();
    if (oldname !== oValue) {
        this._oFileNameLabel.bindProperty("text", oValue);
        // dont write edits back to model unless saved
        this._oFileNameEditBox.bindValue(oValue,function(sValue){
            var sOutput = sValue.substr(0, sValue.lastIndexOf('.')) || sValue;
            return sOutput;
        }, sap.ui.model.BindingMode.OneWay );
        this.setProperty("fileName", oValue);
    }
};


/**
 *  sets the editMode control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setEditMode = function(oValue) {
    var oldMode = this.getEditMode();

    if(oldMode !== oValue) {
        if(this.getModel()){
            this.getModel().setProperty(this.getItems() + "/isEditMode", oValue);
            this.getModel().refresh(true);
        }

        this.setProperty("editMode", oValue);
    }

    if(this.getModel() && oValue === false){
        // reenable edit
        this.getModel().setProperty(this.getItems() + "/isEditEnabled", true);
    }

    this._setToolBarControls();
};

/**
 * sets the useEditControls control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setUseEditControls = function(oValue) {
    this.setProperty("useEditControls", oValue);
    this._setToolBarControls();
};

/**
 * sets the contributor control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setContributor = function(oValue) {
    var oldContributor = this.getContributor();
    if (oldContributor !== oValue) {

        this._setUploadedDateBinding(null, oValue, null);
        this.setProperty("contributor", oValue);
    }
};

/**
 * sets the uploadedDate control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setUploadedDate = function(oValue) {
    var olddate = this.getUploadedDate();
    if (olddate !== oValue) {
        this._setUploadedDateBinding(oValue, null, null);
        this.setProperty("uploadedDate", oValue);
    }
};

/**
 * sets the size control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setSize = function(oValue) {
    var size = this.getSize();
    if (size !== oValue) {
        this._setUploadedDateBinding(null, null,oValue );
        this.setProperty("size", oValue);
    }
};

/**
 * sets the url control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setUrl = function(oValue) {
    var oldurl = this.getUrl();
    if (oldurl !== oValue) {
        this._oFileNameLabel.bindProperty("href", { path: oValue, formatter : this._removeStartingSlash });
        this.setProperty("url", oValue);
    }
};

/**
 * sets the uploadEnabled control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setUploadEnabled = function(oValue) {
    this._oAddButton.setVisible(oValue);
    this.setProperty("uploadEnabled", oValue);

    this._setToolBarControls();
};

/**
 * sets the mimeType control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setMimeType = function(oValue) {
    var oldmimetype = this.getMimeType();
    if (oldmimetype !== oValue) {
        this._oItemIcon.bindProperty("src", { path: oValue,
            formatter: this._getIconFromMimeType });

        this.setProperty("mimeType", oValue);
    }
};

/**
 * sets the fileExtension control property
 * @param oValue
 * @override
 */
sap.ca.ui.FileUpload.prototype.setFileExtension = function(oValue) {
    var oldextension = this.getFileExtension();
    //only use fileExtension if mimeType hasn't been set as mimeType takes precedence
    if (oldextension !== oValue && !this.getProperty("mimeType")) {
        this._oItemIcon.bindProperty("src", { path: oValue,
            formatter: this._getIconFromExtension });

        this.setProperty("fileExtension", oValue);
    }
};


//****************PRIVATES****************************


/**
 * handle cancel button click
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._cancelButtonClicked = function() {
    this.fireCancelClicked();

    //required fix for phone/tablet due to timing issue
    if (jQuery.device.is.phone || jQuery.device.is.tablet) {
        this._oSaveButton.setEnabled(false);
        this._oCancelButton.setEnabled(false);
        this.preventEdits(true);

        setTimeout(jQuery.proxy(function(){
            this.preventEdits(false);
            this._oSaveButton.setEnabled(true);
            this._oCancelButton.setEnabled(true);
            this.abandonPendingRenames();
        },this), 500);
    } else {
        this.abandonPendingRenames();
    }
};

/**
 * handle save button click
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._saveButtonClicked = function() {
    this._oSaveButton.setEnabled(false);
    this._oCancelButton.setEnabled(false);
    this.preventEdits(true);

    this.fireSaveClicked();
};

/**
 * handle edit button click
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._editButtonClicked = function() {
    this._oSaveButton.setEnabled(true);
    this._oCancelButton.setEnabled(true);
    this._toggleEdit();
};

/**
 * toggle edit mode
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._toggleEdit = function() {
    var bEdit = this.getEditMode();
    this.setEditMode(!bEdit);
    bEdit = this.getEditMode();
    this._oEditButton.setVisible(!bEdit);
    this._oCancelButton.setVisible(bEdit);
    this._oSaveButton.setVisible(bEdit && this.getRenameEnabled());
};

/**
 * set visibility of edit controls
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._setToolBarControls = function() {
    var bUseEditControls = this.getUseEditControls();
    var bIsEditMode = this.getEditMode();
    var bIsUploadEnabled = this.getUploadEnabled();

    this._oToolBar.setVisible(bIsUploadEnabled || bUseEditControls);

    this._oEditButton.setVisible(bUseEditControls && !bIsEditMode);
    this._oSaveButton.setVisible(bUseEditControls && bIsEditMode);
    this._oCancelButton.setVisible(bUseEditControls && bIsEditMode);
};

/**
 * handle name change event
 * @param event
 * @param control
 * @private
 */
sap.ca.ui.FileUpload.prototype._nameChanged = function(event, control) {
    var fileToRename = event.getSource().getBindingContext().getProperty();
    fileToRename.newFilename = event.getSource().getValue();
    // save new name in case of rollback
    this.getModel().setProperty(event.getSource().getBindingContext().getPath() + "/newFilename", fileToRename.newFilename);
    // file has been renamed, set the state to pending
    this.getModel().setProperty(event.getSource().getBindingContext().getPath() + "/isPendingFileRename", true);
    control.fireRenameFile(fileToRename);
};

/**
 * determines file the icon from the file extension.
 * @param sVal
 * @return {String}
 * @private
 */
sap.ca.ui.FileUpload.prototype._getIconFromExtension = function(sVal) {

    if(sVal === "pdf") {
        return "sap-icon://pdf-attachment";
    }
    else if(sVal === "jpg" || sVal === "png" || sVal === "bmp") {
        return "sap-icon://attachment-photo";
    }
    else if(sVal === "txt") {
        return "sap-icon://document-text";
    }
    else if(sVal === "doc" || sVal === "docx" || sVal === "odt") {
        return "sap-icon://doc-attachment";
    }
    else if(sVal === "xls" || sVal === "csv") {
        return "sap-icon://excel-attachment";
    }
    else if(sVal === "ppt" || sVal === "pptx" ) {
        return "sap-icon://ppt-attachment";
    }
    else {
        return "sap-icon://document";
    }
};

/**
 * determines the icon from the mime type
 * @param sVal
 * @return {String}
 * @private
 */
sap.ca.ui.FileUpload.prototype._getIconFromMimeType = function(sVal) {

    var sIcon = "";
    if (!sVal) {
        return "sap-icon://document";
    }
    if (sVal.indexOf('image') === 0) {
        sIcon = "sap-icon://attachment-photo";
    } else if (sVal.indexOf('video') === 0) {
        sIcon = "sap-icon://attachment-video";
    } else if (sVal.indexOf('text') === 0) {
        sIcon = "sap-icon://attachment-text-file";
    } else if (sVal.indexOf('audio') === 0) {
        sIcon = "sap-icon://attachment-audio";
    } else if (sVal.indexOf('audio') === 0) {
        sIcon = "sap-icon://attachment-audio";
    } else if (sVal.indexOf('application') === 0) {

        switch (sVal) {
            case 'application/vnd.openxmlformats-officedocument.presentationml.presentation':
            case 'application/vnd.ms-powerpoint':
            case 'application/vnd.openxmlformats-officedocument.presentationml.template':
                sIcon =  "sap-icon://ppt-attachment";
                break;
            case 'application/msword':
            case 'application/vnd.openxmlformats-officedocument.wordprocessingml.document':
            case 'application/vnd.openxmlformats-officedocument.wordprocessingml.template':
                sIcon =  "sap-icon://doc-attachment";
                break;
            case 'application/vnd.ms-excel':
            case 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet':
            case 'application/vnd.openxmlformats-officedocument.spreadsheetml.template':
                sIcon = "sap-icon://excel-attachment";
                break;
            case 'application/pdf':
                sIcon = "sap-icon://pdf-attachment";
                break;
            case 'application/xhtml+xml':
                sIcon = "sap-icon://attachment-html";
                break;
            case 'application/zip':
            case 'application/gzip':
                sIcon = "sap-icon://attachment-zip-file";
                break;
            default:
                sIcon = "sap-icon://document";
        }
    } else {
        sIcon = "sap-icon://document";
    }
    return sIcon;
};


/**
 * gets the Add icon
 * @return {*}
 * @private
 */
sap.ca.ui.FileUpload.prototype._getAddIcon = function() {
    var u = sap.ui.core.IconPool.getIconURI("add");
    this.oAddIcon = sap.ui.core.IconPool.createControlByURI({
        src : u
    });
    this.oAddIcon.addStyleClass("sapCaUiFileUploadGlyphicon");
    this.oAddIcon.addStyleClass("sapCaUiFileUploadGlyphiconPlus");

    return this.oAddIcon;
};

/**
 * remove starting slash
 * @param sVal
 * @return {*}
 * @private
 */
sap.ca.ui.FileUpload.prototype._removeStartingSlash = function(sVal) {
    if(sVal && sVal.charAt(0) === '/') {
        return sVal.substr(1);
    }
    return sVal;
};

/**
 * maintains uploading progress label
 * @private
 */
sap.ca.ui.FileUpload.prototype._maintainUploadingProgress = function() {
    // reinitialise
    if( this.getModel().getProperty(this.getItems()+"/filesUploaded") >  this.getModel().getProperty(this.getItems()+"/filesToUpload")	) {
        this.getModel().setProperty(this.getItems() + "/isUploading", false);
        this.getModel().setProperty(this.getItems() + "/filesToUpload", 0);
        this.getModel().setProperty(this.getItems() + "/filesUploaded", 1);
    }
};
/*
 * Remove the files that are not uploded from the model
 */
sap.ca.ui.FileUpload.prototype._cancelPendingUpload = function() {
    var aItems = this.getModel().getProperty(this.getItems());
    var aItemsUploaded = [];

    //Create array with the file uploaded completely in the server
    jQuery.each(aItems,
        jQuery.proxy(function(index, value) {
            if(value && value.isUploaded) {
                aItemsUploaded.push(value);
            }
        },this)
    );

    this.getModel().setProperty(this.getItems(), aItemsUploaded);
    //Copy old values to the regenerated model
    this.getModel().setProperty(this.getItems()+"/filesToUpload", 0);
    this.getModel().setProperty(this.getItems()+"/filesUploaded", aItems.filesUploaded);
    this.getModel().setProperty(this.getItems()+"/isUploading", false);
    this.getModel().setProperty(this.getItems()+"/isEditEnabled", aItems.isEditEnabled);
    this.getModel().setProperty(this.getItems()+"/isEditMode", aItems.isEditMode);
    this.getModel().setProperty(this.getItems()+"/isUploading", aItems.isRenameEnabled);

    this._maintainUploadingProgress();
};

/**
 * Change handler for isUploaded and isEditMode to derive a calculated property
 * @param e
 */
sap.ca.ui.FileUpload.prototype._isUploadedChange = function(e, itemsPath){

    var isUploaded = e.getSource().getValue();
    var isEdit =  this.getModel().getProperty(itemsPath + "/isEditMode");
    this.getModel().setProperty(e.getSource().getPath().replace("isUploaded","isDeleteVisible"), isUploaded && isEdit);
};

/**
 * handles edit change
 * @param e
 * @param sItemsPath
 * @private
 */
sap.ca.ui.FileUpload.prototype._isEditChange = function(e, sItemsPath){
    var isEdit =  e.getSource().getValue();
    var allFiles = this.getModel().getProperty(sItemsPath + "/");

    for(var i=0;i<allFiles.length;i++){
        var isUploaded = this.getModel().getProperty(sItemsPath + "/" + i + "/isUploaded");
        this.getModel().setProperty(sItemsPath + "/" + i + "/isDeleteVisible", isUploaded && isEdit);
    }
};

/**
 * determines if device is phone
 * @return {*}
 * @private
 */
sap.ca.ui.FileUpload.prototype._isPhone = function() {
    return jQuery.device.is.phone;
};

/**
 * determines if browser is IE9
 * @return {*}
 * @private
 */
sap.ca.ui.FileUpload.prototype._isIE9OrBelow = function() {
    return (sap.ui.Device.browser.name === sap.ui.Device.browser.BROWSER.INTERNET_EXPLORER) && (sap.ui.Device.browser.version < 10);
};

/**
 * set common request headers
 */
sap.ca.ui.FileUpload.prototype._setRequestHeaders = function(xhr) {
    if (this.getAcceptRequestHeader()) {
        xhr.setRequestHeader("Accept", this.getAcceptRequestHeader());
    }
    if (this.getXsrfToken()) {
        xhr.setRequestHeader('x-csrf-token', this.getXsrfToken());
    }
    // set custom headers
    for(var i = 0; i< this._oCustomHeaderArray.length; i++){
        xhr.setRequestHeader(this._oCustomHeaderArray[i].key, this._oCustomHeaderArray[i].value);
    }
};

/**
 * handle delete event
 * @param event
 * @private
 */
sap.ca.ui.FileUpload.prototype._handleDelete = function(event) {
    var fileToDelete = event.oSource.getBindingContext().getProperty();

    sap.ca.ui.dialog.confirmation.open({
        question : this._sDeleteQuestion,
        showNote : false,
        title : this._sDeleteFile,
        confirmButtonLabel : this._sContinue
    }, jQuery.proxy(function(oData) {
        if(oData.isConfirmed) {
            this.fireDeleteFile(fileToDelete);
        }
    }, this));
};



//************jQuery FileUpload event handlers *****************



/**
 * handle jQuery FileUpload sending event
 * @param e
 * @param data
 */
sap.ca.ui.FileUpload.prototype.sending = function(e, data) {
    for(var j = 0; j < data.files.length; j++) {
        var oDataItems = data.files[j];
        var sfileInternalId = oDataItems.internalId;
        // search through the current list of items we have
        var nDataLength = this.getModel().getProperty(this.getItems()).length;
        for ( var i = 0; i < nDataLength; i++) {
            // if the uploaded fileId matches one in the local model, update the status
            var sPath = this.getItems() + "/" + i;

            if (this.getModel().getProperty(sPath)[this.getFileId()] === sfileInternalId &&
                this.getModel().getProperty(sPath).isPending) {
                this.getModel().setProperty(sPath + "/isUploading", true);
                this.getModel().setProperty(sPath + "/isPending", false);
                this.getModel().setProperty(sPath + "/isUploaded", false);
            }
        }
    }
};

/**
 * handle jQuery FileUpload onAdd event
 * @param e
 * @param data
 */
sap.ca.ui.FileUpload.prototype.onAdd = function(e, data) {
    // add the file items into the model on adding
    for(var j = 0; j < data.files.length; j++) {
        var file = data.files[0];
        var internalId = Math.random().toString();
        data.files[0].internalId = internalId;

        var oItems = this.getModel().getProperty(this.getItems());

        var oNewItem = {};
        oNewItem[this.getFileId()] = internalId;
        oNewItem[this.getFileName()] = file.name;
        oNewItem[this.getSize()] = Formatter.format(file.size);
        oNewItem["isPending"] = true;
        oNewItem["isUploading"] = false;
        oNewItem["isUploaded"] = false;
        oNewItem["uploadPercent"] = 0;
        oNewItem["isDeleteVisible"] = false;
        oNewItem["isPendingFileRename"] = false;
        oNewItem["isFileNameSwapped"] = false;

        oItems.unshift(oNewItem);

        this.getModel().setProperty(this.getItems(),oItems);

        var _oCancelUpload = data.submit();

        // store ref to abort
        this.getModel().setProperty(this.getItems() + "/0/abortUpl", _oCancelUpload.abort);
        // add a pending item
        this.getModel().setProperty(this.getItems()+"/filesToUpload", this.getModel().getProperty(this.getItems()+"/filesToUpload")+1);
        this.getModel().setProperty(this.getItems()+"/isUploading", true);
    }

    //has to be a better way than adding and removing bindings like this
    var newSize = this.getModel().getProperty(this.getItems()).length;
    var isUploadedBinding = this.getModel().bindProperty(this.getItems() + "/" + (newSize-1).toString() + "/isUploaded");
    isUploadedBinding.attachChange(this.getItems(), this._isUploadedChange);

    var dataLength = this.getModel().getProperty(this.getItems() + "/").length;

    // when a new file is added we may need to update the models so that renamed files don't change
    for ( var i = 0; i < dataLength; i++) {
        var path = this.getItems() + "/" + i;
        // check if a file has a pending rename, we need to set the filename to be the rename file
        // and the backup file to be the original name...this is to allow a names to appear renamed on a model refresh

        // if files are already swapped don't swap them again
        if (this.getModel().getProperty(path + "/isPendingFileRename")){

            var sTemp = this.getModel().getProperty(path + "/" + this.getFileName());
            var sNewFileName = this.getModel().getProperty(path + "/newFilename");

            // set the filename to the rename
            this.getModel().setProperty(path + "/" + this.getFileName(),
                sNewFileName);
            // set the rename to the old file name
            this.getModel().setProperty(path + "/newFilename",
                sTemp);
            // set state of file to swapped
            this.getModel().setProperty(path + "/isFileNameSwapped", true);
            // if another file is uploaded, don't want to reswap files so set pending to false
            this.getModel().setProperty(path + "/isPendingFileRename", false);
        }
    }
};

/**
 * calculate file upload progress
 * @param e
 * @param data
 */
sap.ca.ui.FileUpload.prototype.calculateProgress = function(e, data) {
    // search through the current list of items we have
    var dataLength = this.getModel().getProperty(this.getItems()).length;
    for ( var i = 0; i < dataLength; i++) {
        // search for the file with the uploading state.
        var progress = parseInt(data.loaded / data.total * 100, 10);
        var path = this.getItems() + "/" + i;
        var property = this.getModel().getProperty(path);

        // always one event per file, no need to iterate over the array
        if (property.isUploading &&
            property[this.getFileId()] === data.files[0].internalId ) {

            this.getModel().setProperty(path + "/uploadPercent", progress);
            this.getModel().setProperty(path + "/isUploaded", false);
        }
    }
};

/*
 * Handles the jQuery FileUpload failures event
 */
sap.ca.ui.FileUpload.prototype.handleUploadFailure = function(oEvt, data) {
    if(data.textStatus !== "abort") {
        this._cancelPendingUpload();
        this.fireFileUploadFailed({
            exception : new Error(this._oBundle.getText("FileUploader.error.connectionLost")),
            response : data
        });
    }
};


/*
 * handle the jQuery FileUpload uploadDone event
 */
sap.ca.ui.FileUpload.prototype.uploadDone = function(e, data) {

    try {
        //for IE9 or below, we need to build a second request and send the base64 encoded string to server
        if (this._isIE9OrBelow()) {
            // the response is inside <html><body><pre> when using the iFrame
            var sEncodedFile;

            // check that we have a result object
            if(this.getUseMultipart()){
                sEncodedFile = $( 'pre', data.result ).text();
                var json = jQuery.parseJSON(sEncodedFile);
                this.fireUploadFile(json);
            }else{
                if (null !== data && null !== data.result) {
                    var sFilename = data.files[0].name;
                    var oSelectedFile = data.files[0];
                    sEncodedFile = $( 'pre', data.result ).text();
                    var oJson;
                    //handle error
                    try { oJson = jQuery.parseJSON(sEncodedFile);
                    } catch (e) {} //not parsable, ignore}

                    if (oJson && oJson.error && oJson.error.code && oJson.error.code === '413'){
                        throw new Error(this._oBundle.getText("FileUploader.error.fileSizeError"));
                    }
                    var sMimeType = sEncodedFile.match(/^data\:(.*);base64,/)[1];
                    sEncodedFile = sEncodedFile.replace(/^data\:(.*);base64,/, '');

                    if (null !== sEncodedFile && "" !== sEncodedFile) {
                        //POST encoded file
                        //create the data object expected by jquery
                        $.ajax({
                            contentType: sMimeType,
                            data: sEncodedFile,
                            type: "POST",
                            url: this.getUploadUrl(),
                            success: jQuery.proxy(function (data, status) {
                                var oData = data.d ? data.d : data;
                                this.fireUploadFile(oData);
                            },this),
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                                throw new Error(this._oBundle.getText("FileUploader.error.fileUploadFail") + " " + errorThrown);
                            },
                            beforeSend: jQuery.proxy(function(xhr, data) {
                                //allow consumer to handle before file upload in case they want to set custom headers based on file info
                                this.fireBeforeUploadFile(oSelectedFile);
                                this._setRequestHeaders(xhr);
                                xhr.setRequestHeader("Content-Transfer-Encoding", 'Base64');
                                xhr.setRequestHeader("Content-Disposition", 'attachment; filename="' + sFilename + '"');
                            }, this)
                        });
                    }
                    // it could be a HTML page returned (error case) - session timeout, not logged on
                    else if (null !== data.result[0] && null !== data.result[0].title){
                        throw new Error(this._oBundle.getText("FileUploader.error.base64Error")+ ": " + data.result[0].title);
                    }else{
                        throw new Error(this._oBundle.getText("FileUploader.error.base64Error"));
                    }
                }
            }
        }
        else if (data && data.result){
            //fire uploadFile event for consumer to handle
            this.fireUploadFile(data.result);
        }else{
            throw new Error(this._oBundle.getText("FileUploader.error.invalidResponse"));
        }
    }
    catch(err) {
        // provide information on event so that custom error message can be used
        this._cancelPendingUpload();
        this.fireFileUploadFailed({
            exception : err,
            response : data
        });
    }
};


//*************** control native events *******************

/**
 * handle touchstart to give highlight effect for upload button where the <input> overlaps with button
 */
sap.ca.ui.FileUpload.prototype.ontouchstart = function(oEvent) {
    if (jQuery.os.ios && oEvent.target.id === this.getId()+"-upload") {
        this._oAddButton._activeButton();
    }
};

/**
 * handle touchend to give highlight effect for upload button where the <input> overlaps with button
 */
sap.ca.ui.FileUpload.prototype.ontouchend = function(oEvent) {
    if (jQuery.os.ios){
        this._oAddButton._inactiveButton();
    }
};

/**
 * handle touchcancel to give highlight effect for upload button where the <input> overlaps with button
 */
sap.ca.ui.FileUpload.prototype.ontouchcancel = function(oEvent) {
    if (jQuery.os.ios){
        this._oAddButton._inactiveButton();
    }
};

/**
 * Function is called when tap occurs on button.
 *
 * @private
 */
sap.ca.ui.FileUpload.prototype.ontap = function(oEvent) {

    if (jQuery.os.ios && oEvent.target.id === this.getId()+"-upload") {
        this._oAddButton.fireTap();
    }
};

}; // end of sap/ca/ui/FileUpload.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.Chart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.Chart.
jQuery.sap.declare("sap.ca.ui.charts.Chart");

jQuery.sap.require('sap.ui.core.Control'); // unlisted dependency retained



/**
 * Constructor for a new charts/Chart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getWidth width} : sap.ui.core.CSSSize (default: '100%')</li>
 * <li>{@link #getHeight height} : sap.ui.core.CSSSize (default: '100%')</li>
 * <li>{@link #getDataset dataset} : object</li>
 * <li>{@link #getChartType chartType} : string (default: 'Bar')</li>
 * <li>{@link #getMinShapeSize minShapeSize} : sap.ui.core.CSSSize (default: '48px')</li>
 * <li>{@link #getLabel label} : string (default: '')</li>
 * <li>{@link #getTitle title} : string (default: 'Chart')</li>
 * <li>{@link #getIcon icon} : string (default: '')</li>
 * <li>{@link #getSecondAxisVisible secondAxisVisible} : boolean (default: true)</li>
 * <li>{@link #getShowLegend showLegend} : boolean (default: true)</li>
 * <li>{@link #getSelectionMode selectionMode} : sap.ca.ui.charts.ChartSelectionMode (default: sap.ca.ui.charts.ChartSelectionMode.Multiple)</li>
 * <li>{@link #getShowHoverBackground showHoverBackground} : boolean (default: false)</li>
 * <li>{@link #getShowTooltip showTooltip} : boolean (default: false)</li>
 * <li>{@link #getShowPopover showPopover} : boolean (default: true)</li>
 * <li>{@link #getShowDataLabel showDataLabel} : boolean (default: true)</li>
 * <li>{@link #getYAxisLabelFormatter yAxisLabelFormatter} : string</li>
 * <li>{@link #getYAxis2LabelFormatter yAxis2LabelFormatter} : string</li>
 * <li>{@link #getXAxisLabelFormatter xAxisLabelFormatter} : string</li>
 * <li>{@link #getXAxis2LabelFormatter xAxis2LabelFormatter} : string</li>
 * <li>{@link #getPlotAreaAxisTooltipFormatter plotAreaAxisTooltipFormatter} : object</li>
 * <li>{@link #getTooltipFormatter tooltipFormatter} : object</li>
 * <li>{@link #getDataLabelFormatter dataLabelFormatter} : object</li>
 * <li>{@link #getPopoverFormatter popoverFormatter} : object</li>
 * <li>{@link #getChartSemanticColorFormatter chartSemanticColorFormatter} : object</li>
 * <li>{@link #getInternalVizChart internalVizChart} : sap.ui.core.Control</li>
 * <li>{@link #getPopoverSubHeader popoverSubHeader} : sap.ui.core.Control</li>
 * <li>{@link #getPopoverFooter popoverFooter} : sap.ui.core.Control</li>
 * <li>{@link #getAdvancedChartSettings advancedChartSettings} : object</li>
 * <li>{@link #getNoData noData} : sap.ui.core.Control</li></ul>
 * </li>
 * <li>Aggregations
 * <ul></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.charts.Chart#event:selectDataPoint selectDataPoint} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.charts.Chart#event:popoverBeforeOpen popoverBeforeOpen} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li>
 * <li>{@link sap.ca.ui.charts.Chart#event:popoverAfterOpen popoverAfterOpen} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 

 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Chart implementation on top of sap.viz that takes care of common functionality.
 * - Embedding in a scroll container
 * - Common color palette
 * - Minimum bar / dot / blip ... size
 * - Integration with ChartToolbar and ChartPopover
 * 
 * @extends sap.ui.core.Control
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.Chart
 */
sap.ui.core.Control.extend("sap.ca.ui.charts.Chart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"width" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '100%'},
		"height" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '100%'},
		"dataset" : {type : "object", group : "Data", defaultValue : null},
		"chartType" : {type : "string", group : "Data", defaultValue : 'Bar'},
		"minShapeSize" : {type : "sap.ui.core.CSSSize", group : "Data", defaultValue : '48px'},
		"label" : {type : "string", group : "Data", defaultValue : ''},
		"title" : {type : "string", group : "Appearance", defaultValue : 'Chart'},
		"icon" : {type : "string", group : "Appearance", defaultValue : ''},
		"secondAxisVisible" : {type : "boolean", group : "Appearance", defaultValue : true},
		"showLegend" : {type : "boolean", group : "Behavior", defaultValue : true},
		"selectionMode" : {type : "sap.ca.ui.charts.ChartSelectionMode", group : "Behavior", defaultValue : sap.ca.ui.charts.ChartSelectionMode.Multiple},
		"showHoverBackground" : {type : "boolean", group : "Behavior", defaultValue : false},
		"showTooltip" : {type : "boolean", group : "Behavior", defaultValue : false},
		"showPopover" : {type : "boolean", group : "Behavior", defaultValue : true},
		"showDataLabel" : {type : "boolean", group : "Behavior", defaultValue : true},
		"yAxisLabelFormatter" : {type : "string", group : "Data", defaultValue : null},
		"yAxis2LabelFormatter" : {type : "string", group : "Data", defaultValue : null},
		"xAxisLabelFormatter" : {type : "string", group : "Data", defaultValue : null},
		"xAxis2LabelFormatter" : {type : "string", group : "Data", defaultValue : null},
		"plotAreaAxisTooltipFormatter" : {type : "object", group : "Data", defaultValue : null},
		"tooltipFormatter" : {type : "object", group : "Data", defaultValue : null},
		"dataLabelFormatter" : {type : "object", group : "Data", defaultValue : null},
		"popoverFormatter" : {type : "object", group : "Data", defaultValue : null},
		"chartSemanticColorFormatter" : {type : "object", group : "Data", defaultValue : null},
		"internalVizChart" : {type : "sap.ui.core.Control", group : "Data", defaultValue : null},
		"popoverSubHeader" : {type : "sap.ui.core.Control", group : "Appearance", defaultValue : null},
		"popoverFooter" : {type : "sap.ui.core.Control", group : "Appearance", defaultValue : null},
		"advancedChartSettings" : {type : "object", group : "Appearance", defaultValue : null},
		"noData" : {type : "sap.ui.core.Control", group : "Appearance", defaultValue : null}
	},
	aggregations : {
    	"internalContent" : {type : "sap.ui.core.Control", multiple : false, visibility : "hidden"}, 
    	"chartPopover" : {type : "sap.ui.core.Control", multiple : false, visibility : "hidden"}
	},
	events : {
		"selectDataPoint" : {}, 
		"popoverBeforeOpen" : {}, 
		"popoverAfterOpen" : {}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.Chart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.Chart.extend
 * @function
 */

sap.ca.ui.charts.Chart.M_EVENTS = {'selectDataPoint':'selectDataPoint','popoverBeforeOpen':'popoverBeforeOpen','popoverAfterOpen':'popoverAfterOpen'};


/**
 * Getter for property <code>width</code>.
 * Target width for the charting area
 *
 * Default value is <code>100%</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>width</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getWidth
 * @function
 */

/**
 * Setter for property <code>width</code>.
 *
 * Default value is <code>100%</code> 
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setWidth
 * @function
 */


/**
 * Getter for property <code>height</code>.
 * Target height for the charting area
 *
 * Default value is <code>100%</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>height</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getHeight
 * @function
 */

/**
 * Setter for property <code>height</code>.
 *
 * Default value is <code>100%</code> 
 *
 * @param {sap.ui.core.CSSSize} sHeight  new value for property <code>height</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setHeight
 * @function
 */


/**
 * Getter for property <code>dataset</code>.
 * Viz Dataset that will hold the data to be displayed.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>dataset</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getDataset
 * @function
 */

/**
 * Setter for property <code>dataset</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oDataset  new value for property <code>dataset</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setDataset
 * @function
 */


/**
 * Getter for property <code>chartType</code>.
 * Type of viz chart that will be displayed.
 *
 * Default value is <code>Bar</code>
 *
 * @return {string} the value of property <code>chartType</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getChartType
 * @function
 */

/**
 * Setter for property <code>chartType</code>.
 *
 * Default value is <code>Bar</code> 
 *
 * @param {string} sChartType  new value for property <code>chartType</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setChartType
 * @function
 */


/**
 * Getter for property <code>minShapeSize</code>.
 * Minimum shape size for touch enabled actions, default and minimum to 48px !
 *
 * Default value is <code>48px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>minShapeSize</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getMinShapeSize
 * @function
 */

/**
 * Setter for property <code>minShapeSize</code>.
 *
 * Default value is <code>48px</code> 
 *
 * @param {sap.ui.core.CSSSize} sMinShapeSize  new value for property <code>minShapeSize</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setMinShapeSize
 * @function
 */


/**
 * Getter for property <code>label</code>.
 * User friendly name for the current chart type
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>label</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getLabel
 * @function
 */

/**
 * Setter for property <code>label</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sLabel  new value for property <code>label</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setLabel
 * @function
 */


/**
 * Getter for property <code>title</code>.
 * Title of the chart
 *
 * Default value is <code>Chart</code>
 *
 * @return {string} the value of property <code>title</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getTitle
 * @function
 */

/**
 * Setter for property <code>title</code>.
 *
 * Default value is <code>Chart</code> 
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setTitle
 * @function
 */


/**
 * Getter for property <code>icon</code>.
 * Icon of the Chart
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>icon</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getIcon
 * @function
 */

/**
 * Setter for property <code>icon</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sIcon  new value for property <code>icon</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setIcon
 * @function
 */


/**
 * Getter for property <code>secondAxisVisible</code>.
 * Flag to show the second axis. Default is true
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>secondAxisVisible</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getSecondAxisVisible
 * @function
 */

/**
 * Setter for property <code>secondAxisVisible</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bSecondAxisVisible  new value for property <code>secondAxisVisible</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setSecondAxisVisible
 * @function
 */


/**
 * Getter for property <code>showLegend</code>.
 * Hide / Show the legend of the chart
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showLegend</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getShowLegend
 * @function
 */

/**
 * Setter for property <code>showLegend</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowLegend  new value for property <code>showLegend</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowLegend
 * @function
 */


/**
 * Getter for property <code>selectionMode</code>.
 * Define the selection mode for the chart
 *
 * Default value is <code>Multiple</code>
 *
 * @return {sap.ca.ui.charts.ChartSelectionMode} the value of property <code>selectionMode</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getSelectionMode
 * @function
 */

/**
 * Setter for property <code>selectionMode</code>.
 *
 * Default value is <code>Multiple</code> 
 *
 * @param {sap.ca.ui.charts.ChartSelectionMode} oSelectionMode  new value for property <code>selectionMode</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setSelectionMode
 * @function
 */


/**
 * Getter for property <code>showHoverBackground</code>.
 * Hide / Show the hover background
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showHoverBackground</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getShowHoverBackground
 * @function
 */

/**
 * Setter for property <code>showHoverBackground</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowHoverBackground  new value for property <code>showHoverBackground</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowHoverBackground
 * @function
 */


/**
 * Getter for property <code>showTooltip</code>.
 * Hide / Show the CVOM tooltip
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showTooltip</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getShowTooltip
 * @function
 */

/**
 * Setter for property <code>showTooltip</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowTooltip  new value for property <code>showTooltip</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowTooltip
 * @function
 */


/**
 * Getter for property <code>showPopover</code>.
 * Hide / Show the sap.ca popover that gives information about what is available
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showPopover</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getShowPopover
 * @function
 */

/**
 * Setter for property <code>showPopover</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowPopover  new value for property <code>showPopover</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowPopover
 * @function
 */


/**
 * Getter for property <code>showDataLabel</code>.
 * Flag to display data values on the bar, default is set to true
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showDataLabel</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getShowDataLabel
 * @function
 */

/**
 * Setter for property <code>showDataLabel</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowDataLabel  new value for property <code>showDataLabel</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowDataLabel
 * @function
 */


/**
 * Getter for property <code>yAxisLabelFormatter</code>.
 * Formatter for Y Axis Label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>yAxisLabelFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getYAxisLabelFormatter
 * @function
 */

/**
 * Setter for property <code>yAxisLabelFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sYAxisLabelFormatter  new value for property <code>yAxisLabelFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setYAxisLabelFormatter
 * @function
 */


/**
 * Getter for property <code>yAxis2LabelFormatter</code>.
 * Formatter for Y Axis 2 Label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>yAxis2LabelFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getYAxis2LabelFormatter
 * @function
 */

/**
 * Setter for property <code>yAxis2LabelFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sYAxis2LabelFormatter  new value for property <code>yAxis2LabelFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setYAxis2LabelFormatter
 * @function
 */


/**
 * Getter for property <code>xAxisLabelFormatter</code>.
 * Formatter for X Axis Label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>xAxisLabelFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getXAxisLabelFormatter
 * @function
 */

/**
 * Setter for property <code>xAxisLabelFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sXAxisLabelFormatter  new value for property <code>xAxisLabelFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setXAxisLabelFormatter
 * @function
 */


/**
 * Getter for property <code>xAxis2LabelFormatter</code>.
 * Formatter for X Axis 2 Label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>xAxis2LabelFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getXAxis2LabelFormatter
 * @function
 */

/**
 * Setter for property <code>xAxis2LabelFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sXAxis2LabelFormatter  new value for property <code>xAxis2LabelFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setXAxis2LabelFormatter
 * @function
 */


/**
 * Getter for property <code>plotAreaAxisTooltipFormatter</code>.
 * Formatter for plotArea Axis Tooltip in bubble charts
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>plotAreaAxisTooltipFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getPlotAreaAxisTooltipFormatter
 * @function
 */

/**
 * Setter for property <code>plotAreaAxisTooltipFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oPlotAreaAxisTooltipFormatter  new value for property <code>plotAreaAxisTooltipFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setPlotAreaAxisTooltipFormatter
 * @function
 */


/**
 * Getter for property <code>tooltipFormatter</code>.
 * Formatter for toolTip
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>tooltipFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getTooltipFormatter
 * @function
 */

/**
 * Setter for property <code>tooltipFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oTooltipFormatter  new value for property <code>tooltipFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setTooltipFormatter
 * @function
 */


/**
 * Getter for property <code>dataLabelFormatter</code>.
 * Formatter for Data Label
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>dataLabelFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getDataLabelFormatter
 * @function
 */

/**
 * Setter for property <code>dataLabelFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oDataLabelFormatter  new value for property <code>dataLabelFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setDataLabelFormatter
 * @function
 */


/**
 * Getter for property <code>popoverFormatter</code>.
 * Formatter for popover
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>popoverFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getPopoverFormatter
 * @function
 */

/**
 * Setter for property <code>popoverFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oPopoverFormatter  new value for property <code>popoverFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setPopoverFormatter
 * @function
 */


/**
 * Getter for property <code>chartSemanticColorFormatter</code>.
 * Function that will be called when the chart is rendered in order to let the
 * application decide which color should be use for each bar.
 * The method should take the following parameter as input :
 * - The data context of the current datashape
 * And as output :
 * - One of sap.ca.ui.charts.ChartSemanticColor type
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>chartSemanticColorFormatter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getChartSemanticColorFormatter
 * @function
 */

/**
 * Setter for property <code>chartSemanticColorFormatter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oChartSemanticColorFormatter  new value for property <code>chartSemanticColorFormatter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setChartSemanticColorFormatter
 * @function
 */


/**
 * Getter for property <code>internalVizChart</code>.
 * Retrieve the internal viz chart to allow some operation on it.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.Control} the value of property <code>internalVizChart</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getInternalVizChart
 * @function
 */

/**
 * Setter for property <code>internalVizChart</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.Control} oInternalVizChart  new value for property <code>internalVizChart</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setInternalVizChart
 * @function
 */


/**
 * Getter for property <code>popoverSubHeader</code>.
 * custom subHeader for popover
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.Control} the value of property <code>popoverSubHeader</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getPopoverSubHeader
 * @function
 */

/**
 * Setter for property <code>popoverSubHeader</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.Control} oPopoverSubHeader  new value for property <code>popoverSubHeader</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setPopoverSubHeader
 * @function
 */


/**
 * Getter for property <code>popoverFooter</code>.
 * custom footer for popover
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.Control} the value of property <code>popoverFooter</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getPopoverFooter
 * @function
 */

/**
 * Setter for property <code>popoverFooter</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.Control} oPopoverFooter  new value for property <code>popoverFooter</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setPopoverFooter
 * @function
 */


/**
 * Getter for property <code>advancedChartSettings</code>.
 * You can specify here any advanced viz chart settings that have not been exposed as a chart property.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>advancedChartSettings</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getAdvancedChartSettings
 * @function
 */

/**
 * Setter for property <code>advancedChartSettings</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oAdvancedChartSettings  new value for property <code>advancedChartSettings</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setAdvancedChartSettings
 * @function
 */


/**
 * Getter for property <code>noData</code>.
 * Control tree to display when there is no data available
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {sap.ui.core.Control} the value of property <code>noData</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getNoData
 * @function
 */

/**
 * Setter for property <code>noData</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {sap.ui.core.Control} oNoData  new value for property <code>noData</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setNoData
 * @function
 */


/**
 * Event is fired when the data point is selected/unselected on the chart 
 *
 * @name sap.ca.ui.charts.Chart#selectDataPoint
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'selectDataPoint' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself. 
 *  
 * Event is fired when the data point is selected/unselected on the chart 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#attachSelectDataPoint
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'selectDataPoint' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#detachSelectDataPoint
 * @function
 */

/**
 * Fire event selectDataPoint to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.Chart#fireSelectDataPoint
 * @function
 */


/**
 * Event is fired before the popover is opened 
 *
 * @name sap.ca.ui.charts.Chart#popoverBeforeOpen
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'popoverBeforeOpen' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself. 
 *  
 * Event is fired before the popover is opened 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#attachPopoverBeforeOpen
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'popoverBeforeOpen' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#detachPopoverBeforeOpen
 * @function
 */

/**
 * Fire event popoverBeforeOpen to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.Chart#firePopoverBeforeOpen
 * @function
 */


/**
 * Event is fired after the popover is opened 
 *
 * @name sap.ca.ui.charts.Chart#popoverAfterOpen
 * @event
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'popoverAfterOpen' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself. 
 *  
 * Event is fired after the popover is opened 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.Chart</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#attachPopoverAfterOpen
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'popoverAfterOpen' event of this <code>sap.ca.ui.charts.Chart</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#detachPopoverAfterOpen
 * @function
 */

/**
 * Fire event popoverAfterOpen to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @protected
 * @name sap.ca.ui.charts.Chart#firePopoverAfterOpen
 * @function
 */


// Start of sap\ca\ui\charts\Chart.js
jQuery.sap.require('sap.m.ScrollContainer'); // unlisted dependency retained

jQuery.sap.require('sap.m.ScrollContainer'); // unlisted dependency retained


jQuery.sap.require('sap.ca.ui.charts.ChartSemanticColor'); // unlisted dependency retained

jQuery.sap.require('sap.ca.ui.charts.ChartColor'); // unlisted dependency retained



/**
 * Prepare the creation of the chart layout by creating the internal scroll container that will be displayed
 *
 */
sap.ca.ui.charts.Chart.prototype.init = function () {
    this._oScrollContainer = new sap.m.ScrollContainer(this._createId("scroll"), {
        width:"100%",
        height:"100%"
    });
    this.setAggregation("internalContent", this._oScrollContainer);

    this._oSelectedDataList = new sap.ca.ui.charts.ClusterList(this._createId("clusterList"));
    this._createPopover();
    this.oChartFormatter = sap.ca.ui.charts.ChartFormatter.getInstance();

    this._oMinimumShapeSizes = {
        desktop: 24,
        mobile: 48,
        desktop_px: jQuery.proxy( function() { return this._oMinimumShapeSizes.desktop + "px"; }, this),
        mobile_px: jQuery.proxy( function() { return this._oMinimumShapeSizes.mobile + "px"; }, this)
    };
};

/**
 * create the responsive popover for the chart
 */
sap.ca.ui.charts.Chart.prototype._createPopover = function () {
    var oCustomHeader = new sap.m.Bar(this._createId("popoverHeaderBar"), {
        contentMiddle:[ new sap.m.Label(this._createId("--popoverLabel"), {
            text:sap.ca.ui.utils.resourcebundle.getText("ChartPopover.title")
        })],
        contentRight:(jQuery.device.is.phone) ? [] :
            [new sap.m.Button(this._createId("--popoverCloseButton"), {
                icon:"sap-icon://decline",
                width:"22px",
                press:jQuery.proxy(this._closePopover, this)
            })]
    });
    this._oChartPopover = new sap.m.ResponsivePopover(this._createId("popover"), {
        modal:false,
        enableScrolling:true,
        verticalScrolling:true,
        horizontalScrolling:false,
        placement:sap.m.PlacementType.Auto,
        contentWidth:"100%",
        contentHeight:"100%",
        customHeader:oCustomHeader,
        content:[this._oSelectedDataList.getControl()]
    });
    this._oChartPopover.addStyleClass('sapCaUiChartPopOver');
    this.setAggregation("chartPopover", this._oChartPopover);
    if (!jQuery.device.is.phone) {
        this._oChartPopover._oControl.oPopup.setAutoClose(false);
    }
    //The content of the popover is added in the static UIArea.
    //Thus the first time the popup is opened we avoid a re-renderer.
    var oStatic = sap.ui.getCore().getStaticAreaRef();
    oStatic = sap.ui.getCore().getUIArea(oStatic);
    oStatic.addContent(this._oChartPopover, true);
    this._oChartPopover._bAppendedToUIArea = true;
    this._oChartPopover.attachAfterOpen(null, jQuery.proxy(this._afterOpenPopover, this));
};

/**
 * close the popover for the chart
 */
sap.ca.ui.charts.Chart.prototype._closePopover = function () {
    if (this._oChartPopover) {
        if (this._oChartPopover.isOpen()) {
            this._oChartPopover.close();
        }
    }
};

/**
 * handle the afterOpen event in the popover
 */
sap.ca.ui.charts.Chart.prototype._afterOpenPopover = function () {
    this.firePopoverAfterOpen();
};
/**
 * Make sure that every object that was created and not added to any aggregation are destroyed.
 * Also remove all the handler that were created.
 */
sap.ca.ui.charts.Chart.prototype.exit = function () {
    this._deregisterEvent();
    this._closePopover();
    if (this._oSelectedDataList) {
        this._oSelectedDataList.destroy();
        this._oSelectedDataList = null;
    }
};

/**
 * Remove all event listeners for the resize / orientation change
 *
 * @private
 */
sap.ca.ui.charts.Chart.prototype._deregisterEvent = function () {
    if (jQuery.device.is.desktop) {
        jQuery(window).unbind("resize", jQuery.proxy(this._onResize, this));
    } else {
        sap.ui.Device.orientation.detachHandler(this._onOrientationChange, this);
        sap.ui.Device.resize.detachHandler(this._onResize, this);
    }
};

/**
 * Creates an id for an Element prefixed with the control id
 *
 * @return {string} id
 * @public
 */
sap.ca.ui.charts.Chart.prototype._createId = function (sId) {
    return this.getId() + "-" + sId;
};

sap.ca.ui.charts.Chart.prototype._findInCss = function (rClassName) {
    var matchingRules = [];
    if (!this._sapCaStylesheet) {
        var sapCaStylesheet = null;
        jQuery.each(document.styleSheets, function (iIndex, oStyleSheet) {
            //ie8 doesn't know ownerNode
            if ((!!oStyleSheet.ownerNode && /sap.ca.ui/.test(oStyleSheet.ownerNode.id))
                || (!!oStyleSheet.owningElement && /sap.ca.ui/.test(oStyleSheet.owningElement.id))) {
                sapCaStylesheet = oStyleSheet;
            }
        });
        // In some cases the sap.ca.ui stylesheet is merged with other stylesheet, so in order to find the style
        // we need to be a little bit more aggressive with our search....
        if(sapCaStylesheet == null) {
            // Let's find the node that contain the rule we want as this will be the correct one
            jQuery.each(document.styleSheets, function (iIndex, oStyleSheet) {
                if (oStyleSheet.rules && oStyleSheet.rules.length > 0) {
                    jQuery.each(oStyleSheet.rules, function (iIndexRule, oRule) {
                        if (rClassName.test(oRule.selectorText)) {
                            sapCaStylesheet = oStyleSheet;
                            return false;
                        }
                    });
                } else if (oStyleSheet.cssRules && oStyleSheet.cssRules.length > 0) {
                    jQuery.each(oStyleSheet.cssRules, function (iIndexRule, oRule) {
                        if (rClassName.test(oRule.selectorText)) {
                            sapCaStylesheet = oStyleSheet;
                            return false;
                        }
                    });
                }
                if(sapCaStylesheet) {
                    return false;
                }
            });
        }
        this._sapCaStylesheet = sapCaStylesheet;
    }
    if (this._sapCaStylesheet) {
        if (this._sapCaStylesheet.rules && this._sapCaStylesheet.rules.length > 0) {
            jQuery.each(this._sapCaStylesheet.rules, function (iIndexRule, oRule) {
                if (rClassName.test(oRule.selectorText)) {
                    matchingRules.push(oRule);

                }
            });
        } else if (this._sapCaStylesheet.cssRules && this._sapCaStylesheet.cssRules.length > 0) {
            jQuery.each(this._sapCaStylesheet.cssRules, function (iIndexRule, oRule) {
                if (rClassName.test(oRule.selectorText)) {
                    matchingRules.push(oRule);

                }
            });
        }
    }
    return matchingRules;

};
/**
 * Read the color palette from the css files directly, this is done to allow
 * easy modification depending on the used theme
 *
 * @returns {Array} the color palette for this chart
 * @private
 */
sap.ca.ui.charts.Chart.prototype._getColorPalette = function () {
    if ((!this._aColorPalette) || this._aColorPalette.length === 0) {
        var colorPalette = [];

        var paletteRules = this._findInCss(/.sapCaUiChartColorPalette-/);
        jQuery.each(paletteRules, function (iIndex, oRule) {
            colorPalette.push(oRule.style.color);
        });
        this._aColorPalette = colorPalette;
    }
    return this._aColorPalette;
};

/**
 * Read the color palette from the css files directly, this is done to allow
 * easy modification depending on the used theme
 *
 * @returns {Array} the color palette for this chart
 * @private
 */
sap.ca.ui.charts.Chart.prototype._getSemanticPalette = function () {
    if (!this._aSemanticPalette || !this._aSemanticPalette.length) {
        var semanticPalette = [];
        var that = this;

        function addToPalette(colorType, cssClass) {
            var paletteRule = that._findInCss(cssClass);
            if (paletteRule.length > 0) {
                var oRule = paletteRule[0];
                semanticPalette[colorType] = oRule.style.color;
            }
        }

        addToPalette(sap.ca.ui.charts.ChartSemanticColor.NeutralDark, /.sapCaUiChartSemanticColor-Neutral-Dark/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.Neutral, /.sapCaUiChartSemanticColor-Neutral/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.NeutralLight, /.sapCaUiChartSemanticColor-Neutral-Light/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.GoodDark, /.sapCaUiChartSemanticColor-Good-Dark/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.Good, /.sapCaUiChartSemanticColor-Good/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.GoodLight, /.sapCaUiChartSemanticColor-Good-Light/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.CriticalDark, /.sapCaUiChartSemanticColor-Critical-Dark/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.Critical, /.sapCaUiChartSemanticColor-Critical/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.CriticalLight, /.sapCaUiChartSemanticColor-Critical-Light/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.BadDark, /.sapCaUiChartSemanticColor-Bad-Dark/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.Bad, /.sapCaUiChartSemanticColor-Bad/);
        addToPalette(sap.ca.ui.charts.ChartSemanticColor.BadLight, /.sapCaUiChartSemanticColor-Bad-Light/);

        this._aSemanticPalette = semanticPalette;
    }
    return this._aSemanticPalette;
};
/**
 * Return the secondary color palette based on the first and the number of measure in the measure group
 *
 * @returns {Array} the color palette for this chart
 * @private
 */
sap.ca.ui.charts.Chart.prototype._getSecondaryColorPalette = function (colorPalette) {
    var dataset = this.getDataset();
    var secondaryColorPaletteArr = [];
    if (dataset && dataset.getVIZDataset()) {
        var startIndexSecondaryColorPalette = dataset.getVIZDataset().getMeasureValuesGroupByIdx(0).getMeasureValues().length;
        $.extend(secondaryColorPaletteArr, colorPalette);
        secondaryColorPaletteArr.splice(0, startIndexSecondaryColorPalette);
    }
    return secondaryColorPaletteArr;
};

/**
 * Read the v-datalabel css property from the stylesheet
 *
 * @returns {string} the v-datalabel rule
 * @private
 */
sap.ca.ui.charts.Chart.prototype._getDataLabelCss = function () {
    if (!this._sDataLabelRule) {
        var dataLabelRule = "";
        var dataLabelRules = this._findInCss(/.sapCaUiChart .v-datalabel/);
        if (dataLabelRules.length > 0) {
            var oRule = dataLabelRules[0];
            dataLabelRule = ".v-datalabel {";
            for (var i = 0; i < oRule.style.length; i++) {
                dataLabelRule += oRule.style[i] + ": " + oRule.style[oRule.style[i]] + "; ";
            }
            dataLabelRule += "}";
        }
        this._sDataLabelRule = dataLabelRule;
    }
    return this._sDataLabelRule;
};

sap.ca.ui.charts.Chart.prototype._getDataPointCss = function () {
    if (!this._sDataPointRule) {
        var dataPointRule = "";
        var dataPointRules = this._findInCss(/.sapCaUiChart .v-datapoint/);
        if (dataPointRules.length > 0) {
            var oRule = dataPointRules[0];
            dataPointRule = ".v-datapoint {";
            for (var i = 0; i < oRule.style.length; i++) {
                dataPointRule += oRule.style[i] + ": " + oRule.style[oRule.style[i]] + "; ";
            }
            dataPointRule += "}";
        }
        this._sDataPointRule = dataPointRule;
    }
    return this._sDataPointRule;
};

sap.ca.ui.charts.Chart.prototype._getEMSize = function (input) {
    if (!this._emSize) {
        this._emSize = parseFloat($("body").css("font-size"));
    }
    var pxSize;
    if (jQuery.sap.endsWith(input, "em") || jQuery.sap.endsWith(input, "rem")) {
        pxSize = this._emSize * parseFloat(input);
    } else {
        pxSize = parseFloat(input);
    }
    return pxSize
};

sap.ca.ui.charts.Chart.prototype._getMarkerSize = function () {
    if (!this._iMarkerSize) {
        var iMarkerSize = 0;
        var markerSizeRules = this._findInCss(/.sapCaUiChartMarkerSize/);
        if (markerSizeRules.length > 0) {
            var oRule = markerSizeRules[0];
            var fontSize = oRule.style['font-size'];
            if (fontSize == null) { // IE, Firefox
                fontSize = oRule.style['fontSize']
            }
            iMarkerSize = parseInt(this._getEMSize(fontSize));
        }
        this._iMarkerSize = iMarkerSize;
    }
    return this._iMarkerSize;
};


sap.ca.ui.charts.Chart.prototype._getAlignedScale = function () {
    var scaleMin = 0;
    var scaleMax;
    var scale = null;
    if (this.getDataset()) {
        var crossData = this.getDataset().getVIZDataset();
        var measureGroup = [];

        for (var j = 0; j < crossData.getMeasureValuesGroupByIdx(1).getMeasureValues()[0]._values[0].length; j++) {
            measureGroup.push(crossData.getMeasureValuesGroupByIdx(1).getMeasureValues()[0]._values[0][j] + crossData.getMeasureValuesGroupByIdx(1).getMeasureValues()[1]._values[0][j])
        }

        var measureGroupMax = Math.max.apply(Math, measureGroup);
        var measureGroupMin = Math.min.apply(Math, measureGroup);

        for (var i = 0; i < crossData.getMeasureValuesGroupCount(); i++) {

            var tempMax = Math.max(Math.max.apply(Math, crossData.getMeasureValuesGroupByIdx(i).getMeasureValues()[0]._values[0]), measureGroupMax);
            var tempMin = Math.min(Math.min.apply(Math, crossData.getMeasureValuesGroupByIdx(i).getMeasureValues()[0]._values[0]), measureGroupMin);
            if (!scaleMax) {
                scaleMax = tempMax;
            }
            scaleMin = (scaleMin < tempMin) ? scaleMin : tempMin;
            scaleMax = (scaleMax > tempMax) ? scaleMax : tempMax;
        }

        scaleMax = (scaleMax > 0) ? parseInt(1.05 * scaleMax) : parseInt(0.95 * scaleMax);
        scale = {fixedRange:true, minValue:scaleMin, maxValue:scaleMax};
    }
    return scale;

};

/*
 * Merge the chart settings with the "advanced" chart settings defined by the app
 */
sap.ca.ui.charts.Chart.prototype._getMergedChartSettings = function () {
    var chartSettings = this._getChartSettings();
    return jQuery.extend(true, chartSettings, this.getAdvancedChartSettings());
};


sap.ca.ui.charts.Chart.prototype._getChartSettings = function () {
    // Prepare chart settings
    var colorPalette = this._getColorPalette().concat();
    if (this.getDataset()) {
        var semanticChartPalette = this._getSemanticPalette();
        if (this._vizChartType.name != sap.ca.ui.charts.ChartType.Bubble) {

            var measures = this.getDataset().getMeasures();
            for (var i = 0; i < measures.length; i++) {
                var fillColor = measures[i].data("fillColor");
                if (fillColor != null && semanticChartPalette.hasOwnProperty(fillColor)) {
                    colorPalette.splice(i, 0, semanticChartPalette[fillColor]);
                }
            }
        }
        else {
            var dimensions = this.getDataset().getDimensions();
            var analysisAxis = this.getDataset().getVIZDataset()._dataSet.analysisAxis[0].data;
            var colorPaletteMap = {};
            for (var i = 0; i < dimensions.length; i++) {
                // Map of the color per value
                var fillColors = dimensions[i].data("fillColors");
                if(fillColors != null) {

                    for(var j = 0; j < analysisAxis.length; j++) {
                        if(analysisAxis[j].name == dimensions[i].getName()) {
                            var values = analysisAxis[j].values;
                            var uniqueValues = [];
                            jQuery.each(values, function(i, el){
                                if(jQuery.inArray(el, uniqueValues) === -1) uniqueValues.push(el);
                            });
                            for(var k = 0; k < uniqueValues.length; k++) {
                                if(fillColors.hasOwnProperty(uniqueValues[k])) {
                                    colorPaletteMap[k] = sap.ui.core.theming.Parameters.get(fillColors[uniqueValues[k]]);
                                    var colorPaletteIdx = jQuery.inArray(colorPaletteMap[k], colorPalette);
                                    if(colorPaletteIdx != -1) {
                                        colorPalette.splice(colorPaletteIdx, 1);
                                    }
                                }
                            }
                        }
                    }

                }
            }
            for(var paletteIdx in colorPaletteMap) {
                colorPalette.splice(paletteIdx, 0, colorPaletteMap[paletteIdx]);
            }

        }

    }
    var chartSettings = {
        width:"100%",
        height:"100%",
        general : {
            layout : {
                padding : 0
            }
        },
        plotArea:{
            colorPalette:colorPalette,
            marker:{
                visible:true,
                size:this._getMarkerSize()
            },
            axisTooltip:{
                formatString:this.getProperty("plotAreaAxisTooltipFormatter")
            },
            animation:{
                dataLoading:true,
                dataUpdating:true,
                resizing:false
            }
        },
        title:{
            visible:false
        },
        dataLabel:{
            visible:this.getProperty("showDataLabel"),
            position:this._vizChartType.dataLabelPosition,
            formatString:this.getProperty("dataLabelFormatter")
        },
        legend:{
            visible:this.getShowLegend(),
            isScrollable : true
        },
        tooltip:{
            visible:this.getShowTooltip(),
            formatString:this.getProperty("tooltipFormatter")
        },

        hoverline:{
            visible:this._vizChartType.showHoverLine
        },
        interaction:{
            supportLassoEvent:false,
            selectability:{
                mode:this.getSelectionMode().toLowerCase()
            }
        },
        background:{
            visible:true,
            border:{
                left:{
                    visible:false
                },
                right:{
                    visible:false
                },
                bottom:{
                    visible:true
                },
                top:{
                    visible:true
                }
            }
        },
        xAxis:{
            label:{
                formatString:this.getProperty("xAxisLabelFormatter")
            }
        },
        xAxis2:{
            label:{
                formatString:this.getProperty("xAxis2LabelFormatter")
            },
            visible:this.getProperty("secondAxisVisible")
        },
        yAxis:{
            label:{
                formatString:this.getProperty("yAxisLabelFormatter")
            }
        },
        yAxis2:{
            label:{
                formatString:this.getProperty("yAxis2LabelFormatter")
            },
            visible:this.getProperty("secondAxisVisible")
        }
    };
    if (this._vizChartType.dualAxis) {
        chartSettings.plotArea.primaryValuesColorPalette = colorPalette;
        chartSettings.plotArea.secondaryValuesColorPalette = this._getSecondaryColorPalette(colorPalette);
        if (!this.getProperty("secondAxisVisible") && this._vizChartType.alignScales) {
            var alignedScales = this._getAlignedScale();
            chartSettings.yAxis2.scale = alignedScales;
            chartSettings.yAxis.scale = alignedScales;
        }
    }
    return chartSettings;
};

/**
 * This is called after all the properties are set on the control.
 * At this point we can initalize the internal chart without any problem
 *
 * @inherit
 */
sap.ca.ui.charts.Chart.prototype.applySettings = function (mSettings, oScope) {
    sap.ui.core.Control.prototype.applySettings.apply(this, arguments);
    this._initChart();
};

sap.ca.ui.charts.Chart.prototype._initChart = function () {
    this._vizChartType = sap.ca.ui.charts.ChartType.getChartProperties(this.getChartType());

    var chartSettings = this._getMergedChartSettings();

    if (this._vizChartType != null) {
        this.setLabel(this._vizChartType.displayLabel);

        // If the icon has not been set, use the default one for this chart type
        if (this.getIcon() == "") {
            this.setProperty("icon", this._vizChartType.icon);
        }
        if (this._oInternalVizChart != null) {
            this._oInternalVizChart.destroy();
        }
        // Tooltip is reserved in UI5 naming so doing that create issue for us
        chartSettings.tooltip = null;
        this._oInternalVizChart = new sap.viz.ui5[this._vizChartType.name](this._createId("vizChart"), chartSettings);
        this._oInternalVizChart.addDelegate({
            onAfterRendering:function () {
                this._onResizeInt();
            }
        }, true, this);

        this._oInternalVizChart.attachBeforeCreateViz(function (oEvent) {
            var oUsrOptions = oEvent.getParameter("usrOptions");
            if (this._vizChartType.vizType) {
                oUsrOptions.type = this._vizChartType.vizType;
            }
            oUsrOptions.css = this._getDataLabelCss() + this._getDataPointCss();
            oUsrOptions.options = this._getMergedChartSettings();
        }, this);

        this._oScrollContainer.addContent(this._oInternalVizChart);

        this._oScrollContainer.setVertical(this._vizChartType.scroll.vertical);
        this._oScrollContainer.setHorizontal(this._vizChartType.scroll.horizontal);

        this._oInternalVizChart.attachInitialized(this.onChartInitialized, this);
        this._oInternalVizChart.attachSelectData(this.onSelectData, this);
        this._oInternalVizChart.attachDeselectData(this.onDeselectData, this);
        if (jQuery.sap.touchEventMode == "ON" && jQuery.device.is.tablet) {
            //Close the popover when we scroll on a tablet
            this._oInternalVizChart.attachBrowserEvent("touchmove",jQuery.proxy(this._closePopover, this));
        }
        this.setMinShapeSize();
    } else {
        jQuery.sap.log.error("Cannot instantiate the Chart control, " + this.getVizType() + " is not a recognized type");
    }
};

/**
 * Create or update local bindings.
 *
 * Called when model or binding contexts have changed. Creates bindings when the model was not available
 * at the time bindProperty or bindAggregation was called. Recreates the bindings when they exist already
 * and when the model has changed.
 *
 * @param {boolean} bUpdateAll forces an update of all bindings, sModelName will be ignored
 * @param {string|undefined} sModelName name of a model whose bindings should be updated
 *
 * @private
 */
sap.ca.ui.charts.Chart.prototype.updateBindings = function (bUpdateAll, sModelName) {
    sap.ui.core.Control.prototype.updateBindings.apply(this, arguments);
};

sap.ca.ui.charts.Chart.prototype.invalidate = function (oOrigin, bInvalidateSize) {
    if (bInvalidateSize) {
        // Delay the invalidation for a few second in case of subsequent resize
        if (this._sInvalidateDelay) {
            jQuery.sap.clearDelayedCall(this._sInvalidateDelay);
        }
        this._sInvalidateDelay = jQuery.sap.delayedCall(200, this, sap.ui.core.Control.prototype.invalidate, arguments);
    } else {
        sap.ui.core.Control.prototype.invalidate.apply(this, arguments);
    }
};

sap.ca.ui.charts.Chart.prototype.setChartType = function (oType) {
    this.setProperty("chartType", oType);
    this.setProperty("icon", "");
    this._vizChartType = sap.ca.ui.charts.ChartType.getChartProperties(this.getChartType());
    this._initChart();

    return this;
};

/**
 * Setter for property <code>title</code>.
 *
 * Default value is <code>Chart</code>
 *
 * @param {string} sTitle  new value for property <code>title</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setTitle
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setTitle = function (sTitle) {
    this.setProperty("title", sTitle);
    return this;
};

/**
 * Setter for property <code>internalVizChart</code>.
 *
 * Default value is <code>oChart</code>
 *
 * @param {sap.viz.ui5.BaseChart} oInternalVizChart  new value for property <code>title</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setTitle
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setInternalVizChart = function (oInternalVizChart) {
    // We don't accept public setter
    jQuery.sap.log.warning("InternalVizChart cannot be set from outside a sap.ca.ui.chart.Chart class.");
    return this;
};

/**
 * Setter for property <code>dataset</code>.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @param {sap.viz.ui5.data.Dataset} oDataset  new value for property <code>dataset</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setDataset
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setDataset = function (oDataset) {
    this._oInternalVizChart.setDataset(oDataset);
    this.setProperty("dataset", oDataset);
    return this;
};

/**
 * Getter for property <code>dataset</code>.
 * Viz Dataset that will hold the data to be displayed.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} oDataset the value of property <code>dataset</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getDataset
 * @function
 */
sap.ca.ui.charts.Chart.prototype.getDataset = function () {
    var dataset = null;
    if (this._oInternalVizChart) {
        dataset = this._oInternalVizChart.getDataset();
    }
    return dataset;
};
/**
 * Getter for property <code>internalVizChart</code>.
 * internal Viz Chart
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} oInternalVizChart the value of property <code>internalVizChart</code>
 * @public
 * @name sap.ca.ui.charts.Chart#getInternalVizChart
 * @function
 */
sap.ca.ui.charts.Chart.prototype.getInternalVizChart = function () {
    return this._oInternalVizChart;
};

/**
 * Catch the setModel call and make sure we refresh the size of the chart.
 *
 * @param {sap.ui.model.Model} oModel the model to be set or <code>null</code> or <code>undefined</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setModel
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setModel = function (oModel) {
    if (this._oSelectedDataList) {
        this._oSelectedDataList.reset();
    }
    sap.ui.core.Control.prototype.setModel.apply(this, arguments);
    return this;
};


/**
 * Setter for property <code>height</code>.
 *
 * Default value is <code>100%</code>
 *
 * @param {sap.ui.core.CSSSize} sHeight  new value for property <code>height</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setHeight
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setHeight = function (sHeight) {
    this.setProperty("height", sHeight);
    return this;
};

/**
 * Setter for property <code>width</code>.
 *
 * Default value is <code>100%</code>
 *
 * @param {sap.ui.core.CSSSize} sWidth  new value for property <code>width</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setWidth
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setWidth = function (sWidth) {
    this.setProperty("width", sWidth);
    return this;
};

/**
 * Setter for property <code>showLegend</code>.
 *
 * Default value is <code>true</code>
 *
 * @param {boolean} bShowLegend  new value for property <code>showLegend</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setShowLegend
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setShowLegend = function (bShowLegend) {
    this.setProperty("showLegend", bShowLegend);
    if (this._oInternalVizChart) {
        this._oInternalVizChart.getLegend().setVisible(bShowLegend)
    }
    return this;
};

sap.ca.ui.charts.Chart.prototype.setShowTooltip = function (bShowTooltip) {
    this.setProperty("showTooltip", bShowTooltip);
    if (this._oInternalVizChart) {
        var tooltip = this._oInternalVizChart.getTooltip();
        if (tooltip.setVisible) {
            tooltip.setVisible(bShowTooltip);
        }
        if (tooltip.setEnabled) {
            tooltip.setEnabled(bShowTooltip);
        }
    }
    return this;
};

/**
 * Setter for property <code>selectionMode</code>.
 *
 * Default value is <code>Multi</code>
 *
 * @param {sap.ca.ui.charts.ChartSelectionMode} oSelectionMode  new value for property <code>selectionMode</code>
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setSelectionMode
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setSelectionMode = function (oSelectionMode) {
    this.setProperty("selectionMode", oSelectionMode);
    if (this._oInternalVizChart) {
        this._oInternalVizChart.getInteraction().getSelectability().setSelectionMode(oSelectionMode.toLowerCase())
    }
    return this;
};

/**
 * Setter for property <code>xAxisLabelFormatter</code>.
 *
 *
 * @param {object} formatter  new value for property <code>xAxisLabelFormatter</code>
 *        formatter can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#xAxisLabelFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setXAxisLabelFormatter = function (formatter) {
    var formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "xAxisLabelFormatter", formatter);
    this.setProperty("xAxisLabelFormatter", formatString);
    return this;
};

/**
 * Setter for property <code>xAxis2LabelFormatter</code>.
 *
 *
 * @param {object} formatter  new value for property <code>xAxis2LabelFormatter</code>
 *        formatter can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#xAxis2LabelFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setXAxis2LabelFormatter = function (formatter) {
    var formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "xAxis2LabelFormatter", formatter);
    this.setProperty("xAxis2LabelFormatter", formatString);
    return this;
};

/**
 * Setter for property <code>yAxisLabelFormatter</code>.
 *
 *
 * @param {object} formatter  new value for property <code>yAxisLabelFormatter</code>
 *        formatter can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#yAxisLabelFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setYAxisLabelFormatter = function (formatter) {
    var formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "yAxisLabelFormatter", formatter);
    this.setProperty("yAxisLabelFormatter", formatString);
    return this;
};

/**
 * Setter for property <code>yAxis2LabelFormatter</code>.
 *
 *
 * @param {object} formatter  new value for property <code>yAxis2LabelFormatter</code>
 *        formatter can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#yAxis2LabelFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setYAxis2LabelFormatter = function (formatter) {
    var formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "yAxis2LabelFormatter", formatter);
    this.setProperty("yAxis2LabelFormatter", formatString);
    return this;
};

/**
 * Setter for property <code>dataLabelFormatter</code>.
 *
 *
 * @param {object} formatterArray  new value for property <code>dataLabelFormatter</code>
 *        [formatterArray] must be a 2 dimensions array of formatters.
 *            [  [ measure 1 of X Axis , ...,  [measure n of X Axis] ],
 *               [ measure 1 of X Axis 2 , ...,  [measure n of X Axis 2] ]
 *        Each of these formatters can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 *        If for an axis, formatters count < measures count, then first formatter of axis will be used
 *        for other measures.

 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#dataLabelFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setDataLabelFormatter = function (formatterArray) {
    var formatString;
    var formatStringArray = [
        []
    ];
    if (Array.isArray(formatterArray)) {
        for (var i = 0; i < formatterArray.length; i++) {
            if (Array.isArray(formatterArray[i])) {
                if (i > 0) {
                    formatStringArray.push([]);
                }
                for (var j = 0; j < formatterArray[i].length; j++) {
                    formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "dataLabelFormatter" + i + "-" + j, formatterArray[i][j]);
                    formatStringArray[i][j] = formatString;
                }
            }
            else {
                jQuery.sap.log.error("dataLabelFormatter must be an array of arrays");
                return this;
            }
        }
    }
    else {
        jQuery.sap.log.error("dataLabelFormatter must be an array of arrays");
        return this;
    }
    this.setProperty("dataLabelFormatter", formatStringArray);
    return this;
};


/**
 * Setter for property <code>plotAreaAxisTooltipFormatter</code>.
 *
 *
 * @param {object} [formatterArray] new value for property <code>plotAreaAxisTooltipFormatter</code>
 *        This is the tooltip for "bubbles" of bubble chart.
 *        [formatterArray] must be an array of 2 formatters (one for X Axis, one for Y axis).
 *        Each of these formatters can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#setPlotAreaAxisTooltipFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setPlotAreaAxisTooltipFormatter = function (formatterArray) {
    var formatString;
    var formatStringArray = [];
    if (Array.isArray(formatterArray)) {
        for (var i = 0; i < formatterArray.length; i++) {
            formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "plotAreaAxisTooltipFormatter" + i, formatterArray[i]);
            formatStringArray[i] = formatString;
        }
    }
    else {
        jQuery.sap.log.error("plotAreaAxisTooltipFormatter must be an array");
        return this;
    }
    this.setProperty("plotAreaAxisTooltipFormatter", formatStringArray);
    return this;
};

/**
 * Setter for property <code>tooltipFormatter</code>.
 *
 *
 * @param {object} formatterArray  new value for property <code>tooltipFormatter</code>
 *        [formatterArray] must be a 2 dimensions array of formatters.
 *            [  [ measure 1 of X Axis , ...,  [measure n of X Axis] ],
 *               [ measure 1 of X Axis 2 , ...,  [measure n of X Axis 2] ]
 *        Each of these formatters can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 *        If for an axis, formatters count < measures count, then first formatter of axis will be used
 *        for other measures.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#tooltipFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setTooltipFormatter = function (formatterArray) {
    var formatString;
    var formatStringArray = [
        []
    ];
    if (Array.isArray(formatterArray)) {
        for (var i = 0; i < formatterArray.length; i++) {
            if (Array.isArray(formatterArray[i])) {
                if (i > 0) {
                    formatStringArray.push([]);
                }
                for (var j = 0; j < formatterArray[i].length; j++) {
                    formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "tooltipFormatter" + i + "-" + j, formatterArray[i][j]);
                    formatStringArray[i][j] = formatString;
                }
            }
            else {
                jQuery.sap.log.error("tooltipFormatter must be an array of arrays");
                return this;
            }
        }
    }
    else {
        jQuery.sap.log.error("tooltipFormatter must be an array of arrays");
        return this;
    }
    this.setProperty("tooltipFormatter", formatStringArray);
    return this;
};

/**
 * Setter for property <code>popoverFormatter</code>.
 *
 *
 * @param {object} formatterArray  new value for property <code>popoverFormatter</code>
 *        [formatterArray] must be a 2 dimensions array of formatters.
 *            [  [ measure 1 of X Axis , ...,  [measure n of X Axis] ],
 *               [ measure 1 of X Axis 2 , ...,  [measure n of X Axis 2] ]
 *        Each of these formatters can be:
 *          - a custom formatting function
 *          - a value of enum sap.ca.ui.charts.DefaultFormatterFunction
 *        If for an axis, formatters count < measures count, then first formatter of axis will be used
 *        for other measures.

 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#popoverFormatter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setPopoverFormatter = function (formatterArray) {
    var formatString;
    var formatStringArray = [
        []
    ];
    if (Array.isArray(formatterArray)) {
        for (var i = 0; i < formatterArray.length; i++) {
            if (Array.isArray(formatterArray[i])) {
                if (i > 0) {
                    formatStringArray.push([]);
                }
                for (var j = 0; j < formatterArray[i].length; j++) {
                    formatString = this.oChartFormatter.addFormatter(this._oInternalVizChart, "popoverFormatter" + i + "-" + j, formatterArray[i][j]);
                    formatStringArray[i][j] = formatString;
                }
            }
            else {
                jQuery.sap.log.error("popoverFormatter must be an array of arrays");
                return this;
            }
        }
    }
    else {
        jQuery.sap.log.error("popoverFormatter must be an array of arrays");
        return this;
    }
    this.setProperty("popoverFormatter", formatStringArray);
    return this;
};

/**
 * Setter for property <code>advancedChartSettings</code>.
 *
 *
 * @param {object} settings
 * You can specify here any advanced viz chart settings that have not been exposed as a chart property.
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#advancedChartSettings
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setAdvancedChartSettings = function (settings) {
    this.setProperty("advancedChartSettings", settings);
    return this;
};

/**
 * Setter for property <code>minShapeSize</code>.
 * Note: doesn't work for the bubble chart's bubbles sizes.
 *
 * @param {string} sMinShapeSize Minimum shape size in pixels.
 *
 * @return {sap.ca.ui.charts.Chart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.Chart#minShapeSize
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setMinShapeSize = function (sMinShapeSize) {

    if (jQuery.device.is.desktop) {
        if(typeof sMinShapeSize !== "undefined")jQuery.sap.log.warning("MinShapeSize must be 24px for desktop. Forcing to 24px.");
        sMinShapeSize = this._oMinimumShapeSizes.desktop_px();
    } else {
        if(typeof sMinShapeSize !== "undefined")jQuery.sap.log.warning("MinShapeSize must be 48px to be clickable on mobile. Forcing to 48px.");
        sMinShapeSize = this._oMinimumShapeSizes.mobile_px();
    }
    this.setProperty("minShapeSize", sMinShapeSize);
    return this;
};

/**
 *  =============
 *  Event Handling
 *  =============
 **/

/**
 * Function that is called after the chart has been rendered
 *
 * @param oEvent viz initialized event that is triggered when the chart has been rendered
 */
sap.ca.ui.charts.Chart.prototype.onChartInitialized = function (oEvent) {
//    Using a code like this we can ask the team to implement a simple callback that would
//    take the datapoint details (with the context / values etc) return us a semantic color value from the type
//    and use this to color the datashape.


    var semanticCallback = this.getChartSemanticColorFormatter();
    if (semanticCallback != null) {
        var chart = d3.select(this._oInternalVizChart.getDomRef()).select('.v-m-root');
        var semanticPalette = this._getSemanticPalette();
        chart.selectAll('g.v-datashape').selectAll('rect').attr('fill', function (d) {
            var semanticColorType = semanticCallback(d);
            var fillColor = d.fillColor;
            if (semanticPalette.hasOwnProperty(semanticColorType)) {
                fillColor = semanticPalette[semanticColorType]
            }
            return fillColor;
        })
        chart.selectAll('g.v-datashape').selectAll('path').attr('fill', function (d) {
            var semanticColorType = semanticCallback(d);
            var fillColor = d.fillColor;
            if (semanticPalette.hasOwnProperty(semanticColorType)) {
                fillColor = semanticPalette[semanticColorType]
            }
            return fillColor;
        })
    }
};

/**
 * Function that is called after a shape has been selected
 *
 * @param oEvent viz selectData event that is triggered when the chart has been rendered
 */
sap.ca.ui.charts.Chart.prototype.onSelectData = function (oEvent) {
    var aSelection = this._oInternalVizChart.selection();
    var selectedItem = null;
    if (aSelection.length > 0) {
        selectedItem = aSelection[aSelection.length - 1];
    }
    if (this.getShowPopover()) {
        var oData = oEvent.getParameter("data");
        var oTarget = oData[oData.length - 1].target;
        for (var p = 0; p < oData.length; p++) {
            for (var q = 0; q < oData[p].data.length; q++) {
                if (!oData[p].data[q] || !oData[p].data[q].ctx || !oData[p].data[q].val) {
                    continue;
                }
                var oContext = oData[p].data[q].ctx;
                var oColor = oData[p].target.attributes.fill.value;

                var sValue = oData[p].data[q].val;
                var vizDataset = this._oInternalVizChart.getDataset().getVIZDataset();
                var dimAxis1 = vizDataset._analysisAxis[0]._dimensionLabels;
                var measureValuesGroup = vizDataset._measureValuesGroup;
                var measures = measureValuesGroup[oContext.path.mg].getMeasureValues();
                var sMeasureName = measures[oContext.path.mi]._uId;
                var sAxisName = "";
                var aGroupKey = [];
                if (oContext.type === 'Measure') {
                    var path = oContext.path;
                    var sKey = path.dii_a1.toString();
                    sKey += path.dii_a2.toString();
                    sKey += path.mg.toString();
                    sKey += path.mi.toString();
                    var that = this;
                    jQuery.each(dimAxis1, function (i, dimension) {
                        sAxisName = dimension._values[oContext.path.dii_a1];
                        aGroupKey.push(sAxisName);
                        if (that._oSelectedDataList.getGroupIndexFor(aGroupKey) === -1) {
                            that._oSelectedDataList.addGroup({
                                key:aGroupKey,
                                title:sAxisName
                            });
                        }
                    });
                    var formatString = "";
                    if (!this.getProperty("popoverFormatter") || !Array.isArray(this.getProperty("popoverFormatter")) ||
                        this.getProperty("popoverFormatter").length < oContext.path.mg || !this.getProperty("popoverFormatter")[oContext.path.mg] || !Array.isArray(this.getProperty("popoverFormatter")[oContext.path.mg]) ||
                        this.getProperty("popoverFormatter")[oContext.path.mg].length == 0) {
                        formatString = sap.ca.ui.charts.DefaultFormatterFunction.STANDARDNUMBER;
                    }
                    else {
                        if (this.getProperty("popoverFormatter")[oContext.path.mg].length < oContext.path.mi) {
                            formatString = this.getProperty("popoverFormatter")[oContext.path.mg][0];
                        }
                        else {
                            formatString = this.getProperty("popoverFormatter")[oContext.path.mg][oContext.path.mi];
                        }
                    }

                    if (this._oSelectedDataList.getItemIndexFor(aGroupKey, sKey) === -1) {
                        this._oSelectedDataList.addItemTo(aGroupKey, [
                            {
                                key:sKey,
                                color:oColor,
                                label:sMeasureName,
                                value:this.oChartFormatter.format(sValue.toString(), formatString)
                            }
                        ]);
                    }
                }
            }
        }
        this.firePopoverBeforeOpen({isOpen: this._oChartPopover.isOpen(), openBy: oTarget, selection:aSelection});
        if (!this._oChartPopover.isOpen()) {
            if (oTarget.width != null) {
                this._oChartPopover.setOffsetX(Math.floor(oTarget.width.baseVal.value));
                this._oChartPopover.setOffsetY(Math.floor((oTarget.height.baseVal.value / 2)));
            }

            if (this._vizChartType.name == sap.ca.ui.charts.ChartType.Bubble) {
                if (oTarget && oTarget.getBoundingClientRect()) {
                    var iBoundingWidth = oTarget.getBoundingClientRect().width;
                    var iBoundingHeight = oTarget.getBoundingClientRect().height;
                    if (iBoundingWidth) {
                        this._oChartPopover.setOffsetX(Math.floor(iBoundingWidth / 2));
                        this._oChartPopover.setOffsetY(Math.floor(iBoundingHeight / 2));
                    }
                }
            }
            if (!jQuery.device.is.phone) {
                this._oChartPopover._oControl.$().css("max-height:" + this._oInternalVizChart.getHeight());
            }
            this._oChartPopover.openBy(oTarget);
        }
    }
    this.fireSelectDataPoint({
        popover:this._oChartPopover,
        srcEvent:oEvent,
        selection:aSelection,
        selectedItem:selectedItem
    });
};

/**
 * Function that is called after a shape has been deselected
 *
 * @param oEvent viz deselectData event that is triggered when the chart has been rendered
 */
sap.ca.ui.charts.Chart.prototype.onDeselectData = function (oEvent) {
    var aSelection = this._oInternalVizChart.selection();
    if (this.getShowPopover()) {
        if (aSelection.length == 0) {
            this._oSelectedDataList.reset();
            this._closePopover();
        } else {
            var oData = oEvent.getParameter("data");
            for (var p = 0; p < oData.length; p++) {
                for (var q = 0; q < oData[p].data.length; q++) {
                    if (!oData[p].data[q] || !oData[p].data[q].ctx || !oData[p].data[q].val) {
                        continue;
                    }

                    var oContext = oData[p].data[q].ctx;
                    if (oContext.type == 'Measure') {
                        var path = oContext.path;
                        var sKey = path.dii_a1.toString();
                        sKey += path.dii_a2.toString();
                        sKey += path.mg.toString();
                        sKey += path.mi.toString();
                        var vizDataset = this._oInternalVizChart.getDataset().getVIZDataset();
                        var dimAxis1 = vizDataset._analysisAxis[0]._dimensionLabels;
                        var sAxisName = "";

                        var aGroupKey = [];
                        jQuery.each(dimAxis1, function (i, dimension) {
                            aGroupKey.push(dimension._values[oContext.path.dii_a1]);
                        });

                        if (this._oSelectedDataList.getItemIndexFor(aGroupKey, sKey) !== -1) {
                            this._oSelectedDataList.removeItemFrom(aGroupKey, sKey);
                        }
                        if (this._oSelectedDataList.getNumberOfItemsFor(aGroupKey) === 0) {
                            this._oSelectedDataList.removeGroup(aGroupKey);
                        }
                    }
                }
            }
        }
    }
    this.fireSelectDataPoint({
        popover:this._oChartPopover,
        srcEvent:oEvent,
        selection:this._oInternalVizChart.selection(),
        selectedItem:null
    });
};

/**
 * Function is called before the rendering of the control is started.
 *
 * Applications must not call this hook method directly, it is called by the framework.
 *
 * Subclasses of Control should override this hook to implement any necessary actions before the rendering.
 *
 * @function
 * @name sap.ui.core.Control.prototype.onBeforeRendering
 * @protected
 */
sap.ca.ui.charts.Chart.prototype.onBeforeRendering = function () {
    this._deregisterEvent();

};

/**
 * Function is called when the rendering of the control is completed.
 *
 * Applications must not call this hook method directly, it is called by the framework.
 *
 * Subclasses of Control should override this hook to implement any necessary actions after the rendering.
 *
 * @function
 * @name sap.ui.core.Control.prototype.onAfterRendering
 * @protected
 */
sap.ca.ui.charts.Chart.prototype.onAfterRendering = function () {

    if (jQuery.device.is.desktop) {
        jQuery(window).bind("resize", jQuery.proxy(this._onResize, this));
    } else {
        sap.ui.Device.orientation.attachHandler(this._onOrientationChange, this);
        sap.ui.Device.resize.attachHandler(this._onResize, this);
    }

};

/**
 * Function to calculate the size of the chart to display.
 * It is based on the vizdataset by looking at the dimension in each analysis axis.
 *
 * The size of the chart is also defined based on the available space in the chart or its container.
 * Special handling is done for the ChartToolbar integration case.
 *
 * @private
 */
sap.ca.ui.charts.Chart.prototype._onResize = function () {
    if (this._sDelayedResize) {
        jQuery.sap.clearIntervalCall(this._sDelayedResize);
    }
    this._sDelayedResize = jQuery.sap.delayedCall(200, this, this._onResizeInt);
};

sap.ca.ui.charts.Chart.prototype._onResizeInt = function () {
    this._closePopover();
    var dataset = this._oInternalVizChart.getDataset();
    if (!dataset) {
        return;
    }
    var vizDataset = dataset.getVIZDataset();
    var iShapeSize = parseInt(this.getMinShapeSize());
    if (vizDataset && !vizDataset._emptyDataset && vizDataset._analysisAxis.length > 0) {
        // Number of data point is derived from the multiplication of both analysis axises length.
        var iShapeCount = vizDataset._analysisAxis[0]._dimensionLabels[0]._values.length;
        var iPaddingCount = iShapeCount;
        var iSpacingCount = 0;

        // Handle the rare case where we are in a stacked chart but don't have multiple measure to display...
        if (vizDataset._analysisAxis[1] != null) {
            iShapeCount *= vizDataset._analysisAxis[1]._dimensionLabels[0]._values.length;
            iSpacingCount = iShapeCount;
        }
        if (!this._vizChartType.stacked) {
            iShapeCount *= vizDataset._measures.length;
            iSpacingCount = iShapeCount * (vizDataset._measures.length - 1)
        }
        var calculatedSize = (iShapeCount * iShapeSize) + (iPaddingCount * iShapeSize) + (iSpacingCount * 4);

        var initialWidth = this.getWidth();
        var initialHeight = this.getHeight();
        var initialWidthI = parseInt(initialWidth);
        var initialHeightI = parseInt(initialHeight);

        if (jQuery.sap.endsWith(initialWidth, "%") || initialWidth == "auto") {
            // Try to read from DomRef if possible at that point
            // Either the domRef exists (cool), or its parent has already been rendered (also cool)
            // Or we need to get the size from the UIArea...
            if (this.getParent() != null && this.getParent().getDomRef() != null) {
                var $DomRef = this.$();
                var $PageSection = $DomRef.parents('.sapMPage').first();
                var $ParentSection = $PageSection.children('section').first();
                var hiddenSection = $ParentSection.parents('.sapMNavItemHidden');
                if(hiddenSection.length != 0) {
                    hiddenSection.removeClass('sapMNavItemHidden');
                }
                if ($ParentSection.length == 0) {
                    $ParentSection = this.getParent().$().parents('section').first();
                }
                if ($ParentSection.length == 0) {
                    $ParentSection = $DomRef.parents('body').first();
                }


                var iSectionWidth = $ParentSection.width();
                var iSectionOffsetLeft = 0;
                if ($ParentSection && $ParentSection.offset()) {
                    iSectionOffsetLeft = $ParentSection.offset().left;
                }
                var iEltOffsetLeft = 0;
                if ($DomRef && $DomRef.offset()) {
                    iEltOffsetLeft = $DomRef.offset().left;
                }

                var iEltOffsetRight = 1;
                // try to find out if there is a padding-bottom / margin-bottom in between here and the section
                var $ParentDom = $DomRef;//this.getParent().$();
                while ($ParentDom != null && $ParentDom.length != 0 && $ParentDom.attr("id") != $ParentSection.attr("id")) {
                    var marginRight = parseInt($ParentDom.css("margin-right"));
                    var paddingRight = parseInt($ParentDom.css("padding-right"));
                    var borderRight = parseInt($ParentDom.css("border-right-width"));
                    if (!isNaN(marginRight)) {
                        iEltOffsetRight += marginRight;
                    }
                    if (!isNaN(paddingRight)) {
                        iEltOffsetRight += paddingRight;
                    }
                    if (!isNaN(borderRight)) {
                        iEltOffsetRight += borderRight;
                    }
                    $ParentDom = $ParentDom.parent();
                }
                if(hiddenSection.length != 0) {
                    hiddenSection.addClass('sapMNavItemHidden');
                }
                initialWidthI = (iSectionWidth - (iEltOffsetLeft - iSectionOffsetLeft) - iEltOffsetRight);
            } else if (this.getUIArea()) {
                initialWidthI = jQuery(this.getUIArea().oRootNode).width();
            } else {
                initialWidthI = "800";
            }

            // Apply the actual percent to the size
            initialWidthI = (initialWidthI * parseInt(initialWidth)) / 100;
        }
        if (jQuery.sap.endsWith(initialHeight, "%") || initialHeight == "auto") {
            // Try to read from DomRef if possible at that point
            // Either the domRef exists (cool), or its parent has already been rendered (also cool)
            // When the parent is a VBox though the height will never be set prior to rendering...
            // Or we need to get the size from the UIArea...
            if (this.getParent() != null && this.getParent().getDomRef() != null) {
                var $DomRef = this.$();
                var $PageSection = $DomRef.parents('.sapMPage').first();
                var $ParentSection = $PageSection.children('section').first();
                var hiddenSection = $ParentSection.parents('.sapMNavItemHidden');
                if(hiddenSection.length != 0) {
                    hiddenSection.removeClass('sapMNavItemHidden');
                }
                if ($ParentSection.length == 0) {
                    $ParentSection = this.getParent().$().parents('section').first();
                }
                if ($ParentSection.length == 0) {
                    $ParentSection = $DomRef.parents('body').first();
                }

                var iSectionHeight = $ParentSection.height();
                var iSectionOffsetTop = 0;
                if ($ParentSection && $ParentSection.offset()) {
                    iSectionOffsetTop = $ParentSection.offset().top;
                }
                var iEltOffsetTop = 0;
                if ($DomRef && $DomRef.offset()) {
                    iEltOffsetTop = $DomRef.offset().top;
                }

                var iEltOffsetBottom = 0;
                // try to find out if there is a padding-bottom / margin-bottom in between here and the section
                var $ParentDom = $DomRef;
                while ($ParentDom != null && $ParentDom.length != 0 && $ParentDom.attr("id") != $ParentSection.attr("id")) {
                    var marginBottom = parseInt($ParentDom.css("margin-bottom"));
                    var paddingBottom = parseInt($ParentDom.css("padding-bottom"));
                    var borderBottom = parseInt($ParentDom.css("border-bottom-width"));
                    if (!isNaN(marginRight)) {
                        iEltOffsetBottom += marginBottom;
                    }
                    if (!isNaN(paddingBottom)) {
                        iEltOffsetBottom += paddingBottom;
                    }
                    if (!isNaN(borderBottom)) {
                        iEltOffsetBottom += borderBottom;
                    }
                    $ParentDom = $ParentDom.parent();
                }
                if(hiddenSection.length != 0) {
                    hiddenSection.addClass('sapMNavItemHidden');
                }
                initialHeightI = (iSectionHeight - (iEltOffsetTop - iSectionOffsetTop) - iEltOffsetBottom);
            } else if (this.getUIArea()) {
                initialHeightI = jQuery(this.getUIArea().oRootNode).height();
            } else {
                initialHeightI = "480";
            }

            // Apply the actual percent to the size
            if (this.getParent() && this.getParent() instanceof sap.ca.ui.charts.ChartToolBar
                && parseInt(initialHeight) != 100) {
                // In case the parent is a chart toolbar we need to take that into account when calculating the percentage if different from 100%
                var toolbarHeight = this.getParent().$().find(".sapMBar").height();
                initialHeightI = (((initialHeightI + toolbarHeight) * parseInt(initialHeight)) / 100) - toolbarHeight;
            } else {
                initialHeightI = (initialHeightI * parseInt(initialHeight)) / 100;
            }

        }

        var iScrollbarSize = { height:0, width:0};
        if (initialHeightI == 0)
        {
            // In the event the page does not exist or something go wrong we can have a 0 height, in that case we need to try again.
            initialHeightI = 100;
            // Force rerendering when the page is available
            jQuery.sap.delayedCall(200, this, this.invalidate);
        }
        if (this._vizChartType.scroll.horizontal) {
            if (calculatedSize > initialWidthI) {
                this._oInternalVizChart.setWidth(calculatedSize + "px");
                iScrollbarSize = jQuery.sap.scrollbarSize();
            } else {
                this._oInternalVizChart.setWidth(initialWidthI + "px");
            }

            this._oInternalVizChart.setHeight((initialHeightI - iScrollbarSize.height) + "px");
        } else if (this._vizChartType.scroll.vertical) {
            if (calculatedSize > initialHeightI) {
                this._oInternalVizChart.setHeight(calculatedSize + "px");
                this._oScrollContainer.setHeight(initialHeightI + "px");
                //For the first resize in order to avoid invalidating everything...
                if (this._oScrollContainer.$()) {
                    this._oScrollContainer.$().height(initialHeightI + "px");
                }

                iScrollbarSize = jQuery.sap.scrollbarSize();
            } else {
                this._oInternalVizChart.setHeight(initialHeightI + "px");
                this._oScrollContainer.setHeight("100%");
                //For the first resize in order to avoid invalidating everything...
                if (this._oScrollContainer.$()) {
                    this._oScrollContainer.$().height("100%");
                }
            }
            this._oInternalVizChart.setWidth((initialWidthI - iScrollbarSize.width) + "px");
        } else { // No scrolling but we still need to give in a correct height
            this._oInternalVizChart.setWidth(initialWidthI + "px");
            this._oInternalVizChart.setHeight(initialHeightI + "px");
        }
        if (this._oInternalVizChart.$()) {
            this._oInternalVizChart.$().height(this._oInternalVizChart.getHeight());
            this._oInternalVizChart.$().width(this._oInternalVizChart.getWidth());
        }
    } else if (!vizDataset || vizDataset._emptyDataset){ // if there is no data, then there must be no VIZDataset. Charts will render "no data" then.
        this._oScrollContainer.setHeight("100%");
        this._oScrollContainer.setWidth("100%");
        if (this._oScrollContainer.$()) {
            this._oScrollContainer.$().height("100%");
            this._oScrollContainer.$().width("100%");
        }
    }

};

/**
 * Handler for the mobile orientationchange.
 * We just make sure that the chart is being resized properly !
 * @private
 */
sap.ca.ui.charts.Chart.prototype._onOrientationChange = function () {
    // For the moment only call onResize
    this._onResize();
};

/**
 * setter for subHeader in the Popover.
 *
 * @param {sap.m.Bar} oSubHeader new value for sub header
 * @public
 * @name sap.ca.ui.charts.Chart#setPopoverSubHeader
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setPopoverSubHeader = function (oSubHeader) {
    if (oSubHeader && oSubHeader instanceof sap.m.Bar) {
        this._oChartPopover.setSubHeader(oSubHeader);
    }
};

/**
 * setter for footer in the Popover.
 *
 * @param {sap.m.Bar} oFooter new value for footer
 * @public
 * @name sap.ca.ui.charts.Chart#setPopoverFooter
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setPopoverFooter = function (oFooter) {
    if (oFooter) {
        if (oFooter instanceof sap.m.Bar) {
            if (!jQuery.device.is.phone) {
                this._oChartPopover._oControl.setFooter(oFooter);
            } else {
                var oPage = new sap.m.Page({
                    showHeader:false,
                    showFooter:true,
                    footer:oFooter,
                    content:[this._oSelectedDataList.getControl()]
                });
                this._oChartPopover.destroyContent();
                this._oChartPopover.addContent(oPage);
            }
        }
        else if (oFooter instanceof sap.ui.core.Control){
            if (!jQuery.device.is.phone) {
                this._oChartPopover.addContent(oFooter);
            }else {
                oFooter.addStyleClass('sapCaUiPopOverFooter');
                var oPage = new sap.m.Page({
                    showHeader:false,
                    showFooter:false,
                    content:[this._oSelectedDataList.getControl(),oFooter]
                });
                this._oChartPopover.destroyContent();
                this._oChartPopover.addContent(oPage);
            }
        }
    }
};


/**
 * setter for aggregation noData in Viz Chart.
 *Control tree to display when there is no data available
 * @param {sap.ui.core.Control} oControl new value for aggregation noData
 * @public
 * @name sap.ca.ui.charts.Chart#setNoData
 * @function
 */
sap.ca.ui.charts.Chart.prototype.setNoData = function (oControl) {
    this._oInternalVizChart.setNoData(oControl);
    return this;
};
/**
 * Getter for aggregation noData in Viz Chart.
 * Control tree to display when there is no data available
 *
 * @return {sap.ui.core.Control} the value for aggregation noData
 * @public
 * @name sap.ca.ui.charts.Chart#getNoData
 * @function
 */
sap.ca.ui.charts.Chart.prototype.getNoData = function () {
    return this._oInternalVizChart.getNoData();
};


}; // end of sap/ca/ui/charts/Chart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.CombinedChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.CombinedChart.
jQuery.sap.declare("sap.ca.ui.charts.CombinedChart");




/**
 * Constructor for a new charts/CombinedChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getData data} : any</li>
 * <li>{@link #getPrimaryAxis primaryAxis} : string[]</li>
 * <li>{@link #getSecondAxis secondAxis} : string[]</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getScrollArea scrollArea} : sap.m.ScrollContainer</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Allows you to create a chart using vertical bars and lines to represent the data
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.CombinedChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.CombinedChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"data" : {type : "any", group : "Data", defaultValue : null},
		"primaryAxis" : {type : "string[]", group : "Appearance", defaultValue : null},
		"secondAxis" : {type : "string[]", group : "Appearance", defaultValue : null}
	},
	aggregations : {
    	"scrollArea" : {type : "sap.m.ScrollContainer", multiple : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.CombinedChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.CombinedChart.extend
 * @function
 */


/**
 * Getter for property <code>data</code>.
 * Data of the Chart
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>data</code>
 * @public
 * @name sap.ca.ui.charts.CombinedChart#getData
 * @function
 */

/**
 * Setter for property <code>data</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oData  new value for property <code>data</code>
 * @return {sap.ca.ui.charts.CombinedChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.CombinedChart#setData
 * @function
 */


/**
 * Getter for property <code>primaryAxis</code>.
 * Shapes for the internal viz chart primary axis. It will be an array of strings, one for each measure. Could be "line" or "bar".
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string[]} the value of property <code>primaryAxis</code>
 * @public
 * @name sap.ca.ui.charts.CombinedChart#getPrimaryAxis
 * @function
 */

/**
 * Setter for property <code>primaryAxis</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string[]} aPrimaryAxis  new value for property <code>primaryAxis</code>
 * @return {sap.ca.ui.charts.CombinedChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.CombinedChart#setPrimaryAxis
 * @function
 */


/**
 * Getter for property <code>secondAxis</code>.
 * Shapes for the internal viz chart secondary axis. It will be an array of strings, one for each measure. Could be "line" or "bar".
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string[]} the value of property <code>secondAxis</code>
 * @public
 * @name sap.ca.ui.charts.CombinedChart#getSecondAxis
 * @function
 */

/**
 * Setter for property <code>secondAxis</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string[]} aSecondAxis  new value for property <code>secondAxis</code>
 * @return {sap.ca.ui.charts.CombinedChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.CombinedChart#setSecondAxis
 * @function
 */


/**
 * Getter for aggregation <code>scrollArea</code>.<br/>
 * scroll area that contains the graph plot
 * 
 * @return {sap.m.ScrollContainer}
 * @public
 * @name sap.ca.ui.charts.CombinedChart#getScrollArea
 * @function
 */


/**
 * Setter for the aggregated <code>scrollArea</code>.
 * @param oScrollArea {sap.m.ScrollContainer}
 * @return {sap.ca.ui.charts.CombinedChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.CombinedChart#setScrollArea
 * @function
 */
	

/**
 * Destroys the scrollArea in the aggregation 
 * named <code>scrollArea</code>.
 * @return {sap.ca.ui.charts.CombinedChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.CombinedChart#destroyScrollArea
 * @function
 */


// Start of sap\ca\ui\charts\CombinedChart.js
jQuery.sap.declare("sap.ca.ui.charts.CombinedChart");


sap.ca.ui.charts.CombinedChart.prototype.init = function () {
    sap.ca.ui.charts.Chart.prototype.init.apply(this);
    this.setChartType("Combination");
};

sap.ca.ui.charts.CombinedChart.prototype._getChartSettings = function () {
    var chartSettings = sap.ca.ui.charts.Chart.prototype._getChartSettings.call(this);
    if (typeof chartSettings.plotArea === "undefined") {
        chartSettings.plotArea = {};
    }
    if( this.getPrimaryAxis() != null  ){
        if (typeof chartSettings.plotArea.dataShape === "undefined") {
            chartSettings.plotArea.dataShape = {};
        }
        chartSettings.plotArea.dataShape.primaryAxis = this.getPrimaryAxis();
    }
    if( this.getSecondAxis() != null  ){
        if (typeof chartSettings.plotArea.dataShape === "undefined") {
            chartSettings.plotArea.dataShape = {};
        }
        chartSettings.plotArea.dataShape.secondAxis = this.getSecondAxis();
    } // Line settings
    chartSettings.plotArea.line = {
        marker: {
            visible: true,
            size: this._getMarkerSize()
        }
    };
    return chartSettings;
};

sap.ca.ui.charts.CombinedChart.prototype.setData = function (oData) {
    this._oInternalVizChart.setModel(oData);
};

sap.ca.ui.charts.CombinedChart.prototype.getScrollArea = function () {
    return this.getAggregation("internalContent");
};

sap.ca.ui.charts.CombinedChart.prototype.setScrollArea = function (oScrollArea) {
    jQuery.sap.log.warning("Usage of deprecated feature, please use instead : this.setAggregation('internalContent')");
};







}; // end of sap/ca/ui/charts/CombinedChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.HorizontalBarChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.HorizontalBarChart.
jQuery.sap.declare("sap.ca.ui.charts.HorizontalBarChart");




/**
 * Constructor for a new charts/HorizontalBarChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getData data} : object</li>
 * <li>{@link #getContainer container} : string (default: 'chart')</li>
 * <li>{@link #getBarHeight barHeight} : int (default: 48)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getScroll scroll} : sap.m.ScrollContainer</li>
 * <li>{@link #getHorizontalBarChart horizontalBarChart} : sap.viz.ui5.Bar</li>
 * <li>{@link #getVerticalArea verticalArea} : sap.m.VBox</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Allows you to create a chart using horizontal bars to represent the data
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.HorizontalBarChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"data" : {type : "object", group : "Misc", defaultValue : null},
		"container" : {type : "string", group : "Misc", defaultValue : 'chart'},
		"barHeight" : {type : "int", group : "Misc", defaultValue : 48}
	},
	aggregations : {
    	"scroll" : {type : "sap.m.ScrollContainer", multiple : false}, 
    	"horizontalBarChart" : {type : "sap.viz.ui5.Bar", multiple : false}, 
    	"verticalArea" : {type : "sap.m.VBox", multiple : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.HorizontalBarChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.HorizontalBarChart.extend
 * @function
 */


/**
 * Getter for property <code>data</code>.
 * The data to be used by the chart
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>data</code>
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getData
 * @function
 */

/**
 * Setter for property <code>data</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oData  new value for property <code>data</code>
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setData
 * @function
 */


/**
 * Getter for property <code>container</code>.
 * The DOM ID where the chart will be added. Deprecated
 *
 * Default value is <code>chart</code>
 *
 * @return {string} the value of property <code>container</code>
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getContainer
 * @function
 */

/**
 * Setter for property <code>container</code>.
 *
 * Default value is <code>chart</code> 
 *
 * @param {string} sContainer  new value for property <code>container</code>
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setContainer
 * @function
 */


/**
 * Getter for property <code>barHeight</code>.
 * Minimum shape size for touch enabled actions, default and minimum to 48px !
 *
 * Default value is <code>48</code>
 *
 * @return {int} the value of property <code>barHeight</code>
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getBarHeight
 * @function
 */

/**
 * Setter for property <code>barHeight</code>.
 *
 * Default value is <code>48</code> 
 *
 * @param {int} iBarHeight  new value for property <code>barHeight</code>
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setBarHeight
 * @function
 */


/**
 * Getter for aggregation <code>scroll</code>.<br/>
 * 
 * 
 * @return {sap.m.ScrollContainer}
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getScroll
 * @function
 */


/**
 * Setter for the aggregated <code>scroll</code>.
 * @param oScroll {sap.m.ScrollContainer}
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setScroll
 * @function
 */
	

/**
 * Destroys the scroll in the aggregation 
 * named <code>scroll</code>.
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#destroyScroll
 * @function
 */


/**
 * Getter for aggregation <code>horizontalBarChart</code>.<br/>
 * 
 * 
 * @return {sap.viz.ui5.Bar}
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getHorizontalBarChart
 * @function
 */


/**
 * Setter for the aggregated <code>horizontalBarChart</code>.
 * @param oHorizontalBarChart {sap.viz.ui5.Bar}
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setHorizontalBarChart
 * @function
 */
	

/**
 * Destroys the horizontalBarChart in the aggregation 
 * named <code>horizontalBarChart</code>.
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#destroyHorizontalBarChart
 * @function
 */


/**
 * Getter for aggregation <code>verticalArea</code>.<br/>
 * 
 * 
 * @return {sap.m.VBox}
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#getVerticalArea
 * @function
 */


/**
 * Setter for the aggregated <code>verticalArea</code>.
 * @param oVerticalArea {sap.m.VBox}
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#setVerticalArea
 * @function
 */
	

/**
 * Destroys the verticalArea in the aggregation 
 * named <code>verticalArea</code>.
 * @return {sap.ca.ui.charts.HorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.HorizontalBarChart#destroyVerticalArea
 * @function
 */


// Start of sap\ca\ui\charts\HorizontalBarChart.js
jQuery.sap.declare("sap.ca.ui.charts.HorizontalBarChart");


/**
 * @name ap.ca.ui.charts.HorizontalBarChart#init
 * @function
 */
sap.ca.ui.charts.HorizontalBarChart.prototype.init = function() {
    sap.ca.ui.charts.Chart.prototype.init.apply(this);
    this.setChartType("Bar");
}

sap.ca.ui.charts.HorizontalBarChart.prototype.setData = function(oData){
    this._oInternalVizChart.setModel(oData);
}

sap.ca.ui.charts.HorizontalBarChart.prototype.getContainer = function(){
    return this.getId();
}

sap.ca.ui.charts.HorizontalBarChart.prototype.setContainer = function(sId){
    jQuery.sap.log.warning("Usage of deprecated feature, please use instead the generated ID : "+ this.getId());
}
sap.ca.ui.charts.HorizontalBarChart.prototype.setBarHeight = function(iBarHeight){
    this.setProperty("minShapeSize", iBarHeight);
}

sap.ca.ui.charts.HorizontalBarChart.prototype.getBarHeight = function(){
    return this.getProperty("minShapeSize");
}

sap.ca.ui.charts.HorizontalBarChart.prototype.setContent = function(oContent){
    jQuery.sap.log.warning("Usage of deprecated feature, please use setAggregation('internalContent')");
}
sap.ca.ui.charts.HorizontalBarChart.prototype.getContent = function(){
    jQuery.sap.log.warning("Usage of deprecated feature please use getAggregation('internalContent')");
    return null;

}
sap.ca.ui.charts.HorizontalBarChart.prototype.setScroll = function(oScroll){
    jQuery.sap.log.warning("Usage of deprecated feature please use setAggregation('internalContent')");
}
sap.ca.ui.charts.HorizontalBarChart.prototype.getScroll = function(){
    return this.getAggregation("internalContent");
}

sap.ca.ui.charts.HorizontalBarChart.prototype.getHorizontalBarChart = function(){
    return this.getAggregation("internalVizChart");
}
sap.ca.ui.charts.HorizontalBarChart.prototype.setHorizontalBarChart = function(oHorizontalBarChart){
    this.setAggregation("internalVizChart", oHorizontalBarChart);
}

sap.ca.ui.charts.HorizontalBarChart.prototype.getVerticalArea = function(){
    jQuery.sap.log.warning("Usage of deprecated feature please use getAggregation('internalContent')");
    return null;
}

sap.ca.ui.charts.HorizontalBarChart.prototype.setVerticalArea = function(oVerticalArea){
    jQuery.sap.log.warning("Usage of deprecated feature, please use setAggregation('internalContent')");
}






}; // end of sap/ca/ui/charts/HorizontalBarChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.LineChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.LineChart.
jQuery.sap.declare("sap.ca.ui.charts.LineChart");




/**
 * Constructor for a new charts/LineChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getChartTitle chartTitle} : string (default: 'Line Chart')</li>
 * <li>{@link #getDataLabelFormat dataLabelFormat} : any (default: '#0')</li>
 * <li>{@link #getMinTouchSize minTouchSize} : string (default: '48px')</li>
 * <li>{@link #getMinTouchWidth minTouchWidth} : string (default: '48px')</li>
 * <li>{@link #getShowLabel showLabel} : boolean (default: true)</li>
 * <li>{@link #getShowScrollContext showScrollContext} : boolean (default: false)</li>
 * <li>{@link #getChartDataset chartDataset} : any</li>
 * <li>{@link #getDatasetSettings datasetSettings} : any</li>
 * <li>{@link #getChartDatasetSettings chartDatasetSettings} : any</li>
 * <li>{@link #getDataPath dataPath} : string</li>
 * <li>{@link #getData data} : any</li>
 * <li>{@link #getChartBusinessData chartBusinessData} : any</li>
 * <li>{@link #getUseDelayedResize useDelayedResize} : boolean (default: false)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getVertical vertical} : sap.m.VBox</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul>
 * <li>{@link sap.ca.ui.charts.LineChart#event:onDetailsSelected onDetailsSelected} : fnListenerFunction or [fnListenerFunction, oListenerObject] or [oData, fnListenerFunction, oListenerObject]</li></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Line Chart for the Fiori Project
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @since 1.0.0
 * @name sap.ca.ui.charts.LineChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.LineChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"chartTitle" : {type : "string", group : "Data", defaultValue : 'Line Chart', deprecated: true},
		"dataLabelFormat" : {type : "any", group : "Appearance", defaultValue : '#0'},
		"minTouchSize" : {type : "string", group : "Behavior", defaultValue : '48px', deprecated: true},
		"minTouchWidth" : {type : "string", group : "Behavior", defaultValue : '48px', deprecated: true},
		"showLabel" : {type : "boolean", group : "Appearance", defaultValue : true, deprecated: true},
		"showScrollContext" : {type : "boolean", group : "Appearance", defaultValue : false, deprecated: true},
		"chartDataset" : {type : "any", group : "Data", defaultValue : null, deprecated: true},
		"datasetSettings" : {type : "any", group : "Data", defaultValue : null, deprecated: true},
		"chartDatasetSettings" : {type : "any", group : "Data", defaultValue : null, deprecated: true},
		"dataPath" : {type : "string", group : "Data", defaultValue : null, deprecated: true},
		"data" : {type : "any", group : "Data", defaultValue : null, deprecated: true},
		"chartBusinessData" : {type : "any", group : "Data", defaultValue : null, deprecated: true},
		"useDelayedResize" : {type : "boolean", group : "Behavior", defaultValue : false, deprecated: true}
	},
	aggregations : {
    	"vertical" : {type : "sap.m.VBox", multiple : false, deprecated: true}
	},
	events : {
		"onDetailsSelected" : {deprecated: true}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.LineChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.LineChart.extend
 * @function
 */

sap.ca.ui.charts.LineChart.M_EVENTS = {'onDetailsSelected':'onDetailsSelected'};


/**
 * Getter for property <code>chartTitle</code>.
 * The title to display on the chart
 *
 * Default value is <code>Line Chart</code>
 *
 * @return {string} the value of property <code>chartTitle</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'title' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getChartTitle
 * @function
 */

/**
 * Setter for property <code>chartTitle</code>.
 *
 * Default value is <code>Line Chart</code> 
 *
 * @param {string} sChartTitle  new value for property <code>chartTitle</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'title' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setChartTitle
 * @function
 */


/**
 * Getter for property <code>dataLabelFormat</code>.
 * The data format string to use to display the data labels on the graph, this is an array of arrays of Format String following the 'sap.viz.ui5.Line' documentation
 * 
 *
 * Default value is <code>'#0'</code>
 *
 * @return {any} the value of property <code>dataLabelFormat</code>
 * @public
 * @name sap.ca.ui.charts.LineChart#getDataLabelFormat
 * @function
 */

/**
 * Setter for property <code>dataLabelFormat</code>.
 *
 * Default value is <code>'#0'</code> 
 *
 * @param {any} oDataLabelFormat  new value for property <code>dataLabelFormat</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.LineChart#setDataLabelFormat
 * @function
 */


/**
 * Getter for property <code>minTouchSize</code>.
 * The minimum size (width for a line chart) that a point has to be, so as to be able to touch on a mobile device, only applies if the chart width is not set
 * 
 *
 * Default value is <code>48px</code>
 *
 * @return {string} the value of property <code>minTouchSize</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the 'dataLabelFormatter' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getMinTouchSize
 * @function
 */

/**
 * Setter for property <code>minTouchSize</code>.
 *
 * Default value is <code>48px</code> 
 *
 * @param {string} sMinTouchSize  new value for property <code>minTouchSize</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the 'dataLabelFormatter' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setMinTouchSize
 * @function
 */


/**
 * Getter for property <code>minTouchWidth</code>.
 * The minimum size (width for a line chart) that a point has to be, so as to be able to touch on a mobile device, only applies if the chart width is not set
 * 
 *
 * Default value is <code>48px</code>
 *
 * @return {string} the value of property <code>minTouchWidth</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the 'minShapeSize' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getMinTouchWidth
 * @function
 */

/**
 * Setter for property <code>minTouchWidth</code>.
 *
 * Default value is <code>48px</code> 
 *
 * @param {string} sMinTouchWidth  new value for property <code>minTouchWidth</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the 'minShapeSize' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setMinTouchWidth
 * @function
 */


/**
 * Getter for property <code>showLabel</code>.
 * Show the data label value on the chart
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showLabel</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'showDataLabel' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getShowLabel
 * @function
 */

/**
 * Setter for property <code>showLabel</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowLabel  new value for property <code>showLabel</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'showDataLabel' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setShowLabel
 * @function
 */


/**
 * Getter for property <code>showScrollContext</code>.
 * Show the chart scroll context, (the preview of the whole chart as a small image when scrolling)
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showScrollContext</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Feature does not work correctly yet.
 * @name sap.ca.ui.charts.LineChart#getShowScrollContext
 * @function
 */

/**
 * Setter for property <code>showScrollContext</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowScrollContext  new value for property <code>showScrollContext</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Feature does not work correctly yet.
 * @name sap.ca.ui.charts.LineChart#setShowScrollContext
 * @function
 */


/**
 * Getter for property <code>chartDataset</code>.
 * Allow the Dataset for the chart to be set, includes the dimensions, and measures, any data binding is removed, this will disable the chart scroll context view,
 * use the dataset settings if you want the
 * scroll context to work
 * 
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>chartDataset</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'dataset' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getChartDataset
 * @function
 */

/**
 * Setter for property <code>chartDataset</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oChartDataset  new value for property <code>chartDataset</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'dataset' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setChartDataset
 * @function
 */


/**
 * Getter for property <code>datasetSettings</code>.
 * Allow the Dataset for the chart to be set by providing the settings for the dataset creation, (internally two datasets are created, one for the main chart and
 * one
 * for the scroll context)
 * 
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>datasetSettings</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is property is not needed any more, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getDatasetSettings
 * @function
 */

/**
 * Setter for property <code>datasetSettings</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oDatasetSettings  new value for property <code>datasetSettings</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is property is not needed any more, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setDatasetSettings
 * @function
 */


/**
 * Getter for property <code>chartDatasetSettings</code>.
 * Allow the Dataset for the chart to be set by providing the settings for the dataset creation, (internally two datasets are created, one for the main chart and
 * one for the scroll context)
 * 
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>chartDatasetSettings</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'datasetSettings' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getChartDatasetSettings
 * @function
 */

/**
 * Setter for property <code>chartDatasetSettings</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oChartDatasetSettings  new value for property <code>chartDatasetSettings</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'datasetSettings' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setChartDatasetSettings
 * @function
 */


/**
 * Getter for property <code>dataPath</code>.
 * Allow the data path for binding the model to the dimensions and measures to be set
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>dataPath</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the binding on 'dataset', do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getDataPath
 * @function
 */

/**
 * Setter for property <code>dataPath</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sDataPath  new value for property <code>dataPath</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the binding on 'dataset', do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setDataPath
 * @function
 */


/**
 * Getter for property <code>data</code>.
 * Allow the chart data to be set, that is the measure and dimension values
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>data</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the binding on 'dataset', do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getData
 * @function
 */

/**
 * Setter for property <code>data</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oData  new value for property <code>data</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Please use the binding on 'dataset', do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setData
 * @function
 */


/**
 * Getter for property <code>chartBusinessData</code>.
 * Allow the chart data to be set, that is the measure and dimension values
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>chartBusinessData</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'data' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getChartBusinessData
 * @function
 */

/**
 * Setter for property <code>chartBusinessData</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oChartBusinessData  new value for property <code>chartBusinessData</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * This is a copy of the 'data' property, do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setChartBusinessData
 * @function
 */


/**
 * Getter for property <code>useDelayedResize</code>.
 * Use a delayed resize event to cause the chart to render when navigated to after resize when in the background
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>useDelayedResize</code>
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getUseDelayedResize
 * @function
 */

/**
 * Setter for property <code>useDelayedResize</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bUseDelayedResize  new value for property <code>useDelayedResize</code>
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setUseDelayedResize
 * @function
 */


/**
 * Getter for aggregation <code>vertical</code>.<br/>
 * The vertical layout
 * 
 * @return {sap.m.VBox}
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#getVertical
 * @function
 */


/**
 * Setter for the aggregated <code>vertical</code>.
 * @param oVertical {sap.m.VBox}
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#setVertical
 * @function
 */
	

/**
 * Destroys the vertical in the aggregation 
 * named <code>vertical</code>.
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#destroyVertical
 * @function
 */


/**
 * Event fired when the details button is pressed on the selected Datapoint Popover 
 *
 * @name sap.ca.ui.charts.LineChart#onDetailsSelected
 * @event
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @param {sap.ui.base.Event} oControlEvent
 * @param {sap.ui.base.EventProvider} oControlEvent.getSource
 * @param {object} oControlEvent.getParameters

 * @public
 */
 
/**
 * Attach event handler <code>fnFunction</code> to the 'onDetailsSelected' event of this <code>sap.ca.ui.charts.LineChart</code>.<br/>.
 * When called, the context of the event handler (its <code>this</code>) will be bound to <code>oListener<code> if specified
 * otherwise to this <code>sap.ca.ui.charts.LineChart</code>.<br/> itself. 
 *  
 * Event fired when the details button is pressed on the selected Datapoint Popover 
 *
 * @param {object}
 *            [oData] An application specific payload object, that will be passed to the event handler along with the event object when firing the event.
 * @param {function}
 *            fnFunction The function to call, when the event occurs.  
 * @param {object}
 *            [oListener=this] Context object to call the event handler with. Defaults to this <code>sap.ca.ui.charts.LineChart</code>.<br/> itself.
 *
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#attachOnDetailsSelected
 * @function
 */

/**
 * Detach event handler <code>fnFunction</code> from the 'onDetailsSelected' event of this <code>sap.ca.ui.charts.LineChart</code>.<br/>
 *
 * The passed function and listener object must match the ones used for event registration.
 *
 * @param {function}
 *            fnFunction The function to call, when the event occurs.
 * @param {object}
 *            oListener Context object on which the given function had to be called.
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#detachOnDetailsSelected
 * @function
 */

/**
 * Fire event onDetailsSelected to attached listeners.

 * @param {Map} [mArguments] the arguments to pass along with the event.
 * @return {sap.ca.ui.charts.LineChart} <code>this</code> to allow method chaining
 * @protected
 * @deprecated Since version 1.0.0. 
 * Do not use as it will be removed in a future release.
 * @name sap.ca.ui.charts.LineChart#fireOnDetailsSelected
 * @function
 */


// Start of sap\ca\ui\charts\LineChart.js
/**
 * This file defines behavior for the control,
 */
sap.ca.ui.charts.LineChart.prototype.init = function() {
    sap.ca.ui.charts.Chart.prototype.init.apply(this);
    this.setChartType("Line");
};
/* Deprecated Aggregations */
sap.ca.ui.charts.LineChart.prototype.setVertical = function( args ){
    jQuery.sap.log.warning("Vertical aggregation is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getVertical = function() {
    jQuery.sap.log.warning("Vertical aggregation is deprecated");
    return null;
};
/* Deprecated events */
sap.ca.ui.charts.LineChart.prototype.attachOnDetailsSelected = function(){
    jQuery.sap.log.warning("onDetailsSelected event is deprecated");
};
/* Deprecated properties */
sap.ca.ui.charts.LineChart.prototype.setUseDelayedResize = function( args ){
    jQuery.sap.log.warning("UseDelayedResize property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getUseDelayedResize = function() {
    jQuery.sap.log.warning("UseDelayedResize property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setChartBusinessData = function( args ){
    jQuery.sap.log.warning("ChartBusinessData property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getChartBusinessData = function() {
    jQuery.sap.log.warning("ChartBusinessData property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setData = function( args ){
    jQuery.sap.log.warning("Data property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getData = function() {
    jQuery.sap.log.warning("Data property is deprecated");
    return null;
};


sap.ca.ui.charts.LineChart.prototype.setDataPath = function( args ){
    jQuery.sap.log.warning("DataPath property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getDataPath = function() {
    jQuery.sap.log.warning("DataPath property is deprecated");
    return null;
};


sap.ca.ui.charts.LineChart.prototype.setChartDatasetSettings = function( args ){
    jQuery.sap.log.warning("ChartDatasetSettings property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getChartDatasetSettings = function() {
    jQuery.sap.log.warning("ChartDatasetSettings property is deprecated");
    return null;
};


sap.ca.ui.charts.LineChart.prototype.setDatasetSettings = function( args ){
    jQuery.sap.log.warning("DatasetSettings property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getDatasetSettings = function() {
    jQuery.sap.log.warning("DatasetSettings property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setChartDataset = function( args ){
    jQuery.sap.log.warning("ChartDataset property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getChartDataset = function() {
    jQuery.sap.log.warning("ChartDataset property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setShowScrollContext = function( args ){
    jQuery.sap.log.warning("Vertical property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getVertical = function() {
    jQuery.sap.log.warning("Vertical property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setShowLabel = function( args ){
    jQuery.sap.log.warning("ShowLabel property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getShowLabel = function() {
    jQuery.sap.log.warning("ShowLabel property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setMinTouchWidth = function( args ){
    jQuery.sap.log.warning("MinTouchWidth property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getMinTouchWidth = function() {
    jQuery.sap.log.warning("MinTouchWidth property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setMinTouchSize = function( args ){
    jQuery.sap.log.warning("MinTouchSize property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getMinTouchSize = function() {
    jQuery.sap.log.warning("MinTouchSize property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setDataLabelFormat = function( args ){
    jQuery.sap.log.warning("DataLabelFormat property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getDataLabelFormat = function() {
    jQuery.sap.log.warning("DataLabelFormat property is deprecated");
    return null;
};

sap.ca.ui.charts.LineChart.prototype.setChartTitle = function( args ){
    jQuery.sap.log.warning("ChartTitle property is deprecated");
};
sap.ca.ui.charts.LineChart.prototype.getChartTitle = function() {
    jQuery.sap.log.warning("ChartTitle property is deprecated");
    return null;
};
}; // end of sap/ca/ui/charts/LineChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.StackedHorizontalBarChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.StackedHorizontalBarChart.
jQuery.sap.declare("sap.ca.ui.charts.StackedHorizontalBarChart");




/**
 * Constructor for a new charts/StackedHorizontalBarChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getType type} : string (default: 'StackedBar')</li>
 * <li>{@link #getMinTouchSize minTouchSize} : sap.ui.core.CSSSize (default: '48px')</li>
 * <li>{@link #getDataLabelFormat dataLabelFormat} : any (default: [["##"]])</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Stacked Horizontal Bar Chart wrapper around the viz StackedBarChart / MultipleStackedBarChart.
 * To be used in conjunction with the chart toolbar.
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.StackedHorizontalBarChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.StackedHorizontalBarChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"type" : {type : "string", group : "Designtime", defaultValue : 'StackedBar', deprecated: true},
		"minTouchSize" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '48px', deprecated: true},
		"dataLabelFormat" : {type : "any", group : "Appearance", defaultValue : [["##"]]}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content", deprecated: true}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.StackedHorizontalBarChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.StackedHorizontalBarChart.extend
 * @function
 */


/**
 * Getter for property <code>type</code>.
 * Mapped to charType property.
 *
 * Default value is <code>StackedBar</code>
 *
 * @return {string} the value of property <code>type</code>
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * type has been deprecated since 1.16.3. Please use the chartType instead.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#getType
 * @function
 */

/**
 * Setter for property <code>type</code>.
 *
 * Default value is <code>StackedBar</code> 
 *
 * @param {string} sType  new value for property <code>type</code>
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * type has been deprecated since 1.16.3. Please use the chartType instead.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#setType
 * @function
 */


/**
 * Getter for property <code>minTouchSize</code>.
 * Mapped to minShapeSize property.
 *
 * Default value is <code>48px</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>minTouchSize</code>
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * minTouchSize has been deprecated since 1.16.3. Please use the minShapeSize instead.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#getMinTouchSize
 * @function
 */

/**
 * Setter for property <code>minTouchSize</code>.
 *
 * Default value is <code>48px</code> 
 *
 * @param {sap.ui.core.CSSSize} sMinTouchSize  new value for property <code>minTouchSize</code>
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * minTouchSize has been deprecated since 1.16.3. Please use the minShapeSize instead.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#setMinTouchSize
 * @function
 */


/**
 * Getter for property <code>dataLabelFormat</code>.
 * Defines the formater string for the dataLabel value to be diaplyed on the bubble e.g [ [##]]
 *
 * Default value is <code>[["##"]]</code>
 *
 * @return {any} the value of property <code>dataLabelFormat</code>
 * @public
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#getDataLabelFormat
 * @function
 */

/**
 * Setter for property <code>dataLabelFormat</code>.
 *
 * Default value is <code>[["##"]]</code> 
 *
 * @param {any} oDataLabelFormat  new value for property <code>dataLabelFormat</code>
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#setDataLabelFormat
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.charts.StackedHorizontalBarChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedHorizontalBarChart#destroyContent
 * @function
 */


// Start of sap\ca\ui\charts\StackedHorizontalBarChart.js


sap.ca.ui.charts.StackedHorizontalBarChart.prototype.setType = function (sValue) {
    var sChartType = "";
    switch (sValue) {
        case "viz/stacked_bar":
            sChartType = sap.ca.ui.charts.ChartType.StackedBar;
            break;
        case "viz/100_stacked_bar":
            sChartType = sap.ca.ui.charts.ChartType.StackedBar100;
            break;
        case "viz/dual_stacked_bar":
            sChartType = sap.ca.ui.charts.ChartType.DualStackedBar;
            break;
        case "viz/100_dual_stacked_bar":
            sChartType = sap.ca.ui.charts.ChartType.DualStackedBar100;
            break;

    }
    this.setProperty("chartType", sChartType);
    return this;
}

sap.ca.ui.charts.StackedHorizontalBarChart.prototype.getType = function () {
    return this.getChartType();
}

sap.ca.ui.charts.StackedHorizontalBarChart.prototype.setMinTouchSize = function (sValue) {
    this.setMinShapeSize(sValue);
    return this;
}

sap.ca.ui.charts.StackedHorizontalBarChart.prototype.getMinTouchSize = function () {
    return this.getMinShapeSize();
}


sap.ca.ui.charts.StackedHorizontalBarChart.prototype.setDataLabelFormat = function (oFormat) {
    jQuery.sap.log.warning("This method has been deprectated. Please use dataLabelFormatter");
};
}; // end of sap/ca/ui/charts/StackedHorizontalBarChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.StackedVerticalColumnChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.StackedVerticalColumnChart.
jQuery.sap.declare("sap.ca.ui.charts.StackedVerticalColumnChart");




/**
 * Constructor for a new charts/StackedVerticalColumnChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getType type} : string (default: 'StackedColumn')</li>
 * <li>{@link #getMinTouchSize minTouchSize} : sap.ui.core.CSSSize (default: '48px')</li>
 * <li>{@link #getDataLabelFormat dataLabelFormat} : any (default: [["##"]])</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Stacked Vertical Column Chart wrapper around the viz StackedColumnChart / MultipleStackedColumnChart.
 * To be used in conjunction with the chart toolbar.
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.StackedVerticalColumnChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.StackedVerticalColumnChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"type" : {type : "string", group : "Designtime", defaultValue : 'StackedColumn', deprecated: true},
		"minTouchSize" : {type : "sap.ui.core.CSSSize", group : "Dimension", defaultValue : '48px', deprecated: true},
		"dataLabelFormat" : {type : "any", group : "Appearance", defaultValue : [["##"]], deprecated: true}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content", deprecated: true}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.StackedVerticalColumnChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.StackedVerticalColumnChart.extend
 * @function
 */


/**
 * Getter for property <code>type</code>.
 * Mapped to charType property.
 *
 * Default value is <code>StackedColumn</code>
 *
 * @return {string} the value of property <code>type</code>
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * type has been deprecated since 1.16.3. Please use the chartType instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#getType
 * @function
 */

/**
 * Setter for property <code>type</code>.
 *
 * Default value is <code>StackedColumn</code> 
 *
 * @param {string} sType  new value for property <code>type</code>
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * type has been deprecated since 1.16.3. Please use the chartType instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#setType
 * @function
 */


/**
 * Getter for property <code>minTouchSize</code>.
 * Mapped to minShapeSize property.
 *
 * Default value is <code>'48px'</code>
 *
 * @return {sap.ui.core.CSSSize} the value of property <code>minTouchSize</code>
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * minTouchSize has been deprecated since 1.16.3. Please use the minShapeSize instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#getMinTouchSize
 * @function
 */

/**
 * Setter for property <code>minTouchSize</code>.
 *
 * Default value is <code>'48px'</code> 
 *
 * @param {sap.ui.core.CSSSize} sMinTouchSize  new value for property <code>minTouchSize</code>
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * minTouchSize has been deprecated since 1.16.3. Please use the minShapeSize instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#setMinTouchSize
 * @function
 */


/**
 * Getter for property <code>dataLabelFormat</code>.
 * Does not do anything anymore
 *
 * Default value is <code>[["##"]]</code>
 *
 * @return {any} the value of property <code>dataLabelFormat</code>
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * dataLabelFormat has been deprecated since 1.16.3. Please use the dataLabelFormatter instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#getDataLabelFormat
 * @function
 */

/**
 * Setter for property <code>dataLabelFormat</code>.
 *
 * Default value is <code>[["##"]]</code> 
 *
 * @param {any} oDataLabelFormat  new value for property <code>dataLabelFormat</code>
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * dataLabelFormat has been deprecated since 1.16.3. Please use the dataLabelFormatter instead.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#setDataLabelFormat
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.charts.StackedVerticalColumnChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 1.16.3. 
 * 
 * content has been deprecated since 1.16.3. The only visible content in the chart now is the internalVizChart.
 * 
 * @name sap.ca.ui.charts.StackedVerticalColumnChart#destroyContent
 * @function
 */


// Start of sap\ca\ui\charts\StackedVerticalColumnChart.js


sap.ca.ui.charts.StackedVerticalColumnChart.prototype.setType = function (sValue){
    var sChartType = "";
    switch (sValue) {
        case "viz/stacked_column":
            sChartType = sap.ca.ui.charts.ChartType.StackedColumn;
            break;
        case "viz/100_stacked_column":
            sChartType = sap.ca.ui.charts.ChartType.StackedColumn100;
            break;
        case "viz/dual_stacked_column":
            sChartType = sap.ca.ui.charts.ChartType.DualStackedColumn;
            break;
        case "viz/100_dual_stacked_column":
            sChartType = sap.ca.ui.charts.ChartType.DualStackedColumn100;
            break;

    }
    this.setProperty("chartType", sChartType);
    return this;
}

sap.ca.ui.charts.StackedVerticalColumnChart.prototype.getType = function (){
    return this.getChartType();
}

sap.ca.ui.charts.StackedVerticalColumnChart.prototype.setMinTouchSize = function (sValue){
    this.setMinShapeSize(sValue);
    return this;
}

sap.ca.ui.charts.StackedVerticalColumnChart.prototype.getMinTouchSize = function (){
    return this.getMinShapeSize();
}


sap.ca.ui.charts.StackedVerticalColumnChart.prototype.setDataLabelFormat = function (oFormat) {
	jQuery.sap.log.warning("This method has been deprectated. Please use dataLabelFormatter");
};
}; // end of sap/ca/ui/charts/StackedVerticalColumnChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.VerticalBarChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.VerticalBarChart.
jQuery.sap.declare("sap.ca.ui.charts.VerticalBarChart");




/**
 * Constructor for a new charts/VerticalBarChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getData data} : object</li>
 * <li>{@link #getContainer container} : string (default: 'chart')</li>
 * <li>{@link #getBarWidth barWidth} : int (default: 48)</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li>
 * <li>{@link #getScroll scroll} : sap.m.ScrollContainer</li>
 * <li>{@link #getVerticalBarChart verticalBarChart} : sap.viz.ui5.Column</li>
 * <li>{@link #getVerticalArea verticalArea} : sap.m.VBox</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Allows you to create a chart using vertical bars to represent the data
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.VerticalBarChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"data" : {type : "object", group : "Data", defaultValue : null},
		"container" : {type : "string", group : "Identification", defaultValue : 'chart'},
		"barWidth" : {type : "int", group : "Appearance", defaultValue : 48}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content"}, 
    	"scroll" : {type : "sap.m.ScrollContainer", multiple : false}, 
    	"verticalBarChart" : {type : "sap.viz.ui5.Column", multiple : false}, 
    	"verticalArea" : {type : "sap.m.VBox", multiple : false}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.VerticalBarChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.VerticalBarChart.extend
 * @function
 */


/**
 * Getter for property <code>data</code>.
 * The data to be used by the chart
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>data</code>
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getData
 * @function
 */

/**
 * Setter for property <code>data</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oData  new value for property <code>data</code>
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setData
 * @function
 */


/**
 * Getter for property <code>container</code>.
 * The DOM ID where the chart will be added. Deprecated
 *
 * Default value is <code>chart</code>
 *
 * @return {string} the value of property <code>container</code>
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getContainer
 * @function
 */

/**
 * Setter for property <code>container</code>.
 *
 * Default value is <code>chart</code> 
 *
 * @param {string} sContainer  new value for property <code>container</code>
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setContainer
 * @function
 */


/**
 * Getter for property <code>barWidth</code>.
 * Minimum shape size for touch enabled actions, default and minimum to 48px !
 *
 * Default value is <code>48</code>
 *
 * @return {int} the value of property <code>barWidth</code>
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getBarWidth
 * @function
 */

/**
 * Setter for property <code>barWidth</code>.
 *
 * Default value is <code>48</code> 
 *
 * @param {int} iBarWidth  new value for property <code>barWidth</code>
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setBarWidth
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#destroyContent
 * @function
 */


/**
 * Getter for aggregation <code>scroll</code>.<br/>
 * 
 * 
 * @return {sap.m.ScrollContainer}
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getScroll
 * @function
 */


/**
 * Setter for the aggregated <code>scroll</code>.
 * @param oScroll {sap.m.ScrollContainer}
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setScroll
 * @function
 */
	

/**
 * Destroys the scroll in the aggregation 
 * named <code>scroll</code>.
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#destroyScroll
 * @function
 */


/**
 * Getter for aggregation <code>verticalBarChart</code>.<br/>
 * 
 * 
 * @return {sap.viz.ui5.Column}
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getVerticalBarChart
 * @function
 */


/**
 * Setter for the aggregated <code>verticalBarChart</code>.
 * @param oVerticalBarChart {sap.viz.ui5.Column}
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setVerticalBarChart
 * @function
 */
	

/**
 * Destroys the verticalBarChart in the aggregation 
 * named <code>verticalBarChart</code>.
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#destroyVerticalBarChart
 * @function
 */


/**
 * Getter for aggregation <code>verticalArea</code>.<br/>
 * The vertical layout
 * 
 * @return {sap.m.VBox}
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#getVerticalArea
 * @function
 */


/**
 * Setter for the aggregated <code>verticalArea</code>.
 * @param oVerticalArea {sap.m.VBox}
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#setVerticalArea
 * @function
 */
	

/**
 * Destroys the verticalArea in the aggregation 
 * named <code>verticalArea</code>.
 * @return {sap.ca.ui.charts.VerticalBarChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.VerticalBarChart#destroyVerticalArea
 * @function
 */


// Start of sap\ca\ui\charts\VerticalBarChart.js
jQuery.sap.declare("sap.ca.ui.charts.VerticalBarChart");


/**
 * @name ap.ca.ui.charts.VerticalBarChart#init
 * @function
 */
sap.ca.ui.charts.VerticalBarChart.prototype.init = function() {
    sap.ca.ui.charts.Chart.prototype.init.apply(this);
    this.setChartType("Column");
}

sap.ca.ui.charts.VerticalBarChart.prototype.setData = function(oData){
    this._oInternalVizChart.setModel(oData);
}

sap.ca.ui.charts.VerticalBarChart.prototype.getContainer = function(){
    return this.getId();
}

sap.ca.ui.charts.VerticalBarChart.prototype.setContainer = function(sId){
    jQuery.sap.log.warning("Usage of deprecated feature, please use instead the generated ID : "+ this.getId());
}
sap.ca.ui.charts.VerticalBarChart.prototype.setBarWidth = function(iBarWidth){
    this.setProperty("minShapeSize", iBarWidth);
}

sap.ca.ui.charts.VerticalBarChart.prototype.getBarWidth = function(){
    return this.getProperty("minShapeSize");
}

sap.ca.ui.charts.VerticalBarChart.prototype.setContent = function(oContent){
    jQuery.sap.log.warning("Usage of deprecated feature, please use setAggregation('internalContent')");
}
sap.ca.ui.charts.VerticalBarChart.prototype.getContent = function(){
    jQuery.sap.log.warning("Usage of deprecated feature please use getAggregation('internalContent')");
    return null;
}
sap.ca.ui.charts.VerticalBarChart.prototype.setScroll = function(oScroll){
    jQuery.sap.log.warning("Usage of deprecated feature please use setAggregation('internalContent')");
}
sap.ca.ui.charts.VerticalBarChart.prototype.getScroll = function(){
    return this.getAggregation("internalContent");
}

sap.ca.ui.charts.VerticalBarChart.prototype.getVerticalBarChart = function(){
    return this.getAggregation("internalVizChart");
}
sap.ca.ui.charts.VerticalBarChart.prototype.setVerticalBarChart = function(oVerticalBarChart){
    this.setAggregation("internalVizChart", oVerticalBarChart);
}

sap.ca.ui.charts.VerticalBarChart.prototype.getVerticalArea = function(){
    jQuery.sap.log.warning("Usage of deprecated feature please use getAggregation('internalContent')");
    return null;
}

sap.ca.ui.charts.VerticalBarChart.prototype.setVerticalArea = function(oVerticalArea){
    jQuery.sap.log.warning("Usage of deprecated feature, please use setAggregation('internalContent')");
}








}; // end of sap/ca/ui/charts/VerticalBarChart.js
if ( !jQuery.sap.isDeclared('sap.ca.ui.charts.BubbleChart') ) {
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright
 * 		2009-2012 SAP AG. All rights reserved
 */

/* ----------------------------------------------------------------------------------
 * Hint: This is a derived (generated) file. Changes should be done in the underlying 
 * source files only (*.control, *.js) or they will be lost after the next generation.
 * ---------------------------------------------------------------------------------- */

// Provides control sap.ca.ui.charts.BubbleChart.
jQuery.sap.declare("sap.ca.ui.charts.BubbleChart");




/**
 * Constructor for a new charts/BubbleChart.
 * 
 * Accepts an object literal <code>mSettings</code> that defines initial 
 * property values, aggregated and associated objects as well as event handlers. 
 * 
 * If the name of a setting is ambiguous (e.g. a property has the same name as an event), 
 * then the framework assumes property, aggregation, association, event in that order. 
 * To override this automatic resolution, one of the prefixes "aggregation:", "association:" 
 * or "event:" can be added to the name of the setting (such a prefixed name must be
 * enclosed in single or double quotes).
 *
 * The supported settings are:
 * <ul>
 * <li>Properties
 * <ul>
 * <li>{@link #getDataLabelFormat dataLabelFormat} : any</li>
 * <li>{@link #getShowTitle showTitle} : boolean (default: false)</li>
 * <li>{@link #getShowXAxisLabel showXAxisLabel} : boolean (default: true)</li>
 * <li>{@link #getXAxisFixedRange xAxisFixedRange} : boolean (default: false)</li>
 * <li>{@link #getXAxisMinValue xAxisMinValue} : float (default: 0)</li>
 * <li>{@link #getXAxisMaxValue xAxisMaxValue} : float (default: 0)</li>
 * <li>{@link #getShowYAxisLabel showYAxisLabel} : boolean (default: true)</li>
 * <li>{@link #getYAxisFixedRange yAxisFixedRange} : boolean (default: false)</li>
 * <li>{@link #getYAxisMinValue yAxisMinValue} : float (default: 0)</li>
 * <li>{@link #getYAxisMaxValue yAxisMaxValue} : float (default: 0)</li>
 * <li>{@link #getShowSizeLegend showSizeLegend} : boolean (default: false)</li>
 * <li>{@link #getXAxisTitle xAxisTitle} : string</li>
 * <li>{@link #getYAxisTitle yAxisTitle} : string</li>
 * <li>{@link #getShowCustomLabels showCustomLabels} : boolean (default: false)</li>
 * <li>{@link #getLabelProperty labelProperty} : object</li>
 * <li>{@link #getXAxisFormatFunction xAxisFormatFunction} : object</li>
 * <li>{@link #getXAxisFormatString xAxisFormatString} : string</li>
 * <li>{@link #getYAxisFormatFunction yAxisFormatFunction} : object</li>
 * <li>{@link #getYAxisFormatString yAxisFormatString} : string</li>
 * <li>{@link #getAxisTooltipFormatString axisTooltipFormatString} : any</li>
 * <li>{@link #getAxisFormatFunction axisFormatFunction} : object</li></ul>
 * </li>
 * <li>Aggregations
 * <ul>
 * <li>{@link #getContent content} : sap.ui.core.Control[]</li></ul>
 * </li>
 * <li>Associations
 * <ul></ul>
 * </li>
 * <li>Events
 * <ul></ul>
 * </li>
 * </ul> 
 *
 * 
 * In addition, all settings applicable to the base type {@link sap.ca.ui.charts.Chart#constructor sap.ca.ui.charts.Chart}
 * can be used as well.
 *
 * @param {string} [sId] id for the new control, generated automatically if no id is given 
 * @param {object} [mSettings] initial settings for the new control
 *
 * @class
 * Add your documentation for the newcharts/BubbleChart
 * @extends sap.ca.ui.charts.Chart
 *
 * @author  
 * @version 1.16.4
 *
 * @constructor   
 * @public
 * @name sap.ca.ui.charts.BubbleChart
 */
sap.ca.ui.charts.Chart.extend("sap.ca.ui.charts.BubbleChart", { metadata : {

	// ---- object ----

	// ---- control specific ----
	library : "sap.ca.ui",
	properties : {
		"dataLabelFormat" : {type : "any", group : "Appearance", defaultValue : null, deprecated: true},
		"showTitle" : {type : "boolean", group : "Appearance", defaultValue : false},
		"showXAxisLabel" : {type : "boolean", group : "Appearance", defaultValue : true},
		"xAxisFixedRange" : {type : "boolean", group : "Appearance", defaultValue : false},
		"xAxisMinValue" : {type : "float", group : "Appearance", defaultValue : 0},
		"xAxisMaxValue" : {type : "float", group : "Appearance", defaultValue : 0},
		"showYAxisLabel" : {type : "boolean", group : "Appearance", defaultValue : true},
		"yAxisFixedRange" : {type : "boolean", group : "Appearance", defaultValue : false},
		"yAxisMinValue" : {type : "float", group : "Appearance", defaultValue : 0},
		"yAxisMaxValue" : {type : "float", group : "Appearance", defaultValue : 0},
		"showSizeLegend" : {type : "boolean", group : "Appearance", defaultValue : false},
		"xAxisTitle" : {type : "string", group : "Appearance", defaultValue : null},
		"yAxisTitle" : {type : "string", group : "Appearance", defaultValue : null},
		"showCustomLabels" : {type : "boolean", group : "Appearance", defaultValue : false},
		"labelProperty" : {type : "object", group : "Appearance", defaultValue : null},
		"xAxisFormatFunction" : {type : "object", group : "Appearance", defaultValue : null, deprecated: true},
		"xAxisFormatString" : {type : "string", group : "Appearance", defaultValue : null, deprecated: true},
		"yAxisFormatFunction" : {type : "object", group : "Appearance", defaultValue : null, deprecated: true},
		"yAxisFormatString" : {type : "string", group : "Appearance", defaultValue : null, deprecated: true},
		"axisTooltipFormatString" : {type : "any", group : "Appearance", defaultValue : null, deprecated: true},
		"axisFormatFunction" : {type : "object", group : "Appearance", defaultValue : null, deprecated: true}
	},
	aggregations : {
    	"content" : {type : "sap.ui.core.Control", multiple : true, singularName : "content"}
	}
}});


/**
 * Creates a new subclass of class sap.ca.ui.charts.BubbleChart with name <code>sClassName</code> 
 * and enriches it with the information contained in <code>oClassInfo</code>.
 * 
 * <code>oClassInfo</code> might contain the same kind of informations as described in {@link sap.ui.core.Element.extend Element.extend}.
 *   
 * @param {string} sClassName name of the class to be created
 * @param {object} [oClassInfo] object literal with informations about the class  
 * @param {function} [FNMetaImpl] constructor function for the metadata object. If not given, it defaults to sap.ui.core.ElementMetadata.
 * @return {function} the created class / constructor function
 * @public
 * @static
 * @name sap.ca.ui.charts.BubbleChart.extend
 * @function
 */


/**
 * Getter for property <code>dataLabelFormat</code>.
 * Defines the formater string for the dataLabel value to be displayed on the bubble
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>dataLabelFormat</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the dataLabelFormatter for any formatting of data label
 * @name sap.ca.ui.charts.BubbleChart#getDataLabelFormat
 * @function
 */

/**
 * Setter for property <code>dataLabelFormat</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oDataLabelFormat  new value for property <code>dataLabelFormat</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the dataLabelFormatter for any formatting of data label
 * @name sap.ca.ui.charts.BubbleChart#setDataLabelFormat
 * @function
 */


/**
 * Getter for property <code>showTitle</code>.
 * Flag to display the title for the chart, default is set to false
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showTitle</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getShowTitle
 * @function
 */

/**
 * Setter for property <code>showTitle</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowTitle  new value for property <code>showTitle</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setShowTitle
 * @function
 */


/**
 * Getter for property <code>showXAxisLabel</code>.
 * Flag to set the visibility of x-axis label, default is set to true.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showXAxisLabel</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getShowXAxisLabel
 * @function
 */

/**
 * Setter for property <code>showXAxisLabel</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowXAxisLabel  new value for property <code>showXAxisLabel</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setShowXAxisLabel
 * @function
 */


/**
 * Getter for property <code>xAxisFixedRange</code>.
 * Flag to define x-axis scale range.
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>xAxisFixedRange</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getXAxisFixedRange
 * @function
 */

/**
 * Setter for property <code>xAxisFixedRange</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bXAxisFixedRange  new value for property <code>xAxisFixedRange</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setXAxisFixedRange
 * @function
 */


/**
 * Getter for property <code>xAxisMinValue</code>.
 * Define the minimum value for x-axis scale
 *
 * Default value is <code>0</code>
 *
 * @return {float} the value of property <code>xAxisMinValue</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getXAxisMinValue
 * @function
 */

/**
 * Setter for property <code>xAxisMinValue</code>.
 *
 * Default value is <code>0</code> 
 *
 * @param {float} fXAxisMinValue  new value for property <code>xAxisMinValue</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setXAxisMinValue
 * @function
 */


/**
 * Getter for property <code>xAxisMaxValue</code>.
 * Define the max value for x-axis scale
 *
 * Default value is <code>0</code>
 *
 * @return {float} the value of property <code>xAxisMaxValue</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getXAxisMaxValue
 * @function
 */

/**
 * Setter for property <code>xAxisMaxValue</code>.
 *
 * Default value is <code>0</code> 
 *
 * @param {float} fXAxisMaxValue  new value for property <code>xAxisMaxValue</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setXAxisMaxValue
 * @function
 */


/**
 * Getter for property <code>showYAxisLabel</code>.
 * Flag to set the visibility of y-axis label, default is set to true.
 *
 * Default value is <code>true</code>
 *
 * @return {boolean} the value of property <code>showYAxisLabel</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getShowYAxisLabel
 * @function
 */

/**
 * Setter for property <code>showYAxisLabel</code>.
 *
 * Default value is <code>true</code> 
 *
 * @param {boolean} bShowYAxisLabel  new value for property <code>showYAxisLabel</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setShowYAxisLabel
 * @function
 */


/**
 * Getter for property <code>yAxisFixedRange</code>.
 * Flag to define y-axis scale range.
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>yAxisFixedRange</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getYAxisFixedRange
 * @function
 */

/**
 * Setter for property <code>yAxisFixedRange</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bYAxisFixedRange  new value for property <code>yAxisFixedRange</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setYAxisFixedRange
 * @function
 */


/**
 * Getter for property <code>yAxisMinValue</code>.
 * Define the minimum value for y-axis scale
 *
 * Default value is <code>0</code>
 *
 * @return {float} the value of property <code>yAxisMinValue</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getYAxisMinValue
 * @function
 */

/**
 * Setter for property <code>yAxisMinValue</code>.
 *
 * Default value is <code>0</code> 
 *
 * @param {float} fYAxisMinValue  new value for property <code>yAxisMinValue</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setYAxisMinValue
 * @function
 */


/**
 * Getter for property <code>yAxisMaxValue</code>.
 * Define the max value for y-axis scale
 *
 * Default value is <code>0</code>
 *
 * @return {float} the value of property <code>yAxisMaxValue</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getYAxisMaxValue
 * @function
 */

/**
 * Setter for property <code>yAxisMaxValue</code>.
 *
 * Default value is <code>0</code> 
 *
 * @param {float} fYAxisMaxValue  new value for property <code>yAxisMaxValue</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setYAxisMaxValue
 * @function
 */


/**
 * Getter for property <code>showSizeLegend</code>.
 * Show / Hide the visibility the size legend of the chart
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showSizeLegend</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getShowSizeLegend
 * @function
 */

/**
 * Setter for property <code>showSizeLegend</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowSizeLegend  new value for property <code>showSizeLegend</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setShowSizeLegend
 * @function
 */


/**
 * Getter for property <code>xAxisTitle</code>.
 * Set x-axis title
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>xAxisTitle</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getXAxisTitle
 * @function
 */

/**
 * Setter for property <code>xAxisTitle</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sXAxisTitle  new value for property <code>xAxisTitle</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setXAxisTitle
 * @function
 */


/**
 * Getter for property <code>yAxisTitle</code>.
 * Set y-axis title
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>yAxisTitle</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getYAxisTitle
 * @function
 */

/**
 * Setter for property <code>yAxisTitle</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sYAxisTitle  new value for property <code>yAxisTitle</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setYAxisTitle
 * @function
 */


/**
 * Getter for property <code>showCustomLabels</code>.
 * Flag to show custom data labels
 *
 * Default value is <code>false</code>
 *
 * @return {boolean} the value of property <code>showCustomLabels</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getShowCustomLabels
 * @function
 */

/**
 * Setter for property <code>showCustomLabels</code>.
 *
 * Default value is <code>false</code> 
 *
 * @param {boolean} bShowCustomLabels  new value for property <code>showCustomLabels</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setShowCustomLabels
 * @function
 */


/**
 * Getter for property <code>labelProperty</code>.
 * Set the binding property values for the labels as array eg. ['property1','property2']. Only 2 labels are supported.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>labelProperty</code>
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getLabelProperty
 * @function
 */

/**
 * Setter for property <code>labelProperty</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oLabelProperty  new value for property <code>labelProperty</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#setLabelProperty
 * @function
 */


/**
 * Getter for property <code>xAxisFormatFunction</code>.
 * Set the formatter function for the x-axis.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>xAxisFormatFunction</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the xAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#getXAxisFormatFunction
 * @function
 */

/**
 * Setter for property <code>xAxisFormatFunction</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oXAxisFormatFunction  new value for property <code>xAxisFormatFunction</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the xAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#setXAxisFormatFunction
 * @function
 */


/**
 * Getter for property <code>xAxisFormatString</code>.
 * Set the format string for x-axis
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>xAxisFormatString</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the xAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#getXAxisFormatString
 * @function
 */

/**
 * Setter for property <code>xAxisFormatString</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sXAxisFormatString  new value for property <code>xAxisFormatString</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the xAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#setXAxisFormatString
 * @function
 */


/**
 * Getter for property <code>yAxisFormatFunction</code>.
 * Set the formatter function for the y-axis.
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>yAxisFormatFunction</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the yAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#getYAxisFormatFunction
 * @function
 */

/**
 * Setter for property <code>yAxisFormatFunction</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oYAxisFormatFunction  new value for property <code>yAxisFormatFunction</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the yAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#setYAxisFormatFunction
 * @function
 */


/**
 * Getter for property <code>yAxisFormatString</code>.
 * Set the format string for y-axis
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {string} the value of property <code>yAxisFormatString</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the yAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#getYAxisFormatString
 * @function
 */

/**
 * Setter for property <code>yAxisFormatString</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {string} sYAxisFormatString  new value for property <code>yAxisFormatString</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the yAxisLabelFormatter for any formatting of the axis labels
 * @name sap.ca.ui.charts.BubbleChart#setYAxisFormatString
 * @function
 */


/**
 * Getter for property <code>axisTooltipFormatString</code>.
 * Flag to set the formatting of the tooltip on x-axis
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {any} the value of property <code>axisTooltipFormatString</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the plotAreaAxisTooltipFormatter
 * @name sap.ca.ui.charts.BubbleChart#getAxisTooltipFormatString
 * @function
 */

/**
 * Setter for property <code>axisTooltipFormatString</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {any} oAxisTooltipFormatString  new value for property <code>axisTooltipFormatString</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the plotAreaAxisTooltipFormatter
 * @name sap.ca.ui.charts.BubbleChart#setAxisTooltipFormatString
 * @function
 */


/**
 * Getter for property <code>axisFormatFunction</code>.
 * Set the formatter function for the axis labels or tooltips
 *
 * Default value is empty/<code>undefined</code>
 *
 * @return {object} the value of property <code>axisFormatFunction</code>
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the plotAreaAxisTooltipFormatter
 * @name sap.ca.ui.charts.BubbleChart#getAxisFormatFunction
 * @function
 */

/**
 * Setter for property <code>axisFormatFunction</code>.
 *
 * Default value is empty/<code>undefined</code> 
 *
 * @param {object} oAxisFormatFunction  new value for property <code>axisFormatFunction</code>
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @deprecated Since version 7.20.0. 
 * This method is deprecated now. Use the plotAreaAxisTooltipFormatter
 * @name sap.ca.ui.charts.BubbleChart#setAxisFormatFunction
 * @function
 */


/**
 * Getter for aggregation <code>content</code>.<br/>
 * 
 * 
 * @return {sap.ui.core.Control[]}
 * @public
 * @name sap.ca.ui.charts.BubbleChart#getContent
 * @function
 */


/**
 * Inserts a content into the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *          oContent the content to insert; if empty, nothing is inserted
 * @param {int}
 *             iIndex the <code>0</code>-based index the content should be inserted at; for 
 *             a negative value of <code>iIndex</code>, the content is inserted at position 0; for a value 
 *             greater than the current size of the aggregation, the content is inserted at 
 *             the last position        
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#insertContent
 * @function
 */

/**
 * Adds some content <code>oContent</code> 
 * to the aggregation named <code>content</code>.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content to add; if empty, nothing is inserted
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#addContent
 * @function
 */

/**
 * Removes an content from the aggregation named <code>content</code>.
 *
 * @param {int | string | sap.ui.core.Control} vContent the content to remove or its index or id
 * @return {sap.ui.core.Control} the removed content or null
 * @public
 * @name sap.ca.ui.charts.BubbleChart#removeContent
 * @function
 */

/**
 * Removes all the controls in the aggregation named <code>content</code>.<br/>
 * Additionally unregisters them from the hosting UIArea.
 * @return {sap.ui.core.Control[]} an array of the removed elements (might be empty)
 * @public
 * @name sap.ca.ui.charts.BubbleChart#removeAllContent
 * @function
 */

/**
 * Checks for the provided <code>sap.ui.core.Control</code> in the aggregation named <code>content</code> 
 * and returns its index if found or -1 otherwise.
 *
 * @param {sap.ui.core.Control}
 *            oContent the content whose index is looked for.
 * @return {int} the index of the provided control in the aggregation if found, or -1 otherwise
 * @public
 * @name sap.ca.ui.charts.BubbleChart#indexOfContent
 * @function
 */
	

/**
 * Destroys all the content in the aggregation 
 * named <code>content</code>.
 * @return {sap.ca.ui.charts.BubbleChart} <code>this</code> to allow method chaining
 * @public
 * @name sap.ca.ui.charts.BubbleChart#destroyContent
 * @function
 */


// Start of sap\ca\ui\charts\BubbleChart.js
///**
// * This file defines behavior for the control,
// */
sap.ca.ui.charts.BubbleChart.prototype.init = function () {

    sap.ca.ui.charts.Chart.prototype.init.apply(this);
    this.setChartType("Bubble");
    this.setProperty("showSizeLegend", this.getShowSizeLegend());

    this.sId = this.getId();
};

sap.ca.ui.charts.BubbleChart.prototype._getChartSettings = function () {

    var genericChartSettings = sap.ca.ui.charts.Chart.prototype._getChartSettings.call(this);
    var specificBubbleSettings = {
        sizeLegend:{
            visible:this.getShowLegend()
        },
        xAxis:{
            title:{
                visible:true,
                text:this.getXAxisTitle()
            },
            label:{
                visible:this.getShowXAxisLabel(),
                formatString:this.getXAxisFormatString()
            },
            scale:{
                fixedRange:this.getXAxisFixedRange(),
                minValue:this.getXAxisMinValue(),
                maxValue:this.getXAxisMaxValue()
            }
        },
        yAxis:{
            title:{
                visible:true,
                text:this.getYAxisTitle()
            },
            label:{
                visible:this.getShowYAxisLabel(),
                formatString:this.getYAxisFormatString()
            },
            scale:{
                fixedRange:this.getYAxisFixedRange(),
                minValue:this.getYAxisMinValue(),
                maxValue:this.getYAxisMaxValue()
            }
        },
        plotArea:{
            axisTooltip:{
                formatString:this.getAxisTooltipFormatString()
            }
        },
        dataLabel:{
            visible:this.getShowDataLabel(),
            formatString:this.getDataLabelFormat()
        }
    };
    return jQuery.extend(true, genericChartSettings, specificBubbleSettings);
};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisFixedRange = function (bValue) {
    this._oInternalVizChart.getXAxis().getScale().setFixedRange(bValue);
    this.setProperty("xAxisFixedRange", bValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisFixedRange = function (bValue) {
    this._oInternalVizChart.getYAxis().getScale().setFixedRange(bValue);
    this.setProperty("yAxisFixedRange", bValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisMinValue = function (iValue) {
    this._oInternalVizChart.getXAxis().getScale().setMinValue(iValue);
    this.setProperty("xAxisMinValue", iValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisMinValue = function (iValue) {
    this._oInternalVizChart.getYAxis().getScale().setMinValue(iValue);
    this.setProperty("yAxisMinValue", iValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisMaxValue = function (iValue) {
    this._oInternalVizChart.getXAxis().getScale().setMaxValue(iValue);
    this.setProperty("xAxisMaxValue", iValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisMaxValue = function (iValue) {
    this._oInternalVizChart.getYAxis().getScale().setMaxValue(iValue);
    this.setProperty("yAxisMaxValue", iValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisTitle = function (sValue) {
    this._oInternalVizChart.getXAxis().getTitle().setText(sValue);
    this.setProperty("xAxisTitle", sValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisTitle = function (sValue) {
    this._oInternalVizChart.getYAxis().getTitle().setText(sValue);
    this.setProperty("yAxisTitle", sValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setShowXAxisLabel = function (bValue) {
    this._oInternalVizChart.getXAxis().getLabel().setVisible(bValue);
    this.setProperty("xAxisLabel", bValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setShowYAxisLabel = function (bValue) {
    this._oInternalVizChart.getYAxis().getLabel().setVisible(bValue);
    this.setProperty("yAxisLabel", bValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setDataLabelFormat = function (aFormat) {
    this._oInternalVizChart.getDataLabel().setFormatString(aFormat);
    this.setProperty("dataLabelFormat", aFormat);
};
sap.ca.ui.charts.BubbleChart.prototype.getDataLabelFormat = function () {
    if (!this.getProperty("dataLabelFormat")) {
        return this.getProperty("dataLabelFormatter");
    }
    jQuery.sap.log.warning("dataLabelFormat property is deprecated. Please use dataLabelFormatter.");
    return this.getProperty("dataLabelFormat");
};

sap.ca.ui.charts.BubbleChart.prototype.setShowSizeLegend = function (bShowSizeLegend) {
    this.setProperty("showSizeLegend", bShowSizeLegend);
    if (this._oInternalVizChart) {
        this._oInternalVizChart.getSizeLegend().setVisible(bShowSizeLegend);
    }
    return this;
};

sap.ca.ui.charts.BubbleChart.prototype.formatDataLabel = function (oEvent) {
    var oChartElt = d3.select(jQuery.sap.byId(this.getId()).children()[0]).select('.v-m-root');
    oChartElt.selectAll('.sapBubbleTxt').remove();

    if (this._oInternalVizChart.getDataset() && this.aData.length > 0) {
        oChartElt = d3.select(jQuery.sap.byId(this.getId()).children()[0]).select('.v-m-root');
        var aDatapoints = oChartElt.selectAll('.v-datapoint');
        var oChartBoundingRect = oChartElt.node().getBoundingClientRect();
        var aBubbleData = this.aData;
        var aLabelProperties = this.getLabelProperty();
        oChartElt.selectAll('.sapBubbleTxt').remove();


        aDatapoints.each(function (d, i) {
            var oPointBoundingRect = this.getBoundingClientRect();
            var x = oPointBoundingRect.left - oChartBoundingRect.left;
            var y = oPointBoundingRect.top + oPointBoundingRect.height / 2 - oChartBoundingRect.top;
            var nTextLength = oPointBoundingRect.right - oPointBoundingRect.left;

            if (sap.ui.Device.browser.firefox) {
                y = y - 10;
            }

            if ((oPointBoundingRect.right - oPointBoundingRect.left) > 60) {
                var sLabelProp1 = aLabelProperties[0];
                if (sLabelProp1) {
                    var sLabel1 = aBubbleData[this.__data__.ctx[0].path.dii_a1][sLabelProp1];
                    if (sap.ui.Device.browser.internet_explorer) {
                        var xPathId = "path" + d.x + sLabel1;
                        oChartElt.append("path").attr("id", xPathId).attr("d", 'M ' + (x + 10) + " " + (y) + ' h ' + (nTextLength - 20)).style('stroke', 'none');
                        oChartElt.append('text').append("textPath").attr("xlink:href", "#" + xPathId).attr('class', 'sapBubbleTxt').text(sLabel1);
                    } else {
                        oChartElt.append("foreignObject")
                            .attr("width", nTextLength)
                            .attr("height", 20)
                            .attr('x', x)
                            .attr('y', y - 7)
                            .attr('text-anchor', 'middle')
                            .attr('pointer-events', 'none')
                            .attr('class', 'sapBubbleTxt')
                            .append("xhtml:body")
                            .style("background", "transparent")
                            .html("<div class='sapBubbleTxtDiv'>" + sLabel1 + "</div>");
                    }
                }

                var sLabelProp2 = aLabelProperties[1];
                if (sLabelProp2) {
                    var sLabel2 = aBubbleData[this.__data__.ctx[0].path.dii_a1][sLabelProp2];
                    if (sap.ui.Device.browser.internet_explorer) {
                        var yPathId = "path" + d.y + sLabel2;
                        oChartElt.append("path").attr("id", yPathId).attr("d", 'M ' + (x + 10) + " " + (y + 12) + ' h ' + (nTextLength - 20)).style('stroke', 'none');
                        oChartElt.append('text').append("textPath").attr("xlink:href", "#" + yPathId).attr('class', 'sapBubbleTxt').text(sLabel2);
                    } else {
                        oChartElt.append("foreignObject")
                            .attr("width", nTextLength)
                            .attr("height", 20)
                            .attr('x', x)
                            .attr('y', y + 4)
                            .attr('text-anchor', 'middle')
                            .attr('pointer-events', 'none')
                            .attr('class', 'sapBubbleTxt')
                            .append("xhtml:body")
                            .style("background", "transparent")
                            .html("<div class='sapBubbleTxtDiv' >" + sLabel2 + "</div>");
                    }
                }
            }
        });

    }
    else {
        jQuery.sap.log.error("BubbleChart: formatDataLabel not possible without dataset");
    }
};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisFormatFunction = function (fnValue) {
    if (fnValue) {
        this.setXAxisLabelFormatter(fnValue);
        this.oChartFormatter._legacyBubbleFormatter = fnValue;
    }
    this.setProperty("xAxisFormatFunction", fnValue);
};

sap.ca.ui.charts.BubbleChart.prototype.getXAxisFormatString = function () {
    if (!this.getProperty("xAxisFormatString") || this.getProperty("xAxisFormatString") == "") {
        return this.getProperty("xAxisLabelFormatter");
    }
    jQuery.sap.log.warning("xAxisFormatString property is deprecated. Please use xAxisLabelFormatter.");
    return this.getProperty("xAxisFormatString");

};

sap.ca.ui.charts.BubbleChart.prototype.setXAxisFormatString = function (sFormatString) {
    jQuery.sap.log.warning("xAxisFormatString property is deprecated. Please use xAxisLabelFormatter.");
    this.setProperty("xAxisFormatString", sFormatString);
    return this;
};

sap.ca.ui.charts.BubbleChart.prototype.getYAxisFormatString = function () {
    if (!this.getProperty("yAxisFormatString") || this.getProperty("yAxisFormatString") == "") {
        return this.getProperty("yAxisLabelFormatter");
    }
    jQuery.sap.log.warning("yAxisFormatString property is deprecated. Please use yAxisLabelFormatter.");
    return this.getProperty("yAxisFormatString");
};

sap.ca.ui.charts.BubbleChart.prototype.getAxisTooltipFormatString = function () {
    if (!this.getProperty("axisTooltipFormatString") || this.getProperty("axisTooltipFormatString") == "") {
        return this.getProperty("plotAreaAxisTooltipFormatter");
    }
    jQuery.sap.log.warning("axisTooltipFormatString property is deprecated. Please use plotAreaAxisTooltipFormatter.");
    return this.getProperty("axisTooltipFormatString");

};

sap.ca.ui.charts.BubbleChart.prototype.setAxisTooltipFormatString = function (sFormatString) {
    jQuery.sap.log.warning("axisTooltipFormatString property is deprecated. Please use axisTooltipFormatString.");
    this.setProperty("axisTooltipFormatString", sFormatString);
    return this;
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisFormatString = function (sFormatString) {
    jQuery.sap.log.warning("yAxisFormatString property is deprecated. Please use yAxisLabelFormatter.");
    this.setProperty("yAxisFormatString", sFormatString);
    return this;
};

sap.ca.ui.charts.BubbleChart.prototype.setYAxisFormatFunction = function (fnValue) {
    if (fnValue) {
        jQuery.sap.log.warning("yAxisFormatFunction property is deprecated. Please use yAxisLabelFormatter.");
        this.setYAxisLabelFormatter(fnValue);
        this.oChartFormatter._legacyBubbleFormatter = fnValue;
    }
    this.setProperty("yAxisFormatFunction", fnValue);
};

sap.ca.ui.charts.BubbleChart.prototype.setAxisFormatFunction = function (fnValue) {
    if (fnValue) {
        jQuery.sap.log.warning("axisFormatFunction property is deprecated. Please use plotAreaAxisTooltipFormatter.");
        this.axisLabelFormatter = fnValue;
        this.oChartFormatter._legacyBubbleFormatter = fnValue;
    }
    this.setProperty("axisFormatFunction", fnValue);
};

sap.ca.ui.charts.BubbleChart.prototype.getShowTitle = function () {
    return sap.ca.ui.charts.Chart.prototype.getTitle.apply(this);
};

sap.ca.ui.charts.BubbleChart.prototype.setShowTitle = function (sTitle) {
    sap.ca.ui.charts.Chart.prototype.setTitle.apply(this, sTitle);
};

sap.ca.ui.charts.BubbleChart.prototype.setContent = function (oContent) {
    jQuery.sap.log.warning("Usage of deprecated feature, please use setAggregation('internalContent')");
};

sap.ca.ui.charts.BubbleChart.prototype.getContent = function () {
    jQuery.sap.log.warning("Usage of deprecated feature please use getAggregation('internalContent')");
    return null;
};

sap.ca.ui.charts.BubbleChart.prototype.onChartInitialized = function (oEvent) {
    sap.ca.ui.charts.Chart.prototype.onChartInitialized.apply(this, arguments);
    var oData = this._oInternalVizChart.getModel().getData();
    this.aData = [];
    // Parse the data
    for (var key in oData) {
        if (jQuery.isArray(oData[key])) {
            this.aData = oData[key];
        }
    }

///    this.aData = this._oInternalVizChart.getDataset().getVIZDataset().getMeasureValuesGroupByIdx(2).getMeasureValues()[0].getValues()[0];

    if (this.getShowCustomLabels()) {
        this.formatDataLabel();
    }
};

sap.ca.ui.charts.BubbleChart.prototype.getShowLegend = function () {
    // one of them true => true
    return sap.ca.ui.charts.Chart.prototype.getShowLegend.call(this) || this.getShowSizeLegend();
};

sap.ca.ui.charts.BubbleChart.prototype.setShowLegend = function (bShow) {
    sap.ca.ui.charts.Chart.prototype.setShowLegend.call(this, bShow);
    this.setShowSizeLegend(bShow);
    return this;
};

}; // end of sap/ca/ui/charts/BubbleChart.js
