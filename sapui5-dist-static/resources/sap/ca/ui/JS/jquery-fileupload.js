/*
 * jQuery File Upload Plugin 5.32.2
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
try{(function(f){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','jquery.ui.widget'],f)}else{f(window.jQuery)}}(function($){'use strict';$.support.fileInput=!(new RegExp('(Android (1\\.[0156]|2\\.[01]))'+'|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)'+'|(w(eb)?OSBrowser)|(webOS)'+'|(Kindle/(1\\.0|2\\.[05]|3\\.0))').test(window.navigator.userAgent)||$('<input type="file">').prop('disabled'));$.support.xhrFileUpload=!!(window.XMLHttpRequestUpload&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget('blueimp.fileupload',{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:'Uploaded bytes exceed file size'},i18n:function(m,c){m=this.messages[m]||m.toString();if(c){$.each(c,function(k,v){m=m.replace('{'+k+'}',v)})}return m},formData:function(f){return f.serializeArray()},add:function(e,d){if(d.autoUpload||(d.autoUpload!==false&&$(this).fileupload('option','autoUpload'))){d.process().done(function(){d.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:['fileInput','dropZone','pasteZone','multipart','forceIframeTransport'],_blobSlice:$.support.blobSlice&&function(){var s=this.slice||this.webkitSlice||this.mozSlice;return s.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(n,l,i){var t=n-this.timestamp;if(!this.bitrate||!i||t>i){this.bitrate=(l-this.loaded)*(1000/t)*8;this.loaded=l;this.timestamp=n}return this.bitrate}},_isXHRUpload:function(o){return!o.forceIframeTransport&&((!o.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload)},_getFormData:function(o){var f;if(typeof o.formData==='function'){return o.formData(o.form)}if($.isArray(o.formData)){return o.formData}if($.type(o.formData)==='object'){f=[];$.each(o.formData,function(n,v){f.push({name:n,value:v})});return f}return[]},_getTotal:function(f){var t=0;$.each(f,function(i,a){t+=a.size||1});return t},_initProgressObject:function(o){var p={loaded:0,total:0,bitrate:0};if(o._progress){$.extend(o._progress,p)}else{o._progress=p}},_initResponseObject:function(o){var p;if(o._response){for(p in o._response){if(o._response.hasOwnProperty(p)){delete o._response[p]}}}else{o._response={}}},_onProgress:function(e,d){if(e.lengthComputable){var n=((Date.now)?Date.now():(new Date()).getTime()),l;if(d._time&&d.progressInterval&&(n-d._time<d.progressInterval)&&e.loaded!==e.total){return}d._time=n;l=Math.floor(e.loaded/e.total*(d.chunkSize||d._progress.total))+(d.uploadedBytes||0);this._progress.loaded+=(l-d._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,d.bitrateInterval);d._progress.loaded=d.loaded=l;d._progress.bitrate=d.bitrate=d._bitrateTimer.getBitrate(n,l,d.bitrateInterval);this._trigger('progress',e,d);this._trigger('progressall',e,this._progress)}},_initProgressListener:function(o){var t=this,x=o.xhr?o.xhr():$.ajaxSettings.xhr();if(x.upload){$(x.upload).bind('progress',function(e){var a=e.originalEvent;e.lengthComputable=a.lengthComputable;e.loaded=a.loaded;e.total=a.total;t._onProgress(e,o)});o.xhr=function(){return x}}},_isInstanceOf:function(t,o){return Object.prototype.toString.call(o)==='[object '+t+']'},_initXHRData:function(o){var t=this,f,a=o.files[0],m=o.multipart||!$.support.xhrFileUpload,p=o.paramName[0];o.headers=o.headers||{};if(o.contentRange){o.headers['Content-Range']=o.contentRange}if(!m||o.blob||!this._isInstanceOf('File',a)){o.headers['Content-Disposition']='attachment; filename="'+encodeURI(a.name)+'"'}if(!m){o.contentType=a.type;o.data=o.blob||a}else if($.support.xhrFormDataFileUpload){if(o.postMessage){f=this._getFormData(o);if(o.blob){f.push({name:p,value:o.blob})}else{$.each(o.files,function(i,a){f.push({name:o.paramName[i]||p,value:a})})}}else{if(t._isInstanceOf('FormData',o.formData)){f=o.formData}else{f=new FormData();$.each(this._getFormData(o),function(i,b){f.append(b.name,b.value)})}if(o.blob){f.append(p,o.blob,a.name)}else{$.each(o.files,function(i,a){if(t._isInstanceOf('File',a)||t._isInstanceOf('Blob',a)){f.append(o.paramName[i]||p,a,a.name)}})}}o.data=f}o.blob=null},_initIframeSettings:function(o){var t=$('<a></a>').prop('href',o.url).prop('host');o.dataType='iframe '+(o.dataType||'');o.formData=this._getFormData(o);if(o.redirect&&t&&t!==location.host){o.formData.push({name:o.redirectParamName||'redirect',value:o.redirect})}},_initDataSettings:function(o){if(this._isXHRUpload(o)){if(!this._chunkedUpload(o,true)){if(!o.data){this._initXHRData(o)}this._initProgressListener(o)}if(o.postMessage){o.dataType='postmessage '+(o.dataType||'')}}else{this._initIframeSettings(o)}},_getParamName:function(o){var f=$(o.fileInput),p=o.paramName;if(!p){p=[];f.each(function(){var a=$(this),n=a.prop('name')||'files[]',i=(a.prop('files')||[1]).length;while(i){p.push(n);i-=1}});if(!p.length){p=[f.prop('name')||'files[]']}}else if(!$.isArray(p)){p=[p]}return p},_initFormSettings:function(o){if(!o.form||!o.form.length){o.form=$(o.fileInput.prop('form'));if(!o.form.length){o.form=$(this.options.fileInput.prop('form'))}}o.paramName=this._getParamName(o);if(!o.url){o.url=o.form.prop('action')||location.href}o.type=(o.type||o.form.prop('method')||'').toUpperCase();if(o.type!=='POST'&&o.type!=='PUT'&&o.type!=='PATCH'){o.type='POST'}if(!o.formAcceptCharset){o.formAcceptCharset=o.form.attr('accept-charset')}},_getAJAXSettings:function(d){var o=$.extend({},this.options,d);this._initFormSettings(o);this._initDataSettings(o);return o},_getDeferredState:function(d){if(d.state){return d.state()}if(d.isResolved()){return'resolved'}if(d.isRejected()){return'rejected'}return'pending'},_enhancePromise:function(p){p.success=p.done;p.error=p.fail;p.complete=p.always;return p},_getXHRPromise:function(r,c,a){var d=$.Deferred(),p=d.promise();c=c||this.options.context||p;if(r===true){d.resolveWith(c,a)}else if(r===false){d.rejectWith(c,a)}p.abort=d.promise;return this._enhancePromise(p)},_addConvenienceMethods:function(e,d){var t=this,g=function(d){return $.Deferred().resolveWith(t,[d]).promise()};d.process=function(r,a){if(r||a){d._processQueue=this._processQueue=(this._processQueue||g(this)).pipe(r,a)}return this._processQueue||g(this)};d.submit=function(){if(this.state()!=='pending'){d.jqXHR=this.jqXHR=(t._trigger('submit',e,this)!==false)&&t._onSend(e,this)}return this.jqXHR||t._getXHRPromise()};d.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}return t._getXHRPromise()};d.state=function(){if(this.jqXHR){return t._getDeferredState(this.jqXHR)}if(this._processQueue){return t._getDeferredState(this._processQueue)}};d.progress=function(){return this._progress};d.response=function(){return this._response}},_getUploadedBytes:function(j){var r=j.getResponseHeader('Range'),p=r&&r.split('-'),u=p&&p.length>1&&parseInt(p[1],10);return u&&u+1},_chunkedUpload:function(a,t){a.uploadedBytes=a.uploadedBytes||0;var b=this,f=a.files[0],c=f.size,u=a.uploadedBytes,m=a.maxChunkSize||c,s=this._blobSlice,d=$.Deferred(),p=d.promise(),j,e;if(!(this._isXHRUpload(a)&&s&&(u||m<c))||a.data){return false}if(t){return true}if(u>=c){f.error=a.i18n('uploadedBytes');return this._getXHRPromise(false,a.context,[null,'error',f.error])}e=function(){var o=$.extend({},a),g=o._progress.loaded;o.blob=s.call(f,u,u+m,f.type);o.chunkSize=o.blob.size;o.contentRange='bytes '+u+'-'+(u+o.chunkSize-1)+'/'+c;b._initXHRData(o);b._initProgressListener(o);j=((b._trigger('chunksend',null,o)!==false&&$.ajax(o))||b._getXHRPromise(false,o.context)).done(function(r,h,j){u=b._getUploadedBytes(j)||(u+o.chunkSize);if(g+o.chunkSize-o._progress.loaded){b._onProgress($.Event('progress',{lengthComputable:true,loaded:u-o.uploadedBytes,total:u-o.uploadedBytes}),o)}a.uploadedBytes=o.uploadedBytes=u;o.result=r;o.textStatus=h;o.jqXHR=j;b._trigger('chunkdone',null,o);b._trigger('chunkalways',null,o);if(u<c){e()}else{d.resolveWith(o.context,[r,h,j])}}).fail(function(j,h,i){o.jqXHR=j;o.textStatus=h;o.errorThrown=i;b._trigger('chunkfail',null,o);b._trigger('chunkalways',null,o);d.rejectWith(o.context,[j,h,i])})};this._enhancePromise(p);p.abort=function(){return j.abort()};e();return p},_beforeSend:function(e,d){if(this._active===0){this._trigger('start');this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(d);this._initProgressObject(d);d._progress.loaded=d.loaded=d.uploadedBytes||0;d._progress.total=d.total=this._getTotal(d.files)||1;d._progress.bitrate=d.bitrate=0;this._active+=1;this._progress.loaded+=d.loaded;this._progress.total+=d.total},_onDone:function(r,t,j,o){var a=o._progress.total,b=o._response;if(o._progress.loaded<a){this._onProgress($.Event('progress',{lengthComputable:true,loaded:a,total:a}),o)}b.result=o.result=r;b.textStatus=o.textStatus=t;b.jqXHR=o.jqXHR=j;this._trigger('done',null,o)},_onFail:function(j,t,e,o){var r=o._response;if(o.recalculateProgress){this._progress.loaded-=o._progress.loaded;this._progress.total-=o._progress.total}r.jqXHR=o.jqXHR=j;r.textStatus=o.textStatus=t;r.errorThrown=o.errorThrown=e;this._trigger('fail',null,o)},_onAlways:function(j,t,a,o){this._trigger('always',null,o)},_onSend:function(e,d){if(!d.submit){this._addConvenienceMethods(e,d)}var t=this,j,a,s,p,o=t._getAJAXSettings(d),b=function(){t._sending+=1;o._bitrateTimer=new t._BitrateTimer();j=j||(((a||t._trigger('send',e,o)===false)&&t._getXHRPromise(false,o.context,a))||t._chunkedUpload(o)||$.ajax(o)).done(function(r,c,j){t._onDone(r,c,j,o)}).fail(function(j,c,f){t._onFail(j,c,f,o)}).always(function(c,f,g){t._onAlways(c,f,g,o);t._sending-=1;t._active-=1;if(o.limitConcurrentUploads&&o.limitConcurrentUploads>t._sending){var n=t._slots.shift();while(n){if(t._getDeferredState(n)==='pending'){n.resolve();break}n=t._slots.shift()}}if(t._active===0){t._trigger('stop')}});return j};this._beforeSend(e,o);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){s=$.Deferred();this._slots.push(s);p=s.pipe(b)}else{this._sequence=this._sequence.pipe(b,b);p=this._sequence}p.abort=function(){a=[undefined,'abort','abort'];if(!j){if(s){s.rejectWith(o.context,a)}return b()}return j.abort()};return this._enhancePromise(p)}return b()},_onAdd:function(e,d){var t=this,r=true,o=$.extend({},this.options,d),l=o.limitMultiFileUploads,p=this._getParamName(o),a,b,f,i;if(!(o.singleFileUploads||l)||!this._isXHRUpload(o)){f=[d.files];a=[p]}else if(!o.singleFileUploads&&l){f=[];a=[];for(i=0;i<d.files.length;i+=l){f.push(d.files.slice(i,i+l));b=p.slice(i,i+l);if(!b.length){b=p}a.push(b)}}else{a=p}d.originalFiles=d.files;$.each(f||d.files,function(c,g){var n=$.extend({},d);n.files=f?g:[g];n.paramName=a[c];t._initResponseObject(n);t._initProgressObject(n);t._addConvenienceMethods(e,n);r=t._trigger('add',e,n);return r});return r},_replaceFileInput:function(a){var b=a.clone(true);$('<form></form>').append(b)[0].reset();a.after(b).detach();$.cleanData(a.unbind('remove'));this.options.fileInput=this.options.fileInput.map(function(i,e){if(e===a[0]){return b[0]}return e});if(a[0]===this.element[0]){this.element=b}},_handleFileTreeEntry:function(a,p){var t=this,d=$.Deferred(),b=function(e){if(e&&!e.entry){e.entry=a}d.resolve([e])},c;p=p||'';if(a.isFile){if(a._file){a._file.relativePath=p;d.resolve(a._file)}else{a.file(function(f){f.relativePath=p;d.resolve(f)},b)}}else if(a.isDirectory){c=a.createReader();c.readEntries(function(e){t._handleFileTreeEntries(e,p+a.name+'/').done(function(f){d.resolve(f)}).fail(b)},b)}else{d.resolve([])}return d.promise()},_handleFileTreeEntries:function(e,p){var t=this;return $.when.apply($,$.map(e,function(a){return t._handleFileTreeEntry(a,p)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(d){d=d||{};var i=d.items;if(i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)){return this._handleFileTreeEntries($.map(i,function(a){var e;if(a.webkitGetAsEntry){e=a.webkitGetAsEntry();if(e){e._file=a.getAsFile()}return e}return a.getAsEntry()}))}return $.Deferred().resolve($.makeArray(d.files)).promise()},_getSingleFileInputFiles:function(f){f=$(f);var e=f.prop('webkitEntries')||f.prop('entries'),a,v;if(e&&e.length){return this._handleFileTreeEntries(e)}a=$.makeArray(f.prop('files'));if(!a.length){v=f.prop('value');if(!v){return $.Deferred().resolve([]).promise()}a=[{name:v.replace(/^.*\\/,'')}]}else if(a[0].name===undefined&&a[0].fileName){$.each(a,function(i,b){b.name=b.fileName;b.size=b.fileSize})}return $.Deferred().resolve(a).promise()},_getFileInputFiles:function(f){if(!(f instanceof $)||f.length===1){return this._getSingleFileInputFiles(f)}return $.when.apply($,$.map(f,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var t=this,d={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(d.fileInput).always(function(f){d.files=f;if(t.options.replaceFileInput){t._replaceFileInput(d.fileInput)}if(t._trigger('change',e,d)!==false){t._onAdd(e,d)}})},_onPaste:function(e){var i=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,d={files:[]};if(i&&i.length){$.each(i,function(a,b){var f=b.getAsFile&&b.getAsFile();if(f){d.files.push(f)}});if(this._trigger('paste',e,d)===false||this._onAdd(e,d)===false){return false}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=this,d=e.dataTransfer,a={};if(d&&d.files&&d.files.length){e.preventDefault();this._getDroppedFiles(d).always(function(f){a.files=f;if(t._trigger('drop',e,a)!==false){t._onAdd(e,a)}})}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var d=e.dataTransfer;if(d){if(this._trigger('dragover',e)===false){return false}if($.inArray('Files',d.types)!==-1){d.dropEffect='copy';e.preventDefault()}}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,'dragover drop');this._off(this.options.pasteZone,'paste');this._off(this.options.fileInput,'change')},_setOption:function(k,v){var r=$.inArray(k,this._specialOptions)!==-1;if(r){this._destroyEventHandlers()}this._super(k,v);if(r){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var o=this.options;if(o.fileInput===undefined){o.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else if(!(o.fileInput instanceof $)){o.fileInput=$(o.fileInput)}if(!(o.dropZone instanceof $)){o.dropZone=$(o.dropZone)}if(!(o.pasteZone instanceof $)){o.pasteZone=$(o.pasteZone)}},_getRegExp:function(s){var p=s.split('/'),m=p.pop();p.shift();return new RegExp(p.join('/'),m)},_isRegExpOption:function(k,v){return k!=='url'&&$.type(v)==='string'&&/^\/.*\/[igm]{0,3}$/.test(v)},_initDataAttributes:function(){var t=this,o=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(k,v){if(t._isRegExpOption(k,v)){v=t._getRegExp(v)}o[k]=v})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(d){var t=this;if(!d||this.options.disabled){return}if(d.fileInput&&!d.files){this._getFileInputFiles(d.fileInput).always(function(f){d.files=f;t._onAdd(null,d)})}else{d.files=$.makeArray(d.files);this._onAdd(null,d)}},send:function(d){if(d&&!this.options.disabled){if(d.fileInput&&!d.files){var t=this,a=$.Deferred(),p=a.promise(),j,b;p.abort=function(){b=true;if(j){return j.abort()}a.reject(null,'abort','abort');return p};this._getFileInputFiles(d.fileInput).always(function(f){if(b){return}if(!f.length){a.reject();return}d.files=f;j=t._onSend(null,d).then(function(r,c,j){a.resolve(r,c,j)},function(j,c,e){a.reject(j,c,e)})});return this._enhancePromise(p)}d.files=$.makeArray(d.files);if(d.files.length){return this._onSend(null,d)}}return this._getXHRPromise(false,d&&d.context)}})}))}catch(e){console.log(e)}
