/*! 
 * Copyright (c) Microsoft.  All rights reserved.
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal  in the Software without restriction, including without limitation the rights  to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR  IMPLIED, INCLUDING BUT NOT LIMITED TO THE
 * WARRANTIES OF MERCHANTABILITY,  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
 * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * datajs.js
 */
(function(w,u){if(!w.datajs){w.datajs={}}if(!w.OData){w.OData={}}var d=w.datajs;var o=w.OData;var P="b";var c="c";var f="entry";var g="f";var h="p";var j="s";var k="u";var l="n";var m="c";var n="d";var q="i";var r="p";var s="n";var t=function(a){return a!==null&&a!==u};var v=function(a,b){var i,e;for(i=0,e=a.length;i<e;i++){if(a[i]===b){return true}}return false};var z=function(a,b){return(a!==u)?a:b};var A=function(a){if(arguments.length===1){w.setTimeout(a,0);return}var b=Array.prototype.slice.call(arguments,1);w.setTimeout(function(){a.apply(this,b)},0)};var B=function(a,b){if(!a){return null}if(K(a)){var i,e,p;for(i=0,e=a.length;i<e;i++){p=B(a[i],b);if(p){return p}}return null}else{if(a.dataServices){return B(a.dataServices.schema,b)}return b(a)}};var C=function(a){return(a.__edmType==="Edm.DateTimeOffset"||(!a.__edmType&&a.__offset))};var D=function(a,b){if(a===0){a=""}else{a="."+H(a.toString(),3)}if(b>0){if(a===""){a=".000"}a+=H(b.toString(),4)}return a};var E=function(a){return"\/Date("+a.getTime()+")\/"};var F=function(a){if(typeof a==="string"){return a}var b=C(a);var e=I(a.__offset);if(b&&e!=="Z"){a=new Date(a.valueOf());var i=Z(e);var p=a.getUTCHours()+(i.d*i.h);var x=a.getMinutes()+(i.d*i.m);a.setUTCHours(p,x)}else if(!b){e=""}var y=a.getUTCFullYear();var _=a.getUTCMonth()+1;var N5="";if(y<=0){y=-(y-1);N5="-"}var ms=D(a.getUTCMilliseconds(),a.__ns);return N5+H(y,4)+"-"+H(_,2)+"-"+H(a.getUTCDate(),2)+"T"+H(a.getUTCHours(),2)+":"+H(a.getUTCMinutes(),2)+":"+H(a.getUTCSeconds(),2)+ms+e};var G=function(a){var b=a.ms;var e="";if(b<0){e="-";b=-b}var i=Math.floor(b/86400000);b-=86400000*i;var p=Math.floor(b/3600000);b-=3600000*p;var x=Math.floor(b/60000);b-=60000*x;var y=Math.floor(b/1000);b-=y*1000;return e+"P"+H(i,2)+"DT"+H(p,2)+"H"+H(x,2)+"M"+H(y,2)+D(b,a.ns)+"S"};var H=function(a,b,e){var i=a.toString(10);while(i.length<b){if(e){i+="0"}else{i="0"+i}}return i};var I=function(a){return(!a||a==="Z"||a==="+00:00"||a==="-00:00")?"Z":a};var J=function(a,b,e,L1,i,p){return i.request(a,function(x){try{if(x.headers){U(x.headers)}if(x.data===u){L1.read(x,p)}}catch(y){if(y.request===u){y.request=a}if(y.response===u){y.response=x}e(y);return}b(x.data,x)},e)};var K=function(a){return Object.prototype.toString.call(a)==="[object Array]"};var L=function(a){return Object.prototype.toString.call(a)==="[object Date]"};var M=function(p,a){if(p){var i,b;for(i=0,b=p.length;i<b;i++){if(p[i].name===a){return p[i]}}}return null};var N=function(a,b,e){return(a)?B(b,function(a4){return S(a,a4,e)}):null};var O=function(a,b){return N(a,b,"complexType")};var Q=function(a,b){return N(a,b,"entityType")};var R=function(a,b){if(b.indexOf(a)===0&&b.charAt(a.length)==="."){return b.substr(a.length+1)}return null};var S=function(a,b,e){if(b){var p=R(b["namespace"],a);var x=b[e];if(p&&x){var i,y;for(i=0,y=x.length;i<y;i++){if(x[i].name===p){return x[i]}}}}return null};var T={"accept":"Accept","content-type":"Content-Type","dataserviceversion":"DataServiceVersion","maxdataserviceversion":"MaxDataServiceVersion"};var U=function(a){for(var b in a){var e=b.toLowerCase();var i=T[e];if(i&&b!==i){var p=a[b];delete a[b];a[i]=p}}};var V=function(a,b){return(a!==u)?a:b};var W=function(a){return parseInt(a,10)};var X=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/;var Y=function(a){var p=X.exec(a);if(p===null){throw{message:"Invalid duration value."}}var y=p[2]||"0";var b=p[3]||"0";var e=W(p[4]||0);var i=W(p[5]||0);var x=W(p[6]||0);var _=parseFloat(p[7]||0);if(y!=="0"||b!=="0"){throw{message:"Unsupported duration value."}}var ms=p[8];var ns=0;if(!ms){ms=0}else{if(ms.length>7){throw{message:"Cannot parse duration value to given precision."}}ns=H(ms.substring(3),4,true);ms=H(ms.substring(0,3),3,true);ms=W(ms);ns=W(ns)}ms+=_*1000+x*60000+i*3600000+e*86400000;if(p[1]==="-"){ms=-ms}var N5={ms:ms,__edmType:"Edm.Time"};if(ns){N5.ns=ns}return N5};var Z=function(a){var b=a.substring(0,1);b=(b==="+")?1:-1;var e=W(a.substring(1));var i=W(a.substring(a.indexOf(":")+1));return{d:b,h:e,m:i}};var $=function(a){switch(typeof(a)){case"object":if(!a){return l}if(K(a)||K(a.results)){return g}if(a.__metadata&&a.__metadata.uri!==u){return f}if(K(a.EntitySets)){return j}if(K(a.__batchRequests)){return P}if(L(a)){return h}return c;case"string":case"number":case"boolean":return h}return k};var a1=function(a,L1,b){if(!a.method){a.method="GET"}if(!a.headers){a.headers={}}else{U(a.headers)}if(a.headers.Accept===u){a.headers.Accept=L1.accept}if(t(a.data)&&a.body===u){L1.write(a,b)}if(!t(a.headers.MaxDataServiceVersion)){a.headers.MaxDataServiceVersion=L1.maxDataServiceVersion||"1.0"}if(a.async===u){a.async=true}};var b1=function(a){switch($(a)){case c:if(a.__deferred&&a.__deferred.uri){return n}return m;case g:case f:return q;case h:return r}return s};var c1=function(e){throw e};var d1=function(a){if(a.trim){return a.trim()}return a.replace(/^\s+|\s+$/g,'')};var e1=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/;var f1=["scheme","authority","path","query","fragment"];var g1=function(a){var b={isAbsolute:false};if(a){var e=e1.exec(a);if(e){var i,p;for(i=0,p=f1.length;i<p;i++){if(e[i+1]){b[f1[i]]=e[i+1]}}}if(b.scheme){b.isAbsolute=true}}return b};var h1=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")};var i1=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/;var j1=/%[0-9A-F]{2}/ig;var k1=function(a){var b=g1(a);var e=b.scheme;var i=b.authority;if(e){b.scheme=e.toLowerCase();if(i){var p=i1.exec(i);if(p){b.authority="//"+(p[1]?p[1]+"@":"")+(p[2].toLowerCase())+(p[3]?":"+p[3]:"")}}}a=h1(b);return a.replace(j1,function(x){return x.toLowerCase()})};var l1=function(a,b){if(!b){return a}var e=g1(a);if(e.isAbsolute){return a}var i=g1(b);var p={};var x;if(e.authority){p.authority=e.authority;x=e.path;p.query=e.query}else{if(!e.path){x=i.path;p.query=e.query||i.query}else{if(e.path.charAt(0)==='/'){x=e.path}else{x=m1(e.path,i.path)}p.query=e.query}p.authority=i.authority}p.path=n1(x);p.scheme=i.scheme;p.fragment=e.fragment;return h1(p)};var m1=function(a,b){var p="/";var e;if(b){e=b.lastIndexOf("/");p=b.substring(0,e);if(p.charAt(p.length-1)!=="/"){p=p+"/"}}return p+a};var n1=function(p){var a="";var b="";var e;while(p){if(p.indexOf("..")===0||p.indexOf(".")===0){p=p.replace(/^\.\.?\/?/g,"")}else if(p.indexOf("/..")===0){p=p.replace(/^\/\..\/?/g,"/");e=a.lastIndexOf("/");if(e===-1){a=""}else{a=a.substring(0,e)}}else if(p.indexOf("/.")===0){p=p.replace(/^\/\.\/?/g,"/")}else{b=p;e=p.indexOf("/",1);if(e!==-1){b=p.substring(0,e)}a=a+b;p=p.replace(b,"")}}return a};var o1=0;var p1=function(a){if(a.method&&a.method!=="GET"){return false}return true};var q1=function(a){var i=w.document.createElement("IFRAME");i.style.display="none";var b=a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;");var e="<html><head><script type=\"text/javascript\" src=\""+b+"\"><\/script><\/head><body><\/body><\/html>";var p=w.document.getElementsByTagName("BODY")[0];p.appendChild(i);x1(i,e);return i};var r1=function(){if(w.XMLHttpRequest){return new w.XMLHttpRequest()}var a;if(w.ActiveXObject){try{return new w.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(_){try{return new w.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){a=e}}}else{a={message:"XMLHttpRequest not supported"}}throw a};var s1=function(a){return a.indexOf("http://")===0||a.indexOf("https://")===0||a.indexOf("file://")===0};var t1=function(a){if(!s1(a)){return true}var b=w.location;var e=b.protocol+"//"+b.host+"/";return(a.indexOf(e)===0)};var u1=function(a,b){try{delete w[a]}catch(e){w[a]=u;if(b===o1-1){o1-=1}}};var v1=function(i){if(i){x1(i,"");i.parentNode.removeChild(i)}return null};var w1=function(x,a){var b=x.getAllResponseHeaders();if(!b){var z1=x.getResponseHeader("Content-Type");var e=x.getResponseHeader("Content-Length");if(z1)a["Content-Type"]=z1;if(e)a["Content-Length"]=e}else{b=b.split(/\r?\n/);var i,p;for(i=0,p=b.length;i<p;i++){if(b[i]){var y=b[i].split(": ");a[y[0]]=y[1]}}}};var x1=function(i,a){var b=(i.contentWindow)?i.contentWindow.document:i.contentDocument.document;b.open();b.write(a);b.close()};o.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:false,request:function(a,b,e){var i={};var x=null;var p=false;var y;i.abort=function(){y=v1(y);if(p){return}p=true;if(x){x.abort();x=null}e({message:"Request aborted"})};var _=function(){y=v1(y);if(!p){p=true;x=null;e({message:"Request timed out"})}};var N5;var O5=a.requestUri;var P5=z(a.enableJsonpCallback,this.enableJsonpCallback);var Q5=z(a.callbackParameterName,this.callbackParameterName);var R5=z(a.formatQueryString,this.formatQueryString);if(!P5||t1(O5)){x=r1();var S5=function(){if(p||x===null||x.readyState!==4){return}var $5=x.statusText;var _5=x.status;if(_5===1223){_5=204;$5="No Content"}var a6=[];w1(x,a6);var b6={requestUri:O5,statusCode:_5,statusText:$5,headers:a6,body:x.responseText};p=true;x=null;if(_5>=200&&_5<=299){b(b6)}else{e({message:"HTTP request failed",request:a,response:b6})}};if(a.user&&a.password){x.open(a.method||"GET",O5,a.async,a.user,a.password)}else{x.open(a.method||"GET",O5,a.async)}if(a.headers){for(N5 in a.headers){x.setRequestHeader(N5,a.headers[N5])}}if(a.timeoutMS){x.timeout=a.timeoutMS;x.ontimeout=_}if(a.async){x.onreadystatechange=S5}x.send(a.body);if(!a.async){S5()}}else{if(!p1(a)){throw{message:"Request is not local and cannot be done through JSONP."}}var T5=o1;o1+=1;var U5=T5.toString();var V5=false;var W5;N5="handleJSONP_"+U5;w[N5]=function($5){y=v1(y);if(!p){V5=true;w.clearTimeout(W5);u1(N5,T5);if(w.ActiveXObject&&!w.DOMParser){$5=w.JSON.parse(w.JSON.stringify($5))}A(b,{body:$5,statusCode:200,headers:{"Content-Type":"application/json"}})}};var X5=(a.timeoutMS)?a.timeoutMS:120000;W5=w.setTimeout(_,X5);var Y5=Q5+"=parent."+N5;if(this.formatQueryString){Y5+="&"+R5}var Z5=O5.indexOf("?");if(Z5===-1){O5=O5+"?"+Y5}else if(Z5===O5.length-1){O5=O5+Y5}else{O5=O5+"&"+Y5}y=q1(O5)}return i}};var y1="2.0";var z1=function(a){if(!a){return null}var b=a.split(";");var p={};var i,e;for(i=1,e=b.length;i<e;i++){var x=b[i].split("=");p[d1(x[0])]=x[1]}return{mediaType:d1(b[0]),properties:p}};var A1=function(z1){if(!z1){return u}var a=z1.mediaType;var p;for(p in z1.properties){a+=";"+p+"="+z1.properties[p]}return a};var B1=function(z1,a,b,L1){return{contentType:z1,dataServiceVersion:a,metadata:b?b.metadata:null,context:b,handler:L1}};var C1=function(a,b,e){if(!a){return}var i=a.headers;if(!i[b]){i[b]=e}};var D1=function(a,b){if(!a.dataServiceVersion){a.dataServiceVersion=b}};var E1=function(a,b){var e=a.headers;return(e&&e[b])||u};var F1=function(a){return z1(E1(a,"Content-Type"))};var G1=/^\s?(\d+\.\d+);?.*$/;var H1=function(a){var b=E1(a,"DataServiceVersion");if(b){var e=G1.exec(b);if(e&&e.length){return e[1]}}};var I1=function(L1,a){return L1.accept.indexOf(a.mediaType)>=0};var J1=function(L1,p,a,b){if(!a||!a.headers){return false}var e=F1(a);var i=H1(a)||"";var x=a.body;if(!t(x)||!x){return false}if(I1(L1,e)){var y=B1(e,i,b,L1);y.response=a;a.data=p(L1,x,y);return a.data!==u}return false};var K1=function(L1,a,b,e){if(!b||!b.headers){return false}var i=F1(b);var p=H1(b);if(!i||I1(L1,i)){var x=B1(i,p,e,L1);x.request=b;b.body=a(L1,b.data,x);if(b.body!==u){C1(b,"DataServiceVersion",x.dataServiceVersion||"1.0");C1(b,"Content-Type",A1(x.contentType));C1(b,"MaxDataServiceVersion",L1.maxDataServiceVersion);return true}}return false};var L1=function(p,a,b,e){return{accept:b,maxDataServiceVersion:e,read:function(i,x){return J1(this,p,i,x)},write:function(i,x){return K1(this,a,i,x)}}};var M1=function(L1,b){return b};var N1=function(L1,a){if(t(a)){return a.toString()}else{return u}};o.textHandler=L1(M1,N1,"text/plain",y1);var O1="application/xml";var P1="http://";var Q1=P1+"www.w3.org/";var R1=P1+"schemas.microsoft.com/ado/";var S1=R1+"2007/08/dataservices";var T1=Q1+"2000/xmlns/";var U1=Q1+"XML/1998/namespace";var V1=R1+"2007/06/edmx";var W1=R1+"2008/09/edm";var X1=R1+"2006/04/edm";var Y1=R1+"2007/05/edm";var Z1=R1+"2009/11/edm";var $1=Q1+"2005/Atom";var _1=Q1+"2007/app";var a2=S1;var b2=S1+"/metadata";var c2=S1+"/related/";var d2=S1+"/scheme";var e2=function(a){var b=/(^\s)|(\s$)/;return b.test(a)};var f2=function(a,x){var b="<c>"+x+"</c>";var p=E2(b,null);var e=a.ownerDocument;var i=p.domNode;if("importNode"in e){i=e.importNode(p.domNode,true)}var y=i.firstChild;while(y){a.appendChild(y);y=y.nextSibling}};var g2=function(a,b,e){try{a.setProperty(b,e)}catch(_){}};var h2=function(){var a;var b;if(w.ActiveXObject){try{b=new ActiveXObject("Msxml2.DOMDocument.6.0");b.async=false;return b}catch(_){try{b=new ActiveXObject("Msxml2.DOMDocument.3.0");b.async=false;g2(b,"ProhibitDTD",true);g2(b,"MaxElementDepth",256);g2(b,"AllowDocumentFunction",false);g2(b,"AllowXsltScript",false);return b}catch(e){a=e}}}else{if(w.DOMParser){return new w.DOMParser()}a={message:"XML DOM parser not supported"}}throw a};var i2=function(a){return{name:a.localName,namespace:a.nsURI,value:a.domNode.value}};var j2=function(a){var b={name:a.localName,namespace:a.nsURI,value:m2(a.domNode),attributes:[],children:[]};r2(a,function(e){if(e.nsURI!==T1){b.attributes.push(i2(e))}});u2(a,function(e){b.children.push(j2(e))});return b};var k2=function(a){var b=/^\s*$/;return a===null||b.test(a)};var l2=function(a){while(a!==null&&a.nodeType===1){var b=I2(a,"space",U1);if(b==="preserve"){return true}else if(b==="default"){break}else{a=a.parentNode}}return false};var m2=function(a){var b=null;var e=a.firstChild;var i=a.ownerDocument.preserveWhiteSpace===false;var p;while(e){if(e.nodeType===3||e.nodeType===4){var x=e.nodeValue;var y=i||!k2(x);if(!y){if(p===u){p=l2(a)}y=p}if(y){if(!b){b=x}else{b+=x}}}e=e.nextSibling}return b};var n2=function(a,b,e){var i;if(a.getElementsByTagNameNS){i=a.getElementsByTagNameNS(b,e);if(i.length!==0){return i[0]}}else{var p=a.firstChild;while(p){if(p.nodeType===1&&x2(p)===e&&p.namespaceURI===b){return p}p=p.nextSibling}}return null};var o2=function(e,a){var p="http://www.mozilla.org/newlayout/xml/parsererror.xml";var b=L2(e,"");if(b.localName==="parsererror"&&b.nsURI===p){var i=m2(e);var x=n2(b,p,"sourcetext");var y=(x)?x.nodeValue:"";throw{message:i,errorXmlText:a,srcText:y}}var _="http://www.w3.org/1999/xhtml";if(b.localName==="h3"&&b.nsURI==_||n2(e,_,"h3")){throw{message:w2(e),errorXmlText:a,srcText:""}}};var p2=function(a,b,e){var i=a.ownerDocument;var p;if(i.createAttributeNS){p=i.createAttributeNS(T1,b)}else{p=i.createNode(2,b,T1)}p.nodeValue=e;a.setAttributeNode(p)};var q2=function(a,b){if(e2(b)){var e=z2(a,"space",U1,"xml");e.value="preserve"}var i=a.ownerDocument.createTextNode(b);a.appendChild(i)};var r2=function(e,a){var b;var p=e.domNode;var i,x;for(i=0,x=p.attributes.length;i<x;i++){b=p.attributes.item(i);a(L2(b))}};var s2=function(e,a,b){return I2(e.domNode,a,b)};var t2=function(a,b,e){var i=a.attributes;if(i.getNamedItemNS){return i.getNamedItemNS(e,b)}return i.getQualifiedItem(b,e)};var u2=function(e,a){var b=e.domNode.firstChild;var i;while(b!==null){if(b.nodeType===1){i=l1(J2(b),e.baseURI);a(L2(b,i))}b=b.nextSibling}};var v2=function(e){var a=e.domNode.firstChild;var b;while(a!==null){if(a.nodeType===1){b=l1(J2(a),e.baseURI);return L2(a,b)}a=a.nextSibling}return null};var w2=function(a){var b=a.text;if(b!==u){return b}b="";var e=a.firstChild;if(e){do{if(e.nodeType===3||e.nodeType===4){b+=e.nodeValue}var i=e.firstChild;if(!i){while(e!==a){i=e.nextSibling;if(i){e=i;break}else{e=e.parentNode}}}else{e=i}}while(e!==a)}return b};var x2=function(a){if(a.localName){return a.localName}return a.baseName};var y2=function(a,b){var e;if(w.ActiveXObject){e=h2();e.documentElement=e.createNode(1,a,b)}else if(w.document.implementation&&w.document.implementation.createDocument){e=w.document.implementation.createDocument(b,a,null)}return L2(e.documentElement)};var z2=function(a,b,e,i){var p=a.ownerDocument;var x;b=(i)?(i+":"+b):b;if(p.createAttributeNS){x=p.createAttributeNS(e,b);a.setAttributeNodeNS(x)}else{x=p.createNode(2,b,e||u);a.setAttributeNode(x)}return x};var A2=function(a,b,e,i){var p=a.ownerDocument;var x;b=(i)?(i+":"+b):b;if(p.createElementNS){x=p.createElementNS(e,b)}else{x=p.createNode(1,b,e||u)}a.appendChild(x);return x};var B2=function(p,a,b,e){var i=p.domNode.ownerDocument;var x;if(i.createElementNS){x=i.createElementNS(b,a)}else{x=i.createNode(1,a,b||u)}if(e){q2(x,e)}p.domNode.appendChild(x);return L2(x)};var C2=function(e,a,b,i){var p=e.domNode.ownerDocument;var x;if(p.createAttributeNS){x=p.createAttributeNS(b,a);x.value=i;e.domNode.setAttributeNodeNS(x)}else{x=p.createNode(2,a,b||u);x.value=i;e.domNode.setAttributeNode(x)}return L2(x)};var D2=function(a,p){if(p){return p+":"+a}return a};var E2=function(a,b){var e=K2(a);var i=l1(J2(e),b);return L2(e,i)};var F2=function(a){var b=a.domNode.ownerDocument;return H2(b)};var G2=function(a){var b=a.childNodes;var i,e=b.length;if(e===0){return""}var p=a.ownerDocument.createDocumentFragment();for(i=0;i<e;i++){p.appendChild(b[i].cloneNode(true))}return H2(p)};var H2=function(a){var x=a.xml;if(x!==u){return x}if(w.XMLSerializer){var b=new w.XMLSerializer();return b.serializeToString(a)}throw{message:"XML serialization unsupported"}};var I2=function(a,b,e){if(a.getAttributeNS){return a.getAttributeNS(e||null,b)}var i=a.attributes.getQualifiedItem(b,e);if(i){return i.value}return null};var J2=function(a){return I2(a,"base",U1)};var K2=function(a){var b=h2();if(b.parseFromString){b=b.parseFromString(a,"text/xml");o2(b.documentElement,a)}else{b.loadXML(a);if(b.parseError.errorCode!==0){throw{message:b.parseError.reason,errorXmlText:a,srcText:b.parseError.srcText}}}return b.documentElement};var L2=function(a,b){var e=a.namespaceURI;var i=a.nodeName;if(!e){if(a.nodeType===2&&(i==="xmlns"||i.indexOf("xmlns:",0)===0)){e=T1}else{e=null}}return{baseURI:b,domNode:a,localName:x2(a),nsURI:e}};var M2=function(x){if(x.nsURI===a2){switch(x.localName){case"links":return N2(x);case"uri":return O2(x)}}return u};var N2=function(a){var b=[];u2(a,function(e){if(e.localName==="uri"&&e.nsURI===a2){var i=O2(e);b.push(i)}});return{results:b}};var O2=function(a){return{uri:w2(a.domNode)}};var P2=function(a){if($(a)===c&&!a.__metadata&&a.hasOwnProperty("uri")){return Q2(a)}};var Q2=function(a){var b=R2(null,"uri",a2);if(a.uri){q2(b.domNode,a.uri)}return b};var R2=function(p,a,b){if(p){return B2(p,a,b)}return y2(a,b)};var S2=function(L1,a){if(a){var b=E2(a);if(b){return M2(b)}}};var T2=function(L1,a,b){var e=b.contentType=b.contentType||z1(O1);var i=u;if(e&&e.mediaType===O1){var x=P2(a);if(x){i=F2(x)}}return i};o.xmlHandler=L1(S2,T2,O1,y1);var U2=["application/atom+xml","application/atomsvc+xml","application/xml"];var V2=U2[0];var W2=D2("inline","m");var X2=D2("properties","m");var Y2=D2("type","m");var Z2=D2("null","m");var $2=[$1,_1,U1,T1];var _2={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"};var a3=function(a){return!(v($2,a))};var b3=function(p){return p};var c3=function(p){return p==="true"};var d3=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2})(?::(\d{2}))?(?:\.(\d+))?(.*)$/;var e3=function(a,b){var p=d3.exec(a);var e=(p)?I(p[8]):null;if(!p||(!b&&e!=="Z")){throw{message:"Invalid date/time value"}}var y=W(p[1]);if(y<=0){y++}var i=p[7];var x=0;if(!i){i=0}else{if(i.length>7){throw{message:"Cannot parse date/time value to given precision."}}x=H(i.substring(3),4,true);i=H(i.substring(0,3),3,true);i=W(i);x=W(x)}var _=W(p[4]);var N5=W(p[5]);var O5=W(p[6])||0;if(e!=="Z"){var P5=Z(e);var Q5=-(P5.d);_+=P5.h*Q5;N5+=P5.m*Q5}var R5=new Date();R5.setUTCFullYear(y,W(p[2])-1,W(p[3]));R5.setUTCHours(_,N5,O5,i);if(isNaN(R5.valueOf())){throw{message:"Invalid date/time value"}}if(b){R5.__edmType="Edm.DateTimeOffset";R5.__offset=e}if(x){R5.__ns=x}return R5};var f3=function(p){return e3(p,false)};var g3=function(p){return e3(p,true)};var h3={"Edm.Boolean":c3,"Edm.Binary":b3,"Edm.DateTime":f3,"Edm.DateTimeOffset":g3,"Edm.Time":Y,"Edm.Decimal":b3,"Edm.Guid":b3,"Edm.String":b3,"Edm.Byte":W,"Edm.Double":parseFloat,"Edm.Single":parseFloat,"Edm.Int16":W,"Edm.Int32":W,"Edm.Int64":b3,"Edm.SByte":W};var i3=function(a){return a.toString()};var j3={"Edm.Binary":i3,"Edm.Boolean":i3,"Edm.Byte":i3,"Edm.DateTime":F,"Edm.DateTimeOffset":F,"Edm.Decimal":i3,"Edm.Double":i3,"Edm.Guid":i3,"Edm.Int16":i3,"Edm.Int32":i3,"Edm.Int64":i3,"Edm.SByte":i3,"Edm.Single":i3,"Edm.String":i3,"Edm.Time":G};var k3=function(a){return a&&(h3[a]!==u)};var l3=function(a,b){if(a!==null&&b){var e=h3[b];if(e){a=e(a)}}return a};var m3=function(a,b){if(a!==null&&b){if(L(a)){b=(C(a))?"Edm.DateTimeOffset":"Edm.DateTime"}var e=j3[b];if(e){a=e(a)}}return a};var n3=function(a,b){if(a.nsURI===$1){switch(a.localName){case"feed":return o3(a,b);case"entry":return F3(a,b)}}if(a.nsURI===_1&&a.localName==="service"){return N3(a)}};var o3=function(a,b){var e={};var i={results:[],__metadata:e};e.feed_extensions=s3(a);u2(a,function(p){switch(p.nsURI){case $1:switch(p.localName){case"id":e.uri=l1(w2(p.domNode),p.baseURI);e.uri_extensions=s3(p);break;case"title":e.title=w2(p.domNode);e.title_extensions=s3(p);break;case"entry":var x=F3(p,b);i.results.push(x);break;case"link":p3(p,i);break}return;case b2:if(p.localName==="count"){i.__count=W(w2(p.domNode));return}break}var y=r3(p);e.feed_extensions.push(y)});return i};var p3=function(a,b){var e=q3(a);var i=b.__metadata;switch(e.rel){case"next":b.__next=e.href;i.next_extensions=e.extensions;break;case"self":i.self=e.href;i.self_extensions=e.extensions;break}};var q3=function(a){var b={extensions:[]};var e;r2(a,function(i){if(!i.nsURI){switch(i.localName){case"href":b.href=l1(i.domNode.nodeValue,a.baseURI);return;case"type":case"rel":b[i.localName]=i.domNode.nodeValue;return}}if(a3(i.nsURI)){e=t3(i);b.extensions.push(e)}});if(!b.href){throw{error:"href attribute missing on link element",element:a}}return b};var r3=function(a){var e={name:a.localName,namespaceURI:a.nsURI,attributes:s3(a),children:[]};u2(a,function(i){var p=r3(i);e.children.push(p)});if(e.children.length===0){var b=w2(a.domNode);if(b){e.value=b}}return e};var s3=function(x){var e=[];r2(x,function(a){if(a3(a.nsURI)){var b=t3(a);e.push(b)}});return e};var t3=function(a){return{name:a.localName,namespaceURI:a.nsURI,value:a.domNode.nodeValue}};var u3=function(p,a){if(p.indexOf('/')===-1){return a[p]}else{var b=p.split('/');var i,e;for(i=0,e=b.length;i<e;i++){if(a===null){return u}a=a[b[i]];if(a===u){return a}}return a}};var v3=function(p,a,b,e){var x;if(p.indexOf('/')===-1){a[p]=b;x=p}else{var y=p.split('/');var i,_;for(i=0,_=(y.length-1);i<_;i++){var N5=a[y[i]];if(N5===u){N5={};a[y[i]]=N5}else if(N5===null){return}a=N5}x=y[i];a[x]=b}if(e){var O5=a.__metadata=a.__metadata||{};var P5=O5.properties=O5.properties||{};var Q5=P5[x]=P5[x]||{};Q5.type=e}};var w3=function(p){return _2[p]||p};var x3=function(a,x,e,b){var p=x.split('/');var i,y;for(i=0,y=p.length;i<y;i++){if(p[i].charAt(0)==="@"){return I2(e,p[i].substring(1),a)}else{e=n2(e,a,p[i]);if(!e){return u}}}if(b){return G2(e)}else{return w2(e)}};var y3=function(a,b,x,e,p,y){var _=e;var N5=x.split('/');var i,O5;for(i=0,O5=N5.length;i<O5;i++){var P5;if(N5[i].charAt(0)==="@"){P5=t2(_,N5[i].substring(1),a);if(!P5){P5=z2(_,N5[i].substring(1),a,b)}}else{P5=n2(_,a,N5[i]);if(!P5){P5=A2(_,N5[i],a,b)}}_=P5}if(_.nodeType===2){_.value=y}else{if(p){_.setAttribute("type",p)}if(p==="xhtml"){f2(_,y)}else{q2(_,y)}}};var z3=function(e){if(e.childNodes.length){return false}var a=e.attributes;var b=a.length;if(b===0){return true}for(var i=0;i<b;i++){var p=a[i].nodeName;if(p!=="xmlns"&&p.indexOf("xmlns:")!==0&&p!=="m:type"){return false}}return true};var A3=function(e,p){var a=n2(e.domNode,b2,"properties");if(!a){var b=n2(e.domNode,$1,"content");if(b){a=n2(b,b2,"properties")}}if(a){var x=a;var y=p.split("/");var i,_;for(i=0,_=(y.length-1);i<_;i++){x=n2(x,a2,y[i]);if(!x){return}}var N5=n2(x,a2,y[i]);if(N5){x.removeChild(N5)}var O5=x;while(O5!==a&&z3(O5)){var P5=O5.parentNode;P5.removeChild(O5);O5=P5}}};var B3=function(a,b,e,i,p,x,y){var _=a["FC_TargetPath"+x];var N5=w3(_);var O5=(_!==N5)?$1:a["FC_NsUri"+x];var P5=(a["FC_KeepInContent"+x]==="true")?true:false;var Q5=a["FC_ContentKind"+x];var R5=a["FC_NsPrefix"+x]||null;var S5=u3(b,i);if(!t(S5)){return}if(!P5){y.dataServiceVersion="2.0";A3(e,b)}S5=m3(S5,p);y3(O5,R5,N5,e.domNode,Q5,S5)};var C3=function(a,b,e,i,p,x){if(a["FC_KeepInContent"+x]==="true"){return}if(u3(b,i)===null){return}var y=a["FC_TargetPath"+x];var _=w3(y);var N5=(y!==_)?$1:a["FC_NsUri"+x];var O5=(a["FC_ContentKind"+x]==="xhtml");var P5=x3(N5,_,e.domNode,O5);if(P5===u){return}P5=l3(P5,p);v3(b,i,P5,p)};var D3=function(a,e,p){var b=p.split("/");var i,x;while(e){var y=e;for(i=0,x=b.length;i<x;i++){var _=y.property;if(!_){break}var N5=M(_,b[i]);if(!N5){break}var O5=N5.type;if(!O5||k3(O5)){return O5||null}y=O(O5,a);if(!y){return null}}e=Q(e.baseType,a)}return null};var E3=function(e,a,b){if(!b||b.length===0){return}var p=a.__metadata.type;while(p){var x=Q(p,b);if(!x){return}var y;var _=x.FC_SourcePath;if(_){y=D3(b,x,_);C3(x,_,e,a,y,"")}var N5=x.property;if(N5){var i,O5;for(i=0,O5=N5.length;i<O5;i++){var P5=N5[i];var Q5=0;var R5="";while(P5["FC_TargetPath"+R5]){_=P5.name;y=P5.type;var S5=P5["FC_SourcePath"+R5];if(S5){_+="/"+S5;y=D3(b,x,_)}C3(P5,_,e,a,y,R5);Q5++;R5="_"+Q5}}}p=x.baseType}};var F3=function(a,b){var e={};var i={__metadata:e};var p=s2(a,"etag",b2);if(p){e.etag=p}u2(a,function(x){if(x.nsURI===$1){switch(x.localName){case"id":e.uri=l1(w2(x.domNode),x.baseURI);e.uri_extensions=s3(x);break;case"category":G3(x,i,e);break;case"content":H3(x,i);break;case"link":J3(x,i,b);break}}if(x.nsURI===b2&&x.localName==="properties"){L3(x,i,e)}});E3(a,i,b);return i};var G3=function(a,e,b){var i=s2(a,"scheme");var p=s2(a,"term");if(i===d2){if(e.__metadata.type){throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:a}}b.type=p;b.type_extensions=[];var x;r2(a,function(y){if(!y.nsURI){if(y.localName!=="scheme"&&y.localName!=="term"){x=t3(y);b.type_extensions.push(x)}}else if(a3(y.nsURI)){x=t3(y);b.type_extensions.push(x)}})}};var H3=function(a,e){var b=s2(a,"src");var i=s2(a,"type");var p=e.__metadata;if(b){if(!i){throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:a}}p.media_src=l1(b,a.baseURI);p.content_type=i}u2(a,function(x){if(b){throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:a}}if(x.nsURI===b2&&x.localName==="properties"){L3(x,e,p)}})};var I3=function(a,e,b){b.edit_media=a.href;b.edit_media_extensions=[];var i,p;for(i=0,p=a.extensions.length;i<p;i++){if(a.extensions[i].namespaceURI===b2&&a.extensions[i].name==="etag"){b.media_etag=a.extensions[i].value}else{b.edit_media_extensions.push(a.extensions[i])}}};var J3=function(a,e,b){var i=q3(a);var p=e.__metadata;switch(i.rel){case"self":p.self=i.href;p.self_link_extensions=i.extensions;break;case"edit":p.edit=i.href;p.edit_link_extensions=i.extensions;break;case"edit-media":I3(i,e,p);break;default:if(i.rel.indexOf(c2)===0){K3(a,i,e,b)}break}};var K3=function(a,b,e,i){var p=b.rel.substring(c2.length);var x=u;u2(a,function(y){if(y.nsURI===b2&&y.localName==="inline"){var _=v2(y);if(_){x=n3(_,i)}else{x=null}}});if(x===u){x={__deferred:{uri:b.href}}}e[p]=x;e.__metadata.properties=e.__metadata.properties||{};e.__metadata.properties[p]={extensions:b.extensions}};var L3=function(p,a,b){u2(p,function(e){if(e.nsURI===a2){b.properties=b.properties||{};M3(e,a,b.properties)}})};var M3=function(p,a,b){var e=null;var i="Edm.String";var x=[];r2(p,function(N5){if(N5.nsURI===b2){switch(N5.localName){case"null":e=N5.domNode.nodeValue;return;case"type":i=N5.domNode.nodeValue;return}}if(a3(N5.nsURI)){var O5=t3(N5);x.push(O5)}});var y=null;var _={type:i,extensions:x};if(e!=="true"){y=w2(p.domNode);if(k3(i)){y=l3(y,i)}else{if(v2(p)){y={__metadata:{type:i}};L3(p,y,_)}}}a[p.localName]=y;b[p.localName]=_};var N3=function(a){var b={workspaces:[],extensions:[]};u2(a,function(e){if(e.nsURI===_1&&e.localName==="workspace"){var i=O3(e);b.workspaces.push(i)}else{var p=r3(a);b.extensions.push(p)}});if(b.workspaces.length===0){throw{message:"Invalid AtomPub service document: No workspace element found.",element:a}}return b};var O3=function(a){var b={collections:[],extensions:[]};u2(a,function(e){if(e.nsURI===$1){if(e.localName==="title"){if(a.title){throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:e}}b.title=w2(e.domNode)}}else if(e.nsURI===_1){if(e.localName==="collection"){var i=P3(e,b);b.collections.push(i)}}else{var p=r3(a);b.extensions.push(p)}});b.title=b.title||"";return b};var P3=function(a){var b={href:s2(a,"href"),extensions:[]};if(!b.href){throw{message:"Invalid AtomPub service document: collection has no href attribute",element:a}}b.href=l1(b.href,a.baseURI);u2(a,function(e){if(e.nsURI===$1){if(e.localName==="title"){if(b.title){throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:e}}b.title=w2(e.domNode)}}else if(e.nsURI!==_1){var i=r3(a);b.extensions.push(i)}});if(!b.title){throw{message:"Invalid AtomPub service document: collection has no title element",element:a}}return b};var Q3=function(a,b){var e;var i=$(a);switch(i){case g:e=S3(null,a,b);break;case f:case c:e=T3(null,a,b);break}return e};var R3=function(p,a){if(p){return B2(p,a,$1)}var b=y2(a,$1);p2(b.domNode,"xmlns:d",a2);p2(b.domNode,"xmlns:m",b2);return b};var S3=function(p,a,b){var e=R3(p,"feed");var x=(K(a))?a:a.results;if(x){var i,y;for(i=0,y=x.length;i<y;i++){T3(e,x[i],b)}}return e};var T3=function(p,a,b){var e=R3(p,"entry");var i=B2(e,"author",$1);B2(i,"name",$1);B2(e,"title",$1);var x=B2(e,"content",$1);C2(x,"type",null,"application/xml");var y=B2(x,X2,b2);var _=(a.__metadata)?a.__metadata.properties:null;V3(e,a.__metadata);X3(e,y,a,_,b);U3(e,a,b);return e};var U3=function(e,a,b){if(!a.__metadata){return}var p=b.metadata;var x=Q(a.__metadata.type,p);while(x){var y;var _=x.FC_SourcePath;if(_){y=D3(p,x,_);B3(x,_,e,a,y,"",b)}var N5=x.property;if(N5){var i,O5;for(i=0,O5=N5.length;i<O5;i++){var P5=N5[i];var Q5=0;var R5="";while(P5["FC_TargetPath"+R5]){_=P5.name;if(P5["FC_SourcePath"+R5]){_+="/"+P5["FC_SourcePath"+R5]}B3(P5,_,e,a,P5.type,R5,b);Q5++;R5="_"+Q5}}}x=Q(x.baseType,p)}};var V3=function(e,a){if(a){if(a.etag){C2(e,"etag",b2,a.etag)}if(a.uri){B2(e,"id",$1,a.uri)}if(a.type){var b=B2(e,"category",$1);C2(b,"term",null,a.type);C2(b,"scheme",null,d2)}}};var W3=function(e,a,b){var i=B2(e,"link",$1);C2(i,"rel",null,b);C2(i,"href",null,a);return i};var X3=function(e,p,a,b,i){var x,y,_,N5;var O5=i.metadata;var P5;for(x in a){if(x!=="__metadata"){y=a[x];_=b1(y);N5=(b)?b[x]:null;if(!N5){if(P5===u){if(a.__metadata){P5=Q(a.__metadata.type,O5)}}if(P5){N5=M(P5.property,x);if(!N5){N5=M(P5.navigationProperty,x)}}}if(_===s){_=r;if(N5&&!k3(N5.type)){if(N5.relationship){_=q}else if(O(N5.type,i.metadata)){_=m}}}if(_===r||_===m){Y3(p,x,_,y,N5,i)}else{Z3(e,_,x,y,i)}}}};var Y3=function(p,a,b,e,i,x){var y=D2(a,"d");var _=i&&i.type;var N5;if(b===m){N5=B2(p,y,a2);var O5;if(i){O5=i.properties}if(e===null){x.dataServiceVersion="2.0"}X3(null,N5,e,O5,x)}else{N5=B2(p,y,a2,m3(e,_||"Edm.String"))}if(e===null){C2(N5,Z2,b2,"true")}if(_){C2(N5,Y2,b2,_)}};var Z3=function(e,a,b,i,p){var x;var y;var _;var N5=a===q;if(N5){x=(i&&i.__metadata)?i.__metadata.uri:"";_=$(i);switch(_){case f:y=T3;break;case g:_="feed";y=S3;break;case l:_=f;y=null;break;default:throw{message:"Invalid payload for inline navigation property: "+_}}}else{x=i.__deferred.uri}var O5=l1(b,c2);var P5=W3(e,x,O5);if(N5){var Q5=B2(P5,W2,b2);C2(P5,"type",null,"application/atom+xml;type="+_);if(y){y(Q5,i,p)}}};var $3=function(L1,a,b){if(a){var e=E2(a);if(e){return n3(e,b.metadata)}}};var _3=function(L1,a,b){var e=b.contentType=b.contentType||z1(V2);var i=u;if(e&&e.mediaType===V2){var p=Q3(a,b);i=F2(p)}return i};o.atomHandler=L1($3,_3,U2.join(","),y1);var a4={elements:{Association:{attributes:["Name"],elements:["End*","ReferentialConstraint"]},AssociationSet:{attributes:["Name","Association"],elements:["End*"]},CollectionType:{attributes:["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},ComplexType:{attributes:["Name","BaseType","Abstract"],elements:["Property*"]},DefiningExpression:{text:true},Dependent:{attributes:["Role"],elements:["PropertyRef*"]},Documentation:{text:true},End:{attributes:["Type","Role","Multiplicity","EntitySet"],elements:["OnDelete"]},EntityContainer:{attributes:["Name","Extends"],elements:["EntitySet*","AssociationSet*","FunctionImport*"]},EntitySet:{attributes:["Name","EntityType"]},EntityType:{attributes:["Name","BaseType","Abstract","OpenType"],elements:["Key","Property*","NavigationProperty*"]},Function:{attributes:["Name","ReturnType"],elements:["Parameter*","DefiningExpression","ReturnType"]},FunctionImport:{attributes:["Name","ReturnType","EntitySet"],elements:["Parameter*"]},Key:{elements:["PropertyRef*"]},NavigationProperty:{attributes:["Name","Relationship","ToRole","FromRole"]},OnDelete:{attributes:["Action"]},Parameter:{attributes:["Name","Type","Mode","MaxLength","Precision","Scale"]},Principal:{attributes:["Role"],elements:["PropertyRef*"]},Property:{attributes:["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode"]},PropertyRef:{attributes:["Name"]},ReferenceType:{attributes:["Type"]},ReferentialConstraint:{elements:["Principal","Dependent"]},ReturnType:{attributes:["ReturnType"],elements:["CollectionType","ReferenceType","RowType"]},RowType:{elements:["Property*"]},Schema:{attributes:["Namespace","Alias"],elements:["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*"]},TypeRef:{attributes:["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},Using:{attributes:["Namespace","Alias"]}}};var b4=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];a4.elements.Property.attributes=a4.elements.Property.attributes.concat(b4);a4.elements.EntityType.attributes=a4.elements.EntityType.attributes.concat(b4);a4.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:V1};a4.elements.DataServices={elements:["Schema*"],ns:V1};a4.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer");a4.elements.Property.attributes.push("m:MimeType");a4.elements.FunctionImport.attributes.push("m:HttpMethod");a4.elements.EntityType.attributes.push("m:HasStream");a4.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"];var c4=function(a){if(!a){return a}if(a.length>1){var b=a.substr(0,2);if(b===b.toUpperCase()){return a}return a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()};var d4=function(p,a){if(a==="Documentation"){return{isArray:true,propertyName:"documentation"}}var e=p.elements;if(!e){return null}var i,b;for(i=0,b=e.length;i<b;i++){var x=e[i];var y=false;if(x.charAt(x.length-1)==="*"){y=true;x=x.substr(0,x.length-1)}if(a===x){var _=c4(x);return{isArray:y,propertyName:_}}}return null};var e4=/^(m:FC_.*)_[0-9]+$/;var f4=function(a){return a===W1||a===X1||a===Y1||a===Z1};var g4=function(e){if(!e.domNode){e=L2(e,"")}var a=e.localName;var b=a4.elements[a];if(!b){return null}if(b.ns){if(e.nsURI!==b.ns){return null}}else if(!f4(e.nsURI)){return null}var i={};var p=[];var x=b.attributes||[];r2(e,function(y){var _=y.domNode;var a=y.localName;var N5=y.nsURI;var O5=_.value;if(N5===T1){return}var P5=null;var Q5=false;if(f4(N5)||N5===null){P5=""}else if(N5===b2){P5="m:"}if(P5!==null){P5+=a;var R5=e4.exec(P5);if(R5){P5=R5[1]}if(v(x,P5)){Q5=true;i[c4(a)]=O5}}if(!Q5){p.push(i2(y))}});u2(e,function(y){var _=d4(b,y.localName);if(_){if(_.isArray){var N5=i[_.propertyName];if(!N5){N5=[];i[_.propertyName]=N5}N5.push(g4(y))}else{i[_.propertyName]=g4(y)}}else{p.push(j2(y))}});if(b.text){i.text=w2(e)}if(p.length){i.extensions=p}return i};var h4=function(L1,a){var b=E2(a);return g4(b)||u};o.metadataHandler=L1(h4,null,O1,y1);var i4=["application/json","application/json;odata=verbose"];var j4=z1(i4[0]);var k4=z1(i4[1]);var l4=function(a,b){var e={collections:[]};var i,p;for(i=0,p=a.EntitySets.length;i<p;i++){var x=a.EntitySets[i];var y={title:x,href:l1(x,b)};e.collections.push(y)}return{workspaces:[e]}};var m4=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/;var n4=function(a){var b;if(a<0){b="-";a=-a}else{b="+"}var e=Math.floor(a/60);a=a-(60*e);return b+H(e,2)+":"+H(a,2)};var o4=function(a){var b=a&&m4.exec(a);if(b){var e=new Date(W(b[1]));if(b[2]){var i=W(b[3]);if(b[2]==="-"){i=-i}var p=e.getUTCMinutes();e.setUTCMinutes(p-i);e.__edmType="Edm.DateTimeOffset";e.__offset=n4(i)}if(!isNaN(e.valueOf())){return e}}};var p4=function(i,a){if(i&&typeof i==="object"){for(var b in i){var e=i[b];var p=p4(e,a);p=a(b,p);if(p!==e){if(e===u){delete i[b]}else{i[b]=p}}}}return i};var q4=function(i,a){return a("",p4(i,a))};var r4=function(L1,a,b){var e=b.metadata;var p=z(b.context?b.context.recognizeDates:u,L1.recognizeDates);var x=(typeof a==="string")?w.JSON.parse(a):a;x=q4(x,function(_,y){if(y&&typeof y==="object"){var N5=y.__metadata&&y.__metadata.type;var O5=Q(N5,e)||O(N5,e);if(O5){var P5=O5.property;if(P5){var i,Q5;for(i=0,Q5=P5.length;i<Q5;i++){var R5=P5[i];var S5=R5.name;var T5=y[S5];if(R5.type==="Edm.DateTime"||R5.type==="Edm.DateTimeOffset"){if(T5){T5=o4(T5);if(!T5){throw{message:"Invalid date/time value"}}y[S5]=T5}}else if(R5.type==="Edm.Time"){if(T5){y[S5]=Y(T5)}}}}}else if(p){for(var U5 in y){T5=y[U5];if(typeof T5==="string"){y[U5]=o4(T5)||T5}}}}return y}).d;x=v4(x,b.dataServiceVersion);x=u4(x,b.response.requestUri);return x};var s4=function(L1,a,b){var e=u;var i=b.contentType=b.contentType||k4;if(i&&i.mediaType===j4.mediaType){var p=a;var x=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return E(this)};e=w.JSON.stringify(p,t4);e=e.replace(/\/Date\(([0-9.+-]+)\)\//g,"\\/Date($1)\\/")}finally{Date.prototype.toJSON=x}}return e};var t4=function(_,a){if(a&&a.__edmType==="Edm.Time"){return G(a)}else{return a}};var u4=function(a,b){if($(a)===j){return l4(a,b)}else{return a}};var v4=function(a,b){if(b&&b.lastIndexOf(";")===b.length-1){b=b.substr(0,b.length-1)}if(!b){if(K(a)){b="1.0"}}if(b==="1.0"){if(K(a)){a={results:a}}}return a};o.jsonHandler=L1(r4,s4,i4.join(","),y1);o.jsonHandler.recognizeDates=false;var w4="multipart/mixed";var x4=/^HTTP\/1\.\d (\d{3}) (.*)$/i;var y4=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;var z4=function(){return Math.floor((1+Math.random())*0x10000).toString(16).substr(1)};var A4=function(p){return p+z4()+"-"+z4()+"-"+z4()};var B4=function(a){return a.handler.partHandler};var C4=function(a){var b=a.boundaries;return b[b.length-1]};var D4=function(L1,a,b){var e=b.contentType.properties["boundary"];return{__batchResponses:F4(a,{boundaries:[e],handlerContext:b})}};var E4=function(L1,a,b){var e=b.contentType=b.contentType||z1(w4);if(e.mediaType===w4){return K4(a,b)}};var F4=function(a,b){var i="--"+C4(b);J4(a,b,i);I4(a,b);var p=[];var x;while(x!=="--"&&b.position<a.length){var y=G4(a,b);var _=z1(y["Content-Type"]);if(_&&_.mediaType===w4){b.boundaries.push(_.properties["boundary"]);try{var N5=F4(a,b)}catch(e){e.response=H4(a,b,i);N5=[e]}p.push({__changeResponses:N5});b.boundaries.pop();J4(a,b,"--"+C4(b))}else{if(!_||_.mediaType!=="application/http"){throw{message:"invalid MIME part type "}}I4(a,b);var O5=H4(a,b,i);try{if(O5.statusCode>=200&&O5.statusCode<=299){B4(b.handlerContext).read(O5,b.handlerContext)}else{O5={message:"HTTP request failed",response:O5}}}catch(e){O5=e}p.push(O5)}x=a.substr(b.position,2);I4(a,b)}return p};var G4=function(a,b){var e={};var p;var i;var x;do{x=b.position;i=I4(a,b);p=y4.exec(i);if(p!==null){e[p[1]]=p[2]}else{b.position=x}}while(i&&p);U(e);return e};var H4=function(a,b,e){var p=b.position;var i=x4.exec(I4(a,b));var x;var y;var _;if(i){x=i[1];y=i[2];_=G4(a,b);I4(a,b)}else{b.position=p}return{statusCode:x,statusText:y,headers:_,body:J4(a,b,"\r\n"+e)}};var I4=function(a,b){return J4(a,b,"\r\n")};var J4=function(a,b,e){var i=b.position||0;var p=a.length;if(e){p=a.indexOf(e,i);if(p===-1){return null}b.position=p+e.length}else{b.position=p}return a.substring(i,p)};var K4=function(a,b){var e=$(a);if(e!==P){throw{message:"Serialization of batches of type \""+e+"\" is not supported"}}var p=A4("batch_");var x=a.__batchRequests;var y="";var i,_;for(i=0,_=x.length;i<_;i++){y+=L4(p,false)+M4(x[i],b)}y+=L4(p,true);var N5=b.contentType.properties;N5.boundary=p;return y};var L4=function(b,a){var e="\r\n--"+b;if(a){e+="--"}return e+"\r\n"};var M4=function(p,a,b){var e=p.__changeRequests;var x;if(K(e)){if(b){throw{message:"Not Supported: change set nested in other change set"}}var y=A4("changeset_");x="Content-Type: "+w4+"; boundary="+y+"\r\n";var i,_;for(i=0,_=e.length;i<_;i++){x+=L4(y,false)+M4(e[i],a,true)}x+=L4(y,true)}else{x="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";a1(p,B4(a),{metadata:a.metadata});x+=N4(p)}return x};var N4=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var e in a.headers){if(a.headers[e]){b=b+e+": "+a.headers[e]+"\r\n"}}if(a.body){function p(i){if(i<=0x7F)return 1;if(i<=0x7FF)return 2;if(i<=0xFFFF)return 3;if(i<=0x1FFFFF)return 4;if(i<=0x3FFFFFF)return 5;if(i<=0x7FFFFFFF)return 6;throw new Error("Illegal argument: "+i)};function x(y){var _=0;for(var i=0;i<y.length;i++){var ch=y.charCodeAt(i);_+=p(ch)}return _};b+="Content-Length: "+x(a.body)+"\r\n"}b+="\r\n";if(a.body){b+=a.body}return b};o.batchHandler=L1(D4,E4,w4,y1);var O4=[o.jsonHandler,o.atomHandler,o.xmlHandler,o.textHandler];var P4=function(a,b,e){var i,p;for(i=0,p=O4.length;i<p&&!O4[i][a](b,e);i++){}if(i===p){throw{message:"no handler for data"}}};o.defaultSuccess=function(a){w.alert(w.JSON.stringify(a))};o.defaultError=c1;o.defaultHandler={read:function(a,b){if(a&&a.body&&a.headers["Content-Type"]){P4("read",a,b)}},write:function(a,b){P4("write",a,b)},maxDataServiceVersion:y1,accept:"application/atomsvc+xml;q=0.8, application/json;odata=verbose;q=0.5, */*;q=0.1"};o.defaultMetadata=[];o.read=function(a,b,e,L1,i,p){var x;if(a instanceof String||typeof a==="string"){x={requestUri:a}}else{x=a}return o.request(x,b,e,L1,i,p)};o.request=function(a,b,e,L1,i,p){if(!b){b=o.defaultSuccess}if(!e){e=o.defaultError}if(!L1){L1=o.defaultHandler}if(!i){i=o.defaultHttpClient}if(!p){p=o.defaultMetadata}a.recognizeDates=z(a.recognizeDates,o.jsonHandler.recognizeDates);a.callbackParameterName=z(a.callbackParameterName,o.defaultHttpClient.callbackParameterName);a.formatQueryString=z(a.formatQueryString,o.defaultHttpClient.formatQueryString);a.enableJsonpCallback=z(a.enableJsonpCallback,o.defaultHttpClient.enableJsonpCallback);var x={metadata:p,recognizeDates:a.recognizeDates,callbackParameterName:a.callbackParameterName,formatQueryString:a.formatQueryString,enableJsonpCallback:a.enableJsonpCallback};try{a1(a,L1,x);return J(a,b,e,L1,i,x)}catch(y){e(y)}};o.batchHandler.partHandler=o.defaultHandler;var Q4=w.localStorage;var R4=function(){var a={v:this.valueOf(),t:"[object Date]"};for(var b in this){a[b]=this[b]}return a};var S4=function(_,a){if(a&&a.t==="[object Date]"){var b=new Date(a.v);for(var e in a){if(e!=="t"&&e!=="v"){b[e]=a[e]}}a=b}return a};var T4=function(a,b){return a.name+"#!#"+b};var U4=function(a,b){return b.replace(a.name+"#!#","")};var V4=function(a){this.name=a};V4.create=function(a){if(V4.isSupported()){return new V4(a)}throw{message:"Web Storage not supported by the browser"}};V4.isSupported=function(){return!!Q4};V4.prototype.add=function(a,b,e,i){i=i||this.defaultError;var p=this;this.contains(a,function(x){if(!x){p.addOrUpdate(a,b,e,i)}else{A(i,{message:"key already exists",key:a})}},i)};V4.prototype.addOrUpdate=function(a,b,i,p){p=p||this.defaultError;if(a instanceof Array){p({message:"Array of keys not supported"})}else{var x=T4(this,a);var y=Date.prototype.toJSON;try{var _=b;if(_!==u){Date.prototype.toJSON=R4;_=w.JSON.stringify(b)}Q4.setItem(x,_);A(i,a,b)}catch(e){if(e.code===22||e.number===0x8007000E){A(p,{name:"QUOTA_EXCEEDED_ERR",error:e})}else{A(p,e)}}finally{Date.prototype.toJSON=y}}};V4.prototype.clear=function(a,b){b=b||this.defaultError;try{var i=0,p=Q4.length;while(p>0&&i<p){var x=Q4.key(i);var y=U4(this,x);if(x!==y){Q4.removeItem(x);p=Q4.length}else{i++}};A(a)}catch(e){A(b,e)}};V4.prototype.close=function(){};V4.prototype.contains=function(a,b,i){i=i||this.defaultError;try{var p=T4(this,a);var x=Q4.getItem(p);A(b,x!==null)}catch(e){A(i,e)}};V4.prototype.defaultError=c1;V4.prototype.getAllKeys=function(a,b){b=b||this.defaultError;var p=[];var i,x;try{for(i=0,x=Q4.length;i<x;i++){var y=Q4.key(i);var _=U4(this,y);if(y!==_){p.push(_)}}A(a,p)}catch(e){A(b,e)}};V4.prototype.mechanism="dom";V4.prototype.read=function(a,b,i){i=i||this.defaultError;if(a instanceof Array){i({message:"Array of keys not supported"})}else{try{var p=T4(this,a);var x=Q4.getItem(p);if(x!==null&&x!=="undefined"){x=w.JSON.parse(x,S4)}else{x=u}A(b,a,x)}catch(e){A(i,e)}}};V4.prototype.remove=function(a,b,i){i=i||this.defaultError;if(a instanceof Array){i({message:"Batches not supported"})}else{try{var p=T4(this,a);Q4.removeItem(p);A(b)}catch(e){A(i,e)}}};V4.prototype.update=function(a,b,e,i){i=i||this.defaultError;var p=this;this.contains(a,function(x){if(x){p.addOrUpdate(a,b,e,i)}else{A(i,{message:"key not found",key:a})}},i)};var W4=w.mozIndexedDB;var X4=w.IDBTransaction;var Y4=w.IDBKeyRange;var Z4=function(a,b){return function(e){if(e.code===11){e={name:"QUOTA_EXCEEDED_ERR",error:e}}if(a){a(e)}else if(b){b(e)}}};var $4=function(a,b,e,i){var p=a.name;var x=a.db;var y=Z4(i,a.defaultError);if(x){e(x.transaction(p,b))}else{var _=W4.open("_datajs_"+p);_.onsuccess=function(N5){x=a.db=N5.target.result;if(!x.objectStoreNames.contains(p)){var O5=x.setVersion("1.0");O5.onsuccess=function(){x.createObjectStore(p,null,false);e(x.transaction(p,b))};O5.onerror=y;O5.onblocked=y}else{e(x.transaction(p,b))}};_.onerror=Z4(i,this.defaultError)}};var _4=function(a){this.name=a};_4.create=function(a){if(_4.isSupported()){return new _4(a)}throw{message:"IndexedDB is not supported on this browser"}};_4.isSupported=function(){return!!W4};_4.prototype.add=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var N5=[];if(a instanceof Array){_=a;N5=b}else{_=[a];N5=[b]}$4(this,X4.READ_WRITE,function(O5){O5.onabort=Z4(p,y);O5.oncomplete=function(){if(a instanceof Array){e(_,N5)}else{e(a,b)}};for(var i=0;i<_.length&&i<N5.length;i++){O5.objectStore(x).add(N5[i],_[i])}},p)};_4.prototype.addOrUpdate=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var N5=[];if(a instanceof Array){_=a;N5=b}else{_=[a];N5=[b]}$4(this,X4.READ_WRITE,function(O5){O5.onabort=Z4(p,y);O5.oncomplete=function(){if(a instanceof Array){e(_,N5)}else{e(a,b)}};for(var i=0;i<_.length&&i<N5.length;i++){O5.objectStore(x).put(N5[i],_[i])}},p)};_4.prototype.clear=function(a,e){var b=this.name;var i=this.defaultError;$4(this,X4.READ_WRITE,function(p){p.onerror=Z4(e,i);p.oncomplete=function(){a()};p.objectStore(b).clear()},e)};_4.prototype.close=function(){if(this.db){this.db.close();this.db=null}};_4.prototype.contains=function(a,b,e){var i=this.name;var p=this.defaultError;$4(this,X4.READ_ONLY,function(x){var y=x.objectStore(i).openCursor(Y4.only(a));x.oncomplete=function(){b(y.result!==u)};x.onerror=Z4(e,p)},e)};_4.prototype.defaultError=c1;_4.prototype.getAllKeys=function(a,e){var b=this.name;var i=this.defaultError;$4(this,X4.READ_ONLY,function(p){var x=[];p.oncomplete=function(){a(x)};var y=p.objectStore(b).openCursor();y.onerror=Z4(e,i);y.onsuccess=function(_){var N5=_.target.result;if(N5){x.push(N5.key);N5["continue"].call(N5)}}},e)};_4.prototype.mechanism="indexeddb";_4.prototype.read=function(a,b,e){var p=this.name;var x=this.defaultError;var y=(a instanceof Array)?a:[a];$4(this,X4.READ_WRITE,function(_){var N5=[];_.onerror=Z4(e,x);_.oncomplete=function(){if(a instanceof Array){b(y,N5)}else{b(y[0],N5[0])}};for(var i=0;i<y.length;i++){var O5=_.objectStore(p);var P5=O5["get"].call(O5,y[i]);P5.onsuccess=function(Q5){N5.push(Q5.target.result)}}},e)};_4.prototype.remove=function(a,b,e){var p=this.name;var x=this.defaultError;var y=(a instanceof Array)?a:[a];$4(this,X4.READ_WRITE,function(_){_.onerror=Z4(e,x);_.oncomplete=function(){b()};for(var i=0;i<y.length;i++){var N5=_.objectStore(p);N5["delete"].call(N5,y[i])}},e)};_4.prototype.update=function(a,b,e,p){var x=this.name;var y=this.defaultError;var _=[];var N5=[];if(a instanceof Array){_=a;N5=b}else{_=[a];N5=[b]}$4(this,X4.READ_WRITE,function(O5){O5.onabort=Z4(p,y);O5.oncomplete=function(){if(a instanceof Array){e(_,N5)}else{e(a,b)}};for(var i=0;i<_.length&&i<N5.length;i++){var P5=O5.objectStore(x).openCursor(Y4.only(_[i]));P5.pair={key:_[i],value:N5[i]};P5.onsuccess=function(Q5){var R5=Q5.target.result;if(R5){R5.update(Q5.target.pair.value)}else{O5.abort()}}}},p)};var a5=function(a){var b=[];var i=[];var e={};this.name=a;var p=function(y){return y||this.defaultError};var x=function(y,_){var N5;if(y instanceof Array){N5="Array of keys not supported"}if(y===u||y===null){N5="Invalid key"}if(N5){A(_,{message:N5});return false}return true};this.add=function(y,_,N5,O5){O5=p(O5);if(x(y,O5)){if(!e.hasOwnProperty(y)){this.addOrUpdate(y,_,N5,O5)}else{O5({message:"key already exists",key:y})}}};this.addOrUpdate=function(y,_,N5,O5){O5=p(O5);if(x(y,O5)){var P5=e[y];if(P5===u){if(b.length>0){P5=b.splice(0,1)}else{P5=i.length}}i[P5]=_;e[y]=P5;A(N5,y,_)}};this.clear=function(y){i=[];e={};b=[];A(y)};this.contains=function(y,_){var N5=e.hasOwnProperty(y);A(_,N5)};this.getAllKeys=function(y){var _=[];for(var a in e){_.push(a)}A(y,_)};this.read=function(y,_,N5){N5=p(N5);if(x(y,N5)){var O5=e[y];A(_,y,i[O5])}};this.remove=function(y,_,N5){N5=p(N5);if(x(y,N5)){var O5=e[y];if(O5!==u){if(O5===i.length-1){i.pop()}else{i[O5]=u;b.push(O5)}delete e[y];if(i.length===0){b=[]}}A(_)}};this.update=function(y,_,N5,O5){O5=p(O5);if(x(y,O5)){if(e.hasOwnProperty(y)){this.addOrUpdate(y,_,N5,O5)}else{O5({message:"key not found",key:y})}}}};a5.create=function(a){return new a5(a)};a5.isSupported=function(){return true};a5.prototype.close=function(){};a5.prototype.defaultError=c1;a5.prototype.mechanism="memory";var b5={indexeddb:_4,dom:V4,memory:a5};d.defaultStoreMechanism="best";d.createStore=function(a,b){if(!b){b=d.defaultStoreMechanism}if(b==="best"){b=(V4.isSupported())?"dom":"memory"}var e=b5[b];if(e){return e.create(a)}throw{message:"Failed to create store",name:a,mechanism:b}};var c5=function(a,b,e){return function(){a[b].apply(a,arguments);return e}};var d5=function(){this._arguments=u;this._done=u;this._fail=u;this._resolved=false;this._rejected=false};d5.prototype={then:function(a,e){if(a){if(!this._done){this._done=[a]}else{this._done.push(a)}}if(e){if(!this._fail){this._fail=[e]}else{this._fail.push(e)}}if(this._resolved){this.resolve.apply(this,this._arguments)}else if(this._rejected){this.reject.apply(this,this._arguments)}return this},resolve:function(){if(this._done){var i,a;for(i=0,a=this._done.length;i<a;i++){this._done[i].apply(null,arguments)}this._done=u;this._resolved=false;this._arguments=u}else{this._resolved=true;this._arguments=arguments}},reject:function(){if(this._fail){var i,a;for(i=0,a=this._fail.length;i<a;i++){this._fail[i].apply(null,arguments)}this._fail=u;this._rejected=false;this._arguments=u}else{this._rejected=true;this._arguments=arguments}},promise:function(){var a={};a.then=c5(this,"then",a);return a}};var e5=function(){if(w.jQuery&&w.jQuery.Deferred){return new w.jQuery.Deferred()}else{return new d5()}};var f5=function(a,b){var e=(a.indexOf("?")>=0)?"&":"?";return a+e+b};var g5=function(a,b){var i=a.indexOf("?");var e="";if(i>=0){e=a.substr(i);a=a.substr(0,i)}if(a[a.length-1]!=="/"){a+="/"}return a+b+e};var h5=function(a,b){return{method:"GET",requestUri:a,user:b.user,password:b.password,enableJsonpCallback:b.enableJsonpCallback,callbackParameterName:b.callbackParameterName,formatQueryString:b.formatQueryString}};var i5=function(a,b){var e=-1;var i=a.indexOf("?");if(i!==-1){var p=a.indexOf("?"+b+"=",i);if(p===-1){p=a.indexOf("&"+b+"=",i)}if(p!==-1){e=p+b.length+2}}return e};var j5=function(a,b,e,i){var p=k5(a,b,[],e,i);return p};var k5=function(a,b,e,i,p){var x=h5(a,b);var y=o.request(x,function(_){var N5=_.__next;var O5=_.results;e=e.concat(O5);if(N5){y=k5(N5,b,e,i,p)}else{i(e)}},p,u,b.httpClient,b.metadata);return{abort:function(){y.abort()}}};var l5=function(a){var b=this;var e=a.source;b.identifier=k1(encodeURI(decodeURI(e)));b.options=a;b.count=function(i,p){var a=b.options;return o.request(h5(g5(e,"$count"),a),function(x){var y=W(x.toString());if(isNaN(y)){p({message:"Count is NaN",count:y})}else{i(y)}},p,u,a.httpClient,a.metadata)};b.read=function(i,p,x,y){var _="$skip="+i+"&$top="+p;return j5(f5(e,_),b.options,x,y)};return b};var m5=function(a,p){
/// <param name="operation" type="Object">Operation with (i)ndex, (c)ount and (d)ata.</param>
/// <param name="page" type="Object">Page with (i)ndex, (c)ount and (d)ata.</param>
var i=n5(a,p);if(i){var b=i.i-p.i;var e=b+(a.c-a.d.length);a.d=a.d.concat(p.d.slice(b,e))}};var n5=function(x,y){
/// <summary>Returns the {(i)ndex, (c)ount} range for the intersection of x and y.</summary>
/// <param name="x" type="Object">Range with (i)ndex and (c)ount members.</param>
/// <param name="y" type="Object">Range with (i)ndex and (c)ount members.</param>
/// <returns type="Object">The intersection (i)ndex and (c)ount; undefined if there is no intersection.</returns>
var a=x.i+x.c;var b=y.i+y.c;var e=(x.i>y.i)?x.i:y.i;var i=(a<b)?a:b;var p;if(i>=e){p={i:e,c:i-e}}return p};var o5=function(a,b){if(a===u||typeof a!=="number"){throw{message:"'"+b+"' must be a number."}}if(isNaN(a)||a<0||!isFinite(a)){throw{message:"'"+b+"' must be greater than or equal to zero."}}};var p5=function(a,b){if(a!==u){if(typeof a!=="number"){throw{message:"'"+b+"' must be a number."}}if(isNaN(a)||a<=0||!isFinite(a)){throw{message:"'"+b+"' must be greater than zero."}}}};var q5=function(a,b){if(a!==u&&(typeof a!=="number"||isNaN(a)||!isFinite(a))){throw{message:"'"+b+"' must be a number."}}};var r5=function(a,b){var i,e;for(i=0,e=a.length;i<e;i++){if(a[i]===b){a.splice(i,1);return true}}return false};var s5=function(a,b){for(var e in b){a[e]=b[e]}return a};var t5=function(a){var b=0;var e=typeof a;if(e==="object"&&a){for(var i in a){b+=i.length*2+t5(a[i])}}else if(e==="string"){b=a.length*2}else{b=8}return b};var u5=function(a,b,p){
/// <returns type="Object">A range with (i)ndex and (c)ount of elements.</returns>
a=Math.floor(a/p)*p;b=Math.ceil((b+1)/p)*p;return{i:a,c:b-a}};var v5="destroy";var w5="idle";var x5="init";var y5="read";var z5="prefetch";var A5="write";var B5="cancel";var C5="end";var D5="error";var E5="start";var F5="wait";var G5="clear";var H5="done";var I5="local";var J5="save";var K5="source";var L5=function(a,p,i,b,e,x,y){var _;var N5;var O5=this;O5.p=p;O5.i=b;O5.c=e;O5.d=x;O5.s=E5;O5.canceled=false;O5.pending=y;O5.oncomplete=null;O5.cancel=function(){if(!i){return}var R5=O5.s;if(R5!==D5&&R5!==C5&&R5!==B5){O5.canceled=true;Q5(B5,_)}};O5.complete=function(){Q5(C5,_)};O5.error=function(R5){if(!O5.canceled){Q5(D5,R5)}};O5.run=function(R5){N5=R5;O5.transition(O5.s,_)};O5.wait=function(x){Q5(F5,x)};var P5=function(R5,N5,x){switch(R5){case E5:if(N5!==x5){a(O5,R5,N5,x)}break;case F5:a(O5,R5,N5,x);break;case B5:a(O5,R5,N5,x);O5.fireCanceled();Q5(C5);break;case D5:a(O5,R5,N5,x);O5.canceled=true;O5.fireRejected(x);Q5(C5);break;case C5:if(O5.oncomplete){O5.oncomplete(O5)}if(!O5.canceled){O5.fireResolved()}a(O5,R5,N5,x);break;default:a(O5,R5,N5,x);break}};var Q5=function(R5,x){O5.s=R5;_=x;P5(R5,N5,x)};O5.transition=Q5;return O5};L5.prototype.fireResolved=function(){var p=this.p;if(p){this.p=null;p.resolve(this.d)}};L5.prototype.fireRejected=function(a){var p=this.p;if(p){this.p=null;p.reject(a)}};L5.prototype.fireCanceled=function(){this.fireRejected({canceled:true,message:"Operation canceled"})};var M5=function(a){var b=x5;var e={counts:0,netReads:0,prefetches:0,cacheReads:0};var p=[];var x=[];var y=[];var N5=0;var O5=false;var P5=V(a.cacheSize,1048576);var Q5=0;var R5=0;var S5=0;var T5=P5===0;var U5=V(a.pageSize,50);var V5=V(a.prefetchSize,U5);var W5="1.0";var X5;var Y5=0;var Z5=a.source;if(typeof Z5==="string"){Z5=new l5(a)}Z5.options=a;var $5=d.createStore(a.name,a.mechanism);var _5=this;_5.onidle=a.idle;_5.stats=e;_5.count=function(){if(X5){throw X5}var i=e5();var _=false;if(O5){A(function(){i.resolve(Q5)});return i.promise()}var t6=Z5.count(function(u6){t6=null;e.counts++;i.resolve(u6)},function(u6){t6=null;i.reject(s5(u6,{canceled:_}))});return s5(i.promise(),{cancel:function(){if(t6){_=true;t6.abort();t6=null}}})};_5.clear=function(){if(X5){throw X5}if(p.length===0){var i=e5();var _=new L5(p6,i,false);i6(_,p);return i.promise()}return p[0].p};_5.filterForward=function(i,_,t6){return f6(i,_,t6,false)};_5.filterBack=function(i,_,t6){return f6(i,_,t6,true)};_5.readRange=function(i,_){o5(i,"index");o5(_,"count");if(X5){throw X5}var t6=e5();var op=new L5(r6,t6,true,i,_,[],0);i6(op,x);return s5(t6.promise(),{cancel:function(){op.cancel()}})};_5.ToObservable=_5.toObservable=function(){if(!w.Rx||!w.Rx.Observable){throw{message:"Rx library not available - include rx.js"}}if(X5){throw X5}return w.Rx.Observable.CreateWithDisposable(function(_){var t6=false;var u6=0;var v6=function(i){if(!t6){_.OnError(i)}};var w6=function(x6){if(!t6){var i,y6;for(i=0,y6=x6.length;i<y6;i++){_.OnNext(x6[i])}if(x6.length<U5){_.OnCompleted()}else{u6+=U5;_5.readRange(u6,U5).then(w6,v6)}}};_5.readRange(u6,U5).then(w6,v6);return{Dispose:function(){t6=true}}})};var a6=function(_){return function(t6){X5={message:_,error:t6};var i,u6;for(i=0,u6=x.length;i<u6;i++){x[i].fireRejected(X5)}for(i=0,u6=p.length;i<u6;i++){p[i].fireRejected(X5)}x=p=null}};var b6=function(_){if(_!==b){b=_;var t6=p.concat(x,y);var i,u6;for(i=0,u6=t6.length;i<u6;i++){t6[i].run(b)}}};var c6=function(){var i=new d5();$5.clear(function(){N5=0;O5=false;Q5=0;R5=0;S5=0;T5=P5===0;e={counts:0,netReads:0,prefetches:0,cacheReads:0};_5.stats=e;$5.close();i.resolve()},function(_){i.reject(_)});return i};var d6=function(i){var _=r5(p,i);if(!_){_=r5(x,i);if(!_){r5(y,i)}}Y5--;b6(w5)};var e6=function(i){
/// <returns type="DjsDeferred">A promise for a page object with (i)ndex, (c)ount, (d)ata.</returns>
var _=new d5();var t6=false;var u6=Z5.read(i,U5,function(v6){var w6={i:i,c:v6.length,d:v6};_.resolve(w6)},function(v6){_.reject(v6)});return s5(_,{cancel:function(){if(u6){u6.abort();t6=true;u6=null}}})};var f6=function(_,t6,u6,v6){_=W(_);t6=W(t6);if(isNaN(_)){throw{message:"'index' must be a valid number.",index:_}}if(isNaN(t6)){throw{message:"'count' must be a valid number.",count:t6}}if(X5){throw X5}_=Math.max(_,0);var w6=e5();var x6=[];var y6=false;var z6=null;var A6=function(E6,F6){if(!y6){if(t6>=0&&x6.length>=t6){w6.resolve(x6)}else{z6=_5.readRange(E6,F6).then(function(G6){for(var i=0,H6=G6.length;i<H6&&(t6<0||x6.length<t6);i++){var I6=v6?H6-i-1:i;var J6=G6[I6];if(u6(J6)){var K6={index:E6+I6,item:J6};v6?x6.unshift(K6):x6.push(K6)}}if((!v6&&G6.length<F6)||(v6&&E6<=0)){w6.resolve(x6)}else{var L6=v6?Math.max(E6-U5,0):E6+F6;A6(L6,U5)}},function(i){w6.reject(i)})}}};var B6=u5(_,_,U5);var C6=v6?B6.i:_;var D6=v6?_-B6.i+1:B6.i+B6.c-_;A6(C6,D6);return s5(w6.promise(),{cancel:function(){if(z6){z6.cancel()}y6=true}})};var g6=function(){if(_5.onidle&&Y5===0){_5.onidle()}};var h6=function(i){if(O5||V5===0||T5){return}if(y.length===0||(y[0]&&y[0].c!==-1)){var _=new L5(q6,null,true,i,V5,null,V5);i6(_,y)}};var i6=function(i,_){i.oncomplete=d6;_.push(i);Y5++;i.run(b)};var j6=function(i){
/// <returns type="DjsDeferred">A promise for a found flag and page object with (i)ndex, (c)ount, (d)ata, and (t)icks.</returns>
var t6=false;var u6=s5(new d5(),{cancel:function(){t6=true}});var v6=m6(u6,"Read page from store failure");$5.contains(i,function(w6){if(t6){return}if(w6){$5.read(i,function(_,x6){if(!t6){u6.resolve(x6!==u,x6)}},v6);return}u6.resolve(false)},v6);return u6};var k6=function(i,_){
/// <param name="page" type="Object">Object with (i)ndex, (c)ount, (d)ata, and (t)icks.</param>
var t6=false;var u6=s5(new d5(),{cancel:function(){t6=true}});var v6=m6(u6,"Save page to store failure");var w6=function(){u6.resolve(true)};if(_.c>0){var x6=t5(_);T5=P5>=0&&P5<N5+x6;if(!T5){$5.addOrUpdate(i,_,function(){n6(_,x6);l6(w6,v6)},v6)}else{w6()}}else{n6(_,0);l6(w6,v6)}return u6};var l6=function(i,_){var t6={actualCacheSize:N5,allDataLocal:O5,cacheSize:P5,collectionCount:Q5,highestSavedPage:R5,highestSavedPageSize:S5,pageSize:U5,sourceId:Z5.identifier,version:W5};$5.addOrUpdate("__settings",t6,i,_)};var m6=function(i){return function(){i.resolve(false)}};var n6=function(i,_){
/// <param name="page" type="Object">Object with (i)ndex, (c)ount, (d)ata.</param>
var t6=i.c;var u6=i.i;if(t6===0){if(R5===u6-U5){Q5=R5+S5}}else{R5=Math.max(R5,u6);if(R5===u6){S5=t6}N5+=_;if(t6<U5&&!Q5){Q5=u6+t6}}if(!O5&&Q5===R5+S5){O5=true}};var o6=function(i,_,t6,u6){var v6=i.canceled&&_!==C5;if(v6){if(_===B5){if(u6&&u6.cancel){u6.cancel()}}}return v6};var p6=function(i,_,t6){var u6=i.transition;if(t6!==v5){b6(v5);return true}switch(_){case E5:u6(G5);break;case C5:g6();break;case G5:c6().then(function(){i.complete()});i.wait();break;default:return false}return true};var q6=function(i,_,t6,u6){if(!o6(i,_,t6,u6)){var v6=i.transition;if(t6!==z5){if(t6===v5){if(_!==B5){i.cancel()}}else if(t6===w5){b6(z5)}return true}switch(_){case E5:if(y[0]===i){v6(I5,i.i)}break;case H5:var w6=i.pending;if(w6>0){w6-=Math.min(w6,u6.c)}if(O5||w6===0||u6.c<U5||T5){i.complete()}else{i.pending=w6;v6(I5,u6.i+U5)}break;default:return s6(i,_,t6,u6,true)}}return true};var r6=function(i,_,t6,u6){if(!o6(i,_,t6,u6)){var v6=i.transition;if(t6!==y5&&_!==E5){if(t6===v5){if(_!==E5){i.cancel()}}else if(t6!==A5){b6(y5)}return true}switch(_){case E5:if(t6===w5||t6===z5){b6(y5);if(i.c>0){var w6=u5(i.i,i.c,U5);v6(I5,w6.i)}else{v6(H5,i)}}break;case H5:m5(i,u6);var x6=i.d.length;if(i.c===x6||u6.c<U5){e.cacheReads++;h6(u6.i+u6.c);i.complete()}else{v6(I5,u6.i+U5)}break;default:return s6(i,_,t6,u6,false)}}return true};var s6=function(i,_,t6,u6,v6){var w6=i.error;var x6=i.transition;var y6=i.wait;var z6;switch(_){case C5:g6();break;case I5:z6=j6(u6).then(function(A6,B6){if(!i.canceled){if(A6){x6(H5,B6)}else{x6(K5,u6)}}});break;case K5:z6=e6(u6).then(function(A6){if(!i.canceled){if(v6){e.prefetches++}else{e.netReads++}x6(J5,A6)}},w6);break;case J5:if(t6!==A5){b6(A5);z6=k6(u6.i,u6).then(function(A6){if(!i.canceled){if(!A6&&v6){i.pending=0}x6(H5,u6)}b6(w5)})}break;default:return false}if(z6){if(i.canceled){z6.cancel()}else if(i.s===_){y6(z6)}}return true};$5.read("__settings",function(_,i){if(t(i)){var t6=i.version;if(!t6||t6.indexOf("1.")!==0){a6("Unsupported cache store version "+t6)();return}if(U5!==i.pageSize||Z5.identifier!==i.sourceId){c6().then(function(){b6(w5)},a6("Unable to clear store during initialization"))}else{N5=i.actualCacheSize;O5=i.allDataLocal;P5=i.cacheSize;Q5=i.collectionCount;R5=i.highestSavedPage;S5=i.highestSavedPageSize;W5=t6;b6(w5)}}else{l6(function(){b6(w5)},a6("Unable to write settings during initialization."))}},a6("Unable to read settings from store."));return _5};d.createDataCache=function(a){p5(a.pageSize,"pageSize");q5(a.cacheSize,"cacheSize");q5(a.prefetchSize,"prefetchSize");if(!t(a.name)){throw{message:"Undefined or null name",options:a}}if(!t(a.source)){throw{message:"Undefined source",options:a}}return new M5(a)}})(window);
